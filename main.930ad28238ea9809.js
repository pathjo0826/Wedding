"use strict";(self.webpackChunkwedding_app=self.webpackChunkwedding_app||[]).push([[792],{443:(hs,or,Ge)=>{Ge.d(or,{$:()=>sv,A:()=>he,G:()=>Tt,K:()=>Qy,L:()=>Mo,N:()=>Vs,P:()=>yi,R:()=>PT,U:()=>He,V:()=>gs,W:()=>jt,X:()=>wd,Y:()=>bp,Z:()=>gi,_:()=>Oo,a:()=>Ev,a0:()=>Bu,a1:()=>Ad,a2:()=>uv,a3:()=>cv,a4:()=>vT,a5:()=>Vi,a6:()=>dv,a7:()=>ET,a8:()=>Vn,a9:()=>at,aA:()=>zy,aB:()=>zt,aC:()=>K,aD:()=>rg,aE:()=>ie,aF:()=>bt,aG:()=>tg,aH:()=>Uv,aI:()=>FT,aJ:()=>Ln,aN:()=>Hr,aQ:()=>Ia,aa:()=>ms,ab:()=>$r,ac:()=>cl,ad:()=>Lo,ae:()=>dl,af:()=>hl,ag:()=>zu,ah:()=>Bs,ak:()=>uo,al:()=>Wu,am:()=>vt,ap:()=>_T,aq:()=>mi,as:()=>Q1,at:()=>vv,au:()=>rt,av:()=>_p,aw:()=>Ze,ax:()=>Ht,ay:()=>El,az:()=>ig,b:()=>co,c:()=>Ov,d:()=>Lv,e:()=>Fv,f:()=>LT,g:()=>$v,h:()=>ni,i:()=>Nd,j:()=>eg,k:()=>Da,l:()=>qp,m:()=>ok,p:()=>Mt,r:()=>$s,s:()=>Mv,u:()=>Qp});var x=Ge(467),Ae=Ge(631),N=Ge(401),Fe=Ge(398),Nt=Ge(635),hn=Ge(779);const Mt={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},he={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};const Tt=function Le(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},tr=function ot(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}},gt=new N.FA("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),qe=new Fe.Vy("@firebase/auth");function fn(g,...c){qe.logLevel<=Fe.$b.ERROR&&qe.error(`Auth (${Ae.SDK_VERSION}): ${g}`,...c)}function Ht(g,...c){throw ve(g,...c)}function zt(g,...c){return ve(g,...c)}function Lr(g,c,h){const m=Object.assign(Object.assign({},tr()),{[c]:h});return new N.FA("auth","Firebase",m).create(c,{appName:g.name})}function _t(g){return Lr(g,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function nt(g,c,h){if(!(c instanceof h))throw h.name!==c.constructor.name&&Ht(g,"argument-error"),Lr(g,"argument-error",`Type of ${c.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ve(g,...c){if("string"!=typeof g){const h=c[0],m=[...c.slice(1)];return m[0]&&(m[0].appName=g.name),g._errorFactory.create(h,...m)}return gt.create(g,...c)}function K(g,c,...h){if(!g)throw ve(c,...h)}function je(g){const c="INTERNAL ASSERTION FAILED: "+g;throw fn(c),new Error(c)}function rt(g,c){g||je(c)}function At(){var g;return typeof self<"u"&&(null===(g=self.location)||void 0===g?void 0:g.href)||""}function kn(){return"http:"===sn()||"https:"===sn()}function sn(){var g;return typeof self<"u"&&(null===(g=self.location)||void 0===g?void 0:g.protocol)||null}class pr{constructor(c,h){this.shortDelay=c,this.longDelay=h,rt(h>c,"Short delay should be less than long delay!"),this.isMobile=(0,N.jZ)()||(0,N.lV)()}get(){return function lt(){return!(typeof navigator<"u"&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(kn()||(0,N.sr)()||"connection"in navigator))||navigator.onLine}()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Xr(g,c){rt(g.emulator,"Emulator should always be set here");const{url:h}=g.emulator;return c?`${h}${c.startsWith("/")?c.slice(1):c}`:h}class ks{static initialize(c,h,m){this.fetchImpl=c,h&&(this.headersImpl=h),m&&(this.responseImpl=m)}static fetch(){return this.fetchImpl?this.fetchImpl:typeof self<"u"&&"fetch"in self?self.fetch:typeof globalThis<"u"&&globalThis.fetch?globalThis.fetch:typeof fetch<"u"?fetch:void je("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:typeof self<"u"&&"Headers"in self?self.Headers:typeof globalThis<"u"&&globalThis.Headers?globalThis.Headers:typeof Headers<"u"?Headers:void je("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:typeof self<"u"&&"Response"in self?self.Response:typeof globalThis<"u"&&globalThis.Response?globalThis.Response:typeof Response<"u"?Response:void je("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const W={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},ee=new pr(3e4,6e4);function Q(g,c){return g.tenantId&&!c.tenantId?Object.assign(Object.assign({},c),{tenantId:g.tenantId}):c}function $(g,c,h,m){return re.apply(this,arguments)}function re(){return(re=(0,x.A)(function*(g,c,h,m,w={}){return ge(g,w,(0,x.A)(function*(){let b={},L={};m&&("GET"===c?L=m:b={body:JSON.stringify(m)});const X=(0,N.Am)(Object.assign({key:g.config.apiKey},L)).slice(1),le=yield g._getAdditionalHeaders();le["Content-Type"]="application/json",g.languageCode&&(le["X-Firebase-Locale"]=g.languageCode);const Me=Object.assign({method:c,headers:le},b);return(0,N.c1)()||(Me.referrerPolicy="no-referrer"),ks.fetch()(Ke(g,g.config.apiHost,h,X),Me)}))})).apply(this,arguments)}function ge(g,c,h){return de.apply(this,arguments)}function de(){return(de=(0,x.A)(function*(g,c,h){g._canInitEmulator=!1;const m=Object.assign(Object.assign({},W),c);try{const w=new gn(g),b=yield Promise.race([h(),w.promise]);w.clearNetworkTimeout();const L=yield b.json();if("needConfirmation"in L)throw gr(g,"account-exists-with-different-credential",L);if(b.ok&&!("errorMessage"in L))return L;{const X=b.ok?L.errorMessage:L.error.message,[le,Me]=X.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===le)throw gr(g,"credential-already-in-use",L);if("EMAIL_EXISTS"===le)throw gr(g,"email-already-in-use",L);if("USER_DISABLED"===le)throw gr(g,"user-disabled",L);const ze=m[le]||le.toLowerCase().replace(/[_\s]+/g,"-");if(Me)throw Lr(g,ze,Me);Ht(g,ze)}}catch(w){if(w instanceof N.g)throw w;Ht(g,"network-request-failed",{message:String(w)})}})).apply(this,arguments)}function Qe(g,c,h,m){return Qt.apply(this,arguments)}function Qt(){return(Qt=(0,x.A)(function*(g,c,h,m,w={}){const b=yield $(g,c,h,m,w);return"mfaPendingCredential"in b&&Ht(g,"multi-factor-auth-required",{_serverResponse:b}),b})).apply(this,arguments)}function Ke(g,c,h,m){const w=`${c}${h}?${m}`;return g.config.emulator?Xr(g.config,w):`${g.config.apiScheme}://${w}`}function Ft(g){switch(g){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class gn{constructor(c){this.auth=c,this.timer=null,this.promise=new Promise((h,m)=>{this.timer=setTimeout(()=>m(zt(this.auth,"network-request-failed")),ee.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function gr(g,c,h){const m={appName:g.name};h.email&&(m.email=h.email),h.phoneNumber&&(m.phoneNumber=h.phoneNumber);const w=zt(g,c,m);return w.customData._tokenResponse=h,w}function kt(g){return void 0!==g&&void 0!==g.getResponse}function Ot(g){return void 0!==g&&void 0!==g.enterprise}class Gn{constructor(c){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===c.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=c.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=c.recaptchaEnforcementState}getProviderEnforcementState(c){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const h of this.recaptchaEnforcementState)if(h.provider&&h.provider===c)return Ft(h.enforcementState);return null}isProviderEnabled(c){return"ENFORCE"===this.getProviderEnforcementState(c)||"AUDIT"===this.getProviderEnforcementState(c)}}function Ir(){return(Ir=(0,x.A)(function*(g){return(yield $(g,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""})).apply(this,arguments)}function Ut(g,c){return hi.apply(this,arguments)}function hi(){return(hi=(0,x.A)(function*(g,c){return $(g,"GET","/v2/recaptchaConfig",Q(g,c))})).apply(this,arguments)}function Po(){return(Po=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:delete",c)})).apply(this,arguments)}function fi(){return(fi=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Xi(g,c){return Fs.apply(this,arguments)}function Fs(){return(Fs=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:lookup",c)})).apply(this,arguments)}function mr(g){if(g)try{const c=new Date(Number(g));if(!isNaN(c.getTime()))return c.toUTCString()}catch{}}function wr(){return(wr=(0,x.A)(function*(g,c=!1){const h=(0,N.Ku)(g),m=yield h.getIdToken(c),w=ro(m);K(w&&w.exp&&w.auth_time&&w.iat,h.auth,"internal-error");const b="object"==typeof w.firebase?w.firebase:void 0,L=b?.sign_in_provider;return{claims:w,token:m,authTime:mr(qn(w.auth_time)),issuedAtTime:mr(qn(w.iat)),expirationTime:mr(qn(w.exp)),signInProvider:L||null,signInSecondFactor:b?.sign_in_second_factor||null}})).apply(this,arguments)}function qn(g){return 1e3*Number(g)}function ro(g){const[c,h,m]=g.split(".");if(void 0===c||void 0===h||void 0===m)return fn("JWT malformed, contained fewer than 3 sections"),null;try{const w=(0,N.u)(h);return w?JSON.parse(w):(fn("Failed to decode base64 JWT payload"),null)}catch(w){return fn("Caught error parsing JWT payload as JSON",w?.toString()),null}}function Zi(g){const c=ro(g);return K(c,"internal-error"),K(typeof c.exp<"u","internal-error"),K(typeof c.iat<"u","internal-error"),Number(c.exp)-Number(c.iat)}function Yt(g,c){return Mi.apply(this,arguments)}function Mi(){return(Mi=(0,x.A)(function*(g,c,h=!1){if(h)return c;try{return yield c}catch(m){throw m instanceof N.g&&function fs({code:g}){return"auth/user-disabled"===g||"auth/user-token-expired"===g}(m)&&g.auth.currentUser===g&&(yield g.auth.signOut()),m}})).apply(this,arguments)}class es{constructor(c){this.user=c,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(c){var h;if(c){const m=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),m}{this.errorBackoff=3e4;const w=(null!==(h=this.user.stsTokenManager.expirationTime)&&void 0!==h?h:0)-Date.now()-3e5;return Math.max(0,w)}}schedule(c=!1){var h=this;if(!this.isRunning)return;const m=this.getInterval(c);this.timerId=setTimeout((0,x.A)(function*(){yield h.iteration()}),m)}iteration(){var c=this;return(0,x.A)(function*(){try{yield c.user.getIdToken(!0)}catch(h){return void("auth/network-request-failed"===h?.code&&c.schedule(!0))}c.schedule()})()}}class Sr{constructor(c,h){this.createdAt=c,this.lastLoginAt=h,this._initializeTime()}_initializeTime(){this.lastSignInTime=mr(this.lastLoginAt),this.creationTime=mr(this.createdAt)}_copy(c){this.createdAt=c.createdAt,this.lastLoginAt=c.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}function nr(g){return Vr.apply(this,arguments)}function Vr(){return(Vr=(0,x.A)(function*(g){var c;const h=g.auth,m=yield g.getIdToken(),w=yield Yt(g,Xi(h,{idToken:m}));K(w?.users.length,h,"internal-error");const b=w.users[0];g._notifyReloadListener(b);const L=null!==(c=b.providerUserInfo)&&void 0!==c&&c.length?No(b.providerUserInfo):[],X=function oo(g,c){return[...g.filter(m=>!c.some(w=>w.providerId===m.providerId)),...c]}(g.providerData,L),ze=!!g.isAnonymous&&!(g.email&&b.passwordHash||X?.length),mt={uid:b.localId,displayName:b.displayName||null,photoURL:b.photoUrl||null,email:b.email||null,emailVerified:b.emailVerified||!1,phoneNumber:b.phoneNumber||null,tenantId:b.tenantId||null,providerData:X,metadata:new Sr(b.createdAt,b.lastLoginAt),isAnonymous:ze};Object.assign(g,mt)})).apply(this,arguments)}function so(){return(so=(0,x.A)(function*(g){const c=(0,N.Ku)(g);yield nr(c),yield c.auth._persistUserIfCurrent(c),c.auth._notifyListenersIfCurrent(c)})).apply(this,arguments)}function No(g){return g.map(c=>{var{providerId:h}=c,m=(0,Nt.Tt)(c,["providerId"]);return{providerId:h,uid:m.rawId||"",displayName:m.displayName||null,email:m.email||null,phoneNumber:m.phoneNumber||null,photoURL:m.photoUrl||null}})}function Re(){return(Re=(0,x.A)(function*(g,c){const h=yield ge(g,{},(0,x.A)(function*(){const m=(0,N.Am)({grant_type:"refresh_token",refresh_token:c}).slice(1),{tokenApiHost:w,apiKey:b}=g.config,L=Ke(g,w,"/v1/token",`key=${b}`),X=yield g._getAdditionalHeaders();return X["Content-Type"]="application/x-www-form-urlencoded",ks.fetch()(L,{method:"POST",headers:X,body:m})}));return{accessToken:h.access_token,expiresIn:h.expires_in,refreshToken:h.refresh_token}})).apply(this,arguments)}function C(){return(C=(0,x.A)(function*(g,c){return $(g,"POST","/v2/accounts:revokeToken",Q(g,c))})).apply(this,arguments)}class E{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(c){K(c.idToken,"internal-error"),K(typeof c.idToken<"u","internal-error"),K(typeof c.refreshToken<"u","internal-error");const h="expiresIn"in c&&typeof c.expiresIn<"u"?Number(c.expiresIn):Zi(c.idToken);this.updateTokensAndExpiration(c.idToken,c.refreshToken,h)}updateFromIdToken(c){K(0!==c.length,"internal-error");const h=Zi(c);this.updateTokensAndExpiration(c,null,h)}getToken(c,h=!1){var m=this;return(0,x.A)(function*(){return h||!m.accessToken||m.isExpired?(K(m.refreshToken,c,"user-token-expired"),m.refreshToken?(yield m.refresh(c,m.refreshToken),m.accessToken):null):m.accessToken})()}clearRefreshToken(){this.refreshToken=null}refresh(c,h){var m=this;return(0,x.A)(function*(){const{accessToken:w,refreshToken:b,expiresIn:L}=yield function ya(g,c){return Re.apply(this,arguments)}(c,h);m.updateTokensAndExpiration(w,b,Number(L))})()}updateTokensAndExpiration(c,h,m){this.refreshToken=h||null,this.accessToken=c||null,this.expirationTime=Date.now()+1e3*m}static fromJSON(c,h){const{refreshToken:m,accessToken:w,expirationTime:b}=h,L=new E;return m&&(K("string"==typeof m,"internal-error",{appName:c}),L.refreshToken=m),w&&(K("string"==typeof w,"internal-error",{appName:c}),L.accessToken=w),b&&(K("number"==typeof b,"internal-error",{appName:c}),L.expirationTime=b),L}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(c){this.accessToken=c.accessToken,this.refreshToken=c.refreshToken,this.expirationTime=c.expirationTime}_clone(){return Object.assign(new E,this.toJSON())}_performRefresh(){return je("not implemented")}}function T(g,c){K("string"==typeof g||typeof g>"u","internal-error",{appName:c})}class R{constructor(c){var{uid:h,auth:m,stsTokenManager:w}=c,b=(0,Nt.Tt)(c,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new es(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=h,this.auth=m,this.stsTokenManager=w,this.accessToken=w.accessToken,this.displayName=b.displayName||null,this.email=b.email||null,this.emailVerified=b.emailVerified||!1,this.phoneNumber=b.phoneNumber||null,this.photoURL=b.photoURL||null,this.isAnonymous=b.isAnonymous||!1,this.tenantId=b.tenantId||null,this.providerData=b.providerData?[...b.providerData]:[],this.metadata=new Sr(b.createdAt||void 0,b.lastLoginAt||void 0)}getIdToken(c){var h=this;return(0,x.A)(function*(){const m=yield Yt(h,h.stsTokenManager.getToken(h.auth,c));return K(m,h.auth,"internal-error"),h.accessToken!==m&&(h.accessToken=m,yield h.auth._persistUserIfCurrent(h),h.auth._notifyListenersIfCurrent(h)),m})()}getIdTokenResult(c){return function On(g){return wr.apply(this,arguments)}(this,c)}reload(){return function io(g){return so.apply(this,arguments)}(this)}_assign(c){this!==c&&(K(this.uid===c.uid,this.auth,"internal-error"),this.displayName=c.displayName,this.photoURL=c.photoURL,this.email=c.email,this.emailVerified=c.emailVerified,this.phoneNumber=c.phoneNumber,this.isAnonymous=c.isAnonymous,this.tenantId=c.tenantId,this.providerData=c.providerData.map(h=>Object.assign({},h)),this.metadata._copy(c.metadata),this.stsTokenManager._assign(c.stsTokenManager))}_clone(c){const h=new R(Object.assign(Object.assign({},this),{auth:c,stsTokenManager:this.stsTokenManager._clone()}));return h.metadata._copy(this.metadata),h}_onReload(c){K(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=c,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(c){this.reloadListener?this.reloadListener(c):this.reloadUserInfo=c}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}_updateTokensIfNecessary(c,h=!1){var m=this;return(0,x.A)(function*(){let w=!1;c.idToken&&c.idToken!==m.stsTokenManager.accessToken&&(m.stsTokenManager.updateFromServerResponse(c),w=!0),h&&(yield nr(m)),yield m.auth._persistUserIfCurrent(m),w&&m.auth._notifyListenersIfCurrent(m)})()}delete(){var c=this;return(0,x.A)(function*(){if((0,Ae._isFirebaseServerApp)(c.auth.app))return Promise.reject(_t(c.auth));const h=yield c.getIdToken();return yield Yt(c,function no(g,c){return Po.apply(this,arguments)}(c.auth,{idToken:h})),c.stsTokenManager.clearRefreshToken(),c.auth.signOut()})()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(c=>Object.assign({},c)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(c,h){var m,w,b,L,X,le,Me,ze;const mt=null!==(m=h.displayName)&&void 0!==m?m:void 0,si=null!==(w=h.email)&&void 0!==w?w:void 0,$o=null!==(b=h.phoneNumber)&&void 0!==b?b:void 0,Ra=null!==(L=h.photoURL)&&void 0!==L?L:void 0,Ho=null!==(X=h.tenantId)&&void 0!==X?X:void 0,mg=null!==(le=h._redirectEventId)&&void 0!==le?le:void 0,_g=null!==(Me=h.createdAt)&&void 0!==Me?Me:void 0,yg=null!==(ze=h.lastLoginAt)&&void 0!==ze?ze:void 0,{uid:xa,emailVerified:Zv,isAnonymous:zr,providerData:vg,stsTokenManager:Cr}=h;K(xa&&Cr,c,"internal-error");const Eg=E.fromJSON(this.name,Cr);K("string"==typeof xa,c,"internal-error"),T(mt,c.name),T(si,c.name),K("boolean"==typeof Zv,c,"internal-error"),K("boolean"==typeof zr,c,"internal-error"),T($o,c.name),T(Ra,c.name),T(Ho,c.name),T(mg,c.name),T(_g,c.name),T(yg,c.name);const Ig=new R({uid:xa,auth:c,email:si,emailVerified:Zv,displayName:mt,isAnonymous:zr,photoURL:Ra,phoneNumber:$o,tenantId:Ho,stsTokenManager:Eg,createdAt:_g,lastLoginAt:yg});return vg&&Array.isArray(vg)&&(Ig.providerData=vg.map(eE=>Object.assign({},eE))),mg&&(Ig._redirectEventId=mg),Ig}static _fromIdTokenResponse(c,h,m=!1){return(0,x.A)(function*(){const w=new E;w.updateFromServerResponse(h);const b=new R({uid:h.localId,auth:c,stsTokenManager:w,isAnonymous:m});return yield nr(b),b})()}static _fromGetAccountInfoResponse(c,h,m){return(0,x.A)(function*(){const w=h.users[0];K(void 0!==w.localId,"internal-error");const b=void 0!==w.providerUserInfo?No(w.providerUserInfo):[],L=!(w.email&&w.passwordHash||b?.length),X=new E;X.updateFromIdToken(m);const le=new R({uid:w.localId,auth:c,stsTokenManager:X,isAnonymous:L}),Me={uid:w.localId,displayName:w.displayName||null,photoURL:w.photoUrl||null,email:w.email||null,emailVerified:w.emailVerified||!1,phoneNumber:w.phoneNumber||null,tenantId:w.tenantId||null,providerData:b,metadata:new Sr(w.createdAt,w.lastLoginAt),isAnonymous:!(w.email&&w.passwordHash||b?.length)};return Object.assign(le,Me),le})()}}const k=new Map;function ie(g){rt(g instanceof Function,"Expected a class definition");let c=k.get(g);return c?(rt(c instanceof g,"Instance stored in cache mismatched with class"),c):(c=new g,k.set(g,c),c)}const He=(()=>{class g{constructor(){this.type="NONE",this.storage={}}_isAvailable(){return(0,x.A)(function*(){return!0})()}_set(h,m){var w=this;return(0,x.A)(function*(){w.storage[h]=m})()}_get(h){var m=this;return(0,x.A)(function*(){const w=m.storage[h];return void 0===w?null:w})()}_remove(h){var m=this;return(0,x.A)(function*(){delete m.storage[h]})()}_addListener(h,m){}_removeListener(h,m){}}return g.type="NONE",g})();function bt(g,c,h){return`firebase:${g}:${c}:${h}`}class Ve{constructor(c,h,m){this.persistence=c,this.auth=h,this.userKey=m;const{config:w,name:b}=this.auth;this.fullUserKey=bt(this.userKey,w.apiKey,b),this.fullPersistenceKey=bt("persistence",w.apiKey,b),this.boundEventHandler=h._onStorageEvent.bind(h),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(c){return this.persistence._set(this.fullUserKey,c.toJSON())}getCurrentUser(){var c=this;return(0,x.A)(function*(){const h=yield c.persistence._get(c.fullUserKey);return h?R._fromJSON(c.auth,h):null})()}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}setPersistence(c){var h=this;return(0,x.A)(function*(){if(h.persistence===c)return;const m=yield h.getCurrentUser();return yield h.removeCurrentUser(),h.persistence=c,m?h.setCurrentUser(m):void 0})()}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static create(c,h,m="authUser"){return(0,x.A)(function*(){if(!h.length)return new Ve(ie(He),c,m);const w=(yield Promise.all(h.map(function(){var Me=(0,x.A)(function*(ze){if(yield ze._isAvailable())return ze});return function(ze){return Me.apply(this,arguments)}}()))).filter(Me=>Me);let b=w[0]||ie(He);const L=bt(m,c.config.apiKey,c.name);let X=null;for(const Me of h)try{const ze=yield Me._get(L);if(ze){const mt=R._fromJSON(c,ze);Me!==b&&(X=mt),b=Me;break}}catch{}const le=w.filter(Me=>Me._shouldAllowMigration);return b._shouldAllowMigration&&le.length?(b=le[0],X&&(yield b._set(L,X.toJSON())),yield Promise.all(h.map(function(){var Me=(0,x.A)(function*(ze){if(ze!==b)try{yield ze._remove(L)}catch{}});return function(ze){return Me.apply(this,arguments)}}())),new Ve(b,c,m)):new Ve(b,c,m)})()}}function mn(g){const c=g.toLowerCase();if(c.includes("opera/")||c.includes("opr/")||c.includes("opios/"))return"Opera";if(Jt(c))return"IEMobile";if(c.includes("msie")||c.includes("trident/"))return"IE";if(c.includes("edge/"))return"Edge";if(be(c))return"Firefox";if(c.includes("silk/"))return"Silk";if(md(c))return"Blackberry";if(_d(c))return"Webos";if(Fn(c))return"Safari";if((c.includes("chrome/")||Ls(c))&&!c.includes("edge/"))return"Chrome";if(Ze(c))return"Android";{const m=g.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if(2===m?.length)return m[1]}return"Other"}function be(g=(0,N.ZQ)()){return/firefox\//i.test(g)}function Fn(g=(0,N.ZQ)()){const c=g.toLowerCase();return c.includes("safari/")&&!c.includes("chrome/")&&!c.includes("crios/")&&!c.includes("android")}function Ls(g=(0,N.ZQ)()){return/crios\//i.test(g)}function Jt(g=(0,N.ZQ)()){return/iemobile/i.test(g)}function Ze(g=(0,N.ZQ)()){return/android/i.test(g)}function md(g=(0,N.ZQ)()){return/blackberry/i.test(g)}function _d(g=(0,N.ZQ)()){return/webos/i.test(g)}function _p(g=(0,N.ZQ)()){return/iphone|ipad|ipod/i.test(g)||/macintosh/i.test(g)&&/mobile/i.test(g)}function zy(g=(0,N.ZQ)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(g)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(g)}function it(g=(0,N.ZQ)()){return _p(g)||Ze(g)||_d(g)||md(g)||/windows phone/i.test(g)||Jt(g)}function Wt(g,c=[]){let h;switch(g){case"Browser":h=mn((0,N.ZQ)());break;case"Worker":h=`${mn((0,N.ZQ)())}-${g}`;break;default:h=g}const m=c.length?c.join(","):"FirebaseCore-web";return`${h}/JsCore/${Ae.SDK_VERSION}/${m}`}class oT{constructor(c){this.auth=c,this.queue=[]}pushCallback(c,h){const m=b=>new Promise((L,X)=>{try{L(c(b))}catch(le){X(le)}});m.onAbort=h,this.queue.push(m);const w=this.queue.length-1;return()=>{this.queue[w]=()=>Promise.resolve()}}runMiddleware(c){var h=this;return(0,x.A)(function*(){if(h.auth.currentUser===c)return;const m=[];try{for(const w of h.queue)yield w(c),w.onAbort&&m.push(w.onAbort)}catch(w){m.reverse();for(const b of m)try{b()}catch{}throw h.auth._errorFactory.create("login-blocked",{originalMessage:w?.message})}})()}}function yp(){return(yp=(0,x.A)(function*(g,c={}){return $(g,"GET","/v2/passwordPolicy",Q(g,c))})).apply(this,arguments)}class ki{constructor(c){var h,m,w,b;const L=c.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(h=L.minPasswordLength)&&void 0!==h?h:6,L.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=L.maxPasswordLength),void 0!==L.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=L.containsLowercaseCharacter),void 0!==L.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=L.containsUppercaseCharacter),void 0!==L.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=L.containsNumericCharacter),void 0!==L.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=L.containsNonAlphanumericCharacter),this.enforcementState=c.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(w=null===(m=c.allowedNonAlphanumericCharacters)||void 0===m?void 0:m.join(""))&&void 0!==w?w:"",this.forceUpgradeOnSignin=null!==(b=c.forceUpgradeOnSignin)&&void 0!==b&&b,this.schemaVersion=c.schemaVersion}validatePassword(c){var h,m,w,b,L,X;const le={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(c,le),this.validatePasswordCharacterOptions(c,le),le.isValid&&(le.isValid=null===(h=le.meetsMinPasswordLength)||void 0===h||h),le.isValid&&(le.isValid=null===(m=le.meetsMaxPasswordLength)||void 0===m||m),le.isValid&&(le.isValid=null===(w=le.containsLowercaseLetter)||void 0===w||w),le.isValid&&(le.isValid=null===(b=le.containsUppercaseLetter)||void 0===b||b),le.isValid&&(le.isValid=null===(L=le.containsNumericCharacter)||void 0===L||L),le.isValid&&(le.isValid=null===(X=le.containsNonAlphanumericCharacter)||void 0===X||X),le}validatePasswordLengthOptions(c,h){const m=this.customStrengthOptions.minPasswordLength,w=this.customStrengthOptions.maxPasswordLength;m&&(h.meetsMinPasswordLength=c.length>=m),w&&(h.meetsMaxPasswordLength=c.length<=w)}validatePasswordCharacterOptions(c,h){let m;this.updatePasswordCharacterOptionsStatuses(h,!1,!1,!1,!1);for(let w=0;w<c.length;w++)m=c.charAt(w),this.updatePasswordCharacterOptionsStatuses(h,m>="a"&&m<="z",m>="A"&&m<="Z",m>="0"&&m<="9",this.allowedNonAlphanumericCharacters.includes(m))}updatePasswordCharacterOptionsStatuses(c,h,m,w,b){this.customStrengthOptions.containsLowercaseLetter&&(c.containsLowercaseLetter||(c.containsLowercaseLetter=h)),this.customStrengthOptions.containsUppercaseLetter&&(c.containsUppercaseLetter||(c.containsUppercaseLetter=m)),this.customStrengthOptions.containsNumericCharacter&&(c.containsNumericCharacter||(c.containsNumericCharacter=w)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(c.containsNonAlphanumericCharacter||(c.containsNonAlphanumericCharacter=b))}}class O1{constructor(c,h,m,w){this.app=c,this.heartbeatServiceProvider=h,this.appCheckServiceProvider=m,this.config=w,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aT(this),this.idTokenSubscription=new aT(this),this.beforeStateQueue=new oT(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=gt,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=c.name,this.clientVersion=w.sdkClientVersion}_initializeWithPersistence(c,h){var m=this;return h&&(this._popupRedirectResolver=ie(h)),this._initializationPromise=this.queue((0,x.A)(function*(){var w,b;if(!m._deleted&&(m.persistenceManager=yield Ve.create(m,c),!m._deleted)){if(null!==(w=m._popupRedirectResolver)&&void 0!==w&&w._shouldInitProactively)try{yield m._popupRedirectResolver._initialize(m)}catch{}yield m.initializeCurrentUser(h),m.lastNotifiedUid=(null===(b=m.currentUser)||void 0===b?void 0:b.uid)||null,!m._deleted&&(m._isInitialized=!0)}})),this._initializationPromise}_onStorageEvent(){var c=this;return(0,x.A)(function*(){if(c._deleted)return;const h=yield c.assertedPersistence.getCurrentUser();if(c.currentUser||h){if(c.currentUser&&h&&c.currentUser.uid===h.uid)return c._currentUser._assign(h),void(yield c.currentUser.getIdToken());yield c._updateCurrentUser(h,!0)}})()}initializeCurrentUserFromIdToken(c){var h=this;return(0,x.A)(function*(){try{const m=yield Xi(h,{idToken:c}),w=yield R._fromGetAccountInfoResponse(h,m,c);yield h.directlySetCurrentUser(w)}catch(m){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",m),yield h.directlySetCurrentUser(null)}})()}initializeCurrentUser(c){var h=this;return(0,x.A)(function*(){var m;if((0,Ae._isFirebaseServerApp)(h.app)){const X=h.app.settings.authIdToken;return X?new Promise(le=>{setTimeout(()=>h.initializeCurrentUserFromIdToken(X).then(le,le))}):h.directlySetCurrentUser(null)}const w=yield h.assertedPersistence.getCurrentUser();let b=w,L=!1;if(c&&h.config.authDomain){yield h.getOrInitRedirectPersistenceManager();const X=null===(m=h.redirectUser)||void 0===m?void 0:m._redirectEventId,le=b?._redirectEventId,Me=yield h.tryRedirectSignIn(c);(!X||X===le)&&Me?.user&&(b=Me.user,L=!0)}if(!b)return h.directlySetCurrentUser(null);if(!b._redirectEventId){if(L)try{yield h.beforeStateQueue.runMiddleware(b)}catch(X){b=w,h._popupRedirectResolver._overrideRedirectResult(h,()=>Promise.reject(X))}return b?h.reloadAndSetCurrentUserOrClear(b):h.directlySetCurrentUser(null)}return K(h._popupRedirectResolver,h,"argument-error"),yield h.getOrInitRedirectPersistenceManager(),h.redirectUser&&h.redirectUser._redirectEventId===b._redirectEventId?h.directlySetCurrentUser(b):h.reloadAndSetCurrentUserOrClear(b)})()}tryRedirectSignIn(c){var h=this;return(0,x.A)(function*(){let m=null;try{m=yield h._popupRedirectResolver._completeRedirectFn(h,c,!0)}catch{yield h._setRedirectUser(null)}return m})()}reloadAndSetCurrentUserOrClear(c){var h=this;return(0,x.A)(function*(){try{yield nr(c)}catch(m){if("auth/network-request-failed"!==m?.code)return h.directlySetCurrentUser(null)}return h.directlySetCurrentUser(c)})()}useDeviceLanguage(){this.languageCode=function pn(){if(typeof navigator>"u")return null;const g=navigator;return g.languages&&g.languages[0]||g.language||null}()}_delete(){var c=this;return(0,x.A)(function*(){c._deleted=!0})()}updateCurrentUser(c){var h=this;return(0,x.A)(function*(){if((0,Ae._isFirebaseServerApp)(h.app))return Promise.reject(_t(h));const m=c?(0,N.Ku)(c):null;return m&&K(m.auth.config.apiKey===h.config.apiKey,h,"invalid-user-token"),h._updateCurrentUser(m&&m._clone(h))})()}_updateCurrentUser(c,h=!1){var m=this;return(0,x.A)(function*(){if(!m._deleted)return c&&K(m.tenantId===c.tenantId,m,"tenant-id-mismatch"),h||(yield m.beforeStateQueue.runMiddleware(c)),m.queue((0,x.A)(function*(){yield m.directlySetCurrentUser(c),m.notifyAuthListeners()}))})()}signOut(){var c=this;return(0,x.A)(function*(){return(0,Ae._isFirebaseServerApp)(c.app)?Promise.reject(_t(c)):(yield c.beforeStateQueue.runMiddleware(null),(c.redirectPersistenceManager||c._popupRedirectResolver)&&(yield c._setRedirectUser(null)),c._updateCurrentUser(null,!0))})()}setPersistence(c){var h=this;return(0,Ae._isFirebaseServerApp)(this.app)?Promise.reject(_t(this)):this.queue((0,x.A)(function*(){yield h.assertedPersistence.setPersistence(ie(c))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}validatePassword(c){var h=this;return(0,x.A)(function*(){h._getPasswordPolicyInternal()||(yield h._updatePasswordPolicy());const m=h._getPasswordPolicyInternal();return m.schemaVersion!==h.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(h._errorFactory.create("unsupported-password-policy-schema-version",{})):m.validatePassword(c)})()}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}_updatePasswordPolicy(){var c=this;return(0,x.A)(function*(){const h=yield function k1(g){return yp.apply(this,arguments)}(c),m=new ki(h);null===c.tenantId?c._projectPasswordPolicy=m:c._tenantPasswordPolicies[c.tenantId]=m})()}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(c){this._errorFactory=new N.FA("auth","Firebase",c())}onAuthStateChanged(c,h,m){return this.registerStateListener(this.authStateSubscription,c,h,m)}beforeAuthStateChanged(c,h){return this.beforeStateQueue.pushCallback(c,h)}onIdTokenChanged(c,h,m){return this.registerStateListener(this.idTokenSubscription,c,h,m)}authStateReady(){return new Promise((c,h)=>{if(this.currentUser)c();else{const m=this.onAuthStateChanged(()=>{m(),c()},h)}})}revokeAccessToken(c){var h=this;return(0,x.A)(function*(){if(h.currentUser){const m=yield h.currentUser.getIdToken(),w={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:c,idToken:m};null!=h.tenantId&&(w.tenantId=h.tenantId),yield function oe(g,c){return C.apply(this,arguments)}(h,w)}})()}toJSON(){var c;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(c=this._currentUser)||void 0===c?void 0:c.toJSON()}}_setRedirectUser(c,h){var m=this;return(0,x.A)(function*(){const w=yield m.getOrInitRedirectPersistenceManager(h);return null===c?w.removeCurrentUser():w.setCurrentUser(c)})()}getOrInitRedirectPersistenceManager(c){var h=this;return(0,x.A)(function*(){if(!h.redirectPersistenceManager){const m=c&&ie(c)||h._popupRedirectResolver;K(m,h,"argument-error"),h.redirectPersistenceManager=yield Ve.create(h,[ie(m._redirectPersistence)],"redirectUser"),h.redirectUser=yield h.redirectPersistenceManager.getCurrentUser()}return h.redirectPersistenceManager})()}_redirectUserForId(c){var h=this;return(0,x.A)(function*(){var m,w;return h._isInitialized&&(yield h.queue((0,x.A)(function*(){}))),(null===(m=h._currentUser)||void 0===m?void 0:m._redirectEventId)===c?h._currentUser:(null===(w=h.redirectUser)||void 0===w?void 0:w._redirectEventId)===c?h.redirectUser:null})()}_persistUserIfCurrent(c){var h=this;return(0,x.A)(function*(){if(c===h.currentUser)return h.queue((0,x.A)(function*(){return h.directlySetCurrentUser(c)}))})()}_notifyListenersIfCurrent(c){c===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var c,h;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const m=null!==(h=null===(c=this.currentUser)||void 0===c?void 0:c.uid)&&void 0!==h?h:null;this.lastNotifiedUid!==m&&(this.lastNotifiedUid=m,this.authStateSubscription.next(this.currentUser))}registerStateListener(c,h,m,w){if(this._deleted)return()=>{};const b="function"==typeof h?h:h.next.bind(h);let L=!1;const X=this._isInitialized?Promise.resolve():this._initializationPromise;if(K(X,this,"internal-error"),X.then(()=>{L||b(this.currentUser)}),"function"==typeof h){const le=c.addObserver(h,m,w);return()=>{L=!0,le()}}{const le=c.addObserver(h);return()=>{L=!0,le()}}}directlySetCurrentUser(c){var h=this;return(0,x.A)(function*(){h.currentUser&&h.currentUser!==c&&h._currentUser._stopProactiveRefresh(),c&&h.isProactiveRefreshEnabled&&c._startProactiveRefresh(),h.currentUser=c,c?yield h.assertedPersistence.setCurrentUser(c):yield h.assertedPersistence.removeCurrentUser()})()}queue(c){return this.operations=this.operations.then(c,c),this.operations}get assertedPersistence(){return K(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(c){!c||this.frameworks.includes(c)||(this.frameworks.push(c),this.frameworks.sort(),this.clientVersion=Wt(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}_getAdditionalHeaders(){var c=this;return(0,x.A)(function*(){var h;const m={"X-Client-Version":c.clientVersion};c.app.options.appId&&(m["X-Firebase-gmpid"]=c.app.options.appId);const w=yield null===(h=c.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===h?void 0:h.getHeartbeatsHeader();w&&(m["X-Firebase-Client"]=w);const b=yield c._getAppCheckToken();return b&&(m["X-Firebase-AppCheck"]=b),m})()}_getAppCheckToken(){var c=this;return(0,x.A)(function*(){var h;const m=yield null===(h=c.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===h?void 0:h.getToken();return m?.error&&function Wn(g,...c){qe.logLevel<=Fe.$b.WARN&&qe.warn(`Auth (${Ae.SDK_VERSION}): ${g}`,...c)}(`Error while retrieving App Check token: ${m.error}`),m?.token})()}}function Ln(g){return(0,N.Ku)(g)}class aT{constructor(c){this.auth=c,this.observer=null,this.addObserver=(0,N.tD)(h=>this.observer=h)}get next(){return K(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let ps={loadJS:()=>(0,x.A)(function*(){throw new Error("Unable to load external scripts")})(),recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Wy(g){return ps.loadJS(g)}function uT(g){return`__${g}${Math.floor(1e6*Math.random())}`}class Oi{constructor(c){this.type="recaptcha-enterprise",this.auth=Ln(c)}verify(c="verify",h=!1){var m=this;return(0,x.A)(function*(){function b(){return b=(0,x.A)(function*(X){if(!h){if(null==X.tenantId&&null!=X._agentRecaptchaConfig)return X._agentRecaptchaConfig.siteKey;if(null!=X.tenantId&&void 0!==X._tenantRecaptchaConfigs[X.tenantId])return X._tenantRecaptchaConfigs[X.tenantId].siteKey}return new Promise(function(){var le=(0,x.A)(function*(Me,ze){Ut(X,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(mt=>{if(void 0!==mt.recaptchaKey){const si=new Gn(mt);return null==X.tenantId?X._agentRecaptchaConfig=si:X._tenantRecaptchaConfigs[X.tenantId]=si,Me(si.siteKey)}ze(new Error("recaptcha Enterprise site key undefined"))}).catch(mt=>{ze(mt)})});return function(Me,ze){return le.apply(this,arguments)}}())}),b.apply(this,arguments)}function L(X,le,Me){const ze=window.grecaptcha;Ot(ze)?ze.enterprise.ready(()=>{ze.enterprise.execute(X,{action:c}).then(mt=>{le(mt)}).catch(()=>{le("NO_RECAPTCHA")})}):Me(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((X,le)=>{(function w(X){return b.apply(this,arguments)})(m.auth).then(Me=>{if(!h&&Ot(window.grecaptcha))L(Me,X,le);else{if(typeof window>"u")return void le(new Error("RecaptchaVerifier is only supported in browser"));let ze=function V1(){return ps.recaptchaEnterpriseScript}();0!==ze.length&&(ze+=Me),Wy(ze).then(()=>{L(Me,X,le)}).catch(mt=>{le(mt)})}}).catch(Me=>{le(Me)})})})()}}function et(g,c,h){return Gy.apply(this,arguments)}function Gy(){return(Gy=(0,x.A)(function*(g,c,h,m=!1){const w=new Oi(g);let b;try{b=yield w.verify(h)}catch{b=yield w.verify(h,!0)}const L=Object.assign({},c);return Object.assign(L,m?{captchaResp:b}:{captchaResponse:b}),Object.assign(L,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(L,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),L})).apply(this,arguments)}function vd(g,c,h,m){return qy.apply(this,arguments)}function qy(){return qy=(0,x.A)(function*(g,c,h,m){var w;if(null!==(w=g._getRecaptchaConfig())&&void 0!==w&&w.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const b=yield et(g,c,h,"getOobCode"===h);return m(g,b)}return m(g,c).catch(function(){var b=(0,x.A)(function*(L){if("auth/missing-recaptcha-token"===L.code){console.log(`${h} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const X=yield et(g,c,h,"getOobCode"===h);return m(g,X)}return Promise.reject(L)});return function(L){return b.apply(this,arguments)}}())}),qy.apply(this,arguments)}function Qy(g,c,h){const m=Ln(g);K(m._canInitEmulator,m,"emulator-config-failed"),K(/^https?:\/\//.test(c),m,"invalid-emulator-scheme");const w=!!h?.disableWarnings,b=Ep(c),{host:L,port:X}=function dT(g){const c=Ep(g),h=/(\/\/)?([^?#/]+)/.exec(g.substr(c.length));if(!h)return{host:"",port:null};const m=h[2].split("@").pop()||"",w=/^(\[[^\]]+\])(:|$)/.exec(m);if(w){const b=w[1];return{host:b,port:Nu(m.substr(b.length+1))}}{const[b,L]=m.split(":");return{host:b,port:Nu(L)}}}(c);m.config.emulator={url:`${b}//${L}${null===X?"":`:${X}`}/`},m.settings.appVerificationDisabledForTesting=!0,m.emulatorConfig=Object.freeze({host:L,port:X,protocol:b.replace(":",""),options:Object.freeze({disableWarnings:w})}),w||function Id(){function g(){const c=document.createElement("p"),h=c.style;c.innerText="Running in emulator mode. Do not use with production credentials.",h.position="fixed",h.width="100%",h.backgroundColor="#ffffff",h.border=".1em solid #000000",h.color="#b50000",h.bottom="0px",h.left="0px",h.margin="0px",h.zIndex="10000",h.textAlign="center",c.classList.add("firebase-emulator-warning"),document.body.appendChild(c)}typeof console<"u"&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",g):g())}()}function Ep(g){const c=g.indexOf(":");return c<0?"":g.substr(0,c+1)}function Nu(g){if(!g)return null;const c=Number(g);return isNaN(c)?null:c}class Mo{constructor(c,h){this.providerId=c,this.signInMethod=h}toJSON(){return je("not implemented")}_getIdTokenResponse(c){return je("not implemented")}_linkToIdToken(c,h){return je("not implemented")}_getReauthenticationResolver(c){return je("not implemented")}}function Ip(g,c){return wp.apply(this,arguments)}function wp(){return(wp=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:resetPassword",Q(g,c))})).apply(this,arguments)}function Mu(){return(Mu=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function Yy(g,c){return Ur.apply(this,arguments)}function Ur(){return(Ur=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:signUp",c)})).apply(this,arguments)}function Xy(){return(Xy=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:update",Q(g,c))})).apply(this,arguments)}function un(g,c){return Zy.apply(this,arguments)}function Zy(){return(Zy=(0,x.A)(function*(g,c){return Qe(g,"POST","/v1/accounts:signInWithPassword",Q(g,c))})).apply(this,arguments)}function Cp(g,c){return we.apply(this,arguments)}function we(){return(we=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:sendOobCode",Q(g,c))})).apply(this,arguments)}function ku(){return(ku=(0,x.A)(function*(g,c){return Cp(g,c)})).apply(this,arguments)}function ev(g,c){return Ou.apply(this,arguments)}function Ou(){return(Ou=(0,x.A)(function*(g,c){return Cp(g,c)})).apply(this,arguments)}function hT(g,c){return Fu.apply(this,arguments)}function Fu(){return(Fu=(0,x.A)(function*(g,c){return Cp(g,c)})).apply(this,arguments)}function tv(){return(tv=(0,x.A)(function*(g,c){return Cp(g,c)})).apply(this,arguments)}function nv(){return(nv=(0,x.A)(function*(g,c){return Qe(g,"POST","/v1/accounts:signInWithEmailLink",Q(g,c))})).apply(this,arguments)}function va(){return(va=(0,x.A)(function*(g,c){return Qe(g,"POST","/v1/accounts:signInWithEmailLink",Q(g,c))})).apply(this,arguments)}class Ea extends Mo{constructor(c,h,m,w=null){super("password",m),this._email=c,this._password=h,this._tenantId=w}static _fromEmailAndPassword(c,h){return new Ea(c,h,"password")}static _fromEmailAndCode(c,h,m=null){return new Ea(c,h,"emailLink",m)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c;if(h?.email&&h?.password){if("password"===h.signInMethod)return this._fromEmailAndPassword(h.email,h.password);if("emailLink"===h.signInMethod)return this._fromEmailAndCode(h.email,h.password,h.tenantId)}return null}_getIdTokenResponse(c){var h=this;return(0,x.A)(function*(){switch(h.signInMethod){case"password":return vd(c,{returnSecureToken:!0,email:h._email,password:h._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",un);case"emailLink":return function j1(g,c){return nv.apply(this,arguments)}(c,{email:h._email,oobCode:h._password});default:Ht(c,"internal-error")}})()}_linkToIdToken(c,h){var m=this;return(0,x.A)(function*(){switch(m.signInMethod){case"password":return vd(c,{idToken:h,returnSecureToken:!0,email:m._email,password:m._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Yy);case"emailLink":return function $1(g,c){return va.apply(this,arguments)}(c,{idToken:h,email:m._email,oobCode:m._password});default:Ht(c,"internal-error")}})()}_getReauthenticationResolver(c){return this._getIdTokenResponse(c)}}function ts(g,c){return Ap.apply(this,arguments)}function Ap(){return(Ap=(0,x.A)(function*(g,c){return Qe(g,"POST","/v1/accounts:signInWithIdp",Q(g,c))})).apply(this,arguments)}class Vs extends Mo{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(c){const h=new Vs(c.providerId,c.signInMethod);return c.idToken||c.accessToken?(c.idToken&&(h.idToken=c.idToken),c.accessToken&&(h.accessToken=c.accessToken),c.nonce&&!c.pendingToken&&(h.nonce=c.nonce),c.pendingToken&&(h.pendingToken=c.pendingToken)):c.oauthToken&&c.oauthTokenSecret?(h.accessToken=c.oauthToken,h.secret=c.oauthTokenSecret):Ht("argument-error"),h}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c,{providerId:m,signInMethod:w}=h,b=(0,Nt.Tt)(h,["providerId","signInMethod"]);if(!m||!w)return null;const L=new Vs(m,w);return L.idToken=b.idToken||void 0,L.accessToken=b.accessToken||void 0,L.secret=b.secret,L.nonce=b.nonce,L.pendingToken=b.pendingToken||null,L}_getIdTokenResponse(c){return ts(c,this.buildRequest())}_linkToIdToken(c,h){const m=this.buildRequest();return m.idToken=h,ts(c,m)}_getReauthenticationResolver(c){const h=this.buildRequest();return h.autoCreate=!1,ts(c,h)}buildRequest(){const c={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)c.pendingToken=this.pendingToken;else{const h={};this.idToken&&(h.id_token=this.idToken),this.accessToken&&(h.access_token=this.accessToken),this.secret&&(h.oauth_token_secret=this.secret),h.providerId=this.providerId,this.nonce&&!this.pendingToken&&(h.nonce=this.nonce),c.postBody=(0,N.Am)(h)}return c}}function ko(){return(ko=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:sendVerificationCode",Q(g,c))})).apply(this,arguments)}function Us(){return(Us=(0,x.A)(function*(g,c){return Qe(g,"POST","/v1/accounts:signInWithPhoneNumber",Q(g,c))})).apply(this,arguments)}function Ee(){return(Ee=(0,x.A)(function*(g,c){const h=yield Qe(g,"POST","/v1/accounts:signInWithPhoneNumber",Q(g,c));if(h.temporaryProof)throw gr(g,"account-exists-with-different-credential",h);return h})).apply(this,arguments)}const iv={USER_NOT_FOUND:"user-not-found"};function ll(){return(ll=(0,x.A)(function*(g,c){return Qe(g,"POST","/v1/accounts:signInWithPhoneNumber",Q(g,Object.assign(Object.assign({},c),{operation:"REAUTH"})),iv)})).apply(this,arguments)}class ao extends Mo{constructor(c){super("phone","phone"),this.params=c}static _fromVerification(c,h){return new ao({verificationId:c,verificationCode:h})}static _fromTokenResponse(c,h){return new ao({phoneNumber:c,temporaryProof:h})}_getIdTokenResponse(c){return function pT(g,c){return Us.apply(this,arguments)}(c,this._makeVerificationRequest())}_linkToIdToken(c,h){return function gT(g,c){return Ee.apply(this,arguments)}(c,Object.assign({idToken:h},this._makeVerificationRequest()))}_getReauthenticationResolver(c){return function ke(g,c){return ll.apply(this,arguments)}(c,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:c,phoneNumber:h,verificationId:m,verificationCode:w}=this.params;return c&&h?{temporaryProof:c,phoneNumber:h}:{sessionInfo:m,code:w}}toJSON(){const c={providerId:this.providerId};return this.params.phoneNumber&&(c.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(c.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(c.verificationCode=this.params.verificationCode),this.params.verificationId&&(c.verificationId=this.params.verificationId),c}static fromJSON(c){"string"==typeof c&&(c=JSON.parse(c));const{verificationId:h,verificationCode:m,phoneNumber:w,temporaryProof:b}=c;return m||h||w||b?new ao({verificationId:h,verificationCode:m,phoneNumber:w,temporaryProof:b}):null}}class Vu{constructor(c){var h,m,w,b,L,X;const le=(0,N.I9)((0,N.hp)(c)),Me=null!==(h=le.apiKey)&&void 0!==h?h:null,ze=null!==(m=le.oobCode)&&void 0!==m?m:null,mt=function Lu(g){switch(g){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(w=le.mode)&&void 0!==w?w:null);K(Me&&ze&&mt,"argument-error"),this.apiKey=Me,this.operation=mt,this.code=ze,this.continueUrl=null!==(b=le.continueUrl)&&void 0!==b?b:null,this.languageCode=null!==(L=le.languageCode)&&void 0!==L?L:null,this.tenantId=null!==(X=le.tenantId)&&void 0!==X?X:null}static parseLink(c){const h=function mT(g){const c=(0,N.I9)((0,N.hp)(g)).link,h=c?(0,N.I9)((0,N.hp)(c)).deep_link_id:null,m=(0,N.I9)((0,N.hp)(g)).deep_link_id;return(m?(0,N.I9)((0,N.hp)(m)).link:null)||m||h||c||g}(c);try{return new Vu(h)}catch{return null}}}let gs=(()=>{class g{constructor(){this.providerId=g.PROVIDER_ID}static credential(h,m){return Ea._fromEmailAndPassword(h,m)}static credentialWithLink(h,m){const w=Vu.parseLink(m);return K(w,"argument-error"),Ea._fromEmailAndCode(h,w.code,w.tenantId)}}return g.PROVIDER_ID="password",g.EMAIL_PASSWORD_SIGN_IN_METHOD="password",g.EMAIL_LINK_SIGN_IN_METHOD="emailLink",g})();class ns{constructor(c){this.providerId=c,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(c){this.defaultLanguageCode=c}setCustomParameters(c){return this.customParameters=c,this}getCustomParameters(){return this.customParameters}}class Br extends ns{constructor(){super(...arguments),this.scopes=[]}addScope(c){return this.scopes.includes(c)||this.scopes.push(c),this}getScopes(){return[...this.scopes]}}class gi extends Br{static credentialFromJSON(c){const h="string"==typeof c?JSON.parse(c):c;return K("providerId"in h&&"signInMethod"in h,"argument-error"),Vs._fromParams(h)}credential(c){return this._credential(Object.assign(Object.assign({},c),{nonce:c.rawNonce}))}_credential(c){return K(c.idToken||c.accessToken,"argument-error"),Vs._fromParams(Object.assign(Object.assign({},c),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(c){return gi.oauthCredentialFromTaggedObject(c)}static credentialFromError(c){return gi.oauthCredentialFromTaggedObject(c.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{oauthIdToken:h,oauthAccessToken:m,oauthTokenSecret:w,pendingToken:b,nonce:L,providerId:X}=c;if(!m&&!w&&!h&&!b||!X)return null;try{return new gi(X)._credential({idToken:h,accessToken:m,nonce:L,pendingToken:b})}catch{return null}}}let jt=(()=>{class g extends Br{constructor(){super("facebook.com")}static credential(h){return Vs._fromParams({providerId:g.PROVIDER_ID,signInMethod:g.FACEBOOK_SIGN_IN_METHOD,accessToken:h})}static credentialFromResult(h){return g.credentialFromTaggedObject(h)}static credentialFromError(h){return g.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h||!("oauthAccessToken"in h)||!h.oauthAccessToken)return null;try{return g.credential(h.oauthAccessToken)}catch{return null}}}return g.FACEBOOK_SIGN_IN_METHOD="facebook.com",g.PROVIDER_ID="facebook.com",g})(),wd=(()=>{class g extends Br{constructor(){super("google.com"),this.addScope("profile")}static credential(h,m){return Vs._fromParams({providerId:g.PROVIDER_ID,signInMethod:g.GOOGLE_SIGN_IN_METHOD,idToken:h,accessToken:m})}static credentialFromResult(h){return g.credentialFromTaggedObject(h)}static credentialFromError(h){return g.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{oauthIdToken:m,oauthAccessToken:w}=h;if(!m&&!w)return null;try{return g.credential(m,w)}catch{return null}}}return g.GOOGLE_SIGN_IN_METHOD="google.com",g.PROVIDER_ID="google.com",g})(),bp=(()=>{class g extends Br{constructor(){super("github.com")}static credential(h){return Vs._fromParams({providerId:g.PROVIDER_ID,signInMethod:g.GITHUB_SIGN_IN_METHOD,accessToken:h})}static credentialFromResult(h){return g.credentialFromTaggedObject(h)}static credentialFromError(h){return g.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h||!("oauthAccessToken"in h)||!h.oauthAccessToken)return null;try{return g.credential(h.oauthAccessToken)}catch{return null}}}return g.GITHUB_SIGN_IN_METHOD="github.com",g.PROVIDER_ID="github.com",g})();class Ia extends Mo{constructor(c,h){super(c,c),this.pendingToken=h}_getIdTokenResponse(c){return ts(c,this.buildRequest())}_linkToIdToken(c,h){const m=this.buildRequest();return m.idToken=h,ts(c,m)}_getReauthenticationResolver(c){const h=this.buildRequest();return h.autoCreate=!1,ts(c,h)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(c){const h="string"==typeof c?JSON.parse(c):c,{providerId:m,signInMethod:w,pendingToken:b}=h;return m&&w&&b&&m===w?new Ia(m,b):null}static _create(c,h){return new Ia(c,h)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class Oo extends ns{constructor(c){K(c.startsWith("saml."),"argument-error"),super(c)}static credentialFromResult(c){return Oo.samlCredentialFromTaggedObject(c)}static credentialFromError(c){return Oo.samlCredentialFromTaggedObject(c.customData||{})}static credentialFromJSON(c){const h=Ia.fromJSON(c);return K(h,"argument-error"),h}static samlCredentialFromTaggedObject({_tokenResponse:c}){if(!c)return null;const{pendingToken:h,providerId:m}=c;if(!h||!m)return null;try{return Ia._create(m,h)}catch{return null}}}let sv=(()=>{class g extends Br{constructor(){super("twitter.com")}static credential(h,m){return Vs._fromParams({providerId:g.PROVIDER_ID,signInMethod:g.TWITTER_SIGN_IN_METHOD,oauthToken:h,oauthTokenSecret:m})}static credentialFromResult(h){return g.credentialFromTaggedObject(h)}static credentialFromError(h){return g.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{oauthAccessToken:m,oauthTokenSecret:w}=h;if(!m||!w)return null;try{return g.credential(m,w)}catch{return null}}}return g.TWITTER_SIGN_IN_METHOD="twitter.com",g.PROVIDER_ID="twitter.com",g})();function Dp(g,c){return Uu.apply(this,arguments)}function Uu(){return(Uu=(0,x.A)(function*(g,c){return Qe(g,"POST","/v1/accounts:signUp",Q(g,c))})).apply(this,arguments)}class Fi{constructor(c){this.user=c.user,this.providerId=c.providerId,this._tokenResponse=c._tokenResponse,this.operationType=c.operationType}static _fromIdTokenResponse(c,h,m,w=!1){return(0,x.A)(function*(){const b=yield R._fromIdTokenResponse(c,m,w),L=Rp(m);return new Fi({user:b,providerId:L,_tokenResponse:m,operationType:h})})()}static _forOperation(c,h,m){return(0,x.A)(function*(){yield c._updateTokensIfNecessary(m,!0);const w=Rp(m);return new Fi({user:c,providerId:w,_tokenResponse:m,operationType:h})})()}}function Rp(g){return g.providerId?g.providerId:"phoneNumber"in g?"phone":null}function Bu(g){return Cd.apply(this,arguments)}function Cd(){return(Cd=(0,x.A)(function*(g){var c;if((0,Ae._isFirebaseServerApp)(g.app))return Promise.reject(_t(g));const h=Ln(g);if(yield h._initializationPromise,null!==(c=h.currentUser)&&void 0!==c&&c.isAnonymous)return new Fi({user:h.currentUser,providerId:null,operationType:"signIn"});const m=yield Dp(h,{returnSecureToken:!0}),w=yield Fi._fromIdTokenResponse(h,"signIn",m,!0);return yield h._updateCurrentUser(w.user),w})).apply(this,arguments)}class ju extends N.g{constructor(c,h,m,w){var b;super(h.code,h.message),this.operationType=m,this.user=w,Object.setPrototypeOf(this,ju.prototype),this.customData={appName:c.name,tenantId:null!==(b=c.tenantId)&&void 0!==b?b:void 0,_serverResponse:h.customData._serverResponse,operationType:m}}static _fromErrorAndOperation(c,h,m,w){return new ju(c,h,m,w)}}function ov(g,c,h,m){return("reauthenticate"===c?h._getReauthenticationResolver(g):h._getIdTokenResponse(g)).catch(b=>{throw"auth/multi-factor-auth-required"===b.code?ju._fromErrorAndOperation(g,b,c,m):b})}function xp(g){return new Set(g.map(({providerId:c})=>c).filter(c=>!!c))}function _T(g,c){return Pp.apply(this,arguments)}function Pp(){return Pp=(0,x.A)(function*(g,c){const h=(0,N.Ku)(g);yield $u(!0,h,c);const{providerUserInfo:m}=yield function Os(g,c){return fi.apply(this,arguments)}(h.auth,{idToken:yield h.getIdToken(),deleteProvider:[c]}),w=xp(m||[]);return h.providerData=h.providerData.filter(b=>w.has(b.providerId)),w.has("phone")||(h.phoneNumber=null),yield h.auth._persistUserIfCurrent(h),h}),Pp.apply(this,arguments)}function Li(g,c){return Np.apply(this,arguments)}function Np(){return(Np=(0,x.A)(function*(g,c,h=!1){const m=yield Yt(g,c._linkToIdToken(g.auth,yield g.getIdToken()),h);return Fi._forOperation(g,"link",m)})).apply(this,arguments)}function $u(g,c,h){return Mp.apply(this,arguments)}function Mp(){return(Mp=(0,x.A)(function*(g,c,h){yield nr(c);const w=!1===g?"provider-already-linked":"no-such-provider";K(xp(c.providerData).has(h)===g,c.auth,w)})).apply(this,arguments)}function av(g,c){return kp.apply(this,arguments)}function kp(){return(kp=(0,x.A)(function*(g,c,h=!1){const{auth:m}=g;if((0,Ae._isFirebaseServerApp)(m.app))return Promise.reject(_t(m));const w="reauthenticate";try{const b=yield Yt(g,ov(m,w,c,g),h);K(b.idToken,m,"internal-error");const L=ro(b.idToken);K(L,m,"internal-error");const{sub:X}=L;return K(g.uid===X,m,"user-mismatch"),Fi._forOperation(g,w,b)}catch(b){throw"auth/user-not-found"===b?.code&&Ht(m,"user-mismatch"),b}})).apply(this,arguments)}function lv(g,c){return Td.apply(this,arguments)}function Td(){return(Td=(0,x.A)(function*(g,c,h=!1){if((0,Ae._isFirebaseServerApp)(g.app))return Promise.reject(_t(g));const m="signIn",w=yield ov(g,m,c),b=yield Fi._fromIdTokenResponse(g,m,w);return h||(yield g._updateCurrentUser(b.user)),b})).apply(this,arguments)}function Ad(g,c){return Op.apply(this,arguments)}function Op(){return(Op=(0,x.A)(function*(g,c){return lv(Ln(g),c)})).apply(this,arguments)}function uv(g,c){return Zr.apply(this,arguments)}function Zr(){return(Zr=(0,x.A)(function*(g,c){const h=(0,N.Ku)(g);return yield $u(!1,h,c.providerId),Li(h,c)})).apply(this,arguments)}function cv(g,c){return Fp.apply(this,arguments)}function Fp(){return(Fp=(0,x.A)(function*(g,c){return av((0,N.Ku)(g),c)})).apply(this,arguments)}function ei(){return(ei=(0,x.A)(function*(g,c){return Qe(g,"POST","/v1/accounts:signInWithCustomToken",Q(g,c))})).apply(this,arguments)}function vT(g,c){return bd.apply(this,arguments)}function bd(){return bd=(0,x.A)(function*(g,c){if((0,Ae._isFirebaseServerApp)(g.app))return Promise.reject(_t(g));const h=Ln(g),m=yield function yT(g,c){return ei.apply(this,arguments)}(h,{token:c,returnSecureToken:!0}),w=yield Fi._fromIdTokenResponse(h,"signIn",m);return yield h._updateCurrentUser(w.user),w}),bd.apply(this,arguments)}class Ye{constructor(c,h){this.factorId=c,this.uid=h.mfaEnrollmentId,this.enrollmentTime=new Date(h.enrolledAt).toUTCString(),this.displayName=h.displayName}static _fromServerResponse(c,h){return"phoneInfo"in h?jr._fromServerResponse(c,h):"totpInfo"in h?St._fromServerResponse(c,h):Ht(c,"internal-error")}}class jr extends Ye{constructor(c){super("phone",c),this.phoneNumber=c.phoneInfo}static _fromServerResponse(c,h){return new jr(h)}}class St extends Ye{constructor(c){super("totp",c)}static _fromServerResponse(c,h){return new St(h)}}function lr(g,c,h){var m;K((null===(m=h.url)||void 0===m?void 0:m.length)>0,g,"invalid-continue-uri"),K(typeof h.dynamicLinkDomain>"u"||h.dynamicLinkDomain.length>0,g,"invalid-dynamic-link-domain"),c.continueUrl=h.url,c.dynamicLinkDomain=h.dynamicLinkDomain,c.canHandleCodeInApp=h.handleCodeInApp,h.iOS&&(K(h.iOS.bundleId.length>0,g,"missing-ios-bundle-id"),c.iOSBundleId=h.iOS.bundleId),h.android&&(K(h.android.packageName.length>0,g,"missing-android-pkg-name"),c.androidInstallApp=h.android.installApp,c.androidMinimumVersionCode=h.android.minimumVersion,c.androidPackageName=h.android.packageName)}function Dr(g){return Fo.apply(this,arguments)}function Fo(){return(Fo=(0,x.A)(function*(g){const c=Ln(g);c._getPasswordPolicyInternal()&&(yield c._updatePasswordPolicy())})).apply(this,arguments)}function Vi(g,c,h){return Sd.apply(this,arguments)}function Sd(){return(Sd=(0,x.A)(function*(g,c,h){const m=Ln(g),w={requestType:"PASSWORD_RESET",email:c,clientType:"CLIENT_TYPE_WEB"};h&&lr(m,w,h),yield vd(m,w,"getOobCode",ev)})).apply(this,arguments)}function dv(g,c,h){return ul.apply(this,arguments)}function ul(){return ul=(0,x.A)(function*(g,c,h){yield Ip((0,N.Ku)(g),{oobCode:c,newPassword:h}).catch(function(){var m=(0,x.A)(function*(w){throw"auth/password-does-not-meet-requirements"===w.code&&Dr(g),w});return function(w){return m.apply(this,arguments)}}())}),ul.apply(this,arguments)}function ET(g,c){return Lp.apply(this,arguments)}function Lp(){return Lp=(0,x.A)(function*(g,c){yield function Jy(g,c){return Xy.apply(this,arguments)}((0,N.Ku)(g),{oobCode:c})}),Lp.apply(this,arguments)}function Vn(g,c){return Ne.apply(this,arguments)}function Ne(){return(Ne=(0,x.A)(function*(g,c){const h=(0,N.Ku)(g),m=yield Ip(h,{oobCode:c}),w=m.requestType;switch(K(w,h,"internal-error"),w){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":K(m.newEmail,h,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":K(m.mfaInfo,h,"internal-error");default:K(m.email,h,"internal-error")}let b=null;return m.mfaInfo&&(b=Ye._fromServerResponse(Ln(h),m.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===m.requestType?m.newEmail:m.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===m.requestType?m.email:m.newEmail)||null,multiFactorInfo:b},operation:w}})).apply(this,arguments)}function at(g,c){return cn.apply(this,arguments)}function cn(){return(cn=(0,x.A)(function*(g,c){const{data:h}=yield Vn((0,N.Ku)(g),c);return h.email})).apply(this,arguments)}function ms(g,c,h){return wa.apply(this,arguments)}function wa(){return(wa=(0,x.A)(function*(g,c,h){if((0,Ae._isFirebaseServerApp)(g.app))return Promise.reject(_t(g));const m=Ln(g),L=yield vd(m,{returnSecureToken:!0,email:c,password:h,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Dp).catch(le=>{throw"auth/password-does-not-meet-requirements"===le.code&&Dr(g),le}),X=yield Fi._fromIdTokenResponse(m,"signIn",L);return yield m._updateCurrentUser(X.user),X})).apply(this,arguments)}function $r(g,c,h){return(0,Ae._isFirebaseServerApp)(g.app)?Promise.reject(_t(g)):Ad((0,N.Ku)(g),gs.credential(c,h)).catch(function(){var m=(0,x.A)(function*(w){throw"auth/password-does-not-meet-requirements"===w.code&&Dr(g),w});return function(w){return m.apply(this,arguments)}}())}function cl(g,c,h){return Un.apply(this,arguments)}function Un(){return(Un=(0,x.A)(function*(g,c,h){const m=Ln(g),w={requestType:"EMAIL_SIGNIN",email:c,clientType:"CLIENT_TYPE_WEB"};(function b(L,X){K(X.handleCodeInApp,m,"argument-error"),X&&lr(m,L,X)})(w,h),yield vd(m,w,"getOobCode",hT)})).apply(this,arguments)}function Lo(g,c){const h=Vu.parseLink(c);return"EMAIL_SIGNIN"===h?.operation}function dl(g,c,h){return tt.apply(this,arguments)}function tt(){return(tt=(0,x.A)(function*(g,c,h){if((0,Ae._isFirebaseServerApp)(g.app))return Promise.reject(_t(g));const m=(0,N.Ku)(g),w=gs.credentialWithLink(c,h||At());return K(w._tenantId===(m.tenantId||null),m,"tenant-id-mismatch"),Ad(m,w)})).apply(this,arguments)}function Dd(){return(Dd=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:createAuthUri",Q(g,c))})).apply(this,arguments)}function hl(g,c){return Bn.apply(this,arguments)}function Bn(){return Bn=(0,x.A)(function*(g,c){const m={identifier:c,continueUri:kn()?At():"http://localhost"},{signinMethods:w}=yield function Hu(g,c){return Dd.apply(this,arguments)}((0,N.Ku)(g),m);return w||[]}),Bn.apply(this,arguments)}function zu(g,c){return Vo.apply(this,arguments)}function Vo(){return Vo=(0,x.A)(function*(g,c){const h=(0,N.Ku)(g),w={requestType:"VERIFY_EMAIL",idToken:yield g.getIdToken()};c&&lr(h.auth,w,c);const{email:b}=yield function Tp(g,c){return ku.apply(this,arguments)}(h.auth,w);b!==g.email&&(yield g.reload())}),Vo.apply(this,arguments)}function Bs(g,c,h){return Ca.apply(this,arguments)}function Ca(){return Ca=(0,x.A)(function*(g,c,h){const m=(0,N.Ku)(g),b={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:yield g.getIdToken(),newEmail:c};h&&lr(m.auth,b,h);const{email:L}=yield function B1(g,c){return tv.apply(this,arguments)}(m.auth,b);L!==g.email&&(yield g.reload())}),Ca.apply(this,arguments)}function js(){return(js=(0,x.A)(function*(g,c){return $(g,"POST","/v1/accounts:update",c)})).apply(this,arguments)}function uo(g,c){return Ta.apply(this,arguments)}function Ta(){return Ta=(0,x.A)(function*(g,{displayName:c,photoURL:h}){if(void 0===c&&void 0===h)return;const m=(0,N.Ku)(g),b={idToken:yield m.getIdToken(),displayName:c,photoUrl:h,returnSecureToken:!0},L=yield Yt(m,function hv(g,c){return js.apply(this,arguments)}(m.auth,b));m.displayName=L.displayName||null,m.photoURL=L.photoUrl||null;const X=m.providerData.find(({providerId:le})=>"password"===le);X&&(X.displayName=m.displayName,X.photoURL=m.photoURL),yield m._updateTokensIfNecessary(L)}),Ta.apply(this,arguments)}function Wu(g,c){const h=(0,N.Ku)(g);return(0,Ae._isFirebaseServerApp)(h.auth.app)?Promise.reject(_t(h.auth)):IT(h,c,null)}function vt(g,c){return IT((0,N.Ku)(g),null,c)}function IT(g,c,h){return Gu.apply(this,arguments)}function Gu(){return Gu=(0,x.A)(function*(g,c,h){const{auth:m}=g,b={idToken:yield g.getIdToken(),returnSecureToken:!0};c&&(b.email=c),h&&(b.password=h);const L=yield Yt(g,function yt(g,c){return Mu.apply(this,arguments)}(m,b));yield g._updateTokensIfNecessary(L,!0)}),Gu.apply(this,arguments)}class ti{constructor(c,h,m={}){this.isNewUser=c,this.providerId=h,this.profile=m}}class qu extends ti{constructor(c,h,m,w){super(c,h,m),this.username=w}}class fl extends ti{constructor(c,h){super(c,"facebook.com",h)}}class Ku extends qu{constructor(c,h){super(c,"github.com",h,"string"==typeof h?.login?h?.login:null)}}class Rr extends ti{constructor(c,h){super(c,"google.com",h)}}class z1 extends qu{constructor(c,h,m){super(c,"twitter.com",h,m)}}function mi(g){const{user:c,_tokenResponse:h}=g;return c.isAnonymous&&!h?{providerId:null,isNewUser:!1,profile:null}:function fv(g){var c,h;if(!g)return null;const{providerId:m}=g,w=g.rawUserInfo?JSON.parse(g.rawUserInfo):{},b=g.isNewUser||"identitytoolkit#SignupNewUserResponse"===g.kind;if(!m&&g?.idToken){const L=null===(h=null===(c=ro(g.idToken))||void 0===c?void 0:c.firebase)||void 0===h?void 0:h.sign_in_provider;if(L)return new ti(b,"anonymous"!==L&&"custom"!==L?L:null)}if(!m)return null;switch(m){case"facebook.com":return new fl(b,w);case"github.com":return new Ku(b,w);case"google.com":return new Rr(b,w);case"twitter.com":return new z1(b,w,g.screenName||null);case"custom":case"anonymous":return new ti(b,null);default:return new ti(b,m,w)}}(h)}class ml{constructor(c,h,m){this.type=c,this.credential=h,this.user=m}static _fromIdtoken(c,h){return new ml("enroll",c,h)}static _fromMfaPendingCredential(c){return new ml("signin",c)}toJSON(){return{multiFactorSession:{["enroll"===this.type?"idToken":"pendingCredential"]:this.credential}}}static fromJSON(c){var h,m;if(c?.multiFactorSession){if(null!==(h=c.multiFactorSession)&&void 0!==h&&h.pendingCredential)return ml._fromMfaPendingCredential(c.multiFactorSession.pendingCredential);if(null!==(m=c.multiFactorSession)&&void 0!==m&&m.idToken)return ml._fromIdtoken(c.multiFactorSession.idToken)}return null}}class mv{constructor(c,h,m){this.session=c,this.hints=h,this.signInResolver=m}static _fromError(c,h){const m=Ln(c),w=h.customData._serverResponse,b=(w.mfaInfo||[]).map(X=>Ye._fromServerResponse(m,X));K(w.mfaPendingCredential,m,"internal-error");const L=ml._fromMfaPendingCredential(w.mfaPendingCredential);return new mv(L,b,function(){var X=(0,x.A)(function*(le){const Me=yield le._process(m,L);delete w.mfaInfo,delete w.mfaPendingCredential;const ze=Object.assign(Object.assign({},w),{idToken:Me.idToken,refreshToken:Me.refreshToken});switch(h.operationType){case"signIn":const mt=yield Fi._fromIdTokenResponse(m,h.operationType,ze);return yield m._updateCurrentUser(mt.user),mt;case"reauthenticate":return K(h.user,m,"internal-error"),Fi._forOperation(h.user,h.operationType,ze);default:Ht(m,"internal-error")}});return function(le){return X.apply(this,arguments)}}())}resolveSignIn(c){var h=this;return(0,x.A)(function*(){return h.signInResolver(c)})()}}function Q1(g,c){var h;const m=(0,N.Ku)(g),w=c;return K(c.customData.operationType,m,"argument-error"),K(null===(h=w.customData._serverResponse)||void 0===h?void 0:h.mfaPendingCredential,m,"argument-error"),mv._fromError(m,w)}class _v{constructor(c){this.user=c,this.enrolledFactors=[],c._onReload(h=>{h.mfaInfo&&(this.enrolledFactors=h.mfaInfo.map(m=>Ye._fromServerResponse(c.auth,m)))})}static _fromUser(c){return new _v(c)}getSession(){var c=this;return(0,x.A)(function*(){return ml._fromIdtoken(yield c.user.getIdToken(),c.user)})()}enroll(c,h){var m=this;return(0,x.A)(function*(){const w=c,b=yield m.getSession(),L=yield Yt(m.user,w._process(m.user.auth,b,h));return yield m.user._updateTokensIfNecessary(L),m.user.reload()})()}unenroll(c){var h=this;return(0,x.A)(function*(){const m="string"==typeof c?c:c.uid,w=yield h.user.getIdToken();try{const b=yield Yt(h.user,function Z1(g,c){return $(g,"POST","/v2/accounts/mfaEnrollment:withdraw",Q(g,c))}(h.user.auth,{idToken:w,mfaEnrollmentId:m}));h.enrolledFactors=h.enrolledFactors.filter(({uid:L})=>L!==m),yield h.user._updateTokensIfNecessary(b),yield h.user.reload()}catch(b){throw b}})()}}const yv=new WeakMap;function vv(g){const c=(0,N.Ku)(g);return yv.has(c)||yv.set(c,_v._fromUser(c)),yv.get(c)}const Qu="__sak";class wT{constructor(c,h){this.storageRetriever=c,this.type=h}_isAvailable(){try{return this.storage?(this.storage.setItem(Qu,"1"),this.storage.removeItem(Qu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(c,h){return this.storage.setItem(c,JSON.stringify(h)),Promise.resolve()}_get(c){const h=this.storage.getItem(c);return Promise.resolve(h?JSON.parse(h):null)}_remove(c){return this.storage.removeItem(c),Promise.resolve()}get storage(){return this.storageRetriever()}}const co=(()=>{class g extends wT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(h,m)=>this.onStorageEvent(h,m),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=it(),this._shouldAllowMigration=!0}forAllChangedKeys(h){for(const m of Object.keys(this.listeners)){const w=this.storage.getItem(m),b=this.localCache[m];w!==b&&h(m,b,w)}}onStorageEvent(h,m=!1){if(!h.key)return void this.forAllChangedKeys((X,le,Me)=>{this.notifyListeners(X,Me)});const w=h.key;m?this.detachListener():this.stopPolling();const b=()=>{const X=this.storage.getItem(w);!m&&this.localCache[w]===X||this.notifyListeners(w,X)},L=this.storage.getItem(w);!function yd(){return(0,N.lT)()&&10===document.documentMode}()||L===h.newValue||h.newValue===h.oldValue?b():setTimeout(b,10)}notifyListeners(h,m){this.localCache[h]=m;const w=this.listeners[h];if(w)for(const b of Array.from(w))b(m&&JSON.parse(m))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((h,m,w)=>{this.onStorageEvent(new StorageEvent("storage",{key:h,oldValue:m,newValue:w}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(h,m){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[h]||(this.listeners[h]=new Set,this.localCache[h]=this.storage.getItem(h)),this.listeners[h].add(m)}_removeListener(h,m){this.listeners[h]&&(this.listeners[h].delete(m),0===this.listeners[h].size&&delete this.listeners[h]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}_set(h,m){var w=()=>super._set,b=this;return(0,x.A)(function*(){yield w().call(b,h,m),b.localCache[h]=JSON.stringify(m)})()}_get(h){var m=()=>super._get,w=this;return(0,x.A)(function*(){const b=yield m().call(w,h);return w.localCache[h]=JSON.stringify(b),b})()}_remove(h){var m=()=>super._remove,w=this;return(0,x.A)(function*(){yield m().call(w,h),delete w.localCache[h]})()}}return g.type="LOCAL",g})(),Ev=(()=>{class g extends wT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(h,m){}_removeListener(h,m){}}return g.type="SESSION",g})();let Rd=(()=>{class g{constructor(h){this.eventTarget=h,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(h){const m=this.receivers.find(b=>b.isListeningto(h));if(m)return m;const w=new g(h);return this.receivers.push(w),w}isListeningto(h){return this.eventTarget===h}handleEvent(h){var m=this;return(0,x.A)(function*(){const w=h,{eventId:b,eventType:L,data:X}=w.data,le=m.handlersMap[L];if(!le?.size)return;w.ports[0].postMessage({status:"ack",eventId:b,eventType:L});const Me=Array.from(le).map(function(){var mt=(0,x.A)(function*(si){return si(w.origin,X)});return function(si){return mt.apply(this,arguments)}}()),ze=yield function xr(g){return Promise.all(g.map(function(){var c=(0,x.A)(function*(h){try{return{fulfilled:!0,value:yield h}}catch(m){return{fulfilled:!1,reason:m}}});return function(h){return c.apply(this,arguments)}}()))}(Me);w.ports[0].postMessage({status:"done",eventId:b,eventType:L,response:ze})})()}_subscribe(h,m){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[h]||(this.handlersMap[h]=new Set),this.handlersMap[h].add(m)}_unsubscribe(h,m){this.handlersMap[h]&&m&&this.handlersMap[h].delete(m),(!m||0===this.handlersMap[h].size)&&delete this.handlersMap[h],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}return g.receivers=[],g})();function Hr(g="",c=10){let h="";for(let m=0;m<c;m++)h+=Math.floor(10*Math.random());return g+h}class Iv{constructor(c){this.target=c,this.handlers=new Set}removeMessageHandler(c){c.messageChannel&&(c.messageChannel.port1.removeEventListener("message",c.onMessage),c.messageChannel.port1.close()),this.handlers.delete(c)}_send(c,h,m=50){var w=this;return(0,x.A)(function*(){const b=typeof MessageChannel<"u"?new MessageChannel:null;if(!b)throw new Error("connection_unavailable");let L,X;return new Promise((le,Me)=>{const ze=Hr("",20);b.port1.start();const mt=setTimeout(()=>{Me(new Error("unsupported_event"))},m);X={messageChannel:b,onMessage(si){const $o=si;if($o.data.eventId===ze)switch($o.data.status){case"ack":clearTimeout(mt),L=setTimeout(()=>{Me(new Error("timeout"))},3e3);break;case"done":clearTimeout(L),le($o.data.response);break;default:clearTimeout(mt),clearTimeout(L),Me(new Error("invalid_response"))}}},w.handlers.add(X),b.port1.addEventListener("message",X.onMessage),w.target.postMessage({eventType:c,eventId:ze,data:h},[b.port2])}).finally(()=>{X&&w.removeMessageHandler(X)})})()}}function rr(){return window}function xd(){return typeof rr().WorkerGlobalScope<"u"&&"function"==typeof rr().importScripts}function Pd(){return(Pd=(0,x.A)(function*(){if(!navigator?.serviceWorker)return null;try{return(yield navigator.serviceWorker.ready).active}catch{return null}})).apply(this,arguments)}const $p="firebaseLocalStorageDb",Yu="firebaseLocalStorage",Ju="fbase_key";class ho{constructor(c){this.request=c}toPromise(){return new Promise((c,h)=>{this.request.addEventListener("success",()=>{c(this.request.result)}),this.request.addEventListener("error",()=>{h(this.request.error)})})}}function fo(g,c){return g.transaction([Yu],c?"readwrite":"readonly").objectStore(Yu)}function Av(){const g=indexedDB.open($p,1);return new Promise((c,h)=>{g.addEventListener("error",()=>{h(g.error)}),g.addEventListener("upgradeneeded",()=>{const m=g.result;try{m.createObjectStore(Yu,{keyPath:Ju})}catch(w){h(w)}}),g.addEventListener("success",(0,x.A)(function*(){const m=g.result;m.objectStoreNames.contains(Yu)?c(m):(m.close(),yield function Tv(){const g=indexedDB.deleteDatabase($p);return new ho(g).toPromise()}(),c(yield Av()))}))})}function CT(g,c,h){return bv.apply(this,arguments)}function bv(){return(bv=(0,x.A)(function*(g,c,h){const m=fo(g,!0).put({[Ju]:c,value:h});return new ho(m).toPromise()})).apply(this,arguments)}function Hp(){return(Hp=(0,x.A)(function*(g,c){const h=fo(g,!1).get(c),m=yield new ho(h).toPromise();return void 0===m?null:m.value})).apply(this,arguments)}function AT(g,c){const h=fo(g,!0).delete(c);return new ho(h).toPromise()}const Nd=(()=>{class g{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}_openDb(){var h=this;return(0,x.A)(function*(){return h.db||(h.db=yield Av()),h.db})()}_withRetries(h){var m=this;return(0,x.A)(function*(){let w=0;for(;;)try{const b=yield m._openDb();return yield h(b)}catch(b){if(w++>3)throw b;m.db&&(m.db.close(),m.db=void 0)}})()}initializeServiceWorkerMessaging(){var h=this;return(0,x.A)(function*(){return xd()?h.initializeReceiver():h.initializeSender()})()}initializeReceiver(){var h=this;return(0,x.A)(function*(){h.receiver=Rd._getInstance(function jp(){return xd()?self:null}()),h.receiver._subscribe("keyChanged",function(){var m=(0,x.A)(function*(w,b){return{keyProcessed:(yield h._poll()).includes(b.key)}});return function(w,b){return m.apply(this,arguments)}}()),h.receiver._subscribe("ping",function(){var m=(0,x.A)(function*(w,b){return["keyChanged"]});return function(w,b){return m.apply(this,arguments)}}())})()}initializeSender(){var h=this;return(0,x.A)(function*(){var m,w;if(h.activeServiceWorker=yield function Up(){return Pd.apply(this,arguments)}(),!h.activeServiceWorker)return;h.sender=new Iv(h.activeServiceWorker);const b=yield h.sender._send("ping",{},800);b&&null!==(m=b[0])&&void 0!==m&&m.fulfilled&&null!==(w=b[0])&&void 0!==w&&w.value.includes("keyChanged")&&(h.serviceWorkerReceiverAvailable=!0)})()}notifyServiceWorker(h){var m=this;return(0,x.A)(function*(){if(m.sender&&m.activeServiceWorker&&function Bp(){var g;return(null===(g=navigator?.serviceWorker)||void 0===g?void 0:g.controller)||null}()===m.activeServiceWorker)try{yield m.sender._send("keyChanged",{key:h},m.serviceWorkerReceiverAvailable?800:50)}catch{}})()}_isAvailable(){return(0,x.A)(function*(){try{if(!indexedDB)return!1;const h=yield Av();return yield CT(h,Qu,"1"),yield AT(h,Qu),!0}catch{}return!1})()}_withPendingWrite(h){var m=this;return(0,x.A)(function*(){m.pendingWrites++;try{yield h()}finally{m.pendingWrites--}})()}_set(h,m){var w=this;return(0,x.A)(function*(){return w._withPendingWrite((0,x.A)(function*(){return yield w._withRetries(b=>CT(b,h,m)),w.localCache[h]=m,w.notifyServiceWorker(h)}))})()}_get(h){var m=this;return(0,x.A)(function*(){const w=yield m._withRetries(b=>function TT(g,c){return Hp.apply(this,arguments)}(b,h));return m.localCache[h]=w,w})()}_remove(h){var m=this;return(0,x.A)(function*(){return m._withPendingWrite((0,x.A)(function*(){return yield m._withRetries(w=>AT(w,h)),delete m.localCache[h],m.notifyServiceWorker(h)}))})()}_poll(){var h=this;return(0,x.A)(function*(){const m=yield h._withRetries(L=>{const X=fo(L,!1).getAll();return new ho(X).toPromise()});if(!m)return[];if(0!==h.pendingWrites)return[];const w=[],b=new Set;if(0!==m.length)for(const{fbase_key:L,value:X}of m)b.add(L),JSON.stringify(h.localCache[L])!==JSON.stringify(X)&&(h.notifyListeners(L,X),w.push(L));for(const L of Object.keys(h.localCache))h.localCache[L]&&!b.has(L)&&(h.notifyListeners(L,null),w.push(L));return w})()}notifyListeners(h,m){this.localCache[h]=m;const w=this.listeners[h];if(w)for(const b of Array.from(w))b(m)}startPolling(){var h=this;this.stopPolling(),this.pollTimer=setInterval((0,x.A)(function*(){return h._poll()}),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(h,m){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[h]||(this.listeners[h]=new Set,this._get(h)),this.listeners[h].add(m)}_removeListener(h,m){this.listeners[h]&&(this.listeners[h].delete(m),0===this.listeners[h].size&&delete this.listeners[h]),0===Object.keys(this.listeners).length&&this.stopPolling()}}return g.type="LOCAL",g})(),Md=1e12;class ST{constructor(c){this.auth=c,this.counter=Md,this._widgets=new Map}render(c,h){const m=this.counter;return this._widgets.set(m,new DT(c,this.auth.name,h||{})),this.counter++,m}reset(c){var h;const m=c||Md;null===(h=this._widgets.get(m))||void 0===h||h.delete(),this._widgets.delete(m)}getResponse(c){var h;return(null===(h=this._widgets.get(c||Md))||void 0===h?void 0:h.getResponse())||""}execute(c){var h=this;return(0,x.A)(function*(){var m;return null===(m=h._widgets.get(c||Md))||void 0===m||m.execute(),""})()}}class DT{constructor(c,h,m){this.params=m,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const w="string"==typeof c?document.getElementById(c):c;K(w,"argument-error",{appName:h}),this.container=w,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),!this.timerId&&(this.timerId=window.setTimeout(()=>{this.responseToken=function xv(g){const c=[],h="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let m=0;m<g;m++)c.push(h.charAt(Math.floor(62*Math.random())));return c.join("")}(50);const{callback:c,"expired-callback":h}=this.params;if(c)try{c(this.responseToken)}catch{}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,h)try{h()}catch{}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const Wp=uT("rcb"),Pv=new pr(3e4,6e4);class RT{constructor(){var c;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!(null===(c=rr().grecaptcha)||void 0===c||!c.render)}load(c,h=""){return K(function sk(g){return g.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(g)}(h),c,"argument-error"),this.shouldResolveImmediately(h)&&kt(rr().grecaptcha)?Promise.resolve(rr().grecaptcha):new Promise((m,w)=>{const b=rr().setTimeout(()=>{w(zt(c,"network-request-failed"))},Pv.get());rr()[Wp]=()=>{rr().clearTimeout(b),delete rr()[Wp];const X=rr().grecaptcha;if(!X||!kt(X))return void w(zt(c,"internal-error"));const le=X.render;X.render=(Me,ze)=>{const mt=le(Me,ze);return this.counter++,mt},this.hostLanguage=h,m(X)},Wy(`${function L1(){return ps.recaptchaV2Script}()}?${(0,N.Am)({onload:Wp,render:"explicit",hl:h})}`).catch(()=>{clearTimeout(b),w(zt(c,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(c){var h;return!(null===(h=rr().grecaptcha)||void 0===h||!h.render)&&(c===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class xT{load(c){return(0,x.A)(function*(){return new ST(c)})()}clearedOneInstance(){}}const Ui="recaptcha",Nv={theme:"light",type:"image"};class PT{constructor(c,h,m=Object.assign({},Nv)){this.parameters=m,this.type=Ui,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=Ln(c),this.isInvisible="invisible"===this.parameters.size,K(typeof document<"u",this.auth,"operation-not-supported-in-this-environment");const w="string"==typeof h?document.getElementById(h):h;K(w,this.auth,"argument-error"),this.container=w,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new xT:new RT,this.validateStartingState()}verify(){var c=this;return(0,x.A)(function*(){c.assertNotDestroyed();const h=yield c.render(),m=c.getAssertedRecaptcha();return m.getResponse(h)||new Promise(b=>{const L=X=>{X&&(c.tokenChangeListeners.delete(L),b(X))};c.tokenChangeListeners.add(L),c.isInvisible&&m.execute(h)})})()}render(){try{this.assertNotDestroyed()}catch(c){return Promise.reject(c)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(c=>{throw this.renderPromise=null,c})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(c=>{this.container.removeChild(c)})}validateStartingState(){K(!this.parameters.sitekey,this.auth,"argument-error"),K(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),K(typeof document<"u",this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(c){return h=>{if(this.tokenChangeListeners.forEach(m=>m(h)),"function"==typeof c)c(h);else if("string"==typeof c){const m=rr()[c];"function"==typeof m&&m(h)}}}assertNotDestroyed(){K(!this.destroyed,this.auth,"internal-error")}makeRenderPromise(){var c=this;return(0,x.A)(function*(){if(yield c.init(),!c.widgetId){let h=c.container;if(!c.isInvisible){const m=document.createElement("div");h.appendChild(m),h=m}c.widgetId=c.getAssertedRecaptcha().render(h,c.parameters)}return c.widgetId})()}init(){var c=this;return(0,x.A)(function*(){K(kn()&&!xd(),c.auth,"internal-error"),yield function NT(){let g=null;return new Promise(c=>{"complete"!==document.readyState?(g=()=>c(),window.addEventListener("load",g)):c()}).catch(c=>{throw g&&window.removeEventListener("load",g),c})}(),c.recaptcha=yield c._recaptchaLoader.load(c.auth,c.auth.languageCode||void 0);const h=yield function ar(g){return Ir.apply(this,arguments)}(c.auth);K(h,c.auth,"internal-error"),c.parameters.sitekey=h})()}getAssertedRecaptcha(){return K(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class kd{constructor(c,h){this.verificationId=c,this.onConfirmation=h}confirm(c){const h=ao._fromVerification(this.verificationId,c);return this.onConfirmation(h)}}function Mv(g,c,h){return Gp.apply(this,arguments)}function Gp(){return(Gp=(0,x.A)(function*(g,c,h){if((0,Ae._isFirebaseServerApp)(g.app))return Promise.reject(_t(g));const m=Ln(g),w=yield Xu(m,c,(0,N.Ku)(h));return new kd(w,b=>Ad(m,b))})).apply(this,arguments)}function qp(g,c,h){return Kp.apply(this,arguments)}function Kp(){return(Kp=(0,x.A)(function*(g,c,h){const m=(0,N.Ku)(g);yield $u(!1,m,"phone");const w=yield Xu(m.auth,c,(0,N.Ku)(h));return new kd(w,b=>uv(m,b))})).apply(this,arguments)}function $s(g,c,h){return Od.apply(this,arguments)}function Od(){return(Od=(0,x.A)(function*(g,c,h){const m=(0,N.Ku)(g);if((0,Ae._isFirebaseServerApp)(m.auth.app))return Promise.reject(_t(m.auth));const w=yield Xu(m.auth,c,(0,N.Ku)(h));return new kd(w,b=>cv(m,b))})).apply(this,arguments)}function Xu(g,c,h){return tn.apply(this,arguments)}function tn(){return tn=(0,x.A)(function*(g,c,h){var m;const w=yield h.verify();try{let b;if(K("string"==typeof w,g,"argument-error"),K(h.type===Ui,g,"argument-error"),b="string"==typeof c?{phoneNumber:c}:c,"session"in b){const L=b.session;if("phoneNumber"in b)return K("enroll"===L.type,g,"internal-error"),(yield function Y1(g,c){return $(g,"POST","/v2/accounts/mfaEnrollment:start",Q(g,c))}(g,{idToken:L.credential,phoneEnrollmentInfo:{phoneNumber:b.phoneNumber,recaptchaToken:w}})).phoneSessionInfo.sessionInfo;{K("signin"===L.type,g,"internal-error");const X=(null===(m=b.multiFactorHint)||void 0===m?void 0:m.uid)||b.multiFactorUid;return K(X,g,"missing-multi-factor-info"),(yield function rk(g,c){return $(g,"POST","/v2/accounts/mfaSignIn:start",Q(g,c))}(g,{mfaPendingCredential:L.credential,mfaEnrollmentId:X,phoneSignInInfo:{recaptchaToken:w}})).phoneResponseInfo.sessionInfo}}{const{sessionInfo:L}=yield function rv(g,c){return ko.apply(this,arguments)}(g,{phoneNumber:b.phoneNumber,recaptchaToken:w});return L}}finally{h._reset()}}),tn.apply(this,arguments)}function Qp(g,c){return yl.apply(this,arguments)}function yl(){return(yl=(0,x.A)(function*(g,c){const h=(0,N.Ku)(g);if((0,Ae._isFirebaseServerApp)(h.auth.app))return Promise.reject(_t(h.auth));yield Li(h,c)})).apply(this,arguments)}let yi=(()=>{class g{constructor(h){this.providerId=g.PROVIDER_ID,this.auth=Ln(h)}verifyPhoneNumber(h,m){return Xu(this.auth,h,(0,N.Ku)(m))}static credential(h,m){return ao._fromVerification(h,m)}static credentialFromResult(h){return g.credentialFromTaggedObject(h)}static credentialFromError(h){return g.credentialFromTaggedObject(h.customData||{})}static credentialFromTaggedObject({_tokenResponse:h}){if(!h)return null;const{phoneNumber:m,temporaryProof:w}=h;return m&&w?ao._fromTokenResponse(m,w):null}}return g.PROVIDER_ID="phone",g.PHONE_SIGN_IN_METHOD="phone",g})();function Aa(g,c){return c?ie(c):(K(g._popupRedirectResolver,g,"argument-error"),g._popupRedirectResolver)}class Fd extends Mo{constructor(c){super("custom","custom"),this.params=c}_getIdTokenResponse(c){return ts(c,this._buildIdpRequest())}_linkToIdToken(c,h){return ts(c,this._buildIdpRequest(h))}_getReauthenticationResolver(c){return ts(c,this._buildIdpRequest())}_buildIdpRequest(c){const h={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return c&&(h.idToken=c),h}}function vl(g){return lv(g.auth,new Fd(g),g.bypassAuthState)}function Bi(g){const{auth:c,user:h}=g;return K(h,c,"internal-error"),av(h,new Fd(g),g.bypassAuthState)}function MT(g){return Yp.apply(this,arguments)}function Yp(){return(Yp=(0,x.A)(function*(g){const{auth:c,user:h}=g;return K(h,c,"internal-error"),Li(h,new Fd(g),g.bypassAuthState)})).apply(this,arguments)}class kv{constructor(c,h,m,w,b=!1){this.auth=c,this.resolver=m,this.user=w,this.bypassAuthState=b,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(h)?h:[h]}execute(){var c=this;return new Promise(function(){var h=(0,x.A)(function*(m,w){c.pendingPromise={resolve:m,reject:w};try{c.eventManager=yield c.resolver._initialize(c.auth),yield c.onExecution(),c.eventManager.registerConsumer(c)}catch(b){c.reject(b)}});return function(m,w){return h.apply(this,arguments)}}())}onAuthEvent(c){var h=this;return(0,x.A)(function*(){const{urlResponse:m,sessionId:w,postBody:b,tenantId:L,error:X,type:le}=c;if(X)return void h.reject(X);const Me={auth:h.auth,requestUri:m,sessionId:w,tenantId:L||void 0,postBody:b||void 0,user:h.user,bypassAuthState:h.bypassAuthState};try{h.resolve(yield h.getIdpTask(le)(Me))}catch(ze){h.reject(ze)}})()}onError(c){this.reject(c)}getIdpTask(c){switch(c){case"signInViaPopup":case"signInViaRedirect":return vl;case"linkViaPopup":case"linkViaRedirect":return MT;case"reauthViaPopup":case"reauthViaRedirect":return Bi;default:Ht(this.auth,"internal-error")}}resolve(c){rt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(c),this.unregisterAndCleanUp()}reject(c){rt(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(c),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Uo=new pr(2e3,1e4);function Ov(g,c,h){return Jp.apply(this,arguments)}function Jp(){return(Jp=(0,x.A)(function*(g,c,h){if((0,Ae._isFirebaseServerApp)(g.app))return Promise.reject(zt(g,"operation-not-supported-in-this-environment"));const m=Ln(g);nt(g,c,ns);const w=Aa(m,h);return new Je(m,"signInViaPopup",c,w).executeNotNull()})).apply(this,arguments)}function Fv(g,c,h){return Ld.apply(this,arguments)}function Ld(){return(Ld=(0,x.A)(function*(g,c,h){const m=(0,N.Ku)(g);if((0,Ae._isFirebaseServerApp)(m.auth.app))return Promise.reject(zt(m.auth,"operation-not-supported-in-this-environment"));nt(m.auth,c,ns);const w=Aa(m.auth,h);return new Je(m.auth,"reauthViaPopup",c,w,m).executeNotNull()})).apply(this,arguments)}function Lv(g,c,h){return Xp.apply(this,arguments)}function Xp(){return(Xp=(0,x.A)(function*(g,c,h){const m=(0,N.Ku)(g);nt(m.auth,c,ns);const w=Aa(m.auth,h);return new Je(m.auth,"linkViaPopup",c,w,m).executeNotNull()})).apply(this,arguments)}let Je=(()=>{class g extends kv{constructor(h,m,w,b,L){super(h,m,b,L),this.provider=w,this.authWindow=null,this.pollId=null,g.currentPopupAction&&g.currentPopupAction.cancel(),g.currentPopupAction=this}executeNotNull(){var h=this;return(0,x.A)(function*(){const m=yield h.execute();return K(m,h.auth,"internal-error"),m})()}onExecution(){var h=this;return(0,x.A)(function*(){rt(1===h.filter.length,"Popup operations only handle one event");const m=Hr();h.authWindow=yield h.resolver._openPopup(h.auth,h.provider,h.filter[0],m),h.authWindow.associatedEvent=m,h.resolver._originValidation(h.auth).catch(w=>{h.reject(w)}),h.resolver._isIframeWebStorageSupported(h.auth,w=>{w||h.reject(zt(h.auth,"web-storage-unsupported"))}),h.pollUserCancellation()})()}get eventId(){var h;return(null===(h=this.authWindow)||void 0===h?void 0:h.associatedEvent)||null}cancel(){this.reject(zt(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,g.currentPopupAction=null}pollUserCancellation(){const h=()=>{var m,w;this.pollId=null!==(w=null===(m=this.authWindow)||void 0===m?void 0:m.window)&&void 0!==w&&w.closed?window.setTimeout(()=>{this.pollId=null,this.reject(zt(this.auth,"popup-closed-by-user"))},8e3):window.setTimeout(h,Uo.get())};h()}}return g.currentPopupAction=null,g})();const Vv="pendingRedirect",Vd=new Map;class kT extends kv{constructor(c,h,m=!1){super(c,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],h,void 0,m),this.eventId=null}execute(){var c=()=>super.execute,h=this;return(0,x.A)(function*(){let m=Vd.get(h.auth._key());if(!m){try{const b=(yield function OT(g,c){return Zp.apply(this,arguments)}(h.resolver,h.auth))?yield c().call(h):null;m=()=>Promise.resolve(b)}catch(w){m=()=>Promise.reject(w)}Vd.set(h.auth._key(),m)}return h.bypassAuthState||Vd.set(h.auth._key(),()=>Promise.resolve(null)),m()})()}onAuthEvent(c){var h=()=>super.onAuthEvent,m=this;return(0,x.A)(function*(){if("signInViaRedirect"===c.type)return h().call(m,c);if("unknown"!==c.type){if(c.eventId){const w=yield m.auth._redirectUserForId(c.eventId);if(w)return m.user=w,h().call(m,c);m.resolve(null)}}else m.resolve(null)})()}onExecution(){return(0,x.A)(function*(){})()}cleanUp(){}}function Zp(){return(Zp=(0,x.A)(function*(g,c){const h=jv(c),m=Bv(g);if(!(yield m._isAvailable()))return!1;const w="true"===(yield m._get(h));return yield m._remove(h),w})).apply(this,arguments)}function Ud(g,c){return Bo.apply(this,arguments)}function Bo(){return(Bo=(0,x.A)(function*(g,c){return Bv(g)._set(jv(c),"true")})).apply(this,arguments)}function FT(){Vd.clear()}function Uv(g,c){Vd.set(g._key(),c)}function Bv(g){return ie(g._redirectPersistence)}function jv(g){return bt(Vv,g.config.apiKey,g.name)}function LT(g,c,h){return function ue(g,c,h){return Dt.apply(this,arguments)}(g,c,h)}function Dt(){return(Dt=(0,x.A)(function*(g,c,h){if((0,Ae._isFirebaseServerApp)(g.app))return Promise.reject(_t(g));const m=Ln(g);nt(g,c,ns),yield m._initializationPromise;const w=Aa(m,h);return yield Ud(w,m),w._openRedirect(m,c,"signInViaRedirect")})).apply(this,arguments)}function ni(g,c,h){return function ri(g,c,h){return _r.apply(this,arguments)}(g,c,h)}function _r(){return(_r=(0,x.A)(function*(g,c,h){const m=(0,N.Ku)(g);if(nt(m.auth,c,ns),(0,Ae._isFirebaseServerApp)(m.auth.app))return Promise.reject(_t(m.auth));yield m.auth._initializationPromise;const w=Aa(m.auth,h);yield Ud(w,m.auth);const b=yield ng(m);return w._openRedirect(m.auth,c,"reauthViaRedirect",b)})).apply(this,arguments)}function $v(g,c,h){return function Zu(g,c,h){return rs.apply(this,arguments)}(g,c,h)}function rs(){return(rs=(0,x.A)(function*(g,c,h){const m=(0,N.Ku)(g);nt(m.auth,c,ns),yield m.auth._initializationPromise;const w=Aa(m.auth,h);yield $u(!1,m,c.providerId),yield Ud(w,m.auth);const b=yield ng(m);return w._openRedirect(m.auth,c,"linkViaRedirect",b)})).apply(this,arguments)}function eg(g,c){return ec.apply(this,arguments)}function ec(){return(ec=(0,x.A)(function*(g,c){return yield Ln(g)._initializationPromise,tg(g,c,!1)})).apply(this,arguments)}function tg(g,c){return Hv.apply(this,arguments)}function Hv(){return(Hv=(0,x.A)(function*(g,c,h=!1){if((0,Ae._isFirebaseServerApp)(g.app))return Promise.reject(_t(g));const m=Ln(g),w=Aa(m,c),L=yield new kT(m,w,h).execute();return L&&!h&&(delete L.user._redirectEventId,yield m._persistUserIfCurrent(L.user),yield m._setRedirectUser(null,c)),L})).apply(this,arguments)}function ng(g){return Pr.apply(this,arguments)}function Pr(){return(Pr=(0,x.A)(function*(g){const c=Hr(`${g.uid}:::`);return g._redirectEventId=c,yield g.auth._setRedirectUser(g),yield g.auth._persistUserIfCurrent(g),c})).apply(this,arguments)}class rg{constructor(c){this.auth=c,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(c){this.consumers.add(c),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,c)&&(this.sendToConsumer(this.queuedRedirectEvent,c),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(c){this.consumers.delete(c)}onEvent(c){if(this.hasEventBeenHandled(c))return!1;let h=!1;return this.consumers.forEach(m=>{this.isEventForConsumer(c,m)&&(h=!0,this.sendToConsumer(c,m),this.saveEventToCache(c))}),this.hasHandledPotentialRedirect||!function VT(g){switch(g.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Hs(g);default:return!1}}(c)||(this.hasHandledPotentialRedirect=!0,h||(this.queuedRedirectEvent=c,h=!0)),h}sendToConsumer(c,h){var m;if(c.error&&!Hs(c)){const w=(null===(m=c.error.code)||void 0===m?void 0:m.split("auth/")[1])||"internal-error";h.onError(zt(this.auth,w))}else h.onAuthEvent(c)}isEventForConsumer(c,h){const m=null===h.eventId||!!c.eventId&&c.eventId===h.eventId;return h.filter.includes(c.type)&&m}hasEventBeenHandled(c){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(ba(c))}saveEventToCache(c){this.cachedEventUids.add(ba(c)),this.lastProcessedEventTime=Date.now()}}function ba(g){return[g.type,g.eventId,g.sessionId,g.tenantId].filter(c=>c).join("-")}function Hs({type:g,error:c}){return"unknown"===g&&"auth/no-auth-event"===c?.code}function ig(g){return sg.apply(this,arguments)}function sg(){return(sg=(0,x.A)(function*(g,c={}){return $(g,"GET","/v1/projects",c)})).apply(this,arguments)}const UT=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,og=/^https?/;function Bd(){return(Bd=(0,x.A)(function*(g){if(g.config.emulator)return;const{authorizedDomains:c}=yield ig(g);for(const h of c)try{if(lg(h))return}catch{}Ht(g,"unauthorized-domain")})).apply(this,arguments)}function lg(g){const c=At(),{protocol:h,hostname:m}=new URL(c);if(g.startsWith("chrome-extension://")){const L=new URL(g);return""===L.hostname&&""===m?"chrome-extension:"===h&&g.replace("chrome-extension://","")===c.replace("chrome-extension://",""):"chrome-extension:"===h&&L.hostname===m}if(!og.test(h))return!1;if(UT.test(g))return m===g;const w=g.replace(/\./g,"\\.");return new RegExp("^(.+\\."+w+"|"+w+")$","i").test(m)}const BT=new pr(3e4,6e4);function ug(){const g=rr().___jsl;if(g?.H)for(const c of Object.keys(g.H))if(g.H[c].r=g.H[c].r||[],g.H[c].L=g.H[c].L||[],g.H[c].r=[...g.H[c].L],g.CP)for(let h=0;h<g.CP.length;h++)g.CP[h]=null}let tc=null;const Wv=new pr(5e3,15e3),Gv="__/auth/iframe",dg="emulator/auth/iframe",jT={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},$T=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ii(g){const c=g.config;K(c.authDomain,g,"auth-domain-config-required");const h=c.emulator?Xr(c,dg):`https://${g.config.authDomain}/${Gv}`,m={apiKey:c.apiKey,appName:g.name,v:Ae.SDK_VERSION},w=$T.get(g.config.apiHost);w&&(m.eid=w);const b=g._getFrameworks();return b.length&&(m.fw=b.join(",")),`${h}?${(0,N.Am)(m).slice(1)}`}function _n(){return _n=(0,x.A)(function*(g){const c=yield function zv(g){return tc=tc||function cg(g){return new Promise((c,h)=>{var m,w,b;function L(){ug(),gapi.load("gapi.iframes",{callback:()=>{c(gapi.iframes.getContext())},ontimeout:()=>{ug(),h(zt(g,"network-request-failed"))},timeout:BT.get()})}if(null!==(w=null===(m=rr().gapi)||void 0===m?void 0:m.iframes)&&void 0!==w&&w.Iframe)c(gapi.iframes.getContext());else{if(null===(b=rr().gapi)||void 0===b||!b.load){const X=uT("iframefcb");return rr()[X]=()=>{gapi.load?L():h(zt(g,"network-request-failed"))},Wy(`${function lT(){return ps.gapiScript}()}?onload=${X}`).catch(le=>h(le))}L()}}).catch(c=>{throw tc=null,c})}(g),tc}(g),h=rr().gapi;return K(h,g,"internal-error"),c.open({where:document.body,url:ii(g),messageHandlersFilter:h.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:jT,dontclear:!0},m=>new Promise(function(){var w=(0,x.A)(function*(b,L){yield m.restyle({setHideOnLeave:!1});const X=zt(g,"network-request-failed"),le=rr().setTimeout(()=>{L(X)},Wv.get());function Me(){rr().clearTimeout(le),b(m)}m.ping(Me).then(Me,()=>{L(X)})});return function(b,L){return w.apply(this,arguments)}}()))}),_n.apply(this,arguments)}const HT={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class hg{constructor(c){this.window=c,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}const qT="__/auth/handler",$d="emulator/auth/handler",Hd=encodeURIComponent("fac");function El(g,c,h,m,w,b){return nc.apply(this,arguments)}function nc(){return(nc=(0,x.A)(function*(g,c,h,m,w,b){K(g.config.authDomain,g,"auth-domain-config-required"),K(g.config.apiKey,g,"invalid-api-key");const L={apiKey:g.config.apiKey,appName:g.name,authType:h,redirectUrl:m,v:Ae.SDK_VERSION,eventId:w};if(c instanceof ns){c.setDefaultLanguage(g.languageCode),L.providerId=c.providerId||"",(0,N.Im)(c.getCustomParameters())||(L.customParameters=JSON.stringify(c.getCustomParameters()));for(const[ze,mt]of Object.entries(b||{}))L[ze]=mt}if(c instanceof Br){const ze=c.getScopes().filter(mt=>""!==mt);ze.length>0&&(L.scopes=ze.join(","))}g.tenantId&&(L.tid=g.tenantId);const X=L;for(const ze of Object.keys(X))void 0===X[ze]&&delete X[ze];const le=yield g._getAppCheckToken(),Me=le?`#${Hd}=${encodeURIComponent(le)}`:"";return`${function Kv({config:g}){return g.emulator?Xr(g,$d):`https://${g.authDomain}/${qT}`}(g)}?${(0,N.Am)(X).slice(1)}${Me}`})).apply(this,arguments)}const zd="webStorageSupport",Da=class KT{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ev,this._completeRedirectFn=tg,this._overrideRedirectResult=Uv}_openPopup(c,h,m,w){var b=this;return(0,x.A)(function*(){var L;rt(null===(L=b.eventManagers[c._key()])||void 0===L?void 0:L.manager,"_initialize() not called before _openPopup()");const X=yield El(c,h,m,At(),w);return function jd(g,c,h,m=500,w=600){const b=Math.max((window.screen.availHeight-w)/2,0).toString(),L=Math.max((window.screen.availWidth-m)/2,0).toString();let X="";const le=Object.assign(Object.assign({},HT),{width:m.toString(),height:w.toString(),top:b,left:L}),Me=(0,N.ZQ)().toLowerCase();h&&(X=Ls(Me)?"_blank":h),be(Me)&&(c=c||"http://localhost",le.scrollbars="yes");const ze=Object.entries(le).reduce((si,[$o,Ra])=>`${si}${$o}=${Ra},`,"");if(function pe(g=(0,N.ZQ)()){var c;return _p(g)&&!(null===(c=window.navigator)||void 0===c||!c.standalone)}(Me)&&"_self"!==X)return function jo(g,c){const h=document.createElement("a");h.href=g,h.target=c;const m=document.createEvent("MouseEvent");m.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),h.dispatchEvent(m)}(c||"",X),new hg(null);const mt=window.open(c||"",X,ze);K(mt,g,"popup-blocked");try{mt.focus()}catch{}return new hg(mt)}(c,X,Hr())})()}_openRedirect(c,h,m,w){var b=this;return(0,x.A)(function*(){return yield b._originValidation(c),function wv(g){rr().location.href=g}(yield El(c,h,m,At(),w)),new Promise(()=>{})})()}_initialize(c){const h=c._key();if(this.eventManagers[h]){const{manager:w,promise:b}=this.eventManagers[h];return w?Promise.resolve(w):(rt(b,"If manager is not set, promise should be"),b)}const m=this.initAndGetManager(c);return this.eventManagers[h]={promise:m},m.catch(()=>{delete this.eventManagers[h]}),m}initAndGetManager(c){var h=this;return(0,x.A)(function*(){const m=yield function Sa(g){return _n.apply(this,arguments)}(c),w=new rg(c);return m.register("authEvent",b=>(K(b?.authEvent,c,"invalid-auth-event"),{status:w.onEvent(b.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),h.eventManagers[c._key()]={manager:w},h.iframes[c._key()]=m,w})()}_isIframeWebStorageSupported(c,h){this.iframes[c._key()].send(zd,{type:zd},w=>{var b;const L=null===(b=w?.[0])||void 0===b?void 0:b[zd];void 0!==L&&h(!!L),Ht(c,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(c){const h=c._key();return this.originValidationPromises[h]||(this.originValidationPromises[h]=function ag(g){return Bd.apply(this,arguments)}(c)),this.originValidationPromises[h]}get _shouldInitProactively(){return it()||Fn()||_p()}};class Il{constructor(c){this.factorId=c}_process(c,h,m){switch(h.type){case"enroll":return this._finalizeEnroll(c,h.credential,m);case"signin":return this._finalizeSignIn(c,h.credential);default:return je("unexpected MultiFactorSessionType")}}}class fg extends Il{constructor(c){super("phone"),this.credential=c}static _fromCredential(c){return new fg(c)}_finalizeEnroll(c,h,m){return function J1(g,c){return $(g,"POST","/v2/accounts/mfaEnrollment:finalize",Q(g,c))}(c,{idToken:h,displayName:m,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(c,h){return function ik(g,c){return $(g,"POST","/v2/accounts/mfaSignIn:finalize",Q(g,c))}(c,{mfaPendingCredential:h,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}let ok=(()=>{class g{constructor(){}static assertion(h){return fg._fromCredential(h)}}return g.FACTOR_ID="phone",g})();var QT="@firebase/auth";class pg{constructor(c){this.auth=c,this.internalListeners=new Map}getUid(){var c;return this.assertAuthConfigured(),(null===(c=this.auth.currentUser)||void 0===c?void 0:c.uid)||null}getToken(c){var h=this;return(0,x.A)(function*(){return h.assertAuthConfigured(),yield h.auth._initializationPromise,h.auth.currentUser?{accessToken:yield h.auth.currentUser.getIdToken(c)}:null})()}addAuthTokenListener(c){if(this.assertAuthConfigured(),this.internalListeners.has(c))return;const h=this.auth.onIdTokenChanged(m=>{c(m?.stsTokenManager.accessToken||null)});this.internalListeners.set(c,h),this.updateProactiveRefresh()}removeAuthTokenListener(c){this.assertAuthConfigured();const h=this.internalListeners.get(c);h&&(this.internalListeners.delete(c),h(),this.updateProactiveRefresh())}assertAuthConfigured(){K(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(0,N.XA)("authIdTokenMaxAge"),function F1(g){ps=g}({loadJS:g=>new Promise((c,h)=>{const m=document.createElement("script");m.setAttribute("src",g),m.onload=c,m.onerror=w=>{const b=zt("internal-error");b.customData=w,h(b)},m.type="text/javascript",m.charset="UTF-8",function Xv(){var g,c;return null!==(c=null===(g=document.getElementsByTagName("head"))||void 0===g?void 0:g[0])&&void 0!==c?c:document}().appendChild(m)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="}),function JT(g){(0,Ae._registerComponent)(new hn.uA("auth",(c,{options:h})=>{const m=c.getProvider("app").getImmediate(),w=c.getProvider("heartbeat"),b=c.getProvider("app-check-internal"),{apiKey:L,authDomain:X}=m.options;K(L&&!L.includes(":"),"invalid-api-key",{appName:m.name});const le={apiKey:L,authDomain:X,clientPlatform:g,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Wt(g)},Me=new O1(m,w,b,le);return function Ed(g,c){const h=c?.persistence||[],m=(Array.isArray(h)?h:[h]).map(ie);c?.errorMap&&g._updateErrorMap(c.errorMap),g._initializeWithPersistence(m,c?.popupRedirectResolver)}(Me,h),Me},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((c,h,m)=>{c.getProvider("auth-internal").initialize()})),(0,Ae._registerComponent)(new hn.uA("auth-internal",c=>{const h=Ln(c.getProvider("auth").getImmediate());return new pg(h)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,Ae.registerVersion)(QT,"1.7.9",function rc(g){switch(g){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(g)),(0,Ae.registerVersion)(QT,"1.7.9","esm2017")}("Browser")},401:(hs,or,Ge)=>{Ge.d(or,{$L:()=>Qt,$g:()=>Xr,A4:()=>he,Am:()=>Os,As:()=>Ke,Bd:()=>je,Cv:()=>kt,FA:()=>ge,Fy:()=>_t,Hk:()=>N,I9:()=>fi,Im:()=>Ir,K3:()=>hn,KA:()=>Mt,Ku:()=>oe,Ll:()=>K,OE:()=>Sr,T9:()=>Ht,Uj:()=>ht,XA:()=>zt,ZQ:()=>nt,bD:()=>hi,c1:()=>At,cY:()=>Lr,dI:()=>Zi,eX:()=>ee,g:()=>re,gR:()=>Gn,gz:()=>Fs,hp:()=>Xi,jZ:()=>ve,kH:()=>Ut,kj:()=>es,lT:()=>pn,lV:()=>sn,mS:()=>Tt,nr:()=>ks,p7:()=>rt,qc:()=>Ot,sr:()=>kn,tD:()=>mr,u:()=>se,vA:()=>Ae,yU:()=>fn,yw:()=>ar,zW:()=>W,zw:()=>Le});const x={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},Ae=function(C,E){if(!C)throw N(E)},N=function(C){return new Error("Firebase Database ("+x.SDK_VERSION+") INTERNAL ASSERT FAILED: "+C)},Fe=function(C){const E=[];let T=0;for(let R=0;R<C.length;R++){let k=C.charCodeAt(R);k<128?E[T++]=k:k<2048?(E[T++]=k>>6|192,E[T++]=63&k|128):55296==(64512&k)&&R+1<C.length&&56320==(64512&C.charCodeAt(R+1))?(k=65536+((1023&k)<<10)+(1023&C.charCodeAt(++R)),E[T++]=k>>18|240,E[T++]=k>>12&63|128,E[T++]=k>>6&63|128,E[T++]=63&k|128):(E[T++]=k>>12|224,E[T++]=k>>6&63|128,E[T++]=63&k|128)}return E},hn={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(C,E){if(!Array.isArray(C))throw Error("encodeByteArray takes an array as a parameter");this.init_();const T=E?this.byteToCharMapWebSafe_:this.byteToCharMap_,R=[];for(let k=0;k<C.length;k+=3){const ie=C[k],ye=k+1<C.length,He=ye?C[k+1]:0,bt=k+2<C.length,Ve=bt?C[k+2]:0;let Fn=(15&He)<<2|Ve>>6,Ls=63&Ve;bt||(Ls=64,ye||(Fn=64)),R.push(T[ie>>2],T[(3&ie)<<4|He>>4],T[Fn],T[Ls])}return R.join("")},encodeString(C,E){return this.HAS_NATIVE_SUPPORT&&!E?btoa(C):this.encodeByteArray(Fe(C),E)},decodeString(C,E){return this.HAS_NATIVE_SUPPORT&&!E?atob(C):function(C){const E=[];let T=0,R=0;for(;T<C.length;){const k=C[T++];if(k<128)E[R++]=String.fromCharCode(k);else if(k>191&&k<224){const ie=C[T++];E[R++]=String.fromCharCode((31&k)<<6|63&ie)}else if(k>239&&k<365){const bt=((7&k)<<18|(63&C[T++])<<12|(63&C[T++])<<6|63&C[T++])-65536;E[R++]=String.fromCharCode(55296+(bt>>10)),E[R++]=String.fromCharCode(56320+(1023&bt))}else{const ie=C[T++],ye=C[T++];E[R++]=String.fromCharCode((15&k)<<12|(63&ie)<<6|63&ye)}}return E.join("")}(this.decodeStringToByteArray(C,E))},decodeStringToByteArray(C,E){this.init_();const T=E?this.charToByteMapWebSafe_:this.charToByteMap_,R=[];for(let k=0;k<C.length;){const ie=T[C.charAt(k++)],He=k<C.length?T[C.charAt(k)]:0;++k;const Ve=k<C.length?T[C.charAt(k)]:64;++k;const be=k<C.length?T[C.charAt(k)]:64;if(++k,null==ie||null==He||null==Ve||null==be)throw new Cn;R.push(ie<<2|He>>4),64!==Ve&&(R.push(He<<4&240|Ve>>2),64!==be&&R.push(Ve<<6&192|be))}return R},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let C=0;C<this.ENCODED_VALS.length;C++)this.byteToCharMap_[C]=this.ENCODED_VALS.charAt(C),this.charToByteMap_[this.byteToCharMap_[C]]=C,this.byteToCharMapWebSafe_[C]=this.ENCODED_VALS_WEBSAFE.charAt(C),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[C]]=C,C>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(C)]=C,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(C)]=C)}}};class Cn extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Mt=function(C){const E=Fe(C);return hn.encodeByteArray(E,!0)},ht=function(C){return Mt(C).replace(/\./g,"")},se=function(C){try{return hn.decodeString(C,!0)}catch(E){console.error("base64Decode failed: ",E)}return null};function he(C){return Le(void 0,C)}function Le(C,E){if(!(E instanceof Object))return E;switch(E.constructor){case Date:return new Date(E.getTime());case Object:void 0===C&&(C={});break;case Array:C=[];break;default:return E}for(const T in E)!E.hasOwnProperty(T)||!ot(T)||(C[T]=Le(C[T],E[T]));return C}function ot(C){return"__proto__"!==C}function Tt(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const qe=()=>{try{return Tt().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const C=process.env.__FIREBASE_DEFAULTS__;return C?JSON.parse(C):void 0})()||(()=>{if(typeof document>"u")return;let C;try{C=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const E=C&&se(C[1]);return E&&JSON.parse(E)})()}catch(C){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${C}`)}},fn=C=>{const E=(C=>{var E,T;return null===(T=null===(E=qe())||void 0===E?void 0:E.emulatorHosts)||void 0===T?void 0:T[C]})(C);if(!E)return;const T=E.lastIndexOf(":");if(T<=0||T+1===E.length)throw new Error(`Invalid host ${E} with no separate hostname and port!`);const R=parseInt(E.substring(T+1),10);return"["===E[0]?[E.substring(1,T-1),R]:[E.substring(0,T),R]},Ht=()=>{var C;return null===(C=qe())||void 0===C?void 0:C.config},zt=C=>{var E;return null===(E=qe())||void 0===E?void 0:E[`_${C}`]};class Lr{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((E,T)=>{this.resolve=E,this.reject=T})}wrapCallback(E){return(T,R)=>{T?this.reject(T):this.resolve(R),"function"==typeof E&&(this.promise.catch(()=>{}),1===E.length?E(T):E(T,R))}}}function _t(C,E){if(C.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const R=E||"demo-project",k=C.iat||0,ie=C.sub||C.user_id;if(!ie)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const ye=Object.assign({iss:`https://securetoken.google.com/${R}`,aud:R,iat:k,exp:k+3600,auth_time:k,sub:ie,user_id:ie,firebase:{sign_in_provider:"custom",identities:{}}},C);return[ht(JSON.stringify({alg:"none",type:"JWT"})),ht(JSON.stringify(ye)),""].join(".")}function nt(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function ve(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(nt())}function K(){var C;const E=null===(C=qe())||void 0===C?void 0:C.forceEnvironment;if("node"===E)return!0;if("browser"===E)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch{return!1}}function je(){return typeof window<"u"||rt()}function rt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function At(){return typeof navigator<"u"&&"Cloudflare-Workers"===navigator.userAgent}function kn(){const C="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof C&&void 0!==C.id}function sn(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function pn(){const C=nt();return C.indexOf("MSIE ")>=0||C.indexOf("Trident/")>=0}function Xr(){return!0===x.NODE_CLIENT||!0===x.NODE_ADMIN}function ks(){return!K()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function W(){try{return"object"==typeof indexedDB}catch{return!1}}function ee(){return new Promise((C,E)=>{try{let T=!0;const R="validate-browser-context-for-indexeddb-analytics-module",k=self.indexedDB.open(R);k.onsuccess=()=>{k.result.close(),T||self.indexedDB.deleteDatabase(R),C(!0)},k.onupgradeneeded=()=>{T=!1},k.onerror=()=>{var ie;E((null===(ie=k.error)||void 0===ie?void 0:ie.message)||"")}}catch(T){E(T)}})}class re extends Error{constructor(E,T,R){super(T),this.code=E,this.customData=R,this.name="FirebaseError",Object.setPrototypeOf(this,re.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,ge.prototype.create)}}class ge{constructor(E,T,R){this.service=E,this.serviceName=T,this.errors=R}create(E,...T){const R=T[0]||{},k=`${this.service}/${E}`,ie=this.errors[E],ye=ie?function de(C,E){return C.replace(Qe,(T,R)=>{const k=E[R];return null!=k?String(k):`<${R}?>`})}(ie,R):"Error";return new re(k,`${this.serviceName}: ${ye} (${k}).`,R)}}const Qe=/\{\$([^}]+)}/g;function Qt(C){return JSON.parse(C)}function Ke(C){return JSON.stringify(C)}const Ft=function(C){let E={},T={},R={},k="";try{const ie=C.split(".");E=Qt(se(ie[0])||""),T=Qt(se(ie[1])||""),k=ie[2],R=T.d||{},delete T.d}catch{}return{header:E,claims:T,data:R,signature:k}},kt=function(C){const T=Ft(C).claims;return!!T&&"object"==typeof T&&T.hasOwnProperty("iat")},Ot=function(C){const E=Ft(C).claims;return"object"==typeof E&&!0===E.admin};function Gn(C,E){return Object.prototype.hasOwnProperty.call(C,E)}function ar(C,E){if(Object.prototype.hasOwnProperty.call(C,E))return C[E]}function Ir(C){for(const E in C)if(Object.prototype.hasOwnProperty.call(C,E))return!1;return!0}function Ut(C,E,T){const R={};for(const k in C)Object.prototype.hasOwnProperty.call(C,k)&&(R[k]=E.call(T,C[k],k,C));return R}function hi(C,E){if(C===E)return!0;const T=Object.keys(C),R=Object.keys(E);for(const k of T){if(!R.includes(k))return!1;const ie=C[k],ye=E[k];if(no(ie)&&no(ye)){if(!hi(ie,ye))return!1}else if(ie!==ye)return!1}for(const k of R)if(!T.includes(k))return!1;return!0}function no(C){return null!==C&&"object"==typeof C}function Os(C){const E=[];for(const[T,R]of Object.entries(C))Array.isArray(R)?R.forEach(k=>{E.push(encodeURIComponent(T)+"="+encodeURIComponent(k))}):E.push(encodeURIComponent(T)+"="+encodeURIComponent(R));return E.length?"&"+E.join("&"):""}function fi(C){const E={};return C.replace(/^\?/,"").split("&").forEach(R=>{if(R){const[k,ie]=R.split("=");E[decodeURIComponent(k)]=decodeURIComponent(ie)}}),E}function Xi(C){const E=C.indexOf("?");if(!E)return"";const T=C.indexOf("#",E);return C.substring(E,T>0?T:void 0)}class Fs{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let E=1;E<this.blockSize;++E)this.pad_[E]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(E,T){T||(T=0);const R=this.W_;if("string"==typeof E)for(let be=0;be<16;be++)R[be]=E.charCodeAt(T)<<24|E.charCodeAt(T+1)<<16|E.charCodeAt(T+2)<<8|E.charCodeAt(T+3),T+=4;else for(let be=0;be<16;be++)R[be]=E[T]<<24|E[T+1]<<16|E[T+2]<<8|E[T+3],T+=4;for(let be=16;be<80;be++){const Fn=R[be-3]^R[be-8]^R[be-14]^R[be-16];R[be]=4294967295&(Fn<<1|Fn>>>31)}let Ve,mn,k=this.chain_[0],ie=this.chain_[1],ye=this.chain_[2],He=this.chain_[3],bt=this.chain_[4];for(let be=0;be<80;be++){be<40?be<20?(Ve=He^ie&(ye^He),mn=1518500249):(Ve=ie^ye^He,mn=1859775393):be<60?(Ve=ie&ye|He&(ie|ye),mn=2400959708):(Ve=ie^ye^He,mn=3395469782);const Fn=(k<<5|k>>>27)+Ve+bt+mn+R[be]&4294967295;bt=He,He=ye,ye=4294967295&(ie<<30|ie>>>2),ie=k,k=Fn}this.chain_[0]=this.chain_[0]+k&4294967295,this.chain_[1]=this.chain_[1]+ie&4294967295,this.chain_[2]=this.chain_[2]+ye&4294967295,this.chain_[3]=this.chain_[3]+He&4294967295,this.chain_[4]=this.chain_[4]+bt&4294967295}update(E,T){if(null==E)return;void 0===T&&(T=E.length);const R=T-this.blockSize;let k=0;const ie=this.buf_;let ye=this.inbuf_;for(;k<T;){if(0===ye)for(;k<=R;)this.compress_(E,k),k+=this.blockSize;if("string"==typeof E){for(;k<T;)if(ie[ye]=E.charCodeAt(k),++ye,++k,ye===this.blockSize){this.compress_(ie),ye=0;break}}else for(;k<T;)if(ie[ye]=E[k],++ye,++k,ye===this.blockSize){this.compress_(ie),ye=0;break}}this.inbuf_=ye,this.total_+=T}digest(){const E=[];let T=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let k=this.blockSize-1;k>=56;k--)this.buf_[k]=255&T,T/=256;this.compress_(this.buf_);let R=0;for(let k=0;k<5;k++)for(let ie=24;ie>=0;ie-=8)E[R]=this.chain_[k]>>ie&255,++R;return E}}function mr(C,E){const T=new Ni(C,E);return T.subscribe.bind(T)}class Ni{constructor(E,T){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=T,this.task.then(()=>{E(this)}).catch(R=>{this.error(R)})}next(E){this.forEachObserver(T=>{T.next(E)})}error(E){this.forEachObserver(T=>{T.error(E)}),this.close(E)}complete(){this.forEachObserver(E=>{E.complete()}),this.close()}subscribe(E,T,R){let k;if(void 0===E&&void 0===T&&void 0===R)throw new Error("Missing Observer.");k=function wr(C,E){if("object"!=typeof C||null===C)return!1;for(const T of E)if(T in C&&"function"==typeof C[T])return!0;return!1}(E,["next","error","complete"])?E:{next:E,error:T,complete:R},void 0===k.next&&(k.next=qn),void 0===k.error&&(k.error=qn),void 0===k.complete&&(k.complete=qn);const ie=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?k.error(this.finalError):k.complete()}catch{}}),this.observers.push(k),ie}unsubscribeOne(E){void 0===this.observers||void 0===this.observers[E]||(delete this.observers[E],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(E){if(!this.finalized)for(let T=0;T<this.observers.length;T++)this.sendOne(T,E)}sendOne(E,T){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[E])try{T(this.observers[E])}catch(R){typeof console<"u"&&console.error&&console.error(R)}})}close(E){this.finalized||(this.finalized=!0,void 0!==E&&(this.finalError=E),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function qn(){}function Zi(C,E){return`${C} failed: ${E} argument `}const es=function(C){const E=[];let T=0;for(let R=0;R<C.length;R++){let k=C.charCodeAt(R);if(k>=55296&&k<=56319){const ie=k-55296;R++,Ae(R<C.length,"Surrogate pair missing trail surrogate."),k=65536+(ie<<10)+(C.charCodeAt(R)-56320)}k<128?E[T++]=k:k<2048?(E[T++]=k>>6|192,E[T++]=63&k|128):k<65536?(E[T++]=k>>12|224,E[T++]=k>>6&63|128,E[T++]=63&k|128):(E[T++]=k>>18|240,E[T++]=k>>12&63|128,E[T++]=k>>6&63|128,E[T++]=63&k|128)}return E},Sr=function(C){let E=0;for(let T=0;T<C.length;T++){const R=C.charCodeAt(T);R<128?E++:R<2048?E+=2:R>=55296&&R<=56319?(E+=4,T++):E+=3}return E};function oe(C){return C&&C._delegate?C._delegate:C}},693:(hs,or,Ge)=>{function x(n){return"function"==typeof n}function Ae(n){const t=n(r=>{Error.call(r),r.stack=(new Error).stack});return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}const N=Ae(n=>function(t){n(this),this.message=t?`${t.length} errors occurred during unsubscription:\n${t.map((r,i)=>`${i+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=t});function Fe(n,e){if(n){const t=n.indexOf(e);0<=t&&n.splice(t,1)}}class Nt{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:t}=this;if(t)if(this._parentage=null,Array.isArray(t))for(const s of t)s.remove(this);else t.remove(this);const{initialTeardown:r}=this;if(x(r))try{r()}catch(s){e=s instanceof N?s.errors:[s]}const{_finalizers:i}=this;if(i){this._finalizers=null;for(const s of i)try{Mt(s)}catch(o){e=e??[],o instanceof N?e=[...e,...o.errors]:e.push(o)}}if(e)throw new N(e)}}add(e){var t;if(e&&e!==this)if(this.closed)Mt(e);else{if(e instanceof Nt){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(t=this._finalizers)&&void 0!==t?t:[]).push(e)}}_hasParent(e){const{_parentage:t}=this;return t===e||Array.isArray(t)&&t.includes(e)}_addParent(e){const{_parentage:t}=this;this._parentage=Array.isArray(t)?(t.push(e),t):t?[t,e]:e}_removeParent(e){const{_parentage:t}=this;t===e?this._parentage=null:Array.isArray(t)&&Fe(t,e)}remove(e){const{_finalizers:t}=this;t&&Fe(t,e),e instanceof Nt&&e._removeParent(this)}}Nt.EMPTY=(()=>{const n=new Nt;return n.closed=!0,n})();const hn=Nt.EMPTY;function Cn(n){return n instanceof Nt||n&&"closed"in n&&x(n.remove)&&x(n.add)&&x(n.unsubscribe)}function Mt(n){x(n)?n():n.unsubscribe()}const ht={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},se={setTimeout(n,e,...t){const{delegate:r}=se;return r?.setTimeout?r.setTimeout(n,e,...t):setTimeout(n,e,...t)},clearTimeout(n){const{delegate:e}=se;return(e?.clearTimeout||clearTimeout)(n)},delegate:void 0};function he(n){se.setTimeout(()=>{const{onUnhandledError:e}=ht;if(!e)throw n;e(n)})}function Le(){}const ot=gt("C",void 0,void 0);function gt(n,e,t){return{kind:n,value:e,error:t}}let Xe=null;function qe(n){if(ht.useDeprecatedSynchronousErrorHandling){const e=!Xe;if(e&&(Xe={errorThrown:!1,error:null}),n(),e){const{errorThrown:t,error:r}=Xe;if(Xe=null,t)throw r}}else n()}class fn extends Nt{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Cn(e)&&e.add(this)):this.destination=je}static create(e,t,r){return new _t(e,t,r)}next(e){this.isStopped?K(function tr(n){return gt("N",n,void 0)}(e),this):this._next(e)}error(e){this.isStopped?K(function Tt(n){return gt("E",void 0,n)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?K(ot,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Ht=Function.prototype.bind;function zt(n,e){return Ht.call(n,e)}class Lr{constructor(e){this.partialObserver=e}next(e){const{partialObserver:t}=this;if(t.next)try{t.next(e)}catch(r){nt(r)}}error(e){const{partialObserver:t}=this;if(t.error)try{t.error(e)}catch(r){nt(r)}else nt(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(t){nt(t)}}}class _t extends fn{constructor(e,t,r){let i;if(super(),x(e)||!e)i={next:e??void 0,error:t??void 0,complete:r??void 0};else{let s;this&&ht.useDeprecatedNextContext?(s=Object.create(e),s.unsubscribe=()=>this.unsubscribe(),i={next:e.next&&zt(e.next,s),error:e.error&&zt(e.error,s),complete:e.complete&&zt(e.complete,s)}):i=e}this.destination=new Lr(i)}}function nt(n){ht.useDeprecatedSynchronousErrorHandling?function Wn(n){ht.useDeprecatedSynchronousErrorHandling&&Xe&&(Xe.errorThrown=!0,Xe.error=n)}(n):he(n)}function K(n,e){const{onStoppedNotification:t}=ht;t&&se.setTimeout(()=>t(n,e))}const je={closed:!0,next:Le,error:function ve(n){throw n},complete:Le},rt="function"==typeof Symbol&&Symbol.observable||"@@observable";function At(n){return n}function sn(n){return 0===n.length?At:1===n.length?n[0]:function(t){return n.reduce((r,i)=>i(r),t)}}let lt=(()=>{class n{constructor(t){t&&(this._subscribe=t)}lift(t){const r=new n;return r.source=this,r.operator=t,r}subscribe(t,r,i){const s=function Xr(n){return n&&n instanceof fn||function pr(n){return n&&x(n.next)&&x(n.error)&&x(n.complete)}(n)&&Cn(n)}(t)?t:new _t(t,r,i);return qe(()=>{const{operator:o,source:a}=this;s.add(o?o.call(s,a):a?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(t){try{return this._subscribe(t)}catch(r){t.error(r)}}forEach(t,r){return new(r=pn(r))((i,s)=>{const o=new _t({next:a=>{try{t(a)}catch(l){s(l),o.unsubscribe()}},error:s,complete:i});this.subscribe(o)})}_subscribe(t){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(t)}[rt](){return this}pipe(...t){return sn(t)(this)}toPromise(t){return new(t=pn(t))((r,i)=>{let s;this.subscribe(o=>s=o,o=>i(o),()=>r(s))})}}return n.create=e=>new n(e),n})();function pn(n){var e;return null!==(e=n??ht.Promise)&&void 0!==e?e:Promise}const ks=Ae(n=>function(){n(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let W=(()=>{class n extends lt{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(t){const r=new ee(this,this);return r.operator=t,r}_throwIfClosed(){if(this.closed)throw new ks}next(t){qe(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(t)}})}error(t){qe(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=t;const{observers:r}=this;for(;r.length;)r.shift().error(t)}})}complete(){qe(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:t}=this;for(;t.length;)t.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0}_trySubscribe(t){return this._throwIfClosed(),super._trySubscribe(t)}_subscribe(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)}_innerSubscribe(t){const{hasError:r,isStopped:i,observers:s}=this;return r||i?hn:(this.currentObservers=null,s.push(t),new Nt(()=>{this.currentObservers=null,Fe(s,t)}))}_checkFinalizedStatuses(t){const{hasError:r,thrownError:i,isStopped:s}=this;r?t.error(i):s&&t.complete()}asObservable(){const t=new lt;return t.source=this,t}}return n.create=(e,t)=>new ee(e,t),n})();class ee extends W{constructor(e,t){super(),this.destination=e,this.source=t}next(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.next)||void 0===r||r.call(t,e)}error(e){var t,r;null===(r=null===(t=this.destination)||void 0===t?void 0:t.error)||void 0===r||r.call(t,e)}complete(){var e,t;null===(t=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===t||t.call(e)}_subscribe(e){var t,r;return null!==(r=null===(t=this.source)||void 0===t?void 0:t.subscribe(e))&&void 0!==r?r:hn}}function Q(n){return x(n?.lift)}function $(n){return e=>{if(Q(e))return e.lift(function(t){try{return n(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function re(n,e,t,r,i){return new ge(n,e,t,r,i)}class ge extends fn{constructor(e,t,r,i,s,o){super(e),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=t?function(a){try{t(a)}catch(l){e.error(l)}}:super._next,this._error=i?function(a){try{i(a)}catch(l){e.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(a){e.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:t}=this;super.unsubscribe(),!t&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function de(n,e){return $((t,r)=>{let i=0;t.subscribe(re(r,s=>{r.next(n.call(e,s,i++))}))})}var Qe=Ge(635);const Qt=n=>n&&"number"==typeof n.length&&"function"!=typeof n;function Ke(n){return x(n?.then)}function Ft(n){return x(n[rt])}function gn(n){return Symbol.asyncIterator&&x(n?.[Symbol.asyncIterator])}function gr(n){return new TypeError(`You provided ${null!==n&&"object"==typeof n?"an invalid object":`'${n}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Ot=function kt(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Gn(n){return x(n?.[Ot])}function ar(n){return(0,Qe.AQ)(this,arguments,function*(){const t=n.getReader();try{for(;;){const{value:r,done:i}=yield(0,Qe.N3)(t.read());if(i)return yield(0,Qe.N3)(void 0);yield yield(0,Qe.N3)(r)}}finally{t.releaseLock()}})}function Ir(n){return x(n?.getReader)}function Ut(n){if(n instanceof lt)return n;if(null!=n){if(Ft(n))return function hi(n){return new lt(e=>{const t=n[rt]();if(x(t.subscribe))return t.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(n);if(Qt(n))return function no(n){return new lt(e=>{for(let t=0;t<n.length&&!e.closed;t++)e.next(n[t]);e.complete()})}(n);if(Ke(n))return function Po(n){return new lt(e=>{n.then(t=>{e.closed||(e.next(t),e.complete())},t=>e.error(t)).then(null,he)})}(n);if(gn(n))return fi(n);if(Gn(n))return function Os(n){return new lt(e=>{for(const t of n)if(e.next(t),e.closed)return;e.complete()})}(n);if(Ir(n))return function Xi(n){return fi(ar(n))}(n)}throw gr(n)}function fi(n){return new lt(e=>{(function Fs(n,e){var t,r,i,s;return(0,Qe.sH)(this,void 0,void 0,function*(){try{for(t=(0,Qe.xN)(n);!(r=yield t.next()).done;)if(e.next(r.value),e.closed)return}catch(o){i={error:o}}finally{try{r&&!r.done&&(s=t.return)&&(yield s.call(t))}finally{if(i)throw i.error}}e.complete()})})(n,e).catch(t=>e.error(t))})}function mr(n,e,t,r=0,i=!1){const s=e.schedule(function(){t(),i?n.add(this.schedule(null,r)):this.unsubscribe()},r);if(n.add(s),!i)return s}function On(n,e,t=1/0){return x(e)?On((r,i)=>de((s,o)=>e(r,s,i,o))(Ut(n(r,i))),t):("number"==typeof e&&(t=e),$((r,i)=>function Ni(n,e,t,r,i,s,o,a){const l=[];let u=0,d=0,p=!1;const _=()=>{p&&!l.length&&!u&&e.complete()},v=D=>u<r?A(D):l.push(D),A=D=>{s&&e.next(D),u++;let P=!1;Ut(t(D,d++)).subscribe(re(e,H=>{i?.(H),s?v(H):e.next(H)},()=>{P=!0},void 0,()=>{if(P)try{for(u--;l.length&&u<r;){const H=l.shift();o?mr(e,o,()=>A(H)):A(H)}_()}catch(H){e.error(H)}}))};return n.subscribe(re(e,v,()=>{p=!0,_()})),()=>{a?.()}}(r,i,n,t)))}function wr(n=1/0){return On(At,n)}const qn=new lt(n=>n.complete());function Mi(n){return n[n.length-1]}function fs(n){return x(Mi(n))?n.pop():void 0}function es(n){return function Yt(n){return n&&x(n.schedule)}(Mi(n))?n.pop():void 0}function nr(n,e=0){return $((t,r)=>{t.subscribe(re(r,i=>mr(r,n,()=>r.next(i),e),()=>mr(r,n,()=>r.complete(),e),i=>mr(r,n,()=>r.error(i),e)))})}function Vr(n,e=0){return $((t,r)=>{r.add(n.schedule(()=>t.subscribe(r),e))})}function ya(n,e){if(!n)throw new Error("Iterable cannot be null");return new lt(t=>{mr(t,e,()=>{const r=n[Symbol.asyncIterator]();mr(t,e,()=>{r.next().then(i=>{i.done?t.complete():t.next(i.value)})},0,!0)})})}function C(n,e){return e?function oe(n,e){if(null!=n){if(Ft(n))return function io(n,e){return Ut(n).pipe(Vr(e),nr(e))}(n,e);if(Qt(n))return function oo(n,e){return new lt(t=>{let r=0;return e.schedule(function(){r===n.length?t.complete():(t.next(n[r++]),t.closed||this.schedule())})})}(n,e);if(Ke(n))return function so(n,e){return Ut(n).pipe(Vr(e),nr(e))}(n,e);if(gn(n))return ya(n,e);if(Gn(n))return function No(n,e){return new lt(t=>{let r;return mr(t,e,()=>{r=n[Ot](),mr(t,e,()=>{let i,s;try{({value:i,done:s}=r.next())}catch(o){return void t.error(o)}s?t.complete():t.next(i)},0,!0)}),()=>x(r?.return)&&r.return()})}(n,e);if(Ir(n))return function Re(n,e){return ya(ar(n),e)}(n,e)}throw gr(n)}(n,e):Ut(n)}function E(...n){const e=es(n),t=function Sr(n,e){return"number"==typeof Mi(n)?n.pop():e}(n,1/0),r=n;return r.length?1===r.length?Ut(r[0]):wr(t)(C(r,e)):qn}class T extends W{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const t=super._subscribe(e);return!t.closed&&e.next(this._value),t}getValue(){const{hasError:e,thrownError:t,_value:r}=this;if(e)throw t;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}function R(...n){return C(n,es(n))}function k(n={}){const{connector:e=(()=>new W),resetOnError:t=!0,resetOnComplete:r=!0,resetOnRefCountZero:i=!0}=n;return s=>{let o,a,l,u=0,d=!1,p=!1;const _=()=>{a?.unsubscribe(),a=void 0},v=()=>{_(),o=l=void 0,d=p=!1},A=()=>{const D=o;v(),D?.unsubscribe()};return $((D,P)=>{u++,!p&&!d&&_();const H=l=l??e();P.add(()=>{u--,0===u&&!p&&!d&&(a=ie(A,i))}),H.subscribe(P),!o&&u>0&&(o=new _t({next:V=>H.next(V),error:V=>{p=!0,_(),a=ie(v,t,V),H.error(V)},complete:()=>{d=!0,_(),a=ie(v,r),H.complete()}}),Ut(D).subscribe(o))})(s)}}function ie(n,e,...t){if(!0===e)return void n();if(!1===e)return;const r=new _t({next:()=>{r.unsubscribe(),n()}});return Ut(e(...t)).subscribe(r)}function ye(n,e){return $((t,r)=>{let i=null,s=0,o=!1;const a=()=>o&&!i&&r.complete();t.subscribe(re(r,l=>{i?.unsubscribe();let u=0;const d=s++;Ut(n(l,d)).subscribe(i=re(r,p=>r.next(e?e(l,p,d,u++):p),()=>{i=null,a()}))},()=>{o=!0,a()}))})}function He(n,e=At){return n=n??bt,$((t,r)=>{let i,s=!0;t.subscribe(re(r,o=>{const a=e(o);(s||!n(i,a))&&(s=!1,i=a,r.next(o))}))})}function bt(n,e){return n===e}function Ve(n){for(let e in n)if(n[e]===Ve)return e;throw Error("Could not find renamed property on target object.")}function mn(n,e){for(const t in e)e.hasOwnProperty(t)&&!n.hasOwnProperty(t)&&(n[t]=e[t])}function be(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(be).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const e=n.toString();if(null==e)return""+e;const t=e.indexOf("\n");return-1===t?e:e.substring(0,t)}function Fn(n,e){return null==n||""===n?null===e?"":e:null==e||""===e?n:n+" "+e}const Ls=Ve({__forward_ref__:Ve});function Jt(n){return n.__forward_ref__=Jt,n.toString=function(){return be(this())},n}function Ze(n){return md(n)?n():n}function md(n){return"function"==typeof n&&n.hasOwnProperty(Ls)&&n.__forward_ref__===Jt}function _d(n){return n&&!!n.\u0275providers}const zy="https://g.co/ng/security#xss";class pe extends Error{constructor(e,t){super(function yd(n,e){return`NG0${Math.abs(n)}${e?": "+e:""}`}(e,t)),this.code=e}}function it(n){return"string"==typeof n?n:null==n?"":String(n)}function vp(n,e){throw new pe(-201,!1)}function Oi(n,e){null==n&&function et(n,e,t,r){throw new Error(`ASSERTION ERROR: ${n}`+(null==r?"":` [Expected=> ${t} ${r} ${e} <=Actual]`))}(e,n,null,"!=")}function Be(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function pi(n){return{providers:n.providers||[],imports:n.imports||[]}}function Ed(n){return Ep(n,Id)||Ep(n,Ip)}function Ep(n,e){return n.hasOwnProperty(e)?n[e]:null}function Nu(n){return n&&(n.hasOwnProperty(Mo)||n.hasOwnProperty(wp))?n[Mo]:null}const Id=Ve({\u0275prov:Ve}),Mo=Ve({\u0275inj:Ve}),Ip=Ve({ngInjectableDef:Ve}),wp=Ve({ngInjectorDef:Ve});var yt=function(n){return n[n.Default=0]="Default",n[n.Host=1]="Host",n[n.Self=2]="Self",n[n.SkipSelf=4]="SkipSelf",n[n.Optional=8]="Optional",n}(yt||{});let Mu;function Ur(n){const e=Mu;return Mu=n,e}function Jy(n,e,t){const r=Ed(n);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:t&yt.Optional?null:void 0!==e?e:void vp(be(n))}const un=globalThis;class we{constructor(e,t){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof t?this.__NG_ELEMENT_ID__=t:void 0!==t&&(this.\u0275prov=Be({token:this,providedIn:t.providedIn||"root",factory:t.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const va={},Ea="__NG_DI_FLAG__",ts="ngTempTokenPath",fT=/\n/gm,rv="__source";let ko;function Us(n){const e=ko;return ko=n,e}function gT(n,e=yt.Default){if(void 0===ko)throw new pe(-203,!1);return null===ko?Jy(n,void 0,e):ko.get(n,e&yt.Optional?null:void 0,e)}function Ee(n,e=yt.Default){return(function Yy(){return Mu}()||gT)(Ze(n),e)}function ke(n,e=yt.Default){return Ee(n,ll(e))}function ll(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function ao(n){const e=[];for(let t=0;t<n.length;t++){const r=Ze(n[t]);if(Array.isArray(r)){if(0===r.length)throw new pe(900,!1);let i,s=yt.Default;for(let o=0;o<r.length;o++){const a=r[o],l=mT(a);"number"==typeof l?-1===l?i=a.token:s|=l:i=a}e.push(Ee(i,s))}else e.push(Ee(r))}return e}function Lu(n,e){return n[Ea]=e,n.prototype[Ea]=e,n}function mT(n){return n[Ea]}function gs(n){return{toString:n}.toString()}var ns=function(n){return n[n.OnPush=0]="OnPush",n[n.Default=1]="Default",n}(ns||{}),Br=function(n){return n[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",n}(Br||{});const gi={},jt=[],wd=Ve({\u0275cmp:Ve}),bp=Ve({\u0275dir:Ve}),Sp=Ve({\u0275pipe:Ve}),Ia=Ve({\u0275mod:Ve}),lo=Ve({\u0275fac:Ve}),Oo=Ve({__NG_ELEMENT_ID__:Ve}),sv=Ve({__NG_ENV_ID__:Ve});function Dp(n,e,t){let r=n.length;for(;;){const i=n.indexOf(e,t);if(-1===i)return i;if(0===i||n.charCodeAt(i-1)<=32){const s=e.length;if(i+s===r||n.charCodeAt(i+s)<=32)return i}t=i+1}}function Uu(n,e,t){let r=0;for(;r<t.length;){const i=t[r];if("number"==typeof i){if(0!==i)break;r++;const s=t[r++],o=t[r++],a=t[r++];n.setAttribute(e,o,a,s)}else{const s=i,o=t[++r];Rp(s)?n.setProperty(e,s,o):n.setAttribute(e,s,o),r++}}return r}function Fi(n){return 3===n||4===n||6===n}function Rp(n){return 64===n.charCodeAt(0)}function Bu(n,e){if(null!==e&&0!==e.length)if(null===n||0===n.length)n=e.slice();else{let t=-1;for(let r=0;r<e.length;r++){const i=e[r];"number"==typeof i?t=i:0===t||Cd(n,t,i,null,-1===t||2===t?e[++r]:null)}}return n}function Cd(n,e,t,r,i){let s=0,o=n.length;if(-1===e)o=-1;else for(;s<n.length;){const a=n[s++];if("number"==typeof a){if(a===e){o=-1;break}if(a>e){o=s-1;break}}}for(;s<n.length;){const a=n[s];if("number"==typeof a)break;if(a===t){if(null===r)return void(null!==i&&(n[s+1]=i));if(r===n[s+1])return void(n[s+2]=i)}s++,null!==r&&s++,null!==i&&s++}-1!==o&&(n.splice(o,0,e),s=o+1),n.splice(s++,0,t),null!==r&&n.splice(s++,0,r),null!==i&&n.splice(s++,0,i)}const ju="ng-template";function ov(n,e,t){let r=0,i=!0;for(;r<n.length;){let s=n[r++];if("string"==typeof s&&i){const o=n[r++];if(t&&"class"===s&&-1!==Dp(o.toLowerCase(),e,0))return!0}else{if(1===s){for(;r<n.length&&"string"==typeof(s=n[r++]);)if(s.toLowerCase()===e)return!0;return!1}"number"==typeof s&&(i=!1)}}return!1}function xp(n){return 4===n.type&&n.value!==ju}function _T(n,e,t){return e===(4!==n.type||t?n.value:ju)}function Pp(n,e,t){let r=4;const i=n.attrs||[],s=function av(n){for(let e=0;e<n.length;e++)if(Fi(n[e]))return e;return n.length}(i);let o=!1;for(let a=0;a<e.length;a++){const l=e[a];if("number"!=typeof l){if(!o)if(4&r){if(r=2|1&r,""!==l&&!_T(n,l,t)||""===l&&1===e.length){if(Li(r))return!1;o=!0}}else{const u=8&r?l:e[++a];if(8&r&&null!==n.attrs){if(!ov(n.attrs,u,t)){if(Li(r))return!1;o=!0}continue}const p=Np(8&r?"class":l,i,xp(n),t);if(-1===p){if(Li(r))return!1;o=!0;continue}if(""!==u){let _;_=p>s?"":i[p+1].toLowerCase();const v=8&r?_:null;if(v&&-1!==Dp(v,u,0)||2&r&&u!==_){if(Li(r))return!1;o=!0}}}}else{if(!o&&!Li(r)&&!Li(l))return!1;if(o&&Li(l))continue;o=!1,r=l|1&r}}return Li(r)||o}function Li(n){return 0==(1&n)}function Np(n,e,t,r){if(null===e)return-1;let i=0;if(r||!t){let s=!1;for(;i<e.length;){const o=e[i];if(o===n)return i;if(3===o||6===o)s=!0;else{if(1===o||2===o){let a=e[++i];for(;"string"==typeof a;)a=e[++i];continue}if(4===o)break;if(0===o){i+=4;continue}}i+=s?1:2}return-1}return function kp(n,e){let t=n.indexOf(4);if(t>-1)for(t++;t<n.length;){const r=n[t];if("number"==typeof r)return-1;if(r===e)return t;t++}return-1}(e,n)}function $u(n,e,t=!1){for(let r=0;r<e.length;r++)if(Pp(n,e[r],t))return!0;return!1}function Td(n,e){return n?":not("+e.trim()+")":e}function Ad(n){let e=n[0],t=1,r=2,i="",s=!1;for(;t<n.length;){let o=n[t];if("string"==typeof o)if(2&r){const a=n[++t];i+="["+o+(a.length>0?'="'+a+'"':"")+"]"}else 8&r?i+="."+o:4&r&&(i+=" "+o);else""!==i&&!Li(o)&&(e+=Td(s,i),i=""),r=o,s=s||!Li(r);t++}return""!==i&&(e+=Td(s,i)),e}function Zr(n){return gs(()=>{const e=Sd(n),t={...e,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===ns.OnPush,directiveDefs:null,pipeDefs:null,dependencies:e.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||Br.Emulated,styles:n.styles||jt,_:null,schemas:n.schemas||null,tView:null,id:""};dv(t);const r=n.dependencies;return t.directiveDefs=ul(r,!1),t.pipeDefs=ul(r,!0),t.id=function Lp(n){let e=0;const t=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const i of t)e=Math.imul(31,e)+i.charCodeAt(0)<<0;return e+=2147483648,"c"+e}(t),t})}function Fp(n){return St(n)||lr(n)}function yT(n){return null!==n}function ei(n){return gs(()=>({type:n.type,bootstrap:n.bootstrap||jt,declarations:n.declarations||jt,imports:n.imports||jt,exports:n.exports||jt,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function bd(n,e){if(null==n)return gi;const t={};for(const r in n)if(n.hasOwnProperty(r)){let i=n[r],s=i;Array.isArray(i)&&(s=i[1],i=i[0]),t[i]=r,e&&(e[i]=s)}return t}function Ye(n){return gs(()=>{const e=Sd(n);return dv(e),e})}function St(n){return n[wd]||null}function lr(n){return n[bp]||null}function Dr(n){return n[Sp]||null}function Vi(n,e){const t=n[Ia]||null;if(!t&&!0===e)throw new Error(`Type ${be(n)} does not have '\u0275mod' property.`);return t}function Sd(n){const e={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:e,inputTransforms:null,inputConfig:n.inputs||gi,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||jt,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:bd(n.inputs,e),outputs:bd(n.outputs)}}function dv(n){n.features?.forEach(e=>e(n))}function ul(n,e){if(!n)return null;const t=e?Dr:Fp;return()=>("function"==typeof n?n():n).map(r=>t(r)).filter(yT)}const Vn=0,Ne=1,at=2,cn=3,ms=4,wa=5,$r=6,cl=7,Un=8,Lo=9,dl=10,tt=11,Hu=12,Dd=13,hl=14,Bn=15,zu=16,Vo=17,Bs=18,Ca=19,hv=20,js=21,uo=22,Ta=23,Wu=24,vt=25,Gu=1,fv=2,ti=7,fl=9,Rr=11;function mi(n){return Array.isArray(n)&&"object"==typeof n[Gu]}function _i(n){return Array.isArray(n)&&!0===n[Gu]}function pv(n){return 0!=(4&n.flags)}function pl(n){return n.componentOffset>-1}function gl(n){return 1==(1&n.flags)}function _s(n){return!!n.template}function Vp(n){return 0!=(512&n[at])}function _l(n,e){return n.hasOwnProperty(lo)?n[lo]:null}let xr=null,Rd=!1;function Hr(n){const e=xr;return xr=n,e}const Iv={version:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{}};function wv(n){if(!ho(n)||n.dirty){if(!n.producerMustRecompute(n)&&!$p(n))return void(n.dirty=!1);n.producerRecomputeValue(n),n.dirty=!1}}function Pd(n){n.dirty=!0,function xd(n){if(void 0===n.liveConsumerNode)return;const e=Rd;Rd=!0;try{for(const t of n.liveConsumerNode)t.dirty||Pd(t)}finally{Rd=e}}(n),n.consumerMarkedDirty?.(n)}function Bp(n){return n&&(n.nextProducerIndex=0),Hr(n)}function jp(n,e){if(Hr(e),n&&void 0!==n.producerNode&&void 0!==n.producerIndexOfThis&&void 0!==n.producerLastReadVersion){if(ho(n))for(let t=n.nextProducerIndex;t<n.producerNode.length;t++)Ju(n.producerNode[t],n.producerIndexOfThis[t]);for(;n.producerNode.length>n.nextProducerIndex;)n.producerNode.pop(),n.producerLastReadVersion.pop(),n.producerIndexOfThis.pop()}}function $p(n){fo(n);for(let e=0;e<n.producerNode.length;e++){const t=n.producerNode[e],r=n.producerLastReadVersion[e];if(r!==t.version||(wv(t),r!==t.version))return!0}return!1}function Cv(n){if(fo(n),ho(n))for(let e=0;e<n.producerNode.length;e++)Ju(n.producerNode[e],n.producerIndexOfThis[e]);n.producerNode.length=n.producerLastReadVersion.length=n.producerIndexOfThis.length=0,n.liveConsumerNode&&(n.liveConsumerNode.length=n.liveConsumerIndexOfThis.length=0)}function Ju(n,e){if(function Tv(n){n.liveConsumerNode??=[],n.liveConsumerIndexOfThis??=[]}(n),fo(n),1===n.liveConsumerNode.length)for(let r=0;r<n.producerNode.length;r++)Ju(n.producerNode[r],n.producerIndexOfThis[r]);const t=n.liveConsumerNode.length-1;if(n.liveConsumerNode[e]=n.liveConsumerNode[t],n.liveConsumerIndexOfThis[e]=n.liveConsumerIndexOfThis[t],n.liveConsumerNode.length--,n.liveConsumerIndexOfThis.length--,e<n.liveConsumerNode.length){const r=n.liveConsumerIndexOfThis[e],i=n.liveConsumerNode[e];fo(i),i.producerIndexOfThis[r]=e}}function ho(n){return n.consumerIsAlwaysLive||(n?.liveConsumerNode?.length??0)>0}function fo(n){n.producerNode??=[],n.producerIndexOfThis??=[],n.producerLastReadVersion??=[]}let Sv=null;const Pv=()=>{},RT=(()=>({...Iv,consumerIsAlwaysLive:!0,consumerAllowSignalWrites:!1,consumerMarkedDirty:n=>{n.schedule(n.ref)},hasRun:!1,cleanupFn:Pv}))();class xT{constructor(e,t,r){this.previousValue=e,this.currentValue=t,this.firstChange=r}isFirstChange(){return this.firstChange}}function Ui(){return Nv}function Nv(n){return n.type.prototype.ngOnChanges&&(n.setInput=NT),PT}function PT(){const n=Mv(this),e=n?.current;if(e){const t=n.previous;if(t===gi)n.previous=e;else for(let r in e)t[r]=e[r];n.current=null,this.ngOnChanges(e)}}function NT(n,e,t,r){const i=this.declaredInputs[t],s=Mv(n)||function Gp(n,e){return n[kd]=e}(n,{previous:gi,current:null}),o=s.current||(s.current={}),a=s.previous,l=a[i];o[i]=new xT(l&&l.currentValue,e,a===gi),n[r]=e}Ui.ngInherit=!0;const kd="__ngSimpleChanges__";function Mv(n){return n[kd]||null}const $s=function(n,e,t){};function tn(n){for(;Array.isArray(n);)n=n[Vn];return n}function yl(n,e){return tn(e[n])}function yi(n,e){return tn(e[n.index])}function Fd(n,e){return n.data[e]}function Bi(n,e){const t=e[n];return mi(t)?t:t[Vn]}function Uo(n,e){return null==e?null:n[e]}function Ov(n){n[Vo]=0}function Jp(n){1024&n[at]||(n[at]|=1024,Ld(n,1))}function Fv(n){1024&n[at]&&(n[at]&=-1025,Ld(n,-1))}function Ld(n,e){let t=n[cn];if(null===t)return;t[wa]+=e;let r=t;for(t=t[cn];null!==t&&(1===e&&1===r[wa]||-1===e&&0===r[wa]);)t[wa]+=e,r=t,t=t[cn]}const Je={lFrame:zv(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Ud(){return Je.bindingsEnabled}function ue(){return Je.lFrame.lView}function Dt(){return Je.lFrame.tView}function ni(n){return Je.lFrame.contextLView=n,n[Un]}function ri(n){return Je.lFrame.contextLView=null,n}function _r(){let n=$v();for(;null!==n&&64===n.type;)n=n.parent;return n}function $v(){return Je.lFrame.currentTNode}function rs(n,e){const t=Je.lFrame;t.currentTNode=n,t.isParent=e}function eg(){return Je.lFrame.isParent}function ba(){return Je.lFrame.bindingIndex++}function Hs(n){const e=Je.lFrame,t=e.bindingIndex;return e.bindingIndex=e.bindingIndex+n,t}function sg(n,e){const t=Je.lFrame;t.bindingIndex=t.bindingRootIndex=n,og(e)}function og(n){Je.lFrame.currentDirectiveIndex=n}function lg(n){Je.lFrame.currentQueryIndex=n}function BT(n){const e=n[Ne];return 2===e.type?e.declTNode:1===e.type?n[$r]:null}function ug(n,e,t){if(t&yt.SkipSelf){let i=e,s=n;for(;!(i=i.parent,null!==i||t&yt.Host||(i=BT(s),null===i||(s=s[hl],10&i.type))););if(null===i)return!1;e=i,n=s}const r=Je.lFrame=tc();return r.currentTNode=e,r.lView=n,!0}function cg(n){const e=tc(),t=n[Ne];Je.lFrame=e,e.currentTNode=t.firstChild,e.lView=n,e.tView=t,e.contextLView=n,e.bindingIndex=t.bindingStartIndex,e.inI18n=!1}function tc(){const n=Je.lFrame,e=null===n?null:n.child;return null===e?zv(n):e}function zv(n){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=e),e}function Wv(){const n=Je.lFrame;return Je.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const Gv=Wv;function dg(){const n=Wv();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function ii(){return Je.lFrame.selectedIndex}function Sa(n){Je.lFrame.selectedIndex=n}function _n(){const n=Je.lFrame;return Fd(n.tView,n.selectedIndex)}let hg=!0;function jd(){return hg}function jo(n){hg=n}function $d(n,e){for(let t=e.directiveStart,r=e.directiveEnd;t<r;t++){const s=n.data[t].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:d}=s;o&&(n.contentHooks??=[]).push(-t,o),a&&((n.contentHooks??=[]).push(t,a),(n.contentCheckHooks??=[]).push(t,a)),l&&(n.viewHooks??=[]).push(-t,l),u&&((n.viewHooks??=[]).push(t,u),(n.viewCheckHooks??=[]).push(t,u)),null!=d&&(n.destroyHooks??=[]).push(t,d)}}function Hd(n,e,t){Kv(n,e,3,t)}function El(n,e,t,r){(3&n[at])===t&&Kv(n,e,t,r)}function nc(n,e){let t=n[at];(3&t)===e&&(t&=8191,t+=1,n[at]=t)}function Kv(n,e,t,r){const s=r??-1,o=e.length-1;let a=0;for(let l=void 0!==r?65535&n[Vo]:0;l<o;l++)if("number"==typeof e[l+1]){if(a=e[l],null!=r&&a>=r)break}else e[l]<0&&(n[Vo]+=65536),(a<s||-1==s)&&(KT(n,t,e,l),n[Vo]=(4294901760&n[Vo])+l+2),l++}function zd(n,e){$s(4,n,e);const t=Hr(null);try{e.call(n)}finally{Hr(t),$s(5,n,e)}}function KT(n,e,t,r){const i=t[r]<0,s=t[r+1],a=n[i?-t[r]:t[r]];i?n[at]>>13<n[Vo]>>16&&(3&n[at])===e&&(n[at]+=8192,zd(a,s)):zd(a,s)}const Da=-1;class Il{constructor(e,t,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=t,this.injectImpl=r}}function pg(n){return n!==Da}function rc(n){return 32767&n}function ic(n,e){let t=function JT(n){return n>>16}(n),r=e;for(;t>0;)r=r[hl],t--;return r}let gg=!0;function sc(n){const e=gg;return gg=n,e}const XT=255,Xv=5;let g=0;const c={};function m(n,e){const t=b(n,e);if(-1!==t)return t;const r=e[Ne];r.firstCreatePass&&(n.injectorIndex=e.length,w(r.data,n),w(e,null),w(r.blueprint,null));const i=L(n,e),s=n.injectorIndex;if(pg(i)){const o=rc(i),a=ic(i,e),l=a[Ne].data;for(let u=0;u<8;u++)e[s+u]=a[o+u]|l[o+u]}return e[s+8]=i,s}function w(n,e){n.push(0,0,0,0,0,0,0,0,e)}function b(n,e){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===e[n.injectorIndex+8]?-1:n.injectorIndex}function L(n,e){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let t=0,r=null,i=e;for(;null!==i;){if(r=eE(i),null===r)return Da;if(t++,i=i[hl],-1!==r.injectorIndex)return r.injectorIndex|t<<16}return Da}function X(n,e,t){!function h(n,e,t){let r;"string"==typeof t?r=t.charCodeAt(0)||0:t.hasOwnProperty(Oo)&&(r=t[Oo]),null==r&&(r=t[Oo]=g++);const i=r&XT;e.data[n+(i>>Xv)]|=1<<i}(n,e,t)}function Me(n,e,t){if(t&yt.Optional||void 0!==n)return n;vp()}function ze(n,e,t,r){if(t&yt.Optional&&void 0===r&&(r=null),!(t&(yt.Self|yt.Host))){const i=n[Lo],s=Ur(void 0);try{return i?i.get(e,r,t&yt.Optional):Jy(e,r,t&yt.Optional)}finally{Ur(s)}}return Me(r,0,t)}function mt(n,e,t,r=yt.Default,i){if(null!==n){if(2048&e[at]&&!(r&yt.Self)){const o=function Ig(n,e,t,r,i){let s=n,o=e;for(;null!==s&&null!==o&&2048&o[at]&&!(512&o[at]);){const a=si(s,o,t,r|yt.Self,c);if(a!==c)return a;let l=s.parent;if(!l){const u=o[hv];if(u){const d=u.get(t,c,r);if(d!==c)return d}l=eE(o),o=o[hl]}s=l}return i}(n,e,t,r,c);if(o!==c)return o}const s=si(n,e,t,r,c);if(s!==c)return s}return ze(e,t,r,i)}function si(n,e,t,r,i){const s=function mg(n){if("string"==typeof n)return n.charCodeAt(0)||0;const e=n.hasOwnProperty(Oo)?n[Oo]:void 0;return"number"==typeof e?e>=0?e&XT:vg:e}(t);if("function"==typeof s){if(!ug(e,n,r))return r&yt.Host?Me(i,0,r):ze(e,t,r,i);try{let o;if(o=s(r),null!=o||r&yt.Optional)return o;vp()}finally{Gv()}}else if("number"==typeof s){let o=null,a=b(n,e),l=Da,u=r&yt.Host?e[Bn][$r]:null;for((-1===a||r&yt.SkipSelf)&&(l=-1===a?L(n,e):e[a+8],l!==Da&&yg(r,!1)?(o=e[Ne],a=rc(l),e=ic(l,e)):a=-1);-1!==a;){const d=e[Ne];if(_g(s,a,d.data)){const p=$o(a,e,t,o,r,u);if(p!==c)return p}l=e[a+8],l!==Da&&yg(r,e[Ne].data[a+8]===u)&&_g(s,a,e)?(o=d,a=rc(l),e=ic(l,e)):a=-1}}return i}function $o(n,e,t,r,i,s){const o=e[Ne],a=o.data[n+8],d=function Ra(n,e,t,r,i){const s=n.providerIndexes,o=e.data,a=1048575&s,l=n.directiveStart,d=s>>20,_=i?a+d:n.directiveEnd;for(let v=r?a:a+d;v<_;v++){const A=o[v];if(v<l&&t===A||v>=l&&A.type===t)return v}if(i){const v=o[l];if(v&&_s(v)&&v.type===t)return l}return null}(a,o,t,null==r?pl(a)&&gg:r!=o&&0!=(3&a.type),i&yt.Host&&s===a);return null!==d?Ho(e,o,d,a):c}function Ho(n,e,t,r){let i=n[t];const s=e.data;if(function fg(n){return n instanceof Il}(i)){const o=i;o.resolving&&function oT(n,e){const t=e?`. Dependency path: ${e.join(" > ")} > ${n}`:"";throw new pe(-200,`Circular dependency in DI detected for ${n}${t}`)}(function Wt(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():it(n)}(s[t]));const a=sc(o.canSeeViewProviders);o.resolving=!0;const u=o.injectImpl?Ur(o.injectImpl):null;ug(n,r,yt.Default);try{i=n[t]=o.factory(void 0,s,n,r),e.firstCreatePass&&t>=r.directiveStart&&function qT(n,e,t){const{ngOnChanges:r,ngOnInit:i,ngDoCheck:s}=e.type.prototype;if(r){const o=Nv(e);(t.preOrderHooks??=[]).push(n,o),(t.preOrderCheckHooks??=[]).push(n,o)}i&&(t.preOrderHooks??=[]).push(0-n,i),s&&((t.preOrderHooks??=[]).push(n,s),(t.preOrderCheckHooks??=[]).push(n,s))}(t,s[t],e)}finally{null!==u&&Ur(u),sc(a),o.resolving=!1,Gv()}}return i}function _g(n,e,t){return!!(t[e+(n>>Xv)]&1<<n)}function yg(n,e){return!(n&yt.Self||n&yt.Host&&e)}class zr{constructor(e,t){this._tNode=e,this._lView=t}get(e,t,r){return mt(this._tNode,this._lView,e,ll(r),t)}}function vg(){return new zr(_r(),ue())}function Cr(n){return gs(()=>{const e=n.prototype.constructor,t=e[lo]||Eg(e),r=Object.prototype;let i=Object.getPrototypeOf(n.prototype).constructor;for(;i&&i!==r;){const s=i[lo]||Eg(i);if(s&&s!==t)return s;i=Object.getPrototypeOf(i)}return s=>new s})}function Eg(n){return md(n)?()=>{const e=Eg(Ze(n));return e&&e()}:_l(n)}function eE(n){const e=n[Ne],t=e.type;return 2===t?e.declTNode:1===t?n[$r]:null}const qd="__parameters__";function Qd(n,e,t){return gs(()=>{const r=function ZT(n){return function(...t){if(n){const r=n(...t);for(const i in r)this[i]=r[i]}}}(e);function i(...s){if(this instanceof i)return r.apply(this,s),this;const o=new i(...s);return a.annotation=o,a;function a(l,u,d){const p=l.hasOwnProperty(qd)?l[qd]:Object.defineProperty(l,qd,{value:[]})[qd];for(;p.length<=d;)p.push(null);return(p[d]=p[d]||[]).push(o),l}}return t&&(i.prototype=Object.create(t.prototype)),i.prototype.ngMetadataName=n,i.annotationCls=i,i})}function Jd(n,e){n.forEach(t=>Array.isArray(t)?Jd(t,e):e(t))}function uk(n,e,t){e>=n.length?n.push(t):n.splice(e,0,t)}function nE(n,e){return e>=n.length-1?n.pop():n.splice(e,1)[0]}function ys(n,e,t){let r=Xd(n,e);return r>=0?n[1|r]=t:(r=~r,function _9(n,e,t,r){let i=n.length;if(i==e)n.push(t,r);else if(1===i)n.push(r,n[0]),n[0]=t;else{for(i--,n.push(n[i-1],n[i]);i>e;)n[i]=n[i-2],i--;n[e]=t,n[e+1]=r}}(n,r,e,t)),r}function eA(n,e){const t=Xd(n,e);if(t>=0)return n[1|t]}function Xd(n,e){return function ck(n,e,t){let r=0,i=n.length>>t;for(;i!==r;){const s=r+(i-r>>1),o=n[s<<t];if(e===o)return s<<t;o>e?i=s:r=s+1}return~(i<<t)}(n,e,1)}const vs=Lu(Qd("Optional"),8),iE=Lu(Qd("SkipSelf"),4);function uE(n){return 128==(128&n.flags)}var wl=function(n){return n[n.Important=1]="Important",n[n.DashCase=2]="DashCase",n}(wl||{});const sA=new Map;let j9=0;const aA="__ngContext__";function vi(n,e){mi(e)?(n[aA]=e[Ca],function H9(n){sA.set(n[Ca],n)}(e)):n[aA]=e}let lA;function uA(n,e){return lA(n,e)}function bg(n){const e=n[cn];return _i(e)?e[cn]:e}function xk(n){return Nk(n[Hu])}function Pk(n){return Nk(n[ms])}function Nk(n){for(;null!==n&&!_i(n);)n=n[ms];return n}function th(n,e,t,r,i){if(null!=r){let s,o=!1;_i(r)?s=r:mi(r)&&(o=!0,r=r[Vn]);const a=tn(r);0===n&&null!==t?null==i?Fk(e,t,a):oc(e,t,a,i||null,!0):1===n&&null!==t?oc(e,t,a,i||null,!0):2===n?function mE(n,e,t){const r=pE(n,e);r&&function l5(n,e,t,r){n.removeChild(e,t,r)}(n,r,e,t)}(e,a,o):3===n&&e.destroyNode(a),null!=s&&function d5(n,e,t,r,i){const s=t[ti];s!==tn(t)&&th(e,n,r,s,i);for(let a=Rr;a<t.length;a++){const l=t[a];Dg(l[Ne],l,n,e,r,s)}}(e,n,s,t,i)}}function hE(n,e,t){return n.createElement(e,t)}function kk(n,e){const t=n[fl],r=t.indexOf(e);Fv(e),t.splice(r,1)}function fE(n,e){if(n.length<=Rr)return;const t=Rr+e,r=n[t];if(r){const i=r[zu];null!==i&&i!==n&&kk(i,r),e>0&&(n[t-1][ms]=r[ms]);const s=nE(n,Rr+e);!function e5(n,e){Dg(n,e,e[tt],2,null,null),e[Vn]=null,e[$r]=null}(r[Ne],r);const o=s[Bs];null!==o&&o.detachView(s[Ne]),r[cn]=null,r[ms]=null,r[at]&=-129}return r}function dA(n,e){if(!(256&e[at])){const t=e[tt];e[Ta]&&Cv(e[Ta]),e[Wu]&&Cv(e[Wu]),t.destroyNode&&Dg(n,e,t,3,null,null),function r5(n){let e=n[Hu];if(!e)return hA(n[Ne],n);for(;e;){let t=null;if(mi(e))t=e[Hu];else{const r=e[Rr];r&&(t=r)}if(!t){for(;e&&!e[ms]&&e!==n;)mi(e)&&hA(e[Ne],e),e=e[cn];null===e&&(e=n),mi(e)&&hA(e[Ne],e),t=e&&e[ms]}e=t}}(e)}}function hA(n,e){if(!(256&e[at])){e[at]&=-129,e[at]|=256,function a5(n,e){let t;if(null!=n&&null!=(t=n.destroyHooks))for(let r=0;r<t.length;r+=2){const i=e[t[r]];if(!(i instanceof Il)){const s=t[r+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const a=i[s[o]],l=s[o+1];$s(4,a,l);try{l.call(a)}finally{$s(5,a,l)}}else{$s(4,i,s);try{s.call(i)}finally{$s(5,i,s)}}}}}(n,e),function o5(n,e){const t=n.cleanup,r=e[cl];if(null!==t)for(let s=0;s<t.length-1;s+=2)if("string"==typeof t[s]){const o=t[s+3];o>=0?r[o]():r[-o].unsubscribe(),s+=2}else t[s].call(r[t[s+1]]);null!==r&&(e[cl]=null);const i=e[js];if(null!==i){e[js]=null;for(let s=0;s<i.length;s++)(0,i[s])()}}(n,e),1===e[Ne].type&&e[tt].destroy();const t=e[zu];if(null!==t&&_i(e[cn])){t!==e[cn]&&kk(t,e);const r=e[Bs];null!==r&&r.detachView(n)}!function z9(n){sA.delete(n[Ca])}(e)}}function fA(n,e,t){return function Ok(n,e,t){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return t[Vn];{const{componentOffset:i}=r;if(i>-1){const{encapsulation:s}=n.data[r.directiveStart+i];if(s===Br.None||s===Br.Emulated)return null}return yi(r,t)}}(n,e.parent,t)}function oc(n,e,t,r,i){n.insertBefore(e,t,r,i)}function Fk(n,e,t){n.appendChild(e,t)}function Lk(n,e,t,r,i){null!==r?oc(n,e,t,r,i):Fk(n,e,t)}function pE(n,e){return n.parentNode(e)}let pA,yA,yE,Bk=function Uk(n,e,t){return 40&n.type?yi(n,t):null};function gE(n,e,t,r){const i=fA(n,r,e),s=e[tt],a=function Vk(n,e,t){return Bk(n,e,t)}(r.parent||e[$r],r,e);if(null!=i)if(Array.isArray(t))for(let l=0;l<t.length;l++)Lk(s,i,t[l],a,!1);else Lk(s,i,t,a,!1);void 0!==pA&&pA(s,r,e,t,i)}function Sg(n,e){if(null!==e){const t=e.type;if(3&t)return yi(e,n);if(4&t)return gA(-1,n[e.index]);if(8&t){const r=e.child;if(null!==r)return Sg(n,r);{const i=n[e.index];return _i(i)?gA(-1,i):tn(i)}}if(32&t)return uA(e,n)()||tn(n[e.index]);{const r=$k(n,e);return null!==r?Array.isArray(r)?r[0]:Sg(bg(n[Bn]),r):Sg(n,e.next)}}return null}function $k(n,e){return null!==e?n[Bn][$r].projection[e.projection]:null}function gA(n,e){const t=Rr+n+1;if(t<e.length){const r=e[t],i=r[Ne].firstChild;if(null!==i)return Sg(r,i)}return e[ti]}function mA(n,e,t,r,i,s,o){for(;null!=t;){const a=r[t.index],l=t.type;if(o&&0===e&&(a&&vi(tn(a),r),t.flags|=2),32!=(32&t.flags))if(8&l)mA(n,e,t.child,r,i,s,!1),th(e,n,i,a,s);else if(32&l){const u=uA(t,r);let d;for(;d=u();)th(e,n,i,d,s);th(e,n,i,a,s)}else 16&l?zk(n,e,r,t,i,s):th(e,n,i,a,s);t=o?t.projectionNext:t.next}}function Dg(n,e,t,r,i,s){mA(t,r,n.firstChild,e,i,s,!1)}function zk(n,e,t,r,i,s){const o=t[Bn],l=o[$r].projection[r.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++)th(e,n,i,l[u],s);else{let u=l;const d=o[cn];uE(r)&&(u.flags|=128),mA(n,e,u,d,i,s,!0)}}function Wk(n,e,t){""===t?n.removeAttribute(e,"class"):n.setAttribute(e,"class",t)}function Gk(n,e,t){const{mergedAttrs:r,classes:i,styles:s}=t;null!==r&&Uu(n,e,r),null!==i&&Wk(n,e,i),null!==s&&function f5(n,e,t){n.setAttribute(e,"style",t)}(n,e,s)}function Qk(n){return function vA(){if(void 0===yE&&(yE=null,un.trustedTypes))try{yE=un.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return yE}()?.createScriptURL(n)||n}class Yk{constructor(e){this.changingThisBreaksApplicationSecurity=e}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${zy})`}}function Cl(n){return n instanceof Yk?n.changingThisBreaksApplicationSecurity:n}function Rg(n,e){const t=function C5(n){return n instanceof Yk&&n.getTypeName()||null}(n);if(null!=t&&t!==e){if("ResourceURL"===t&&"URL"===e)return!0;throw new Error(`Required a safe ${e}, got a ${t} (see ${zy})`)}return t===e}const S5=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var ih=function(n){return n[n.NONE=0]="NONE",n[n.HTML=1]="HTML",n[n.STYLE=2]="STYLE",n[n.SCRIPT=3]="SCRIPT",n[n.URL=4]="URL",n[n.RESOURCE_URL=5]="RESOURCE_URL",n}(ih||{});function Tl(n){const e=Pg();return e?e.sanitize(ih.URL,n)||"":Rg(n,"URL")?Cl(n):function EA(n){return(n=String(n)).match(S5)?n:"unsafe:"+n}(it(n))}function rO(n){const e=Pg();if(e)return Qk(e.sanitize(ih.RESOURCE_URL,n)||"");if(Rg(n,"ResourceURL"))return Qk(Cl(n));throw new pe(904,!1)}function Pg(){const n=ue();return n&&n[dl].sanitizer}const Ng=new we("ENVIRONMENT_INITIALIZER"),sO=new we("INJECTOR",-1),oO=new we("INJECTOR_DEF_TYPES");class TA{get(e,t=va){if(t===va){const r=new Error(`NullInjectorError: No provider for ${be(e)}!`);throw r.name="NullInjectorError",r}return t}}function EE(n){return{\u0275providers:n}}function B5(...n){return{\u0275providers:aO(0,n),\u0275fromNgModule:!0}}function aO(n,...e){const t=[],r=new Set;let i;const s=o=>{t.push(o)};return Jd(e,o=>{const a=o;IE(a,s,[],r)&&(i||=[],i.push(a))}),void 0!==i&&lO(i,s),t}function lO(n,e){for(let t=0;t<n.length;t++){const{ngModule:r,providers:i}=n[t];AA(i,s=>{e(s,r)})}}function IE(n,e,t,r){if(!(n=Ze(n)))return!1;let i=null,s=Nu(n);const o=!s&&St(n);if(s||o){if(o&&!o.standalone)return!1;i=n}else{const l=n.ngModule;if(s=Nu(l),!s)return!1;i=l}const a=r.has(i);if(o){if(a)return!1;if(r.add(i),o.dependencies){const l="function"==typeof o.dependencies?o.dependencies():o.dependencies;for(const u of l)IE(u,e,t,r)}}else{if(!s)return!1;{if(null!=s.imports&&!a){let u;r.add(i);try{Jd(s.imports,d=>{IE(d,e,t,r)&&(u||=[],u.push(d))})}finally{}void 0!==u&&lO(u,e)}if(!a){const u=_l(i)||(()=>new i);e({provide:i,useFactory:u,deps:jt},i),e({provide:oO,useValue:i,multi:!0},i),e({provide:Ng,useValue:()=>Ee(i),multi:!0},i)}const l=s.providers;if(null!=l&&!a){const u=n;AA(l,d=>{e(d,u)})}}}return i!==n&&void 0!==n.providers}function AA(n,e){for(let t of n)_d(t)&&(t=t.\u0275providers),Array.isArray(t)?AA(t,e):e(t)}const j5=Ve({provide:String,useValue:Ve});function bA(n){return null!==n&&"object"==typeof n&&j5 in n}function ac(n){return"function"==typeof n}const SA=new we("Set Injector scope."),wE={},H5={};let DA;function CE(){return void 0===DA&&(DA=new TA),DA}class Es{}class sh extends Es{get destroyed(){return this._destroyed}constructor(e,t,r,i){super(),this.parent=t,this.source=r,this.scopes=i,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,xA(e,o=>this.processProvider(o)),this.records.set(sO,oh(void 0,this)),i.has("environment")&&this.records.set(Es,oh(void 0,this));const s=this.records.get(SA);null!=s&&"string"==typeof s.value&&this.scopes.add(s.value),this.injectorDefTypes=new Set(this.get(oO.multi,jt,yt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const t of this._ngOnDestroyHooks)t.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const t of e)t()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(e){return this.assertNotDestroyed(),this._onDestroyHooks.push(e),()=>this.removeOnDestroy(e)}runInContext(e){this.assertNotDestroyed();const t=Us(this),r=Ur(void 0);try{return e()}finally{Us(t),Ur(r)}}get(e,t=va,r=yt.Default){if(this.assertNotDestroyed(),e.hasOwnProperty(sv))return e[sv](this);r=ll(r);const s=Us(this),o=Ur(void 0);try{if(!(r&yt.SkipSelf)){let l=this.records.get(e);if(void 0===l){const u=function K5(n){return"function"==typeof n||"object"==typeof n&&n instanceof we}(e)&&Ed(e);l=u&&this.injectableDefInScope(u)?oh(RA(e),wE):null,this.records.set(e,l)}if(null!=l)return this.hydrate(e,l)}return(r&yt.Self?CE():this.parent).get(e,t=r&yt.Optional&&t===va?null:t)}catch(a){if("NullInjectorError"===a.name){if((a[ts]=a[ts]||[]).unshift(be(e)),s)throw a;return function Vu(n,e,t,r){const i=n[ts];throw e[rv]&&i.unshift(e[rv]),n.message=function H1(n,e,t,r=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let i=be(e);if(Array.isArray(e))i=e.map(be).join(" -> ");else if("object"==typeof e){let s=[];for(let o in e)if(e.hasOwnProperty(o)){let a=e[o];s.push(o+":"+("string"==typeof a?JSON.stringify(a):be(a)))}i=`{${s.join(", ")}}`}return`${t}${r?"("+r+")":""}[${i}]: ${n.replace(fT,"\n  ")}`}("\n"+n.message,i,t,r),n.ngTokenPath=i,n[ts]=null,n}(a,e,"R3InjectorError",this.source)}throw a}finally{Ur(o),Us(s)}}resolveInjectorInitializers(){const e=Us(this),t=Ur(void 0);try{const i=this.get(Ng.multi,jt,yt.Self);for(const s of i)s()}finally{Us(e),Ur(t)}}toString(){const e=[],t=this.records;for(const r of t.keys())e.push(be(r));return`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new pe(205,!1)}processProvider(e){let t=ac(e=Ze(e))?e:Ze(e&&e.provide);const r=function W5(n){return bA(n)?oh(void 0,n.useValue):oh(dO(n),wE)}(e);if(ac(e)||!0!==e.multi)this.records.get(t);else{let i=this.records.get(t);i||(i=oh(void 0,wE,!0),i.factory=()=>ao(i.multi),this.records.set(t,i)),t=e,i.multi.push(e)}this.records.set(t,r)}hydrate(e,t){return t.value===wE&&(t.value=H5,t.value=t.factory()),"object"==typeof t.value&&t.value&&function q5(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(t.value)&&this._ngOnDestroyHooks.add(t.value),t.value}injectableDefInScope(e){if(!e.providedIn)return!1;const t=Ze(e.providedIn);return"string"==typeof t?"any"===t||this.scopes.has(t):this.injectorDefTypes.has(t)}removeOnDestroy(e){const t=this._onDestroyHooks.indexOf(e);-1!==t&&this._onDestroyHooks.splice(t,1)}}function RA(n){const e=Ed(n),t=null!==e?e.factory:_l(n);if(null!==t)return t;if(n instanceof we)throw new pe(204,!1);if(n instanceof Function)return function z5(n){const e=n.length;if(e>0)throw function Cg(n,e){const t=[];for(let r=0;r<n;r++)t.push(e);return t}(e,"?"),new pe(204,!1);const t=function dT(n){return n&&(n[Id]||n[Ip])||null}(n);return null!==t?()=>t.factory(n):()=>new n}(n);throw new pe(204,!1)}function dO(n,e,t){let r;if(ac(n)){const i=Ze(n);return _l(i)||RA(i)}if(bA(n))r=()=>Ze(n.useValue);else if(function cO(n){return!(!n||!n.useFactory)}(n))r=()=>n.useFactory(...ao(n.deps||[]));else if(function uO(n){return!(!n||!n.useExisting)}(n))r=()=>Ee(Ze(n.useExisting));else{const i=Ze(n&&(n.useClass||n.provide));if(!function G5(n){return!!n.deps}(n))return _l(i)||RA(i);r=()=>new i(...ao(n.deps))}return r}function oh(n,e,t=!1){return{factory:n,value:e,multi:t?[]:void 0}}function xA(n,e){for(const t of n)Array.isArray(t)?xA(t,e):t&&_d(t)?xA(t.\u0275providers,e):e(t)}const TE=new we("AppId",{providedIn:"root",factory:()=>Q5}),Q5="ng",hO=new we("Platform Initializer"),zo=new we("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),fO=new we("CSP nonce",{providedIn:"root",factory:()=>function rh(){if(void 0!==yA)return yA;if(typeof document<"u")return document;throw new pe(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let pO=(n,e,t)=>null;function VA(n,e,t=!1){return pO(n,e,t)}class s8{}class _O{}class a8{resolveComponentFactory(e){throw function o8(n){const e=Error(`No component factory found for ${be(n)}.`);return e.ngComponent=n,e}(e)}}let xE=(()=>{class n{static{this.NULL=new a8}}return n})();function l8(){return uh(_r(),ue())}function uh(n,e){return new Is(yi(n,e))}let Is=(()=>{class n{constructor(t){this.nativeElement=t}static{this.__NG_ELEMENT_ID__=l8}}return n})();class vO{}let Na=(()=>{class n{constructor(){this.destroyNode=null}static{this.__NG_ELEMENT_ID__=()=>function c8(){const n=ue(),t=Bi(_r().index,n);return(mi(t)?t:n)[tt]}()}}return n})(),d8=(()=>{class n{static{this.\u0275prov=Be({token:n,providedIn:"root",factory:()=>null})}}return n})();class ch{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const EO=new ch("16.2.12"),jA={};function TO(n,e=null,t=null,r){const i=AO(n,e,t,r);return i.resolveInjectorInitializers(),i}function AO(n,e=null,t=null,r,i=new Set){const s=[t||jt,B5(n)];return r=r||("object"==typeof n?void 0:be(n)),new sh(s,e||CE(),r||null,i)}let ss=(()=>{class n{static{this.THROW_IF_NOT_FOUND=va}static{this.NULL=new TA}static create(t,r){if(Array.isArray(t))return TO({name:""},r,t,"");{const i=t.name??"";return TO({name:i},t.parent,t.providers,i)}}static{this.\u0275prov=Be({token:n,providedIn:"any",factory:()=>Ee(sO)})}static{this.__NG_ELEMENT_ID__=-1}}return n})();function HA(n){return n.ngOriginalError}class Ma{constructor(){this._console=console}handleError(e){const t=this._findOriginalError(e);this._console.error("ERROR",e),t&&this._console.error("ORIGINAL ERROR",t)}_findOriginalError(e){let t=e&&HA(e);for(;t&&HA(t);)t=HA(t);return t||null}}function zA(n){return e=>{setTimeout(n,void 0,e)}}const ur=class v8 extends W{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,t,r){let i=e,s=t||(()=>null),o=r;if(e&&"object"==typeof e){const l=e;i=l.next?.bind(l),s=l.error?.bind(l),o=l.complete?.bind(l)}this.__isAsync&&(s=zA(s),i&&(i=zA(i)),o&&(o=zA(o)));const a=super.subscribe({next:i,error:s,complete:o});return e instanceof Nt&&e.add(a),a}};function SO(...n){}class Xt{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:t=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new ur(!1),this.onMicrotaskEmpty=new ur(!1),this.onStable=new ur(!1),this.onError=new ur(!1),typeof Zone>"u")throw new pe(908,!1);Zone.assertZonePatched();const i=this;i._nesting=0,i._outer=i._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(i._inner=i._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(i._inner=i._inner.fork(Zone.longStackTraceZoneSpec)),i.shouldCoalesceEventChangeDetection=!r&&t,i.shouldCoalesceRunChangeDetection=r,i.lastRequestAnimationFrameId=-1,i.nativeRequestAnimationFrame=function E8(){const n="function"==typeof un.requestAnimationFrame;let e=un[n?"requestAnimationFrame":"setTimeout"],t=un[n?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&e&&t){const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r);const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,function C8(n){const e=()=>{!function w8(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(un,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,GA(n),n.isCheckStableRunning=!0,WA(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),GA(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(t,r,i,s,o,a)=>{if(function A8(n){return!(!Array.isArray(n)||1!==n.length)&&!0===n[0].data?.__ignore_ng_zone__}(a))return t.invokeTask(i,s,o,a);try{return DO(n),t.invokeTask(i,s,o,a)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||n.shouldCoalesceRunChangeDetection)&&e(),RO(n)}},onInvoke:(t,r,i,s,o,a,l)=>{try{return DO(n),t.invoke(i,s,o,a,l)}finally{n.shouldCoalesceRunChangeDetection&&e(),RO(n)}},onHasTask:(t,r,i,s)=>{t.hasTask(i,s),r===i&&("microTask"==s.change?(n._hasPendingMicrotasks=s.microTask,GA(n),WA(n)):"macroTask"==s.change&&(n.hasPendingMacrotasks=s.macroTask))},onHandleError:(t,r,i,s)=>(t.handleError(i,s),n.runOutsideAngular(()=>n.onError.emit(s)),!1)})}(i)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Xt.isInAngularZone())throw new pe(909,!1)}static assertNotInAngularZone(){if(Xt.isInAngularZone())throw new pe(909,!1)}run(e,t,r){return this._inner.run(e,t,r)}runTask(e,t,r,i){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+i,e,I8,SO,SO);try{return s.runTask(o,t,r)}finally{s.cancelTask(o)}}runGuarded(e,t,r){return this._inner.runGuarded(e,t,r)}runOutsideAngular(e){return this._outer.run(e)}}const I8={};function WA(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function GA(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function DO(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function RO(n){n._nesting--,WA(n)}class T8{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new ur,this.onMicrotaskEmpty=new ur,this.onStable=new ur,this.onError=new ur}run(e,t,r){return e.apply(t,r)}runGuarded(e,t,r){return e.apply(t,r)}runOutsideAngular(e){return e()}runTask(e,t,r,i){return e.apply(t,r)}}const xO=new we("",{providedIn:"root",factory:PO});function PO(){const n=ke(Xt);let e=!0;return E(new lt(i=>{e=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{i.next(e),i.complete()})}),new lt(i=>{let s;n.runOutsideAngular(()=>{s=n.onStable.subscribe(()=>{Xt.assertNotInAngularZone(),queueMicrotask(()=>{!e&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(e=!0,i.next(!0))})})});const o=n.onUnstable.subscribe(()=>{Xt.assertInAngularZone(),e&&(e=!1,n.runOutsideAngular(()=>{i.next(!1)}))});return()=>{s.unsubscribe(),o.unsubscribe()}}).pipe(k()))}function ka(n){return n instanceof Function?n():n}let qA=(()=>{class n{constructor(){this.renderDepth=0,this.handler=null}begin(){this.handler?.validateBegin(),this.renderDepth++}end(){this.renderDepth--,0===this.renderDepth&&this.handler?.execute()}ngOnDestroy(){this.handler?.destroy(),this.handler=null}static{this.\u0275prov=Be({token:n,providedIn:"root",factory:()=>new n})}}return n})();function Og(n){for(;n;){n[at]|=64;const e=bg(n);if(Vp(n)&&!e)return n;n=e}return null}const FO=new we("",{providedIn:"root",factory:()=>!1});let ME=null;function BO(n,e){return n[e]??HO()}function jO(n,e){const t=HO();t.producerNode?.length&&(n[e]=ME,t.lView=n,ME=$O())}const O8={...Iv,consumerIsAlwaysLive:!0,consumerMarkedDirty:n=>{Og(n.lView)},lView:null};function $O(){return Object.create(O8)}function HO(){return ME??=$O(),ME}const ut={};function Bt(n){zO(Dt(),ue(),ii()+n,!1)}function zO(n,e,t,r){if(!r)if(3==(3&e[at])){const s=n.preOrderCheckHooks;null!==s&&Hd(e,s,t)}else{const s=n.preOrderHooks;null!==s&&El(e,s,0,t)}Sa(t)}function _e(n,e=yt.Default){const t=ue();return null===t?Ee(n,e):mt(_r(),t,Ze(n),e)}function kE(n,e,t,r,i,s,o,a,l,u,d){const p=e.blueprint.slice();return p[Vn]=i,p[at]=140|r,(null!==u||n&&2048&n[at])&&(p[at]|=2048),Ov(p),p[cn]=p[hl]=n,p[Un]=t,p[dl]=o||n&&n[dl],p[tt]=a||n&&n[tt],p[Lo]=l||n&&n[Lo]||null,p[$r]=s,p[Ca]=function $9(){return j9++}(),p[uo]=d,p[hv]=u,p[Bn]=2==e.type?n[Bn]:p,p}function fh(n,e,t,r,i){let s=n.data[e];if(null===s)s=function KA(n,e,t,r,i){const s=$v(),o=eg(),l=n.data[e]=function H8(n,e,t,r,i,s){let o=e?e.injectorIndex:-1,a=0;return function Bo(){return null!==Je.skipHydrationRootTNode}()&&(a|=128),{type:t,index:r,insertBeforeIndex:null,injectorIndex:o,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:i,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,t,e,r,i);return null===n.firstChild&&(n.firstChild=l),null!==s&&(o?null==s.child&&null!==l.parent&&(s.child=l):null===s.next&&(s.next=l,l.prev=s)),l}(n,e,t,r,i),function VT(){return Je.lFrame.inI18n}()&&(s.flags|=32);else if(64&s.type){s.type=t,s.value=r,s.attrs=i;const o=function Zu(){const n=Je.lFrame,e=n.currentTNode;return n.isParent?e:e.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return rs(s,!0),s}function Fg(n,e,t,r){if(0===t)return-1;const i=e.length;for(let s=0;s<t;s++)e.push(r),n.blueprint.push(r),n.data.push(null);return i}function GO(n,e,t,r,i){const s=BO(e,Ta),o=ii(),a=2&r;try{Sa(-1),a&&e.length>vt&&zO(n,e,vt,!1),$s(a?2:0,i);const u=a?s:null,d=Bp(u);try{null!==u&&(u.dirty=!1),t(r,i)}finally{jp(u,d)}}finally{a&&null===e[Ta]&&jO(e,Ta),Sa(o),$s(a?3:1,i)}}function QA(n,e,t){if(pv(e)){const r=Hr(null);try{const s=e.directiveEnd;for(let o=e.directiveStart;o<s;o++){const a=n.data[o];a.contentQueries&&a.contentQueries(1,t[o],o)}}finally{Hr(r)}}}function YA(n,e,t){Ud()&&(function Y8(n,e,t,r){const i=t.directiveStart,s=t.directiveEnd;pl(t)&&function rK(n,e,t){const r=yi(e,n),i=qO(t);let o=16;t.signals?o=4096:t.onPush&&(o=64);const a=OE(n,kE(n,i,null,o,r,e,null,n[dl].rendererFactory.createRenderer(r,t),null,null,null));n[e.index]=a}(e,t,n.data[i+t.componentOffset]),n.firstCreatePass||m(t,e),vi(r,e);const o=t.initialInputs;for(let a=i;a<s;a++){const l=n.data[a],u=Ho(e,n,a,t);vi(u,e),null!==o&&iK(0,a-i,u,l,0,o),_s(l)&&(Bi(t.index,e)[Un]=Ho(e,n,a,t))}}(n,e,t,yi(t,e)),64==(64&t.flags)&&XO(n,e,t))}function JA(n,e,t=yi){const r=e.localNames;if(null!==r){let i=e.index+1;for(let s=0;s<r.length;s+=2){const o=r[s+1],a=-1===o?t(e,n):n[o];n[i++]=a}}}function qO(n){const e=n.tView;return null===e||e.incompleteFirstPass?n.tView=XA(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):e}function XA(n,e,t,r,i,s,o,a,l,u,d){const p=vt+r,_=p+i,v=function L8(n,e){const t=[];for(let r=0;r<e;r++)t.push(r<n?null:ut);return t}(p,_),A="function"==typeof u?u():u;return v[Ne]={type:n,blueprint:v,template:t,queries:null,viewQuery:a,declTNode:e,data:v.slice().fill(null,p),bindingStartIndex:p,expandoStartIndex:_,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:A,incompleteFirstPass:!1,ssrId:d}}let KO=n=>null;function QO(n,e,t,r){for(let i in n)if(n.hasOwnProperty(i)){t=null===t?{}:t;const s=n[i];null===r?YO(t,e,i,s):r.hasOwnProperty(i)&&YO(t,e,r[i],s)}return t}function YO(n,e,t,r){n.hasOwnProperty(t)?n[t].push(e,r):n[t]=[e,r]}function ws(n,e,t,r,i,s,o,a){const l=yi(e,t);let d,u=e.inputs;!a&&null!=u&&(d=u[r])?(rb(n,t,d,r,i),pl(e)&&function G8(n,e){const t=Bi(e,n);16&t[at]||(t[at]|=64)}(t,e.index)):3&e.type&&(r=function W8(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(r),i=null!=o?o(i,e.value||"",r):i,s.setProperty(l,r,i))}function ZA(n,e,t,r){if(Ud()){const i=null===r?null:{"":-1},s=function X8(n,e){const t=n.directiveRegistry;let r=null,i=null;if(t)for(let s=0;s<t.length;s++){const o=t[s];if($u(e,o.selectors,!1))if(r||(r=[]),_s(o))if(null!==o.findHostDirectiveDefs){const a=[];i=i||new Map,o.findHostDirectiveDefs(o,a,i),r.unshift(...a,o),eb(n,e,a.length)}else r.unshift(o),eb(n,e,0);else i=i||new Map,o.findHostDirectiveDefs?.(o,r,i),r.push(o)}return null===r?null:[r,i]}(n,t);let o,a;null===s?o=a=null:[o,a]=s,null!==o&&JO(n,e,t,o,i,a),i&&function Z8(n,e,t){if(e){const r=n.localNames=[];for(let i=0;i<e.length;i+=2){const s=t[e[i+1]];if(null==s)throw new pe(-301,!1);r.push(e[i],s)}}}(t,r,i)}t.mergedAttrs=Bu(t.mergedAttrs,t.attrs)}function JO(n,e,t,r,i,s){for(let u=0;u<r.length;u++)X(m(t,e),n,r[u].type);!function tK(n,e,t){n.flags|=1,n.directiveStart=e,n.directiveEnd=e+t,n.providerIndexes=e}(t,n.data.length,r.length);for(let u=0;u<r.length;u++){const d=r[u];d.providersResolver&&d.providersResolver(d)}let o=!1,a=!1,l=Fg(n,e,r.length,null);for(let u=0;u<r.length;u++){const d=r[u];t.mergedAttrs=Bu(t.mergedAttrs,d.hostAttrs),nK(n,t,e,l,d),eK(l,d,i),null!==d.contentQueries&&(t.flags|=4),(null!==d.hostBindings||null!==d.hostAttrs||0!==d.hostVars)&&(t.flags|=64);const p=d.type.prototype;!o&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((n.preOrderHooks??=[]).push(t.index),o=!0),!a&&(p.ngOnChanges||p.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(t.index),a=!0),l++}!function z8(n,e,t){const i=e.directiveEnd,s=n.data,o=e.attrs,a=[];let l=null,u=null;for(let d=e.directiveStart;d<i;d++){const p=s[d],_=t?t.get(p):null,A=_?_.outputs:null;l=QO(p.inputs,d,l,_?_.inputs:null),u=QO(p.outputs,d,u,A);const D=null===l||null===o||xp(e)?null:sK(l,d,o);a.push(D)}null!==l&&(l.hasOwnProperty("class")&&(e.flags|=8),l.hasOwnProperty("style")&&(e.flags|=16)),e.initialInputs=a,e.inputs=l,e.outputs=u}(n,t,s)}function XO(n,e,t){const r=t.directiveStart,i=t.directiveEnd,s=t.index,o=function UT(){return Je.lFrame.currentDirectiveIndex}();try{Sa(s);for(let a=r;a<i;a++){const l=n.data[a],u=e[a];og(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&J8(l,u)}}finally{Sa(-1),og(o)}}function J8(n,e){null!==n.hostBindings&&n.hostBindings(1,e)}function eb(n,e,t){e.componentOffset=t,(n.components??=[]).push(e.index)}function eK(n,e,t){if(t){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)t[e.exportAs[r]]=n;_s(e)&&(t[""]=n)}}function nK(n,e,t,r,i){n.data[r]=i;const s=i.factory||(i.factory=_l(i.type)),o=new Il(s,_s(i),_e);n.blueprint[r]=o,t[r]=o,function K8(n,e,t,r,i){const s=i.hostBindings;if(s){let o=n.hostBindingOpCodes;null===o&&(o=n.hostBindingOpCodes=[]);const a=~e.index;(function Q8(n){let e=n.length;for(;e>0;){const t=n[--e];if("number"==typeof t&&t<0)return t}return 0})(o)!=a&&o.push(a),o.push(t,r,s)}}(n,e,r,Fg(n,t,i.hostVars,ut),i)}function Wo(n,e,t,r,i,s){const o=yi(n,e);!function tb(n,e,t,r,i,s,o){if(null==s)n.removeAttribute(e,i,t);else{const a=null==o?it(s):o(s,r||"",i);n.setAttribute(e,i,a,t)}}(e[tt],o,s,n.value,t,r,i)}function iK(n,e,t,r,i,s){const o=s[e];if(null!==o)for(let a=0;a<o.length;)ZO(r,t,o[a++],o[a++],o[a++])}function ZO(n,e,t,r,i){const s=Hr(null);try{const o=n.inputTransforms;null!==o&&o.hasOwnProperty(r)&&(i=o[r].call(e,i)),null!==n.setInput?n.setInput(e,i,t,r):e[r]=i}finally{Hr(s)}}function sK(n,e,t){let r=null,i=0;for(;i<t.length;){const s=t[i];if(0!==s)if(5!==s){if("number"==typeof s)break;if(n.hasOwnProperty(s)){null===r&&(r=[]);const o=n[s];for(let a=0;a<o.length;a+=2)if(o[a]===e){r.push(s,o[a+1],t[i+1]);break}}i+=2}else i+=2;else i+=4}return r}function eF(n,e,t,r){return[n,!0,!1,e,null,0,r,t,null,null,null]}function tF(n,e){const t=n.contentQueries;if(null!==t)for(let r=0;r<t.length;r+=2){const s=t[r+1];if(-1!==s){const o=n.data[s];lg(t[r]),o.contentQueries(2,e[s],s)}}}function OE(n,e){return n[Hu]?n[Dd][ms]=e:n[Hu]=e,n[Dd]=e,e}function nb(n,e,t){lg(0);const r=Hr(null);try{e(n,t)}finally{Hr(r)}}function sF(n,e){const t=n[Lo],r=t?t.get(Ma,null):null;r&&r.handleError(e)}function rb(n,e,t,r,i){for(let s=0;s<t.length;){const o=t[s++],a=t[s++];ZO(n.data[o],e[o],r,a,i)}}function Oa(n,e,t){const r=yl(e,n);!function Mk(n,e,t){n.setValue(e,t)}(n[tt],r,t)}function oK(n,e){const t=Bi(e,n),r=t[Ne];!function aK(n,e){for(let t=e.length;t<n.blueprint.length;t++)e.push(n.blueprint[t])}(r,t);const i=t[Vn];null!==i&&null===t[uo]&&(t[uo]=VA(i,t[Lo])),ib(r,t,t[Un])}function ib(n,e,t){cg(e);try{const r=n.viewQuery;null!==r&&nb(1,r,t);const i=n.template;null!==i&&GO(n,e,i,1,t),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&tF(n,e),n.staticViewQueries&&nb(2,n.viewQuery,t);const s=n.components;null!==s&&function lK(n,e){for(let t=0;t<e.length;t++)oK(n,e[t])}(e,s)}catch(r){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),r}finally{e[at]&=-5,dg()}}let oF=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(t,r,i){const s=typeof Zone>"u"?null:Zone.current,o=function Wp(n,e,t){const r=Object.create(RT);t&&(r.consumerAllowSignalWrites=!0),r.fn=n,r.schedule=e;const i=o=>{r.cleanupFn=o};return r.ref={notify:()=>Pd(r),run:()=>{if(r.dirty=!1,r.hasRun&&!$p(r))return;r.hasRun=!0;const o=Bp(r);try{r.cleanupFn(),r.cleanupFn=Pv,r.fn(i)}finally{jp(r,o)}},cleanup:()=>r.cleanupFn()},r.ref}(t,u=>{this.all.has(u)&&this.queue.set(u,s)},i);let a;this.all.add(o),o.notify();const l=()=>{o.cleanup(),a?.(),this.all.delete(o),this.queue.delete(o)};return a=r?.onDestroy(l),{destroy:l}}flush(){if(0!==this.queue.size)for(const[t,r]of this.queue)this.queue.delete(t),r?r.run(()=>t.run()):t.run()}get isQueueEmpty(){return 0===this.queue.size}static{this.\u0275prov=Be({token:n,providedIn:"root",factory:()=>new n})}}return n})();function FE(n,e,t){let r=t?n.styles:null,i=t?n.classes:null,s=0;if(null!==e)for(let o=0;o<e.length;o++){const a=e[o];"number"==typeof a?s=a:1==s?i=Fn(i,a):2==s&&(r=Fn(r,a+": "+e[++o]+";"))}t?n.styles=r:n.stylesWithoutHost=r,t?n.classes=i:n.classesWithoutHost=i}function Lg(n,e,t,r,i=!1){for(;null!==t;){const s=e[t.index];null!==s&&r.push(tn(s)),_i(s)&&aF(s,r);const o=t.type;if(8&o)Lg(n,e,t.child,r);else if(32&o){const a=uA(t,e);let l;for(;l=a();)r.push(l)}else if(16&o){const a=$k(e,t);if(Array.isArray(a))r.push(...a);else{const l=bg(e[Bn]);Lg(l[Ne],l,a,r,!0)}}t=i?t.projectionNext:t.next}return r}function aF(n,e){for(let t=Rr;t<n.length;t++){const r=n[t],i=r[Ne].firstChild;null!==i&&Lg(r[Ne],r,i,e)}n[ti]!==n[Vn]&&e.push(n[ti])}function LE(n,e,t,r=!0){const i=e[dl],s=i.rendererFactory,o=i.afterRenderEventManager;s.begin?.(),o?.begin();try{lF(n,e,n.template,t)}catch(l){throw r&&sF(e,l),l}finally{s.end?.(),i.effectManager?.flush(),o?.end()}}function lF(n,e,t,r){const i=e[at];if(256!=(256&i)){e[dl].effectManager?.flush(),cg(e);try{Ov(e),function rg(n){return Je.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==t&&GO(n,e,t,2,r);const o=3==(3&i);if(o){const u=n.preOrderCheckHooks;null!==u&&Hd(e,u,null)}else{const u=n.preOrderHooks;null!==u&&El(e,u,0,null),nc(e,0)}if(function dK(n){for(let e=xk(n);null!==e;e=Pk(e)){if(!e[fv])continue;const t=e[fl];for(let r=0;r<t.length;r++){Jp(t[r])}}}(e),uF(e,2),null!==n.contentQueries&&tF(n,e),o){const u=n.contentCheckHooks;null!==u&&Hd(e,u)}else{const u=n.contentHooks;null!==u&&El(e,u,1),nc(e,1)}!function F8(n,e){const t=n.hostBindingOpCodes;if(null===t)return;const r=BO(e,Wu);try{for(let i=0;i<t.length;i++){const s=t[i];if(s<0)Sa(~s);else{const o=s,a=t[++i],l=t[++i];sg(a,o),r.dirty=!1;const u=Bp(r);try{l(2,e[o])}finally{jp(r,u)}}}}finally{null===e[Wu]&&jO(e,Wu),Sa(-1)}}(n,e);const a=n.components;null!==a&&dF(e,a,0);const l=n.viewQuery;if(null!==l&&nb(2,l,r),o){const u=n.viewCheckHooks;null!==u&&Hd(e,u)}else{const u=n.viewHooks;null!==u&&El(e,u,2),nc(e,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),e[at]&=-73,Fv(e)}finally{dg()}}}function uF(n,e){for(let t=xk(n);null!==t;t=Pk(t))for(let r=Rr;r<t.length;r++)cF(t[r],e)}function hK(n,e,t){cF(Bi(e,n),t)}function cF(n,e){if(!function Yp(n){return 128==(128&n[at])}(n))return;const t=n[Ne],r=n[at];if(80&r&&0===e||1024&r||2===e)lF(t,n,t.template,n[Un]);else if(n[wa]>0){uF(n,1);const i=t.components;null!==i&&dF(n,i,1)}}function dF(n,e,t){for(let r=0;r<e.length;r++)hK(n,e[r],t)}class Vg{get rootNodes(){const e=this._lView,t=e[Ne];return Lg(t,e,t.firstChild,[])}constructor(e,t){this._lView=e,this._cdRefInjectingView=t,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Un]}set context(e){this._lView[Un]=e}get destroyed(){return 256==(256&this._lView[at])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[cn];if(_i(e)){const t=e[8],r=t?t.indexOf(this):-1;r>-1&&(fE(e,r),nE(t,r))}this._attachedToViewContainer=!1}dA(this._lView[Ne],this._lView)}onDestroy(e){!function Lv(n,e){if(256==(256&n[at]))throw new pe(911,!1);null===n[js]&&(n[js]=[]),n[js].push(e)}(this._lView,e)}markForCheck(){Og(this._cdRefInjectingView||this._lView)}detach(){this._lView[at]&=-129}reattach(){this._lView[at]|=128}detectChanges(){LE(this._lView[Ne],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new pe(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function n5(n,e){Dg(n,e,e[tt],2,null,null)}(this._lView[Ne],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new pe(902,!1);this._appRef=e}}class fK extends Vg{constructor(e){super(e),this._view=e}detectChanges(){const e=this._view;LE(e[Ne],e,e[Un],!1)}checkNoChanges(){}get context(){return null}}class hF extends xE{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const t=St(e);return new Ug(t,this.ngModule)}}function fF(n){const e=[];for(let t in n)n.hasOwnProperty(t)&&e.push({propName:n[t],templateName:t});return e}class gK{constructor(e,t){this.injector=e,this.parentInjector=t}get(e,t,r){r=ll(r);const i=this.injector.get(e,jA,r);return i!==jA||t===jA?i:this.parentInjector.get(e,t,r)}}class Ug extends _O{get inputs(){const e=this.componentDef,t=e.inputTransforms,r=fF(e.inputs);if(null!==t)for(const i of r)t.hasOwnProperty(i.propName)&&(i.transform=t[i.propName]);return r}get outputs(){return fF(this.componentDef.outputs)}constructor(e,t){super(),this.componentDef=e,this.ngModule=t,this.componentType=e.type,this.selector=function Op(n){return n.map(Ad).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!t}create(e,t,r,i){let s=(i=i||this.ngModule)instanceof Es?i:i?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const o=s?new gK(e,s):e,a=o.get(vO,null);if(null===a)throw new pe(407,!1);const p={rendererFactory:a,sanitizer:o.get(d8,null),effectManager:o.get(oF,null),afterRenderEventManager:o.get(qA,null)},_=a.createRenderer(null,this.componentDef),v=this.componentDef.selectors[0][0]||"div",A=r?function V8(n,e,t,r){const s=r.get(FO,!1)||t===Br.ShadowDom,o=n.selectRootElement(e,s);return function U8(n){KO(n)}(o),o}(_,r,this.componentDef.encapsulation,o):hE(_,v,function pK(n){const e=n.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(v)),H=this.componentDef.signals?4608:this.componentDef.onPush?576:528;let V=null;null!==A&&(V=VA(A,o,!0));const Y=XA(0,null,null,1,0,null,null,null,null,null,null),ae=kE(null,Y,null,H,null,null,p,_,o,null,V);let Te,$e;cg(ae);try{const U=this.componentDef;let M,F=null;U.findHostDirectiveDefs?(M=[],F=new Map,U.findHostDirectiveDefs(U,M,F),M.push(U)):M=[U];const j=function _K(n,e){const t=n[Ne],r=vt;return n[r]=e,fh(t,r,2,"#host",null)}(ae,A),z=function yK(n,e,t,r,i,s,o){const a=i[Ne];!function vK(n,e,t,r){for(const i of n)e.mergedAttrs=Bu(e.mergedAttrs,i.hostAttrs);null!==e.mergedAttrs&&(FE(e,e.mergedAttrs,!0),null!==t&&Gk(r,t,e))}(r,n,e,o);let l=null;null!==e&&(l=VA(e,i[Lo]));const u=s.rendererFactory.createRenderer(e,t);let d=16;t.signals?d=4096:t.onPush&&(d=64);const p=kE(i,qO(t),null,d,i[n.index],n,s,u,null,null,l);return a.firstCreatePass&&eb(a,n,r.length-1),OE(i,p),i[n.index]=p}(j,A,U,M,ae,p,_);$e=Fd(Y,vt),A&&function IK(n,e,t,r){if(r)Uu(n,t,["ng-version",EO.full]);else{const{attrs:i,classes:s}=function uv(n){const e=[],t=[];let r=1,i=2;for(;r<n.length;){let s=n[r];if("string"==typeof s)2===i?""!==s&&e.push(s,n[++r]):8===i&&t.push(s);else{if(!Li(i))break;i=s}r++}return{attrs:e,classes:t}}(e.selectors[0]);i&&Uu(n,t,i),s&&s.length>0&&Wk(n,t,s.join(" "))}}(_,U,A,r),void 0!==t&&function wK(n,e,t){const r=n.projection=[];for(let i=0;i<e.length;i++){const s=t[i];r.push(null!=s?Array.from(s):null)}}($e,this.ngContentSelectors,t),Te=function EK(n,e,t,r,i,s){const o=_r(),a=i[Ne],l=yi(o,i);JO(a,i,o,t,null,r);for(let d=0;d<t.length;d++)vi(Ho(i,a,o.directiveStart+d,o),i);XO(a,i,o),l&&vi(l,i);const u=Ho(i,a,o.directiveStart+o.componentOffset,o);if(n[Un]=i[Un]=u,null!==s)for(const d of s)d(u,e);return QA(a,o,n),u}(z,U,M,F,ae,[CK]),ib(Y,ae,null)}finally{dg()}return new mK(this.componentType,Te,uh($e,ae),ae,$e)}}class mK extends s8{constructor(e,t,r,i,s){super(),this.location=r,this._rootLView=i,this._tNode=s,this.previousInputValues=null,this.instance=t,this.hostView=this.changeDetectorRef=new fK(i),this.componentType=e}setInput(e,t){const r=this._tNode.inputs;let i;if(null!==r&&(i=r[e])){if(this.previousInputValues??=new Map,this.previousInputValues.has(e)&&Object.is(this.previousInputValues.get(e),t))return;const s=this._rootLView;rb(s[Ne],s,i,e,t),this.previousInputValues.set(e,t),Og(Bi(this._tNode.index,s))}}get injector(){return new zr(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}function CK(){const n=_r();$d(ue()[Ne],n)}function on(n){let e=function pF(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),t=!0;const r=[n];for(;e;){let i;if(_s(n))i=e.\u0275cmp||e.\u0275dir;else{if(e.\u0275cmp)throw new pe(903,!1);i=e.\u0275dir}if(i){if(t){r.push(i);const o=n;o.inputs=VE(n.inputs),o.inputTransforms=VE(n.inputTransforms),o.declaredInputs=VE(n.declaredInputs),o.outputs=VE(n.outputs);const a=i.hostBindings;a&&SK(n,a);const l=i.viewQuery,u=i.contentQueries;if(l&&AK(n,l),u&&bK(n,u),mn(n.inputs,i.inputs),mn(n.declaredInputs,i.declaredInputs),mn(n.outputs,i.outputs),null!==i.inputTransforms&&(null===o.inputTransforms&&(o.inputTransforms={}),mn(o.inputTransforms,i.inputTransforms)),_s(i)&&i.data.animation){const d=n.data;d.animation=(d.animation||[]).concat(i.data.animation)}}const s=i.features;if(s)for(let o=0;o<s.length;o++){const a=s[o];a&&a.ngInherit&&a(n),a===on&&(t=!1)}}e=Object.getPrototypeOf(e)}!function TK(n){let e=0,t=null;for(let r=n.length-1;r>=0;r--){const i=n[r];i.hostVars=e+=i.hostVars,i.hostAttrs=Bu(i.hostAttrs,t=Bu(t,i.hostAttrs))}}(r)}function VE(n){return n===gi?{}:n===jt?[]:n}function AK(n,e){const t=n.viewQuery;n.viewQuery=t?(r,i)=>{e(r,i),t(r,i)}:e}function bK(n,e){const t=n.contentQueries;n.contentQueries=t?(r,i,s)=>{e(r,i,s),t(r,i,s)}:e}function SK(n,e){const t=n.hostBindings;n.hostBindings=t?(r,i)=>{e(r,i),t(r,i)}:e}function yF(n){const e=n.inputConfig,t={};for(const r in e)if(e.hasOwnProperty(r)){const i=e[r];Array.isArray(i)&&i[2]&&(t[r]=i[2])}n.inputTransforms=t}function UE(n){return!!sb(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function sb(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function Ei(n,e,t){return!Object.is(n[e],t)&&(n[e]=t,!0)}function lc(n,e,t,r){const i=Ei(n,e,t);return Ei(n,e+1,r)||i}function qo(n,e,t,r){const i=ue();return Ei(i,ba(),e)&&(Dt(),Wo(_n(),i,n,e,t,r)),qo}function gh(n,e,t,r){return Ei(n,ba(),t)?e+it(t)+r:ut}function yh(n,e,t,r,i,s,o,a,l,u){const p=function Ws(n,e,t,r,i,s){const o=lc(n,e,t,r);return lc(n,e+2,i,s)||o}(n,function po(){return Je.lFrame.bindingIndex}(),t,i,o,l);return Hs(4),p?e+it(t)+r+it(i)+s+it(o)+a+it(l)+u:ut}function go(n,e,t,r,i,s,o,a){const l=ue(),u=Dt(),d=n+vt,p=u.firstCreatePass?function XK(n,e,t,r,i,s,o,a,l){const u=e.consts,d=fh(e,n,4,o||null,Uo(u,a));ZA(e,t,d,Uo(u,l)),$d(e,d);const p=d.tView=XA(2,d,r,i,s,e.directiveRegistry,e.pipeRegistry,null,e.schemas,u,null);return null!==e.queries&&(e.queries.template(e,d),p.queries=e.queries.embeddedTView(d)),d}(d,u,l,e,t,r,i,s,o):u.data[d];rs(p,!1);const _=PF(u,l,p,n);jd()&&gE(u,l,_,p),vi(_,l),OE(l,l[d]=eF(_,l,_,p)),gl(p)&&YA(u,l,p),null!=o&&JA(l,p,a)}let PF=function NF(n,e,t,r){return jo(!0),e[tt].createComment("")};function Ko(n){return function vl(n,e){return n[e]}(function tg(){return Je.lFrame.contextLView}(),vt+n)}function Tn(n,e,t){const r=ue();return Ei(r,ba(),e)&&ws(Dt(),_n(),r,n,e,r[tt],t,!1),Tn}function db(n,e,t,r,i){const o=i?"class":"style";rb(n,t,e.inputs[o],o,r)}function me(n,e,t,r){const i=ue(),s=Dt(),o=vt+n,a=i[tt],l=s.firstCreatePass?function nQ(n,e,t,r,i,s){const o=e.consts,l=fh(e,n,2,r,Uo(o,i));return ZA(e,t,l,Uo(o,s)),null!==l.attrs&&FE(l,l.attrs,!1),null!==l.mergedAttrs&&FE(l,l.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,l),l}(o,s,i,e,t,r):s.data[o],u=MF(s,i,l,a,e,n);i[o]=u;const d=gl(l);return rs(l,!0),Gk(a,u,l),32!=(32&l.flags)&&jd()&&gE(s,i,u,l),0===function kT(){return Je.lFrame.elementDepthCount}()&&vi(u,i),function OT(){Je.lFrame.elementDepthCount++}(),d&&(YA(s,i,l),QA(s,l,i)),null!==r&&JA(i,l),me}function Ie(){let n=_r();eg()?function ec(){Je.lFrame.isParent=!1}():(n=n.parent,rs(n,!1));const e=n;(function FT(n){return Je.skipHydrationRootTNode===n})(e)&&function LT(){Je.skipHydrationRootTNode=null}(),function Zp(){Je.lFrame.elementDepthCount--}();const t=Dt();return t.firstCreatePass&&($d(t,n),pv(n)&&t.queries.elementEnd(n)),null!=e.classesWithoutHost&&function Jv(n){return 0!=(8&n.flags)}(e)&&db(t,e,ue(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function Wd(n){return 0!=(16&n.flags)}(e)&&db(t,e,ue(),e.stylesWithoutHost,!1),Ie}function Tr(n,e,t,r){return me(n,e,t,r),Ie(),Tr}let MF=(n,e,t,r,i,s)=>(jo(!0),hE(r,i,function qv(){return Je.lFrame.currentNamespace}()));function Al(){return ue()}function zg(n){return!!n&&"function"==typeof n.then}function FF(n){return!!n&&"function"==typeof n.subscribe}function An(n,e,t,r){const i=ue(),s=Dt(),o=_r();return function VF(n,e,t,r,i,s,o){const a=gl(r),u=n.firstCreatePass&&function rF(n){return n.cleanup||(n.cleanup=[])}(n),d=e[Un],p=function nF(n){return n[cl]||(n[cl]=[])}(e);let _=!0;if(3&r.type||o){const D=yi(r,e),P=o?o(D):D,H=p.length,V=o?ae=>o(tn(ae[r.index])):r.index;let Y=null;if(!o&&a&&(Y=function lQ(n,e,t,r){const i=n.cleanup;if(null!=i)for(let s=0;s<i.length-1;s+=2){const o=i[s];if(o===t&&i[s+1]===r){const a=e[cl],l=i[s+2];return a.length>l?a[l]:null}"string"==typeof o&&(s+=2)}return null}(n,e,i,r.index)),null!==Y)(Y.__ngLastListenerFn__||Y).__ngNextListenerFn__=s,Y.__ngLastListenerFn__=s,_=!1;else{s=BF(r,e,d,s,!1);const ae=t.listen(P,i,s);p.push(s,ae),u&&u.push(i,V,H,H+1)}}else s=BF(r,e,d,s,!1);const v=r.outputs;let A;if(_&&null!==v&&(A=v[i])){const D=A.length;if(D)for(let P=0;P<D;P+=2){const Te=e[A[P]][A[P+1]].subscribe(s),$e=p.length;p.push(s,Te),u&&u.push(i,r.index,$e,-($e+1))}}}(s,i,i[tt],o,n,e,r),An}function UF(n,e,t,r){try{return $s(6,e,t),!1!==t(r)}catch(i){return sF(n,i),!1}finally{$s(7,e,t)}}function BF(n,e,t,r,i){return function s(o){if(o===Function)return r;Og(n.componentOffset>-1?Bi(n.index,e):e);let l=UF(e,t,r,o),u=s.__ngNextListenerFn__;for(;u;)l=UF(e,t,u,o)&&l,u=u.__ngNextListenerFn__;return i&&!1===l&&o.preventDefault(),l}}function Mr(n=1){return function jT(n){return(Je.lFrame.contextLView=function $T(n,e){for(;n>0;)e=e[hl],n--;return e}(n,Je.lFrame.contextLView))[Un]}(n)}function Ch(n,e,t){return pb(n,"",e,"",t),Ch}function pb(n,e,t,r,i){const s=ue(),o=gh(s,e,t,r);return o!==ut&&ws(Dt(),_n(),s,n,o,s[tt],i,!1),pb}function zE(n,e){return n<<17|e<<2}function bl(n){return n>>17&32767}function gb(n){return 2|n}function uc(n){return(131068&n)>>2}function mb(n,e){return-131069&n|e<<2}function _b(n){return 1|n}function QF(n,e,t,r,i){const s=n[t+1],o=null===e;let a=r?bl(s):uc(s),l=!1;for(;0!==a&&(!1===l||o);){const d=n[a+1];_Q(n[a],e)&&(l=!0,n[a+1]=r?_b(d):gb(d)),a=r?bl(d):uc(d)}l&&(n[t+1]=r?gb(s):_b(s))}function _Q(n,e){return null===n||null==e||(Array.isArray(n)?n[1]:n)===e||!(!Array.isArray(n)||"string"!=typeof e)&&Xd(n,e)>=0}function Sl(n,e){return function mo(n,e,t,r){const i=ue(),s=Dt(),o=Hs(2);s.firstUpdatePass&&function iL(n,e,t,r){const i=n.data;if(null===i[t+1]){const s=i[ii()],o=function rL(n,e){return e>=n.expandoStartIndex}(n,t);(function lL(n,e){return 0!=(n.flags&(e?8:16))})(s,r)&&null===e&&!o&&(e=!1),e=function bQ(n,e,t,r){const i=function ag(n){const e=Je.lFrame.currentDirectiveIndex;return-1===e?null:n[e]}(n);let s=r?e.residualClasses:e.residualStyles;if(null===i)0===(r?e.classBindings:e.styleBindings)&&(t=Wg(t=yb(null,n,e,t,r),e.attrs,r),s=null);else{const o=e.directiveStylingLast;if(-1===o||n[o]!==i)if(t=yb(i,n,e,t,r),null===s){let l=function SQ(n,e,t){const r=t?e.classBindings:e.styleBindings;if(0!==uc(r))return n[bl(r)]}(n,e,r);void 0!==l&&Array.isArray(l)&&(l=yb(null,n,e,l[1],r),l=Wg(l,e.attrs,r),function DQ(n,e,t,r){n[bl(t?e.classBindings:e.styleBindings)]=r}(n,e,r,l))}else s=function RQ(n,e,t){let r;const i=e.directiveEnd;for(let s=1+e.directiveStylingLast;s<i;s++)r=Wg(r,n[s].hostAttrs,t);return Wg(r,e.attrs,t)}(n,e,r)}return void 0!==s&&(r?e.residualClasses=s:e.residualStyles=s),t}(i,s,e,r),function gQ(n,e,t,r,i,s){let o=s?e.classBindings:e.styleBindings,a=bl(o),l=uc(o);n[r]=t;let d,u=!1;if(Array.isArray(t)?(d=t[1],(null===d||Xd(t,d)>0)&&(u=!0)):d=t,i)if(0!==l){const _=bl(n[a+1]);n[r+1]=zE(_,a),0!==_&&(n[_+1]=mb(n[_+1],r)),n[a+1]=function fQ(n,e){return 131071&n|e<<17}(n[a+1],r)}else n[r+1]=zE(a,0),0!==a&&(n[a+1]=mb(n[a+1],r)),a=r;else n[r+1]=zE(l,0),0===a?a=r:n[l+1]=mb(n[l+1],r),l=r;u&&(n[r+1]=gb(n[r+1])),QF(n,d,r,!0),QF(n,d,r,!1),function mQ(n,e,t,r,i){const s=i?n.residualClasses:n.residualStyles;null!=s&&"string"==typeof e&&Xd(s,e)>=0&&(t[r+1]=_b(t[r+1]))}(e,d,n,r,s),o=zE(a,l),s?e.classBindings=o:e.styleBindings=o}(i,s,e,t,o,r)}}(s,n,o,r),e!==ut&&Ei(i,o,e)&&function oL(n,e,t,r,i,s,o,a){if(!(3&e.type))return;const l=n.data,u=l[a+1],d=function pQ(n){return 1==(1&n)}(u)?aL(l,e,t,i,uc(u),o):void 0;WE(d)||(WE(s)||function hQ(n){return 2==(2&n)}(u)&&(s=aL(l,null,t,i,a,o)),function h5(n,e,t,r,i){if(e)i?n.addClass(t,r):n.removeClass(t,r);else{let s=-1===r.indexOf("-")?void 0:wl.DashCase;null==i?n.removeStyle(t,r,s):("string"==typeof i&&i.endsWith("!important")&&(i=i.slice(0,-10),s|=wl.Important),n.setStyle(t,r,i,s))}}(r,o,yl(ii(),t),i,s))}(s,s.data[ii()],i,i[tt],n,i[o+1]=function MQ(n,e){return null==n||""===n||("string"==typeof e?n+=e:"object"==typeof n&&(n=be(Cl(n)))),n}(e,t),r,o)}(n,e,null,!0),Sl}function yb(n,e,t,r,i){let s=null;const o=t.directiveEnd;let a=t.directiveStylingLast;for(-1===a?a=t.directiveStart:a++;a<o&&(s=e[a],r=Wg(r,s.hostAttrs,i),s!==n);)a++;return null!==n&&(t.directiveStylingLast=a),r}function Wg(n,e,t){const r=t?1:2;let i=-1;if(null!==e)for(let s=0;s<e.length;s++){const o=e[s];"number"==typeof o?i=o:i===r&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),ys(n,o,!!t||e[++s]))}return void 0===n?null:n}function aL(n,e,t,r,i,s){const o=null===e;let a;for(;i>0;){const l=n[i],u=Array.isArray(l),d=u?l[1]:l,p=null===d;let _=t[i+1];_===ut&&(_=p?jt:void 0);let v=p?eA(_,r):d===r?_:void 0;if(u&&!WE(v)&&(v=eA(l,r)),WE(v)&&(a=v,o))return a;const A=n[i+1];i=o?bl(A):uc(A)}if(null!==e){let l=s?e.residualClasses:e.residualStyles;null!=l&&(a=eA(l,r))}return a}function WE(n){return void 0!==n}function Se(n,e=""){const t=ue(),r=Dt(),i=n+vt,s=r.firstCreatePass?fh(r,i,1,e,null):r.data[i],o=uL(r,t,s,e,n);t[i]=o,jd()&&gE(r,t,o,s),rs(s,!1)}let uL=(n,e,t,r,i)=>(jo(!0),function dE(n,e){return n.createText(e)}(e[tt],r));function vb(n){return Dl("",n,""),vb}function Dl(n,e,t){const r=ue(),i=gh(r,n,e,t);return i!==ut&&Oa(r,ii(),i),Dl}function Eb(n,e,t,r,i,s,o,a,l){const u=ue(),d=yh(u,n,e,t,r,i,s,o,a,l);return d!==ut&&Oa(u,ii(),d),Eb}const bh="en-US";let xL=bh;function Cb(n,e,t,r,i){if(n=Ze(n),Array.isArray(n))for(let s=0;s<n.length;s++)Cb(n[s],e,t,r,i);else{const s=Dt(),o=ue(),a=_r();let l=ac(n)?n:Ze(n.provide);const u=dO(n),d=1048575&a.providerIndexes,p=a.directiveStart,_=a.providerIndexes>>20;if(ac(n)||!n.multi){const v=new Il(u,i,_e),A=Ab(l,e,i?d:d+_,p);-1===A?(X(m(a,o),s,l),Tb(s,n,e.length),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(v),o.push(v)):(t[A]=v,o[A]=v)}else{const v=Ab(l,e,d+_,p),A=Ab(l,e,d,d+_),P=A>=0&&t[A];if(i&&!P||!i&&!(v>=0&&t[v])){X(m(a,o),s,l);const H=function eJ(n,e,t,r,i){const s=new Il(n,t,_e);return s.multi=[],s.index=e,s.componentProviders=0,tV(s,i,r&&!t),s}(i?ZY:XY,t.length,i,r,u);!i&&P&&(t[A].providerFactory=H),Tb(s,n,e.length,0),e.push(l),a.directiveStart++,a.directiveEnd++,i&&(a.providerIndexes+=1048576),t.push(H),o.push(H)}else Tb(s,n,v>-1?v:A,tV(t[i?A:v],u,!i&&r));!i&&r&&P&&t[A].componentProviders++}}}function Tb(n,e,t,r){const i=ac(e),s=function $5(n){return!!n.useClass}(e);if(i||s){const l=(s?Ze(e.useClass):e).prototype.ngOnDestroy;if(l){const u=n.destroyHooks||(n.destroyHooks=[]);if(!i&&e.multi){const d=u.indexOf(t);-1===d?u.push(t,[r,l]):u[d+1].push(r,l)}else u.push(t,l)}}}function tV(n,e,t){return t&&n.componentProviders++,n.multi.push(e)-1}function Ab(n,e,t,r){for(let i=t;i<r;i++)if(e[i]===n)return i;return-1}function XY(n,e,t,r){return bb(this.multi,[])}function ZY(n,e,t,r){const i=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,a=Ho(t,t[Ne],this.providerFactory.index,r);s=a.slice(0,o),bb(i,s);for(let l=o;l<a.length;l++)s.push(a[l])}else s=[],bb(i,s);return s}function bb(n,e){for(let t=0;t<n.length;t++)e.push((0,n[t])());return e}function Kn(n,e=[]){return t=>{t.providersResolver=(r,i)=>function JY(n,e,t){const r=Dt();if(r.firstCreatePass){const i=_s(n);Cb(t,r.data,r.blueprint,i,!0),Cb(e,r.data,r.blueprint,i,!1)}}(r,i?i(n):n,e)}}class dc{}class nV{}class Sb extends dc{constructor(e,t,r){super(),this._parent=t,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new hF(this);const i=Vi(e);this._bootstrapComponents=ka(i.bootstrap),this._r3Injector=AO(e,t,[{provide:dc,useValue:this},{provide:xE,useValue:this.componentFactoryResolver},...r],be(e),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(e)}get injector(){return this._r3Injector}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(t=>t()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Db extends nV{constructor(e){super(),this.moduleType=e}create(e){return new Sb(this.moduleType,e,[])}}class rV extends dc{constructor(e){super(),this.componentFactoryResolver=new hF(this),this.instance=null;const t=new sh([...e.providers,{provide:dc,useValue:this},{provide:xE,useValue:this.componentFactoryResolver}],e.parent||CE(),e.debugName,new Set(["environment"]));this.injector=t,e.runEnvironmentInitializers&&t.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(e){this.injector.onDestroy(e)}}function Rb(n,e,t=null){return new rV({providers:n,parent:e,debugName:t,runEnvironmentInitializers:!0}).injector}let rJ=(()=>{class n{constructor(t){this._injector=t,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(t){if(!t.standalone)return null;if(!this.cachedInjectors.has(t)){const r=aO(0,t.type),i=r.length>0?Rb([r],this._injector,`Standalone[${t.type.name}]`):null;this.cachedInjectors.set(t,i)}return this.cachedInjectors.get(t)}ngOnDestroy(){try{for(const t of this.cachedInjectors.values())null!==t&&t.destroy()}finally{this.cachedInjectors.clear()}}static{this.\u0275prov=Be({token:n,providedIn:"environment",factory:()=>new n(Ee(Es))})}}return n})();function iV(n){n.getStandaloneInjector=e=>e.get(rJ).getOrCreateStandaloneInjector(n)}function PJ(n,e,t,r=!0){const i=e[Ne];if(function i5(n,e,t,r){const i=Rr+r,s=t.length;r>0&&(t[i-1][ms]=e),r<s-Rr?(e[ms]=t[i],uk(t,Rr+r,e)):(t.push(e),e[ms]=null),e[cn]=t;const o=e[zu];null!==o&&t!==o&&function s5(n,e){const t=n[fl];e[Bn]!==e[cn][cn][Bn]&&(n[fv]=!0),null===t?n[fl]=[e]:t.push(e)}(o,e);const a=e[Bs];null!==a&&a.insertView(n),e[at]|=128}(i,e,n,t),r){const s=gA(t,n),o=e[tt],a=pE(o,n[ti]);null!==a&&function t5(n,e,t,r,i,s){r[Vn]=i,r[$r]=e,Dg(n,r,t,1,i,s)}(i,n[$r],o,e,a,s)}}let Fa=(()=>{class n{static{this.__NG_ELEMENT_ID__=kJ}}return n})();const NJ=Fa,MJ=class extends NJ{constructor(e,t,r){super(),this._declarationLView=e,this._declarationTContainer=t,this.elementRef=r}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(e,t){return this.createEmbeddedViewImpl(e,t)}createEmbeddedViewImpl(e,t,r){const i=function xJ(n,e,t,r){const i=e.tView,a=kE(n,i,t,4096&n[at]?4096:16,null,e,null,null,null,r?.injector??null,r?.hydrationInfo??null);a[zu]=n[e.index];const u=n[Bs];return null!==u&&(a[Bs]=u.createEmbeddedView(i)),ib(i,a,t),a}(this._declarationLView,this._declarationTContainer,e,{injector:t,hydrationInfo:r});return new Vg(i)}};function kJ(){return function YE(n,e){return 4&n.type?new MJ(e,n,uh(n,e)):null}(_r(),ue())}let yo=(()=>{class n{static{this.__NG_ELEMENT_ID__=BJ}}return n})();function BJ(){return function wV(n,e){let t;const r=e[n.index];return _i(r)?t=r:(t=eF(r,e,null,n),e[n.index]=t,OE(e,t)),CV(t,e,n,r),new EV(t,n,e)}(_r(),ue())}const jJ=yo,EV=class extends jJ{constructor(e,t,r){super(),this._lContainer=e,this._hostTNode=t,this._hostLView=r}get element(){return uh(this._hostTNode,this._hostLView)}get injector(){return new zr(this._hostTNode,this._hostLView)}get parentInjector(){const e=L(this._hostTNode,this._hostLView);if(pg(e)){const t=ic(e,this._hostLView),r=rc(e);return new zr(t[Ne].data[r+8],t)}return new zr(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const t=IV(this._lContainer);return null!==t&&t[e]||null}get length(){return this._lContainer.length-Rr}createEmbeddedView(e,t,r){let i,s;"number"==typeof r?i=r:null!=r&&(i=r.index,s=r.injector);const a=e.createEmbeddedViewImpl(t||{},s,null);return this.insertImpl(a,i,false),a}createComponent(e,t,r,i,s){const o=e&&!function wg(n){return"function"==typeof n}(e);let a;if(o)a=t;else{const D=t||{};a=D.index,r=D.injector,i=D.projectableNodes,s=D.environmentInjector||D.ngModuleRef}const l=o?e:new Ug(St(e)),u=r||this.parentInjector;if(!s&&null==l.ngModule){const P=(o?u:this.parentInjector).get(Es,null);P&&(s=P)}St(l.componentType??{});const v=l.create(u,i,null,s);return this.insertImpl(v.hostView,a,false),v}insert(e,t){return this.insertImpl(e,t,!1)}insertImpl(e,t,r){const i=e._lView;if(function kv(n){return _i(n[cn])}(i)){const l=this.indexOf(e);if(-1!==l)this.detach(l);else{const u=i[cn],d=new EV(u,u[$r],u[cn]);d.detach(d.indexOf(e))}}const o=this._adjustIndex(t),a=this._lContainer;return PJ(a,i,o,!r),e.attachToViewContainerRef(),uk(Nb(a),o,e),e}move(e,t){return this.insert(e,t)}indexOf(e){const t=IV(this._lContainer);return null!==t?t.indexOf(e):-1}remove(e){const t=this._adjustIndex(e,-1),r=fE(this._lContainer,t);r&&(nE(Nb(this._lContainer),t),dA(r[Ne],r))}detach(e){const t=this._adjustIndex(e,-1),r=fE(this._lContainer,t);return r&&null!=nE(Nb(this._lContainer),t)?new Vg(r):null}_adjustIndex(e,t=0){return e??this.length+t}};function IV(n){return n[8]}function Nb(n){return n[8]||(n[8]=[])}let CV=function TV(n,e,t,r){if(n[ti])return;let i;i=8&t.type?tn(r):function $J(n,e){const t=n[tt],r=t.createComment(""),i=yi(e,n);return oc(t,pE(t,i),r,function u5(n,e){return n.nextSibling(e)}(t,i),!1),r}(e,t),n[ti]=i};const Hb=new we("Application Initializer");let zb=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((t,r)=>{this.resolve=t,this.reject=r}),this.appInits=ke(Hb,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const t=[];for(const i of this.appInits){const s=i();if(zg(s))t.push(s);else if(FF(s)){const o=new Promise((a,l)=>{s.subscribe({complete:a,error:l})});t.push(o)}}const r=()=>{this.done=!0,this.resolve()};Promise.all(t).then(()=>{r()}).catch(i=>{this.reject(i)}),0===t.length&&r(),this.initialized=!0}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),QV=(()=>{class n{log(t){console.log(t)}warn(t){console.warn(t)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();const La=new we("LocaleId",{providedIn:"root",factory:()=>ke(La,yt.Optional|yt.SkipSelf)||function vX(){return typeof $localize<"u"&&$localize.locale||bh}()});let ZE=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new T(!1)}add(){this.hasPendingTasks.next(!0);const t=this.taskId++;return this.pendingTasks.add(t),t}remove(t){this.pendingTasks.delete(t),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();class wX{constructor(e,t){this.ngModuleFactory=e,this.componentFactories=t}}let YV=(()=>{class n{compileModuleSync(t){return new Db(t)}compileModuleAsync(t){return Promise.resolve(this.compileModuleSync(t))}compileModuleAndAllComponentsSync(t){const r=this.compileModuleSync(t),s=ka(Vi(t).declarations).reduce((o,a)=>{const l=St(a);return l&&o.push(new Ug(l)),o},[]);return new wX(r,s)}compileModuleAndAllComponentsAsync(t){return Promise.resolve(this.compileModuleAndAllComponentsSync(t))}clearCache(){}clearCacheFor(t){}getModuleId(t){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const e2=new we(""),tI=new we("");let Qb,qb=(()=>{class n{constructor(t,r,i){this._ngZone=t,this.registry=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,Qb||(function zX(n){Qb=n}(i),i.addToWindow(r)),this._watchAngularEvents(),t.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Xt.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let t=this._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(this._didWork)}this._didWork=!1});else{let t=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(t)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(t=>({source:t.source,creationLocation:t.creationLocation,data:t.data})):[]}addCallback(t,r,i){let s=-1;r&&r>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),t(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:t,timeoutId:s,updateCb:i})}whenStable(t,r,i){if(i&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(t,r,i),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(t){this.registry.registerApplication(t,this)}unregisterApplication(t){this.registry.unregisterApplication(t)}findProviders(t,r,i){return[]}static{this.\u0275fac=function(r){return new(r||n)(Ee(Xt),Ee(Kb),Ee(tI))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})(),Kb=(()=>{class n{constructor(){this._applications=new Map}registerApplication(t,r){this._applications.set(t,r)}unregisterApplication(t){this._applications.delete(t)}unregisterAllApplications(){this._applications.clear()}getTestability(t){return this._applications.get(t)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(t,r=!0){return Qb?.findTestabilityInTree(this,t,r)??null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})(),Rl=null;const t2=new we("AllowMultipleToken"),Yb=new we("PlatformDestroyListeners"),Jb=new we("appBootstrapListener");class r2{constructor(e,t){this.name=e,this.token=t}}function s2(n,e,t=[]){const r=`Platform: ${e}`,i=new we(r);return(s=[])=>{let o=Xb();if(!o||o.injector.get(t2,!1)){const a=[...t,...s,{provide:i,useValue:!0}];n?n(a):function qX(n){if(Rl&&!Rl.get(t2,!1))throw new pe(400,!1);(function n2(){!function nk(n){Sv=n}(()=>{throw new pe(600,!1)})})(),Rl=n;const e=n.get(a2);(function i2(n){n.get(hO,null)?.forEach(t=>t())})(n)}(function o2(n=[],e){return ss.create({name:e,providers:[{provide:SA,useValue:"platform"},{provide:Yb,useValue:new Set([()=>Rl=null])},...n]})}(a,r))}return function QX(n){const e=Xb();if(!e)throw new pe(401,!1);return e}()}}function Xb(){return Rl?.get(a2)??null}let a2=(()=>{class n{constructor(t){this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(t,r){const i=function YX(n="zone.js",e){return"noop"===n?new T8:"zone.js"===n?new Xt(e):n}(r?.ngZone,function l2(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:r?.ngZoneEventCoalescing,runCoalescing:r?.ngZoneRunCoalescing}));return i.run(()=>{const s=function nJ(n,e,t){return new Sb(n,e,t)}(t.moduleType,this.injector,function f2(n){return[{provide:Xt,useFactory:n},{provide:Ng,multi:!0,useFactory:()=>{const e=ke(XX,{optional:!0});return()=>e.initialize()}},{provide:h2,useFactory:JX},{provide:xO,useFactory:PO}]}(()=>i)),o=s.injector.get(Ma,null);return i.runOutsideAngular(()=>{const a=i.onError.subscribe({next:l=>{o.handleError(l)}});s.onDestroy(()=>{nI(this._modules,s),a.unsubscribe()})}),function u2(n,e,t){try{const r=t();return zg(r)?r.catch(i=>{throw e.runOutsideAngular(()=>n.handleError(i)),i}):r}catch(r){throw e.runOutsideAngular(()=>n.handleError(r)),r}}(o,i,()=>{const a=s.injector.get(zb);return a.runInitializers(),a.donePromise.then(()=>(function PL(n){Oi(n,"Expected localeId to be defined"),"string"==typeof n&&(xL=n.toLowerCase().replace(/_/g,"-"))}(s.injector.get(La,bh)||bh),this._moduleDoBootstrap(s),s))})})}bootstrapModule(t,r=[]){const i=c2({},r);return function WX(n,e,t){const r=new Db(t);return Promise.resolve(r)}(0,0,t).then(s=>this.bootstrapModuleFactory(s,i))}_moduleDoBootstrap(t){const r=t.injector.get(Rh);if(t._bootstrapComponents.length>0)t._bootstrapComponents.forEach(i=>r.bootstrap(i));else{if(!t.instance.ngDoBootstrap)throw new pe(-403,!1);t.instance.ngDoBootstrap(r)}this._modules.push(t)}onDestroy(t){this._destroyListeners.push(t)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new pe(404,!1);this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r());const t=this._injector.get(Yb,null);t&&(t.forEach(r=>r()),t.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static{this.\u0275fac=function(r){return new(r||n)(Ee(ss))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"platform"})}}return n})();function c2(n,e){return Array.isArray(e)?e.reduce(c2,n):{...n,...e}}let Rh=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ke(h2),this.zoneIsStable=ke(xO),this.componentTypes=[],this.components=[],this.isStable=ke(ZE).hasPendingTasks.pipe(ye(t=>t?R(!1):this.zoneIsStable),He(),k()),this._injector=ke(Es)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(t,r){const i=t instanceof _O;if(!this._injector.get(zb).done)throw!i&&function Fo(n){const e=St(n)||lr(n)||Dr(n);return null!==e&&e.standalone}(t),new pe(405,!1);let o;o=i?t:this._injector.get(xE).resolveComponentFactory(t),this.componentTypes.push(o.componentType);const a=function GX(n){return n.isBoundToModule}(o)?void 0:this._injector.get(dc),u=o.create(ss.NULL,[],r||o.selector,a),d=u.location.nativeElement,p=u.injector.get(e2,null);return p?.registerApplication(d),u.onDestroy(()=>{this.detachView(u.hostView),nI(this.components,u),p?.unregisterApplication(d)}),this._loadComponent(u),u}tick(){if(this._runningTick)throw new pe(101,!1);try{this._runningTick=!0;for(let t of this._views)t.detectChanges()}catch(t){this.internalErrorHandler(t)}finally{this._runningTick=!1}}attachView(t){const r=t;this._views.push(r),r.attachToAppRef(this)}detachView(t){const r=t;nI(this._views,r),r.detachFromAppRef()}_loadComponent(t){this.attachView(t.hostView),this.tick(),this.components.push(t);const r=this._injector.get(Jb,[]);r.push(...this._bootstrapListeners),r.forEach(i=>i(t))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(t=>t()),this._views.slice().forEach(t=>t.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(t){return this._destroyListeners.push(t),()=>nI(this._destroyListeners,t)}destroy(){if(this._destroyed)throw new pe(406,!1);const t=this._injector;t.destroy&&!t.destroyed&&t.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function nI(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}const h2=new we("",{providedIn:"root",factory:()=>ke(Ma).handleError.bind(void 0)});function JX(){const n=ke(Xt),e=ke(Ma);return t=>n.runOutsideAngular(()=>e.handleError(t))}let XX=(()=>{class n{constructor(){this.zone=ke(Xt),this.applicationRef=ke(Rh)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();let rI=(()=>{class n{static{this.__NG_ELEMENT_ID__=eZ}}return n})();function eZ(n){return function tZ(n,e,t){if(pl(n)&&!t){const r=Bi(n.index,e);return new Vg(r,r)}return 47&n.type?new Vg(e[Bn],e):null}(_r(),ue(),16==(16&n))}class v2{constructor(){}supports(e){return UE(e)}create(e){return new oZ(e)}}const sZ=(n,e)=>e;class oZ{constructor(e){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=e||sZ}forEachItem(e){let t;for(t=this._itHead;null!==t;t=t._next)e(t)}forEachOperation(e){let t=this._itHead,r=this._removalsHead,i=0,s=null;for(;t||r;){const o=!r||t&&t.currentIndex<I2(r,i,s)?t:r,a=I2(o,i,s),l=o.currentIndex;if(o===r)i--,r=r._nextRemoved;else if(t=t._next,null==o.previousIndex)i++;else{s||(s=[]);const u=a-i,d=l-i;if(u!=d){for(let _=0;_<u;_++){const v=_<s.length?s[_]:s[_]=0,A=v+_;d<=A&&A<u&&(s[_]=v+1)}s[o.previousIndex]=d-u}}a!==l&&e(o,a,l)}}forEachPreviousItem(e){let t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachMovedItem(e){let t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}forEachIdentityChange(e){let t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}diff(e){if(null==e&&(e=[]),!UE(e))throw new pe(900,!1);return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let i,s,o,t=this._itHead,r=!1;if(Array.isArray(e)){this.length=e.length;for(let a=0;a<this.length;a++)s=e[a],o=this._trackByFn(a,s),null!==t&&Object.is(t.trackById,o)?(r&&(t=this._verifyReinsertion(t,s,o,a)),Object.is(t.item,s)||this._addIdentityChange(t,s)):(t=this._mismatch(t,s,o,a),r=!0),t=t._next}else i=0,function kK(n,e){if(Array.isArray(n))for(let t=0;t<n.length;t++)e(n[t]);else{const t=n[Symbol.iterator]();let r;for(;!(r=t.next()).done;)e(r.value)}}(e,a=>{o=this._trackByFn(i,a),null!==t&&Object.is(t.trackById,o)?(r&&(t=this._verifyReinsertion(t,a,o,i)),Object.is(t.item,a)||this._addIdentityChange(t,a)):(t=this._mismatch(t,a,o,i),r=!0),t=t._next,i++}),this.length=i;return this._truncate(t),this.collection=e,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(e,t,r,i){let s;return null===e?s=this._itTail:(s=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,s,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(r,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,s,i)):e=this._addAfter(new aZ(t,r),s,i),e}_verifyReinsertion(e,t,r,i){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(r,null);return null!==s?e=this._reinsertAfter(s,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}_truncate(e){for(;null!==e;){const t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(e,t,r){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);const i=e._prevRemoved,s=e._nextRemoved;return null===i?this._removalsHead=s:i._nextRemoved=s,null===s?this._removalsTail=i:s._prevRemoved=i,this._insertAfter(e,t,r),this._addToMoves(e,r),e}_moveAfter(e,t,r){return this._unlink(e),this._insertAfter(e,t,r),this._addToMoves(e,r),e}_addAfter(e,t,r){return this._insertAfter(e,t,r),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}_insertAfter(e,t,r){const i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new E2),this._linkedRecords.put(e),e.currentIndex=r,e}_remove(e){return this._addToRemovals(this._unlink(e))}_unlink(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);const t=e._prev,r=e._next;return null===t?this._itHead=r:t._next=r,null===r?this._itTail=t:r._prev=t,e}_addToMoves(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}_addToRemovals(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new E2),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}_addIdentityChange(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}class aZ{constructor(e,t){this.item=e,this.trackById=t,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class lZ{constructor(){this._head=null,this._tail=null}add(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}get(e,t){let r;for(r=this._head;null!==r;r=r._nextDup)if((null===t||t<=r.currentIndex)&&Object.is(r.trackById,e))return r;return null}remove(e){const t=e._prevDup,r=e._nextDup;return null===t?this._head=r:t._nextDup=r,null===r?this._tail=t:r._prevDup=t,null===this._head}}class E2{constructor(){this.map=new Map}put(e){const t=e.trackById;let r=this.map.get(t);r||(r=new lZ,this.map.set(t,r)),r.add(e)}get(e,t){const i=this.map.get(e);return i?i.get(e,t):null}remove(e){const t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function I2(n,e,t){const r=n.previousIndex;if(null===r)return r;let i=0;return t&&r<t.length&&(i=t[r]),r+e+i}class w2{constructor(){}supports(e){return e instanceof Map||sb(e)}create(){return new uZ}}class uZ{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(e){let t;for(t=this._mapHead;null!==t;t=t._next)e(t)}forEachPreviousItem(e){let t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}forEachChangedItem(e){let t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}forEachAddedItem(e){let t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}forEachRemovedItem(e){let t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}diff(e){if(e){if(!(e instanceof Map||sb(e)))throw new pe(900,!1)}else e=new Map;return this.check(e)?this:null}onDestroy(){}check(e){this._reset();let t=this._mapHead;if(this._appendAfter=null,this._forEach(e,(r,i)=>{if(t&&t.key===i)this._maybeAddToChanges(t,r),this._appendAfter=t,t=t._next;else{const s=this._getOrCreateRecordForKey(i,r);t=this._insertBeforeOrAppend(t,s)}}),t){t._prev&&(t._prev._next=null),this._removalsHead=t;for(let r=t;null!==r;r=r._nextRemoved)r===this._mapHead&&(this._mapHead=null),this._records.delete(r.key),r._nextRemoved=r._next,r.previousValue=r.currentValue,r.currentValue=null,r._prev=null,r._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(e,t){if(e){const r=e._prev;return t._next=e,t._prev=r,e._prev=t,r&&(r._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}_getOrCreateRecordForKey(e,t){if(this._records.has(e)){const i=this._records.get(e);this._maybeAddToChanges(i,t);const s=i._prev,o=i._next;return s&&(s._next=o),o&&(o._prev=s),i._next=null,i._prev=null,i}const r=new cZ(e);return this._records.set(e,r),r.currentValue=t,this._addToAdditions(r),r}_reset(){if(this.isDirty){let e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}_addToAdditions(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}_addToChanges(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}_forEach(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(r=>t(e[r],r))}}class cZ{constructor(e){this.key=e,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function C2(){return new oI([new v2])}let oI=(()=>{class n{static{this.\u0275prov=Be({token:n,providedIn:"root",factory:C2})}constructor(t){this.factories=t}static create(t,r){if(null!=r){const i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||C2()),deps:[[n,new iE,new vs]]}}find(t){const r=this.factories.find(i=>i.supports(t));if(null!=r)return r;throw new pe(901,!1)}}return n})();function T2(){return new tm([new w2])}let tm=(()=>{class n{static{this.\u0275prov=Be({token:n,providedIn:"root",factory:T2})}constructor(t){this.factories=t}static create(t,r){if(r){const i=r.factories.slice();t=t.concat(i)}return new n(t)}static extend(t){return{provide:n,useFactory:r=>n.create(t,r||T2()),deps:[[n,new iE,new vs]]}}find(t){const r=this.factories.find(i=>i.supports(t));if(r)return r;throw new pe(901,!1)}}return n})();const fZ=s2(null,"core",[]);let pZ=(()=>{class n{constructor(t){}static{this.\u0275fac=function(r){return new(r||n)(Ee(Rh))}}static{this.\u0275mod=ei({type:n})}static{this.\u0275inj=pi({})}}return n})();function xh(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}let iS=null;function xl(){return iS}class DZ{}const Cs=new we("DocumentToken");let sS=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:function(){return ke(xZ)},providedIn:"platform"})}}return n})();const RZ=new we("Location Initialized");let xZ=(()=>{class n extends sS{constructor(){super(),this._doc=ke(Cs),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return xl().getBaseHref(this._doc)}onPopState(t){const r=xl().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",t,!1),()=>r.removeEventListener("popstate",t)}onHashChange(t){const r=xl().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",t,!1),()=>r.removeEventListener("hashchange",t)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(t){this._location.pathname=t}pushState(t,r,i){this._history.pushState(t,r,i)}replaceState(t,r,i){this._history.replaceState(t,r,i)}forward(){this._history.forward()}back(){this._history.back()}historyGo(t=0){this._history.go(t)}getState(){return this._history.state}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:function(){return new n},providedIn:"platform"})}}return n})();function oS(n,e){if(0==n.length)return e;if(0==e.length)return n;let t=0;return n.endsWith("/")&&t++,e.startsWith("/")&&t++,2==t?n+e.substring(1):1==t?n+e:n+"/"+e}function M2(n){const e=n.match(/#|\?|$/),t=e&&e.index||n.length;return n.slice(0,t-("/"===n[t-1]?1:0))+n.slice(t)}function Va(n){return n&&"?"!==n[0]?"?"+n:n}let fc=(()=>{class n{historyGo(t){throw new Error("Not implemented")}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:function(){return ke(O2)},providedIn:"root"})}}return n})();const k2=new we("appBaseHref");let O2=(()=>{class n extends fc{constructor(t,r){super(),this._platformLocation=t,this._removeListenerFns=[],this._baseHref=r??this._platformLocation.getBaseHrefFromDOM()??ke(Cs).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}prepareExternalUrl(t){return oS(this._baseHref,t)}path(t=!1){const r=this._platformLocation.pathname+Va(this._platformLocation.search),i=this._platformLocation.hash;return i&&t?`${r}${i}`:r}pushState(t,r,i,s){const o=this.prepareExternalUrl(i+Va(s));this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){const o=this.prepareExternalUrl(i+Va(s));this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(Ee(sS),Ee(k2,8))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),PZ=(()=>{class n extends fc{constructor(t,r){super(),this._platformLocation=t,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(t){this._removeListenerFns.push(this._platformLocation.onPopState(t),this._platformLocation.onHashChange(t))}getBaseHref(){return this._baseHref}path(t=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(t){const r=oS(this._baseHref,t);return r.length>0?"#"+r:r}pushState(t,r,i,s){let o=this.prepareExternalUrl(i+Va(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.pushState(t,r,o)}replaceState(t,r,i,s){let o=this.prepareExternalUrl(i+Va(s));0==o.length&&(o=this._platformLocation.pathname),this._platformLocation.replaceState(t,r,o)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(t=0){this._platformLocation.historyGo?.(t)}static{this.\u0275fac=function(r){return new(r||n)(Ee(sS),Ee(k2,8))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})(),aS=(()=>{class n{constructor(t){this._subject=new ur,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=t;const r=this._locationStrategy.getBaseHref();this._basePath=function kZ(n){if(new RegExp("^(https?:)?//").test(n)){const[,t]=n.split(/\/\/[^\/]+/);return t}return n}(M2(F2(r))),this._locationStrategy.onPopState(i=>{this._subject.emit({url:this.path(!0),pop:!0,state:i.state,type:i.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(t=!1){return this.normalize(this._locationStrategy.path(t))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(t,r=""){return this.path()==this.normalize(t+Va(r))}normalize(t){return n.stripTrailingSlash(function MZ(n,e){if(!n||!e.startsWith(n))return e;const t=e.substring(n.length);return""===t||["/",";","?","#"].includes(t[0])?t:e}(this._basePath,F2(t)))}prepareExternalUrl(t){return t&&"/"!==t[0]&&(t="/"+t),this._locationStrategy.prepareExternalUrl(t)}go(t,r="",i=null){this._locationStrategy.pushState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Va(r)),i)}replaceState(t,r="",i=null){this._locationStrategy.replaceState(i,"",t,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(t+Va(r)),i)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(t=0){this._locationStrategy.historyGo?.(t)}onUrlChange(t){return this._urlChangeListeners.push(t),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)})),()=>{const r=this._urlChangeListeners.indexOf(t);this._urlChangeListeners.splice(r,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(t="",r){this._urlChangeListeners.forEach(i=>i(t,r))}subscribe(t,r,i){return this._subject.subscribe({next:t,error:r,complete:i})}static{this.normalizeQueryParams=Va}static{this.joinWithSlash=oS}static{this.stripTrailingSlash=M2}static{this.\u0275fac=function(r){return new(r||n)(Ee(fc))}}static{this.\u0275prov=Be({token:n,factory:function(){return function NZ(){return new aS(Ee(fc))}()},providedIn:"root"})}}return n})();function F2(n){return n.replace(/\/index.html$/,"")}function W2(n,e){e=encodeURIComponent(e);for(const t of n.split(";")){const r=t.indexOf("="),[i,s]=-1==r?[t,""]:[t.slice(0,r),t.slice(r+1)];if(i.trim()===e)return decodeURIComponent(s)}return null}class Eee{constructor(e,t,r,i){this.$implicit=e,this.ngForOf=t,this.index=r,this.count=i}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let K2=(()=>{class n{set ngForOf(t){this._ngForOf=t,this._ngForOfDirty=!0}set ngForTrackBy(t){this._trackByFn=t}get ngForTrackBy(){return this._trackByFn}constructor(t,r,i){this._viewContainer=t,this._template=r,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(t){t&&(this._template=t)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const t=this._ngForOf;!this._differ&&t&&(this._differ=this._differs.find(t).create(this.ngForTrackBy))}if(this._differ){const t=this._differ.diff(this._ngForOf);t&&this._applyChanges(t)}}_applyChanges(t){const r=this._viewContainer;t.forEachOperation((i,s,o)=>{if(null==i.previousIndex)r.createEmbeddedView(this._template,new Eee(i.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)r.remove(null===s?void 0:s);else if(null!==s){const a=r.get(s);r.move(a,o),Q2(a,i)}});for(let i=0,s=r.length;i<s;i++){const a=r.get(i).context;a.index=i,a.count=s,a.ngForOf=this._ngForOf}t.forEachIdentityChange(i=>{Q2(r.get(i.currentIndex),i)})}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||n)(_e(yo),_e(Fa),_e(oI))}}static{this.\u0275dir=Ye({type:n,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}}return n})();function Q2(n,e){n.context.$implicit=e.item}let yI=(()=>{class n{constructor(t,r){this._viewContainer=t,this._context=new Iee,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(t){this._context.$implicit=this._context.ngIf=t,this._updateView()}set ngIfThen(t){Y2("ngIfThen",t),this._thenTemplateRef=t,this._thenViewRef=null,this._updateView()}set ngIfElse(t){Y2("ngIfElse",t),this._elseTemplateRef=t,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(t,r){return!0}static{this.\u0275fac=function(r){return new(r||n)(_e(yo),_e(Fa))}}static{this.\u0275dir=Ye({type:n,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}}return n})();class Iee{constructor(){this.$implicit=null,this.ngIf=null}}function Y2(n,e){if(e&&!e.createEmbeddedView)throw new Error(`${n} must be a TemplateRef, but received '${be(e)}'.`)}let X2=(()=>{class n{constructor(t,r,i){this._ngEl=t,this._differs=r,this._renderer=i,this._ngStyle=null,this._differ=null}set ngStyle(t){this._ngStyle=t,!this._differ&&t&&(this._differ=this._differs.find(t).create())}ngDoCheck(){if(this._differ){const t=this._differ.diff(this._ngStyle);t&&this._applyChanges(t)}}_setStyle(t,r){const[i,s]=t.split("."),o=-1===i.indexOf("-")?void 0:wl.DashCase;null!=r?this._renderer.setStyle(this._ngEl.nativeElement,i,s?`${r}${s}`:r,o):this._renderer.removeStyle(this._ngEl.nativeElement,i,o)}_applyChanges(t){t.forEachRemovedItem(r=>this._setStyle(r.key,null)),t.forEachAddedItem(r=>this._setStyle(r.key,r.currentValue)),t.forEachChangedItem(r=>this._setStyle(r.key,r.currentValue))}static{this.\u0275fac=function(r){return new(r||n)(_e(Is),_e(tm),_e(Na))}}static{this.\u0275dir=Ye({type:n,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}}return n})(),qee=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ei({type:n})}static{this.\u0275inj=pi({})}}return n})();function vI(n){return"server"===n}let Jee=(()=>{class n{static{this.\u0275prov=Be({token:n,providedIn:"root",factory:()=>new Xee(Ee(Cs),window)})}}return n})();class Xee{constructor(e,t){this.document=e,this.window=t,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const t=function Zee(n,e){const t=n.getElementById(e)||n.getElementsByName(e)[0];if(t)return t;if("function"==typeof n.createTreeWalker&&n.body&&"function"==typeof n.body.attachShadow){const r=n.createTreeWalker(n.body,NodeFilter.SHOW_ELEMENT);let i=r.currentNode;for(;i;){const s=i.shadowRoot;if(s){const o=s.getElementById(e)||s.querySelector(`[name="${e}"]`);if(o)return o}i=r.nextNode()}}return null}(this.document,e);t&&(this.scrollToElement(t),t.focus())}setHistoryScrollRestoration(e){this.supportsScrolling()&&(this.window.history.scrollRestoration=e)}scrollToElement(e){const t=e.getBoundingClientRect(),r=t.left+this.window.pageXOffset,i=t.top+this.window.pageYOffset,s=this.offset();this.window.scrollTo(r-s[0],i-s[1])}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}class tU{}class wte extends DZ{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class TS extends wte{static makeCurrent(){!function SZ(n){iS||(iS=n)}(new TS)}onAndCancel(e,t,r){return e.addEventListener(t,r),()=>{e.removeEventListener(t,r)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}getBaseHref(e){const t=function Cte(){return sm=sm||document.querySelector("base"),sm?sm.getAttribute("href"):null}();return null==t?null:function Tte(n){wI=wI||document.createElement("a"),wI.setAttribute("href",n);const e=wI.pathname;return"/"===e.charAt(0)?e:`/${e}`}(t)}resetBaseElement(){sm=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return W2(document.cookie,e)}}let wI,sm=null,bte=(()=>{class n{build(){return new XMLHttpRequest}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();const AS=new we("EventManagerPlugins");let oU=(()=>{class n{constructor(t,r){this._zone=r,this._eventNameToPlugin=new Map,t.forEach(i=>{i.manager=this}),this._plugins=t.slice().reverse()}addEventListener(t,r,i){return this._findPluginFor(r).addEventListener(t,r,i)}getZone(){return this._zone}_findPluginFor(t){let r=this._eventNameToPlugin.get(t);if(r)return r;if(r=this._plugins.find(s=>s.supports(t)),!r)throw new pe(5101,!1);return this._eventNameToPlugin.set(t,r),r}static{this.\u0275fac=function(r){return new(r||n)(Ee(AS),Ee(Xt))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();class aU{constructor(e){this._doc=e}}const bS="ng-app-id";let lU=(()=>{class n{constructor(t,r,i,s={}){this.doc=t,this.appId=r,this.nonce=i,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=vI(s),this.resetHostNodes()}addStyles(t){for(const r of t)1===this.changeUsageCount(r,1)&&this.onStyleAdded(r)}removeStyles(t){for(const r of t)this.changeUsageCount(r,-1)<=0&&this.onStyleRemoved(r)}ngOnDestroy(){const t=this.styleNodesInDOM;t&&(t.forEach(r=>r.remove()),t.clear());for(const r of this.getAllStyles())this.onStyleRemoved(r);this.resetHostNodes()}addHost(t){this.hostNodes.add(t);for(const r of this.getAllStyles())this.addStyleToHost(t,r)}removeHost(t){this.hostNodes.delete(t)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(t){for(const r of this.hostNodes)this.addStyleToHost(r,t)}onStyleRemoved(t){const r=this.styleRef;r.get(t)?.elements?.forEach(i=>i.remove()),r.delete(t)}collectServerRenderedStyles(){const t=this.doc.head?.querySelectorAll(`style[${bS}="${this.appId}"]`);if(t?.length){const r=new Map;return t.forEach(i=>{null!=i.textContent&&r.set(i.textContent,i)}),r}return null}changeUsageCount(t,r){const i=this.styleRef;if(i.has(t)){const s=i.get(t);return s.usage+=r,s.usage}return i.set(t,{usage:r,elements:[]}),r}getStyleElement(t,r){const i=this.styleNodesInDOM,s=i?.get(r);if(s?.parentNode===t)return i.delete(r),s.removeAttribute(bS),s;{const o=this.doc.createElement("style");return this.nonce&&o.setAttribute("nonce",this.nonce),o.textContent=r,this.platformIsServer&&o.setAttribute(bS,this.appId),o}}addStyleToHost(t,r){const i=this.getStyleElement(t,r);t.appendChild(i);const s=this.styleRef,o=s.get(r)?.elements;o?o.push(i):s.set(r,{elements:[i],usage:1})}resetHostNodes(){const t=this.hostNodes;t.clear(),t.add(this.doc.head)}static{this.\u0275fac=function(r){return new(r||n)(Ee(Cs),Ee(TE),Ee(fO,8),Ee(zo))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();const SS={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},DS=/%COMP%/g,xte=new we("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function cU(n,e){return e.map(t=>t.replace(DS,n))}let dU=(()=>{class n{constructor(t,r,i,s,o,a,l,u=null){this.eventManager=t,this.sharedStylesHost=r,this.appId=i,this.removeStylesOnCompDestroy=s,this.doc=o,this.platformId=a,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=vI(a),this.defaultRenderer=new RS(t,o,l,this.platformIsServer)}createRenderer(t,r){if(!t||!r)return this.defaultRenderer;this.platformIsServer&&r.encapsulation===Br.ShadowDom&&(r={...r,encapsulation:Br.Emulated});const i=this.getOrCreateRenderer(t,r);return i instanceof fU?i.applyToHost(t):i instanceof xS&&i.applyStyles(),i}getOrCreateRenderer(t,r){const i=this.rendererByCompId;let s=i.get(r.id);if(!s){const o=this.doc,a=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,d=this.removeStylesOnCompDestroy,p=this.platformIsServer;switch(r.encapsulation){case Br.Emulated:s=new fU(l,u,r,this.appId,d,o,a,p);break;case Br.ShadowDom:return new kte(l,u,t,r,o,a,this.nonce,p);default:s=new xS(l,u,r,d,o,a,p)}i.set(r.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}static{this.\u0275fac=function(r){return new(r||n)(Ee(oU),Ee(lU),Ee(TE),Ee(xte),Ee(Cs),Ee(zo),Ee(Xt),Ee(fO))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();class RS{constructor(e,t,r,i){this.eventManager=e,this.doc=t,this.ngZone=r,this.platformIsServer=i,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(SS[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(hU(e)?e.content:e).appendChild(t)}insertBefore(e,t,r){e&&(hU(e)?e.content:e).insertBefore(t,r)}removeChild(e,t){e&&e.removeChild(t)}selectRootElement(e,t){let r="string"==typeof e?this.doc.querySelector(e):e;if(!r)throw new pe(-5104,!1);return t||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,r,i){if(i){t=i+":"+t;const s=SS[i];s?e.setAttributeNS(s,t,r):e.setAttribute(t,r)}else e.setAttribute(t,r)}removeAttribute(e,t,r){if(r){const i=SS[r];i?e.removeAttributeNS(i,t):e.removeAttribute(`${r}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,r,i){i&(wl.DashCase|wl.Important)?e.style.setProperty(t,r,i&wl.Important?"important":""):e.style[t]=r}removeStyle(e,t,r){r&wl.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,r){e[t]=r}setValue(e,t){e.nodeValue=t}listen(e,t,r){if("string"==typeof e&&!(e=xl().getGlobalEventTarget(this.doc,e)))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(r))}decoratePreventDefault(e){return t=>{if("__ngUnwrap__"===t)return e;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))&&t.preventDefault()}}}function hU(n){return"TEMPLATE"===n.tagName&&void 0!==n.content}class kte extends RS{constructor(e,t,r,i,s,o,a,l){super(e,s,o,l),this.sharedStylesHost=t,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=cU(i.id,i.styles);for(const d of u){const p=document.createElement("style");a&&p.setAttribute("nonce",a),p.textContent=d,this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,r){return super.insertBefore(this.nodeOrShadowRoot(e),t,r)}removeChild(e,t){return super.removeChild(this.nodeOrShadowRoot(e),t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class xS extends RS{constructor(e,t,r,i,s,o,a,l){super(e,s,o,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=l?cU(l,r.styles):r.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class fU extends xS{constructor(e,t,r,i,s,o,a,l){const u=i+"-"+r.id;super(e,t,r,s,o,a,l,u),this.contentAttr=function Pte(n){return"_ngcontent-%COMP%".replace(DS,n)}(u),this.hostAttr=function Nte(n){return"_nghost-%COMP%".replace(DS,n)}(u)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){const r=super.createElement(e,t);return super.setAttribute(r,this.contentAttr,""),r}}let Ote=(()=>{class n extends aU{constructor(t){super(t)}supports(t){return!0}addEventListener(t,r,i){return t.addEventListener(r,i,!1),()=>this.removeEventListener(t,r,i)}removeEventListener(t,r,i){return t.removeEventListener(r,i)}static{this.\u0275fac=function(r){return new(r||n)(Ee(Cs))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();const pU=["alt","control","meta","shift"],Fte={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Lte={alt:n=>n.altKey,control:n=>n.ctrlKey,meta:n=>n.metaKey,shift:n=>n.shiftKey};let Vte=(()=>{class n extends aU{constructor(t){super(t)}supports(t){return null!=n.parseEventName(t)}addEventListener(t,r,i){const s=n.parseEventName(r),o=n.eventCallback(s.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>xl().onAndCancel(t,s.domEventName,o))}static parseEventName(t){const r=t.toLowerCase().split("."),i=r.shift();if(0===r.length||"keydown"!==i&&"keyup"!==i)return null;const s=n._normalizeKey(r.pop());let o="",a=r.indexOf("code");if(a>-1&&(r.splice(a,1),o="code."),pU.forEach(u=>{const d=r.indexOf(u);d>-1&&(r.splice(d,1),o+=u+".")}),o+=s,0!=r.length||0===s.length)return null;const l={};return l.domEventName=i,l.fullKey=o,l}static matchEventFullKeyCode(t,r){let i=Fte[t.key]||t.key,s="";return r.indexOf("code.")>-1&&(i=t.code,s="code."),!(null==i||!i)&&(i=i.toLowerCase()," "===i?i="space":"."===i&&(i="dot"),pU.forEach(o=>{o!==i&&(0,Lte[o])(t)&&(s+=o+".")}),s+=i,s===r)}static eventCallback(t,r,i){return s=>{n.matchEventFullKeyCode(s,t)&&i.runGuarded(()=>r(s))}}static _normalizeKey(t){return"esc"===t?"escape":t}static{this.\u0275fac=function(r){return new(r||n)(Ee(Cs))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();const $te=s2(fZ,"browser",[{provide:zo,useValue:"browser"},{provide:hO,useValue:function Ute(){TS.makeCurrent()},multi:!0},{provide:Cs,useFactory:function jte(){return function _5(n){yA=n}(document),document},deps:[]}]),Hte=new we(""),_U=[{provide:tI,useClass:class Ate{addToWindow(e){un.getAngularTestability=(r,i=!0)=>{const s=e.findTestabilityInTree(r,i);if(null==s)throw new pe(5103,!1);return s},un.getAllAngularTestabilities=()=>e.getAllTestabilities(),un.getAllAngularRootElements=()=>e.getAllRootElements(),un.frameworkStabilizers||(un.frameworkStabilizers=[]),un.frameworkStabilizers.push(r=>{const i=un.getAllAngularTestabilities();let s=i.length,o=!1;const a=function(l){o=o||l,s--,0==s&&r(o)};i.forEach(l=>{l.whenStable(a)})})}findTestabilityInTree(e,t,r){return null==t?null:e.getTestability(t)??(r?xl().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null)}},deps:[]},{provide:e2,useClass:qb,deps:[Xt,Kb,tI]},{provide:qb,useClass:qb,deps:[Xt,Kb,tI]}],yU=[{provide:SA,useValue:"root"},{provide:Ma,useFactory:function Bte(){return new Ma},deps:[]},{provide:AS,useClass:Ote,multi:!0,deps:[Cs,Xt,zo]},{provide:AS,useClass:Vte,multi:!0,deps:[Cs]},dU,lU,oU,{provide:vO,useExisting:dU},{provide:tU,useClass:bte,deps:[]},[]];let zte=(()=>{class n{constructor(t){}static withServerTransition(t){return{ngModule:n,providers:[{provide:TE,useValue:t.appId}]}}static{this.\u0275fac=function(r){return new(r||n)(Ee(Hte,12))}}static{this.\u0275mod=ei({type:n})}static{this.\u0275inj=pi({providers:[...yU,..._U],imports:[qee,pZ]})}}return n})(),vU=(()=>{class n{constructor(t){this._doc=t}getTitle(){return this._doc.title}setTitle(t){this._doc.title=t||""}static{this.\u0275fac=function(r){return new(r||n)(Ee(Cs))}}static{this.\u0275prov=Be({token:n,factory:function(r){let i=null;return i=r?new r:function Gte(){return new vU(Ee(Cs))}(),i},providedIn:"root"})}}return n})();typeof window<"u"&&window;const{isArray:Xte}=Array,{getPrototypeOf:Zte,prototype:ene,keys:tne}=Object;function CU(n){if(1===n.length){const e=n[0];if(Xte(e))return{args:e,keys:null};if(function nne(n){return n&&"object"==typeof n&&Zte(n)===ene}(e)){const t=tne(e);return{args:t.map(r=>e[r]),keys:t}}}return{args:n,keys:null}}const{isArray:rne}=Array;function TU(n){return de(e=>function ine(n,e){return rne(e)?n(...e):n(e)}(n,e))}function AU(n,e){return n.reduce((t,r,i)=>(t[r]=e[i],t),{})}function NS(...n){const e=es(n),t=fs(n),{args:r,keys:i}=CU(n);if(0===r.length)return C([],e);const s=new lt(function sne(n,e,t=At){return r=>{bU(e,()=>{const{length:i}=n,s=new Array(i);let o=i,a=i;for(let l=0;l<i;l++)bU(e,()=>{const u=C(n[l],e);let d=!1;u.subscribe(re(r,p=>{s[l]=p,d||(d=!0,a--),a||r.next(t(s.slice()))},()=>{--o||r.complete()}))},r)},r)}}(r,e,i?o=>AU(i,o):At));return t?s.pipe(TU(t)):s}function bU(n,e,t){n?mr(t,n,e):e()}const CI=Ae(n=>function(){n(this),this.name="EmptyError",this.message="no elements in sequence"});function MS(...n){return function one(){return wr(1)}()(C(n,es(n)))}function SU(n){return new lt(e=>{Ut(n()).subscribe(e)})}function om(n,e){const t=x(n)?n:()=>n,r=i=>i.error(t());return new lt(e?i=>e.schedule(r,0,i):r)}function kS(){return $((n,e)=>{let t=null;n._refCount++;const r=re(e,void 0,void 0,void 0,()=>{if(!n||n._refCount<=0||0<--n._refCount)return void(t=null);const i=n._connection,s=t;t=null,i&&(!s||i===s)&&i.unsubscribe(),e.unsubscribe()});n.subscribe(r),r.closed||(t=n.connect())})}class DU extends lt{constructor(e,t){super(),this.source=e,this.subjectFactory=t,this._subject=null,this._refCount=0,this._connection=null,Q(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,e?.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new Nt;const t=this.getSubject();e.add(this.source.subscribe(re(t,void 0,()=>{this._teardown(),t.complete()},r=>{this._teardown(),t.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=Nt.EMPTY)}return e}refCount(){return kS()(this)}}function Nh(n){return n<=0?()=>qn:$((e,t)=>{let r=0;e.subscribe(re(t,i=>{++r<=n&&(t.next(i),n<=r&&t.complete())}))})}function TI(...n){const e=es(n);return $((t,r)=>{(e?MS(n,t,e):MS(n,t)).subscribe(r)})}function Ks(n,e){return $((t,r)=>{let i=0;t.subscribe(re(r,s=>n.call(e,s,i++)&&r.next(s)))})}function AI(n){return $((e,t)=>{let r=!1;e.subscribe(re(t,i=>{r=!0,t.next(i)},()=>{r||t.next(n),t.complete()}))})}function RU(n=ane){return $((e,t)=>{let r=!1;e.subscribe(re(t,i=>{r=!0,t.next(i)},()=>r?t.complete():t.error(n())))})}function ane(){return new CI}function Nl(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Ks((i,s)=>n(i,s,r)):At,Nh(1),t?AI(e):RU(()=>new CI))}function Mh(n,e){return x(e)?On(n,e,1):On(n,1)}function oi(n,e,t){const r=x(n)||e||t?{next:n,error:e,complete:t}:n;return r?$((i,s)=>{var o;null===(o=r.subscribe)||void 0===o||o.call(r);let a=!0;i.subscribe(re(s,l=>{var u;null===(u=r.next)||void 0===u||u.call(r,l),s.next(l)},()=>{var l;a=!1,null===(l=r.complete)||void 0===l||l.call(r),s.complete()},l=>{var u;a=!1,null===(u=r.error)||void 0===u||u.call(r,l),s.error(l)},()=>{var l,u;a&&(null===(l=r.unsubscribe)||void 0===l||l.call(r)),null===(u=r.finalize)||void 0===u||u.call(r)}))}):At}function pc(n){return $((e,t)=>{let s,r=null,i=!1;r=e.subscribe(re(t,void 0,void 0,o=>{s=Ut(n(o,pc(n)(e))),r?(r.unsubscribe(),r=null,s.subscribe(t)):i=!0})),i&&(r.unsubscribe(),r=null,s.subscribe(t))})}function bI(n,e){return $(function lne(n,e,t,r,i){return(s,o)=>{let a=t,l=e,u=0;s.subscribe(re(o,d=>{const p=u++;l=a?n(l,d,p):(a=!0,d),r&&o.next(l)},i&&(()=>{a&&o.next(l),o.complete()})))}}(n,e,arguments.length>=2,!0))}function OS(n){return n<=0?()=>qn:$((e,t)=>{let r=[];e.subscribe(re(t,i=>{r.push(i),n<r.length&&r.shift()},()=>{for(const i of r)t.next(i);t.complete()},void 0,()=>{r=null}))})}function am(n){return $((e,t)=>{try{e.subscribe(t)}finally{t.add(n)}})}const ft="primary",lm=Symbol("RouteTitle");class hne{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){const t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}}function kh(n){return new hne(n)}function fne(n,e,t){const r=t.path.split("/");if(r.length>n.length||"full"===t.pathMatch&&(e.hasChildren()||r.length<n.length))return null;const i={};for(let s=0;s<r.length;s++){const o=r[s],a=n[s];if(o.startsWith(":"))i[o.substring(1)]=a;else if(o!==a.path)return null}return{consumed:n.slice(0,r.length),posParams:i}}function Jo(n,e){const t=n?Object.keys(n):void 0,r=e?Object.keys(e):void 0;if(!t||!r||t.length!=r.length)return!1;let i;for(let s=0;s<t.length;s++)if(i=t[s],!xU(n[i],e[i]))return!1;return!0}function xU(n,e){if(Array.isArray(n)&&Array.isArray(e)){if(n.length!==e.length)return!1;const t=[...n].sort(),r=[...e].sort();return t.every((i,s)=>r[s]===i)}return n===e}function PU(n){return n.length>0?n[n.length-1]:null}function Ml(n){return function Jte(n){return!!n&&(n instanceof lt||x(n.lift)&&x(n.subscribe))}(n)?n:zg(n)?C(Promise.resolve(n)):R(n)}const gne={exact:function kU(n,e,t){if(!gc(n.segments,e.segments)||!SI(n.segments,e.segments,t)||n.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!n.children[r]||!kU(n.children[r],e.children[r],t))return!1;return!0},subset:OU},NU={exact:function mne(n,e){return Jo(n,e)},subset:function _ne(n,e){return Object.keys(e).length<=Object.keys(n).length&&Object.keys(e).every(t=>xU(n[t],e[t]))},ignored:()=>!0};function MU(n,e,t){return gne[t.paths](n.root,e.root,t.matrixParams)&&NU[t.queryParams](n.queryParams,e.queryParams)&&!("exact"===t.fragment&&n.fragment!==e.fragment)}function OU(n,e,t){return FU(n,e,e.segments,t)}function FU(n,e,t,r){if(n.segments.length>t.length){const i=n.segments.slice(0,t.length);return!(!gc(i,t)||e.hasChildren()||!SI(i,t,r))}if(n.segments.length===t.length){if(!gc(n.segments,t)||!SI(n.segments,t,r))return!1;for(const i in e.children)if(!n.children[i]||!OU(n.children[i],e.children[i],r))return!1;return!0}{const i=t.slice(0,n.segments.length),s=t.slice(n.segments.length);return!!(gc(n.segments,i)&&SI(n.segments,i,r)&&n.children[ft])&&FU(n.children[ft],e,s,r)}}function SI(n,e,t){return e.every((r,i)=>NU[t](n[i].parameters,r.parameters))}class Oh{constructor(e=new an([],{}),t={},r=null){this.root=e,this.queryParams=t,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=kh(this.queryParams)),this._queryParamMap}toString(){return Ene.serialize(this)}}class an{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(r=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return DI(this)}}class um{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap||(this._parameterMap=kh(this.parameters)),this._parameterMap}toString(){return UU(this)}}function gc(n,e){return n.length===e.length&&n.every((t,r)=>t.path===e[r].path)}let cm=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:function(){return new FS},providedIn:"root"})}}return n})();class FS{parse(e){const t=new Pne(e);return new Oh(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){const t=`/${dm(e.root,!0)}`,r=function Cne(n){const e=Object.keys(n).map(t=>{const r=n[t];return Array.isArray(r)?r.map(i=>`${RI(t)}=${RI(i)}`).join("&"):`${RI(t)}=${RI(r)}`}).filter(t=>!!t);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${t}${r}${"string"==typeof e.fragment?`#${function Ine(n){return encodeURI(n)}(e.fragment)}`:""}`}}const Ene=new FS;function DI(n){return n.segments.map(e=>UU(e)).join("/")}function dm(n,e){if(!n.hasChildren())return DI(n);if(e){const t=n.children[ft]?dm(n.children[ft],!1):"",r=[];return Object.entries(n.children).forEach(([i,s])=>{i!==ft&&r.push(`${i}:${dm(s,!1)}`)}),r.length>0?`${t}(${r.join("//")})`:t}{const t=function vne(n,e){let t=[];return Object.entries(n.children).forEach(([r,i])=>{r===ft&&(t=t.concat(e(i,r)))}),Object.entries(n.children).forEach(([r,i])=>{r!==ft&&(t=t.concat(e(i,r)))}),t}(n,(r,i)=>i===ft?[dm(n.children[ft],!1)]:[`${i}:${dm(r,!1)}`]);return 1===Object.keys(n.children).length&&null!=n.children[ft]?`${DI(n)}/${t[0]}`:`${DI(n)}/(${t.join("//")})`}}function LU(n){return encodeURIComponent(n).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function RI(n){return LU(n).replace(/%3B/gi,";")}function LS(n){return LU(n).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function xI(n){return decodeURIComponent(n)}function VU(n){return xI(n.replace(/\+/g,"%20"))}function UU(n){return`${LS(n.path)}${function wne(n){return Object.keys(n).map(e=>`;${LS(e)}=${LS(n[e])}`).join("")}(n.parameters)}`}const Tne=/^[^\/()?;#]+/;function VS(n){const e=n.match(Tne);return e?e[0]:""}const Ane=/^[^\/()?;=#]+/,Sne=/^[^=?&#]+/,Rne=/^[^&#]+/;class Pne{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new an([],{}):new an([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(r[ft]=new an(e,t)),r}parseSegment(){const e=VS(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new pe(4009,!1);return this.capture(e),new um(xI(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const t=function bne(n){const e=n.match(Ane);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const i=VS(this.remaining);i&&(r=i,this.capture(r))}e[xI(t)]=xI(r)}parseQueryParam(e){const t=function Dne(n){const e=n.match(Sne);return e?e[0]:""}(this.remaining);if(!t)return;this.capture(t);let r="";if(this.consumeOptional("=")){const o=function xne(n){const e=n.match(Rne);return e?e[0]:""}(this.remaining);o&&(r=o,this.capture(r))}const i=VU(t),s=VU(r);if(e.hasOwnProperty(i)){let o=e[i];Array.isArray(o)||(o=[o],e[i]=o),o.push(s)}else e[i]=s}parseParens(e){const t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=VS(this.remaining),i=this.remaining[r.length];if("/"!==i&&")"!==i&&";"!==i)throw new pe(4010,!1);let s;r.indexOf(":")>-1?(s=r.slice(0,r.indexOf(":")),this.capture(s),this.capture(":")):e&&(s=ft);const o=this.parseChildren();t[s]=1===Object.keys(o).length?o[ft]:new an([],o),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new pe(4011,!1)}}function BU(n){return n.segments.length>0?new an([],{[ft]:n}):n}function jU(n){const e={};for(const r of Object.keys(n.children)){const s=jU(n.children[r]);if(r===ft&&0===s.segments.length&&s.hasChildren())for(const[o,a]of Object.entries(s.children))e[o]=a;else(s.segments.length>0||s.hasChildren())&&(e[r]=s)}return function Nne(n){if(1===n.numberOfChildren&&n.children[ft]){const e=n.children[ft];return new an(n.segments.concat(e.segments),e.children)}return n}(new an(n.segments,e))}function mc(n){return n instanceof Oh}function $U(n){let e;const i=BU(function t(s){const o={};for(const l of s.children){const u=t(l);o[l.outlet]=u}const a=new an(s.url,o);return s===n&&(e=a),a}(n.root));return e??i}function HU(n,e,t,r){let i=n;for(;i.parent;)i=i.parent;if(0===e.length)return US(i,i,i,t,r);const s=function kne(n){if("string"==typeof n[0]&&1===n.length&&"/"===n[0])return new WU(!0,0,n);let e=0,t=!1;const r=n.reduce((i,s,o)=>{if("object"==typeof s&&null!=s){if(s.outlets){const a={};return Object.entries(s.outlets).forEach(([l,u])=>{a[l]="string"==typeof u?u.split("/"):u}),[...i,{outlets:a}]}if(s.segmentPath)return[...i,s.segmentPath]}return"string"!=typeof s?[...i,s]:0===o?(s.split("/").forEach((a,l)=>{0==l&&"."===a||(0==l&&""===a?t=!0:".."===a?e++:""!=a&&i.push(a))}),i):[...i,s]},[]);return new WU(t,e,r)}(e);if(s.toRoot())return US(i,i,new an([],{}),t,r);const o=function One(n,e,t){if(n.isAbsolute)return new NI(e,!0,0);if(!t)return new NI(e,!1,NaN);if(null===t.parent)return new NI(t,!0,0);const r=PI(n.commands[0])?0:1;return function Fne(n,e,t){let r=n,i=e,s=t;for(;s>i;){if(s-=i,r=r.parent,!r)throw new pe(4005,!1);i=r.segments.length}return new NI(r,!1,i-s)}(t,t.segments.length-1+r,n.numberOfDoubleDots)}(s,i,n),a=o.processChildren?fm(o.segmentGroup,o.index,s.commands):GU(o.segmentGroup,o.index,s.commands);return US(i,o.segmentGroup,a,t,r)}function PI(n){return"object"==typeof n&&null!=n&&!n.outlets&&!n.segmentPath}function hm(n){return"object"==typeof n&&null!=n&&n.outlets}function US(n,e,t,r,i){let o,s={};r&&Object.entries(r).forEach(([l,u])=>{s[l]=Array.isArray(u)?u.map(d=>`${d}`):`${u}`}),o=n===e?t:zU(n,e,t);const a=BU(jU(o));return new Oh(a,s,i)}function zU(n,e,t){const r={};return Object.entries(n.children).forEach(([i,s])=>{r[i]=s===e?t:zU(s,e,t)}),new an(n.segments,r)}class WU{constructor(e,t,r){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=r,e&&r.length>0&&PI(r[0]))throw new pe(4003,!1);const i=r.find(hm);if(i&&i!==PU(r))throw new pe(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class NI{constructor(e,t,r){this.segmentGroup=e,this.processChildren=t,this.index=r}}function GU(n,e,t){if(n||(n=new an([],{})),0===n.segments.length&&n.hasChildren())return fm(n,e,t);const r=function Vne(n,e,t){let r=0,i=e;const s={match:!1,pathIndex:0,commandIndex:0};for(;i<n.segments.length;){if(r>=t.length)return s;const o=n.segments[i],a=t[r];if(hm(a))break;const l=`${a}`,u=r<t.length-1?t[r+1]:null;if(i>0&&void 0===l)break;if(l&&u&&"object"==typeof u&&void 0===u.outlets){if(!KU(l,u,o))return s;r+=2}else{if(!KU(l,{},o))return s;r++}i++}return{match:!0,pathIndex:i,commandIndex:r}}(n,e,t),i=t.slice(r.commandIndex);if(r.match&&r.pathIndex<n.segments.length){const s=new an(n.segments.slice(0,r.pathIndex),{});return s.children[ft]=new an(n.segments.slice(r.pathIndex),n.children),fm(s,0,i)}return r.match&&0===i.length?new an(n.segments,{}):r.match&&!n.hasChildren()?BS(n,e,t):r.match?fm(n,0,i):BS(n,e,t)}function fm(n,e,t){if(0===t.length)return new an(n.segments,{});{const r=function Lne(n){return hm(n[0])?n[0].outlets:{[ft]:n}}(t),i={};if(Object.keys(r).some(s=>s!==ft)&&n.children[ft]&&1===n.numberOfChildren&&0===n.children[ft].segments.length){const s=fm(n.children[ft],e,t);return new an(n.segments,s.children)}return Object.entries(r).forEach(([s,o])=>{"string"==typeof o&&(o=[o]),null!==o&&(i[s]=GU(n.children[s],e,o))}),Object.entries(n.children).forEach(([s,o])=>{void 0===r[s]&&(i[s]=o)}),new an(n.segments,i)}}function BS(n,e,t){const r=n.segments.slice(0,e);let i=0;for(;i<t.length;){const s=t[i];if(hm(s)){const l=Une(s.outlets);return new an(r,l)}if(0===i&&PI(t[0])){r.push(new um(n.segments[e].path,qU(t[0]))),i++;continue}const o=hm(s)?s.outlets[ft]:`${s}`,a=i<t.length-1?t[i+1]:null;o&&a&&PI(a)?(r.push(new um(o,qU(a))),i+=2):(r.push(new um(o,{})),i++)}return new an(r,{})}function Une(n){const e={};return Object.entries(n).forEach(([t,r])=>{"string"==typeof r&&(r=[r]),null!==r&&(e[t]=BS(new an([],{}),0,r))}),e}function qU(n){const e={};return Object.entries(n).forEach(([t,r])=>e[t]=`${r}`),e}function KU(n,e,t){return n==t.path&&Jo(e,t.parameters)}const pm="imperative";class Xo{constructor(e,t){this.id=e,this.url=t}}class MI extends Xo{constructor(e,t,r="imperative",i=null){super(e,t),this.type=0,this.navigationTrigger=r,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class kl extends Xo{constructor(e,t,r){super(e,t),this.urlAfterRedirects=r,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class gm extends Xo{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Fh extends Xo{constructor(e,t,r,i){super(e,t),this.reason=r,this.code=i,this.type=16}}class kI extends Xo{constructor(e,t,r,i){super(e,t),this.error=r,this.target=i,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class QU extends Xo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Bne extends Xo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class jne extends Xo{constructor(e,t,r,i,s){super(e,t),this.urlAfterRedirects=r,this.state=i,this.shouldActivate=s,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class $ne extends Xo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Hne extends Xo{constructor(e,t,r,i){super(e,t),this.urlAfterRedirects=r,this.state=i,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zne{constructor(e){this.route=e,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class Wne{constructor(e){this.route=e,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Gne{constructor(e){this.snapshot=e,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class qne{constructor(e){this.snapshot=e,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Kne{constructor(e){this.snapshot=e,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Qne{constructor(e){this.snapshot=e,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class YU{constructor(e,t,r){this.routerEvent=e,this.position=t,this.anchor=r,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class jS{}class $S{constructor(e){this.url=e}}class Yne{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new mm,this.attachRef=null}}let mm=(()=>{class n{constructor(){this.contexts=new Map}onChildOutletCreated(t,r){const i=this.getOrCreateContext(t);i.outlet=r,this.contexts.set(t,i)}onChildOutletDestroyed(t){const r=this.getContext(t);r&&(r.outlet=null,r.attachRef=null)}onOutletDeactivated(){const t=this.contexts;return this.contexts=new Map,t}onOutletReAttached(t){this.contexts=t}getOrCreateContext(t){let r=this.getContext(t);return r||(r=new Yne,this.contexts.set(t,r)),r}getContext(t){return this.contexts.get(t)||null}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();class JU{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){const t=HS(e,this._root);return t?t.children.map(r=>r.value):[]}firstChild(e){const t=HS(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){const t=zS(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return zS(e,this._root).map(t=>t.value)}}function HS(n,e){if(n===e.value)return e;for(const t of e.children){const r=HS(n,t);if(r)return r}return null}function zS(n,e){if(n===e.value)return[e];for(const t of e.children){const r=zS(n,t);if(r.length)return r.unshift(e),r}return[]}class ja{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}}function Lh(n){const e={};return n&&n.children.forEach(t=>e[t.value.outlet]=t),e}class XU extends JU{constructor(e,t){super(e),this.snapshot=t,WS(this,e)}toString(){return this.snapshot.toString()}}function ZU(n,e){const t=function Jne(n,e){const o=new OI([],{},{},"",{},ft,e,null,{});return new tB("",new ja(o,[]))}(0,e),r=new T([new um("",{})]),i=new T({}),s=new T({}),o=new T({}),a=new T(""),l=new Vh(r,i,o,a,s,ft,e,t.root);return l.snapshot=t.root,new XU(new ja(l,[]),t)}class Vh{constructor(e,t,r,i,s,o,a,l){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=r,this.fragmentSubject=i,this.dataSubject=s,this.outlet=o,this.component=a,this._futureSnapshot=l,this.title=this.dataSubject?.pipe(de(u=>u[lm]))??R(void 0),this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(de(e=>kh(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(de(e=>kh(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function eB(n,e="emptyOnly"){const t=n.pathFromRoot;let r=0;if("always"!==e)for(r=t.length-1;r>=1;){const i=t[r],s=t[r-1];if(i.routeConfig&&""===i.routeConfig.path)r--;else{if(s.component)break;r--}}return function Xne(n){return n.reduce((e,t)=>({params:{...e.params,...t.params},data:{...e.data,...t.data},resolve:{...t.data,...e.resolve,...t.routeConfig?.data,...t._resolvedData}}),{params:{},data:{},resolve:{}})}(t.slice(r))}class OI{get title(){return this.data?.[lm]}constructor(e,t,r,i,s,o,a,l,u){this.url=e,this.params=t,this.queryParams=r,this.fragment=i,this.data=s,this.outlet=o,this.component=a,this.routeConfig=l,this._resolve=u}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=kh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=kh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class tB extends JU{constructor(e,t){super(t),this.url=e,WS(this,t)}toString(){return nB(this._root)}}function WS(n,e){e.value._routerState=n,e.children.forEach(t=>WS(n,t))}function nB(n){const e=n.children.length>0?` { ${n.children.map(nB).join(", ")} } `:"";return`${n.value}${e}`}function GS(n){if(n.snapshot){const e=n.snapshot,t=n._futureSnapshot;n.snapshot=t,Jo(e.queryParams,t.queryParams)||n.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&n.fragmentSubject.next(t.fragment),Jo(e.params,t.params)||n.paramsSubject.next(t.params),function pne(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;++t)if(!Jo(n[t],e[t]))return!1;return!0}(e.url,t.url)||n.urlSubject.next(t.url),Jo(e.data,t.data)||n.dataSubject.next(t.data)}else n.snapshot=n._futureSnapshot,n.dataSubject.next(n._futureSnapshot.data)}function qS(n,e){const t=Jo(n.params,e.params)&&function yne(n,e){return gc(n,e)&&n.every((t,r)=>Jo(t.parameters,e[r].parameters))}(n.url,e.url);return t&&!(!n.parent!=!e.parent)&&(!n.parent||qS(n.parent,e.parent))}let KS=(()=>{class n{constructor(){this.activated=null,this._activatedRoute=null,this.name=ft,this.activateEvents=new ur,this.deactivateEvents=new ur,this.attachEvents=new ur,this.detachEvents=new ur,this.parentContexts=ke(mm),this.location=ke(yo),this.changeDetector=ke(rI),this.environmentInjector=ke(Es),this.inputBinder=ke(FI,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(t){if(t.name){const{firstChange:r,previousValue:i}=t.name;if(r)return;this.isTrackedInParentContexts(i)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(i)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(t){return this.parentContexts.getContext(t)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const t=this.parentContexts.getContext(this.name);t?.route&&(t.attachRef?this.attach(t.attachRef,t.route):this.activateWith(t.route,t.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new pe(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new pe(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new pe(4012,!1);this.location.detach();const t=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(t.instance),t}attach(t,r){this.activated=t,this._activatedRoute=r,this.location.insert(t.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(t.instance)}deactivate(){if(this.activated){const t=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(t)}}activateWith(t,r){if(this.isActivated)throw new pe(4013,!1);this._activatedRoute=t;const i=this.location,o=t.snapshot.component,a=this.parentContexts.getOrCreateContext(this.name).children,l=new Zne(t,a,i.injector);this.activated=i.createComponent(o,{index:i.length,injector:l,environmentInjector:r??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Ye({type:n,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[Ui]})}}return n})();class Zne{constructor(e,t,r){this.route=e,this.childContexts=t,this.parent=r}get(e,t){return e===Vh?this.route:e===mm?this.childContexts:this.parent.get(e,t)}}const FI=new we("");let rB=(()=>{class n{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(t){this.unsubscribeFromRouteData(t),this.subscribeToRouteData(t)}unsubscribeFromRouteData(t){this.outletDataSubscriptions.get(t)?.unsubscribe(),this.outletDataSubscriptions.delete(t)}subscribeToRouteData(t){const{activatedRoute:r}=t,i=NS([r.queryParams,r.params,r.data]).pipe(ye(([s,o,a],l)=>(a={...s,...o,...a},0===l?R(a):Promise.resolve(a)))).subscribe(s=>{if(!t.isActivated||!t.activatedComponentRef||t.activatedRoute!==r||null===r.component)return void this.unsubscribeFromRouteData(t);const o=function bZ(n){const e=St(n);if(!e)return null;const t=new Ug(e);return{get selector(){return t.selector},get type(){return t.componentType},get inputs(){return t.inputs},get outputs(){return t.outputs},get ngContentSelectors(){return t.ngContentSelectors},get isStandalone(){return e.standalone},get isSignal(){return e.signals}}}(r.component);if(o)for(const{templateName:a}of o.inputs)t.activatedComponentRef.setInput(a,s[a]);else this.unsubscribeFromRouteData(t)});this.outletDataSubscriptions.set(t,i)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();function _m(n,e,t){if(t&&n.shouldReuseRoute(e.value,t.value.snapshot)){const r=t.value;r._futureSnapshot=e.value;const i=function tre(n,e,t){return e.children.map(r=>{for(const i of t.children)if(n.shouldReuseRoute(r.value,i.value.snapshot))return _m(n,r,i);return _m(n,r)})}(n,e,t);return new ja(r,i)}{if(n.shouldAttach(e.value)){const s=n.retrieve(e.value);if(null!==s){const o=s.route;return o.value._futureSnapshot=e.value,o.children=e.children.map(a=>_m(n,a)),o}}const r=function nre(n){return new Vh(new T(n.url),new T(n.params),new T(n.queryParams),new T(n.fragment),new T(n.data),n.outlet,n.component,n)}(e.value),i=e.children.map(s=>_m(n,s));return new ja(r,i)}}const QS="ngNavigationCancelingError";function iB(n,e){const{redirectTo:t,navigationBehaviorOptions:r}=mc(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=sB(!1,0,e);return i.url=t,i.navigationBehaviorOptions=r,i}function sB(n,e,t){const r=new Error("NavigationCancelingError: "+(n||""));return r[QS]=!0,r.cancellationCode=e,t&&(r.url=t),r}function oB(n){return n&&n[QS]}let aB=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Zr({type:n,selectors:[["ng-component"]],standalone:!0,features:[iV],decls:1,vars:0,template:function(r,i){1&r&&Tr(0,"router-outlet")},dependencies:[KS],encapsulation:2})}}return n})();function YS(n){const e=n.children&&n.children.map(YS),t=e?{...n,children:e}:{...n};return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==ft&&(t.component=aB),t}function Io(n){return n.outlet||ft}function ym(n){if(!n)return null;if(n.routeConfig?._injector)return n.routeConfig._injector;for(let e=n.parent;e;e=e.parent){const t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}class cre{constructor(e,t,r,i,s){this.routeReuseStrategy=e,this.futureState=t,this.currState=r,this.forwardEvent=i,this.inputBindingEnabled=s}activate(e){const t=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,r,e),GS(this.futureState.root),this.activateChildRoutes(t,r,e)}deactivateChildRoutes(e,t,r){const i=Lh(t);e.children.forEach(s=>{const o=s.value.outlet;this.deactivateRoutes(s,i[o],r),delete i[o]}),Object.values(i).forEach(s=>{this.deactivateRouteAndItsChildren(s,r)})}deactivateRoutes(e,t,r){const i=e.value,s=t?t.value:null;if(i===s)if(i.component){const o=r.getContext(i.outlet);o&&this.deactivateChildRoutes(e,t,o.children)}else this.deactivateChildRoutes(e,t,r);else s&&this.deactivateRouteAndItsChildren(t,r)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Lh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);if(r&&r.outlet){const o=r.outlet.detach(),a=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:o,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){const r=t.getContext(e.value.outlet),i=r&&e.value.component?r.children:t,s=Lh(e);for(const o of Object.keys(s))this.deactivateRouteAndItsChildren(s[o],i);r&&(r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated()),r.attachRef=null,r.route=null)}activateChildRoutes(e,t,r){const i=Lh(t);e.children.forEach(s=>{this.activateRoutes(s,i[s.value.outlet],r),this.forwardEvent(new Qne(s.value.snapshot))}),e.children.length&&this.forwardEvent(new qne(e.value.snapshot))}activateRoutes(e,t,r){const i=e.value,s=t?t.value:null;if(GS(i),i===s)if(i.component){const o=r.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,o.children)}else this.activateChildRoutes(e,t,r);else if(i.component){const o=r.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){const a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),o.children.onOutletReAttached(a.contexts),o.attachRef=a.componentRef,o.route=a.route.value,o.outlet&&o.outlet.attach(a.componentRef,a.route.value),GS(a.route.value),this.activateChildRoutes(e,null,o.children)}else{const a=ym(i.snapshot);o.attachRef=null,o.route=i,o.injector=a,o.outlet&&o.outlet.activateWith(i,o.injector),this.activateChildRoutes(e,null,o.children)}}else this.activateChildRoutes(e,null,r)}}class lB{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class LI{constructor(e,t){this.component=e,this.route=t}}function dre(n,e,t){const r=n._root;return vm(r,e?e._root:null,t,[r.value])}function Uh(n,e){const t=Symbol(),r=e.get(n,t);return r===t?"function"!=typeof n||function Qy(n){return null!==Ed(n)}(n)?e.get(n):n:r}function vm(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=Lh(e);return n.children.forEach(o=>{(function fre(n,e,t,r,i={canDeactivateChecks:[],canActivateChecks:[]}){const s=n.value,o=e?e.value:null,a=t?t.getContext(n.value.outlet):null;if(o&&s.routeConfig===o.routeConfig){const l=function pre(n,e,t){if("function"==typeof t)return t(n,e);switch(t){case"pathParamsChange":return!gc(n.url,e.url);case"pathParamsOrQueryParamsChange":return!gc(n.url,e.url)||!Jo(n.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!qS(n,e)||!Jo(n.queryParams,e.queryParams);default:return!qS(n,e)}}(o,s,s.routeConfig.runGuardsAndResolvers);l?i.canActivateChecks.push(new lB(r)):(s.data=o.data,s._resolvedData=o._resolvedData),vm(n,e,s.component?a?a.children:null:t,r,i),l&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new LI(a.outlet.component,o))}else o&&Em(e,a,i),i.canActivateChecks.push(new lB(r)),vm(n,null,s.component?a?a.children:null:t,r,i)})(o,s[o.value.outlet],t,r.concat([o.value]),i),delete s[o.value.outlet]}),Object.entries(s).forEach(([o,a])=>Em(a,t.getContext(o),i)),i}function Em(n,e,t){const r=Lh(n),i=n.value;Object.entries(r).forEach(([s,o])=>{Em(o,i.component?e?e.children.getContext(s):null:e,t)}),t.canDeactivateChecks.push(new LI(i.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,i))}function Im(n){return"function"==typeof n}function uB(n){return n instanceof CI||"EmptyError"===n?.name}const VI=Symbol("INITIAL_VALUE");function Bh(){return ye(n=>NS(n.map(e=>e.pipe(Nh(1),TI(VI)))).pipe(de(e=>{for(const t of e)if(!0!==t){if(t===VI)return VI;if(!1===t||t instanceof Oh)return t}return!0}),Ks(e=>e!==VI),Nh(1)))}function cB(n){return function kn(...n){return sn(n)}(oi(e=>{if(mc(e))throw iB(0,e)}),de(e=>!0===e))}class UI{constructor(e){this.segmentGroup=e||null}}class dB{constructor(e){this.urlTree=e}}function jh(n){return om(new UI(n))}function hB(n){return om(new dB(n))}class kre{constructor(e,t){this.urlSerializer=e,this.urlTree=t}noMatchError(e){return new pe(4002,!1)}lineralizeSegments(e,t){let r=[],i=t.root;for(;;){if(r=r.concat(i.segments),0===i.numberOfChildren)return R(r);if(i.numberOfChildren>1||!i.children[ft])return om(new pe(4e3,!1));i=i.children[ft]}}applyRedirectCommands(e,t,r){return this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,r)}applyRedirectCreateUrlTree(e,t,r,i){const s=this.createSegmentGroup(e,t.root,r,i);return new Oh(s,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){const r={};return Object.entries(e).forEach(([i,s])=>{if("string"==typeof s&&s.startsWith(":")){const a=s.substring(1);r[i]=t[a]}else r[i]=s}),r}createSegmentGroup(e,t,r,i){const s=this.createSegments(e,t.segments,r,i);let o={};return Object.entries(t.children).forEach(([a,l])=>{o[a]=this.createSegmentGroup(e,l,r,i)}),new an(s,o)}createSegments(e,t,r,i){return t.map(s=>s.path.startsWith(":")?this.findPosParam(e,s,i):this.findOrReturn(s,r))}findPosParam(e,t,r){const i=r[t.path.substring(1)];if(!i)throw new pe(4001,!1);return i}findOrReturn(e,t){let r=0;for(const i of t){if(i.path===e.path)return t.splice(r),i;r++}return e}}const JS={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ore(n,e,t,r,i){const s=XS(n,e,t);return s.matched?(r=function ire(n,e){return n.providers&&!n._injector&&(n._injector=Rb(n.providers,e,`Route: ${n.path}`)),n._injector??e}(e,r),function Pre(n,e,t,r){const i=e.canMatch;return i&&0!==i.length?R(i.map(o=>{const a=Uh(o,n);return Ml(function Ere(n){return n&&Im(n.canMatch)}(a)?a.canMatch(e,t):n.runInContext(()=>a(e,t)))})).pipe(Bh(),cB()):R(!0)}(r,e,t).pipe(de(o=>!0===o?s:{...JS}))):R(s)}function XS(n,e,t){if(""===e.path)return"full"===e.pathMatch&&(n.hasChildren()||t.length>0)?{...JS}:{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};const i=(e.matcher||fne)(t,n,e);if(!i)return{...JS};const s={};Object.entries(i.posParams??{}).forEach(([a,l])=>{s[a]=l.path});const o=i.consumed.length>0?{...s,...i.consumed[i.consumed.length-1].parameters}:s;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:o,positionalParamSegments:i.posParams??{}}}function fB(n,e,t,r){return t.length>0&&function Vre(n,e,t){return t.some(r=>BI(n,e,r)&&Io(r)!==ft)}(n,t,r)?{segmentGroup:new an(e,Lre(r,new an(t,n.children))),slicedSegments:[]}:0===t.length&&function Ure(n,e,t){return t.some(r=>BI(n,e,r))}(n,t,r)?{segmentGroup:new an(n.segments,Fre(n,0,t,r,n.children)),slicedSegments:t}:{segmentGroup:new an(n.segments,n.children),slicedSegments:t}}function Fre(n,e,t,r,i){const s={};for(const o of r)if(BI(n,t,o)&&!i[Io(o)]){const a=new an([],{});s[Io(o)]=a}return{...i,...s}}function Lre(n,e){const t={};t[ft]=e;for(const r of n)if(""===r.path&&Io(r)!==ft){const i=new an([],{});t[Io(r)]=i}return t}function BI(n,e,t){return(!(n.hasChildren()||e.length>0)||"full"!==t.pathMatch)&&""===t.path}class Hre{constructor(e,t,r,i,s,o,a){this.injector=e,this.configLoader=t,this.rootComponentType=r,this.config=i,this.urlTree=s,this.paramsInheritanceStrategy=o,this.urlSerializer=a,this.allowRedirects=!0,this.applyRedirects=new kre(this.urlSerializer,this.urlTree)}noMatchError(e){return new pe(4002,!1)}recognize(){const e=fB(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,e,ft).pipe(pc(t=>{if(t instanceof dB)return this.allowRedirects=!1,this.urlTree=t.urlTree,this.match(t.urlTree);throw t instanceof UI?this.noMatchError(t):t}),de(t=>{const r=new OI([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},ft,this.rootComponentType,null,{}),i=new ja(r,t),s=new tB("",i),o=function Mne(n,e,t=null,r=null){return HU($U(n),e,t,r)}(r,[],this.urlTree.queryParams,this.urlTree.fragment);return o.queryParams=this.urlTree.queryParams,s.url=this.urlSerializer.serialize(o),this.inheritParamsAndData(s._root),{state:s,tree:o}}))}match(e){return this.processSegmentGroup(this.injector,this.config,e.root,ft).pipe(pc(r=>{throw r instanceof UI?this.noMatchError(r):r}))}inheritParamsAndData(e){const t=e.value,r=eB(t,this.paramsInheritanceStrategy);t.params=Object.freeze(r.params),t.data=Object.freeze(r.data),e.children.forEach(i=>this.inheritParamsAndData(i))}processSegmentGroup(e,t,r,i){return 0===r.segments.length&&r.hasChildren()?this.processChildren(e,t,r):this.processSegment(e,t,r,r.segments,i,!0)}processChildren(e,t,r){const i=[];for(const s of Object.keys(r.children))"primary"===s?i.unshift(s):i.push(s);return C(i).pipe(Mh(s=>{const o=r.children[s],a=function lre(n,e){const t=n.filter(r=>Io(r)===e);return t.push(...n.filter(r=>Io(r)!==e)),t}(t,s);return this.processSegmentGroup(e,a,o,s)}),bI((s,o)=>(s.push(...o),s)),AI(null),function une(n,e){const t=arguments.length>=2;return r=>r.pipe(n?Ks((i,s)=>n(i,s,r)):At,OS(1),t?AI(e):RU(()=>new CI))}(),On(s=>{if(null===s)return jh(r);const o=pB(s);return function zre(n){n.sort((e,t)=>e.value.outlet===ft?-1:t.value.outlet===ft?1:e.value.outlet.localeCompare(t.value.outlet))}(o),R(o)}))}processSegment(e,t,r,i,s,o){return C(t).pipe(Mh(a=>this.processSegmentAgainstRoute(a._injector??e,t,a,r,i,s,o).pipe(pc(l=>{if(l instanceof UI)return R(null);throw l}))),Nl(a=>!!a),pc(a=>{if(uB(a))return function jre(n,e,t){return 0===e.length&&!n.children[t]}(r,i,s)?R([]):jh(r);throw a}))}processSegmentAgainstRoute(e,t,r,i,s,o,a){return function Bre(n,e,t,r){return!!(Io(n)===r||r!==ft&&BI(e,t,n))&&("**"===n.path||XS(e,n,t).matched)}(r,i,s,o)?void 0===r.redirectTo?this.matchSegmentAgainstRoute(e,i,r,s,o,a):a&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,r,s,o):jh(i):jh(i)}expandSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){return"**"===i.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,i,o):this.expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,t,r,i){const s=this.applyRedirects.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?hB(s):this.applyRedirects.lineralizeSegments(r,s).pipe(On(o=>{const a=new an(o,{});return this.processSegment(e,t,a,o,i,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,t,r,i,s,o){const{matched:a,consumedSegments:l,remainingSegments:u,positionalParamSegments:d}=XS(t,i,s);if(!a)return jh(t);const p=this.applyRedirects.applyRedirectCommands(l,i.redirectTo,d);return i.redirectTo.startsWith("/")?hB(p):this.applyRedirects.lineralizeSegments(i,p).pipe(On(_=>this.processSegment(e,r,t,_.concat(u),o,!1)))}matchSegmentAgainstRoute(e,t,r,i,s,o){let a;if("**"===r.path){const l=i.length>0?PU(i).parameters:{};a=R({snapshot:new OI(i,l,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,gB(r),Io(r),r.component??r._loadedComponent??null,r,mB(r)),consumedSegments:[],remainingSegments:[]}),t.children={}}else a=Ore(t,r,i,e).pipe(de(({matched:l,consumedSegments:u,remainingSegments:d,parameters:p})=>l?{snapshot:new OI(u,p,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,gB(r),Io(r),r.component??r._loadedComponent??null,r,mB(r)),consumedSegments:u,remainingSegments:d}:null));return a.pipe(ye(l=>null===l?jh(t):this.getChildConfig(e=r._injector??e,r,i).pipe(ye(({routes:u})=>{const d=r._loadedInjector??e,{snapshot:p,consumedSegments:_,remainingSegments:v}=l,{segmentGroup:A,slicedSegments:D}=fB(t,_,v,u);if(0===D.length&&A.hasChildren())return this.processChildren(d,u,A).pipe(de(H=>null===H?null:[new ja(p,H)]));if(0===u.length&&0===D.length)return R([new ja(p,[])]);const P=Io(r)===s;return this.processSegment(d,u,A,D,P?ft:s,!0).pipe(de(H=>[new ja(p,H)]))}))))}getChildConfig(e,t,r){return t.children?R({routes:t.children,injector:e}):t.loadChildren?void 0!==t._loadedRoutes?R({routes:t._loadedRoutes,injector:t._loadedInjector}):function xre(n,e,t,r){const i=e.canLoad;return void 0===i||0===i.length?R(!0):R(i.map(o=>{const a=Uh(o,n);return Ml(function mre(n){return n&&Im(n.canLoad)}(a)?a.canLoad(e,t):n.runInContext(()=>a(e,t)))})).pipe(Bh(),cB())}(e,t,r).pipe(On(i=>i?this.configLoader.loadChildren(e,t).pipe(oi(s=>{t._loadedRoutes=s.routes,t._loadedInjector=s.injector})):function Mre(n){return om(sB(!1,3))}())):R({routes:[],injector:e})}}function Wre(n){const e=n.value.routeConfig;return e&&""===e.path}function pB(n){const e=[],t=new Set;for(const r of n){if(!Wre(r)){e.push(r);continue}const i=e.find(s=>r.value.routeConfig===s.value.routeConfig);void 0!==i?(i.children.push(...r.children),t.add(i)):e.push(r)}for(const r of t){const i=pB(r.children);e.push(new ja(r.value,i))}return e.filter(r=>!t.has(r))}function gB(n){return n.data||{}}function mB(n){return n.resolve||{}}function _B(n){return"string"==typeof n.title||null===n.title}function ZS(n){return ye(e=>{const t=n(e);return t?C(t).pipe(de(()=>e)):R(e)})}const $h=new we("ROUTES");let eD=(()=>{class n{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=ke(YV)}loadComponent(t){if(this.componentLoaders.get(t))return this.componentLoaders.get(t);if(t._loadedComponent)return R(t._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(t);const r=Ml(t.loadComponent()).pipe(de(yB),oi(s=>{this.onLoadEndListener&&this.onLoadEndListener(t),t._loadedComponent=s}),am(()=>{this.componentLoaders.delete(t)})),i=new DU(r,()=>new W).pipe(kS());return this.componentLoaders.set(t,i),i}loadChildren(t,r){if(this.childrenLoaders.get(r))return this.childrenLoaders.get(r);if(r._loadedRoutes)return R({routes:r._loadedRoutes,injector:r._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(r);const s=function Xre(n,e,t,r){return Ml(n.loadChildren()).pipe(de(yB),On(i=>i instanceof nV||Array.isArray(i)?R(i):C(e.compileModuleAsync(i))),de(i=>{r&&r(n);let s,o,a=!1;return Array.isArray(i)?(o=i,!0):(s=i.create(t).injector,o=s.get($h,[],{optional:!0,self:!0}).flat()),{routes:o.map(YS),injector:s}}))}(r,this.compiler,t,this.onLoadEndListener).pipe(am(()=>{this.childrenLoaders.delete(r)})),o=new DU(s,()=>new W).pipe(kS());return this.childrenLoaders.set(r,o),o}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function yB(n){return function Zre(n){return n&&"object"==typeof n&&"default"in n}(n)?n.default:n}let jI=(()=>{class n{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new W,this.transitionAbortSubject=new W,this.configLoader=ke(eD),this.environmentInjector=ke(Es),this.urlSerializer=ke(cm),this.rootContexts=ke(mm),this.inputBindingEnabled=null!==ke(FI,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>R(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=i=>this.events.next(new Wne(i)),this.configLoader.onLoadStartListener=i=>this.events.next(new zne(i))}complete(){this.transitions?.complete()}handleNavigationRequest(t){const r=++this.navigationId;this.transitions?.next({...this.transitions.value,...t,id:r})}setupNavigations(t,r,i){return this.transitions=new T({id:0,currentUrlTree:r,currentRawUrl:r,currentBrowserUrl:r,extractedUrl:t.urlHandlingStrategy.extract(r),urlAfterRedirects:t.urlHandlingStrategy.extract(r),rawUrl:r,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:pm,restoredState:null,currentSnapshot:i.snapshot,targetSnapshot:null,currentRouterState:i,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(Ks(s=>0!==s.id),de(s=>({...s,extractedUrl:t.urlHandlingStrategy.extract(s.rawUrl)})),ye(s=>{this.currentTransition=s;let o=!1,a=!1;return R(s).pipe(oi(l=>{this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),ye(l=>{const u=l.currentBrowserUrl.toString(),d=!t.navigated||l.extractedUrl.toString()!==u||u!==l.currentUrlTree.toString();if(!d&&"reload"!==(l.extras.onSameUrlNavigation??t.onSameUrlNavigation)){const _="";return this.events.next(new Fh(l.id,this.urlSerializer.serialize(l.rawUrl),_,0)),l.resolve(null),qn}if(t.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return R(l).pipe(ye(_=>{const v=this.transitions?.getValue();return this.events.next(new MI(_.id,this.urlSerializer.serialize(_.extractedUrl),_.source,_.restoredState)),v!==this.transitions?.getValue()?qn:Promise.resolve(_)}),function Gre(n,e,t,r,i,s){return On(o=>function $re(n,e,t,r,i,s,o="emptyOnly"){return new Hre(n,e,t,r,i,o,s).recognize()}(n,e,t,r,o.extractedUrl,i,s).pipe(de(({state:a,tree:l})=>({...o,targetSnapshot:a,urlAfterRedirects:l}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,t.config,this.urlSerializer,t.paramsInheritanceStrategy),oi(_=>{s.targetSnapshot=_.targetSnapshot,s.urlAfterRedirects=_.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:_.urlAfterRedirects};const v=new QU(_.id,this.urlSerializer.serialize(_.extractedUrl),this.urlSerializer.serialize(_.urlAfterRedirects),_.targetSnapshot);this.events.next(v)}));if(d&&t.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){const{id:_,extractedUrl:v,source:A,restoredState:D,extras:P}=l,H=new MI(_,this.urlSerializer.serialize(v),A,D);this.events.next(H);const V=ZU(0,this.rootComponentType).snapshot;return this.currentTransition=s={...l,targetSnapshot:V,urlAfterRedirects:v,extras:{...P,skipLocationChange:!1,replaceUrl:!1}},R(s)}{const _="";return this.events.next(new Fh(l.id,this.urlSerializer.serialize(l.extractedUrl),_,1)),l.resolve(null),qn}}),oi(l=>{const u=new Bne(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(u)}),de(l=>(this.currentTransition=s={...l,guards:dre(l.targetSnapshot,l.currentSnapshot,this.rootContexts)},s)),function wre(n,e){return On(t=>{const{targetSnapshot:r,currentSnapshot:i,guards:{canActivateChecks:s,canDeactivateChecks:o}}=t;return 0===o.length&&0===s.length?R({...t,guardsResult:!0}):function Cre(n,e,t,r){return C(n).pipe(On(i=>function Rre(n,e,t,r,i){const s=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return s&&0!==s.length?R(s.map(a=>{const l=ym(e)??i,u=Uh(a,l);return Ml(function vre(n){return n&&Im(n.canDeactivate)}(u)?u.canDeactivate(n,e,t,r):l.runInContext(()=>u(n,e,t,r))).pipe(Nl())})).pipe(Bh()):R(!0)}(i.component,i.route,t,e,r)),Nl(i=>!0!==i,!0))}(o,r,i,n).pipe(On(a=>a&&function gre(n){return"boolean"==typeof n}(a)?function Tre(n,e,t,r){return C(e).pipe(Mh(i=>MS(function bre(n,e){return null!==n&&e&&e(new Gne(n)),R(!0)}(i.route.parent,r),function Are(n,e){return null!==n&&e&&e(new Kne(n)),R(!0)}(i.route,r),function Dre(n,e,t){const r=e[e.length-1],s=e.slice(0,e.length-1).reverse().map(o=>function hre(n){const e=n.routeConfig?n.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:n,guards:e}:null}(o)).filter(o=>null!==o).map(o=>SU(()=>R(o.guards.map(l=>{const u=ym(o.node)??t,d=Uh(l,u);return Ml(function yre(n){return n&&Im(n.canActivateChild)}(d)?d.canActivateChild(r,n):u.runInContext(()=>d(r,n))).pipe(Nl())})).pipe(Bh())));return R(s).pipe(Bh())}(n,i.path,t),function Sre(n,e,t){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return R(!0);const i=r.map(s=>SU(()=>{const o=ym(e)??t,a=Uh(s,o);return Ml(function _re(n){return n&&Im(n.canActivate)}(a)?a.canActivate(e,n):o.runInContext(()=>a(e,n))).pipe(Nl())}));return R(i).pipe(Bh())}(n,i.route,t))),Nl(i=>!0!==i,!0))}(r,s,n,e):R(a)),de(a=>({...t,guardsResult:a})))})}(this.environmentInjector,l=>this.events.next(l)),oi(l=>{if(s.guardsResult=l.guardsResult,mc(l.guardsResult))throw iB(0,l.guardsResult);const u=new jne(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(u)}),Ks(l=>!!l.guardsResult||(this.cancelNavigationTransition(l,"",3),!1)),ZS(l=>{if(l.guards.canActivateChecks.length)return R(l).pipe(oi(u=>{const d=new $ne(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}),ye(u=>{let d=!1;return R(u).pipe(function qre(n,e){return On(t=>{const{targetSnapshot:r,guards:{canActivateChecks:i}}=t;if(!i.length)return R(t);let s=0;return C(i).pipe(Mh(o=>function Kre(n,e,t,r){const i=n.routeConfig,s=n._resolve;return void 0!==i?.title&&!_B(i)&&(s[lm]=i.title),function Qre(n,e,t,r){const i=function Yre(n){return[...Object.keys(n),...Object.getOwnPropertySymbols(n)]}(n);if(0===i.length)return R({});const s={};return C(i).pipe(On(o=>function Jre(n,e,t,r){const i=ym(e)??r,s=Uh(n,i);return Ml(s.resolve?s.resolve(e,t):i.runInContext(()=>s(e,t)))}(n[o],e,t,r).pipe(Nl(),oi(a=>{s[o]=a}))),OS(1),function cne(n){return de(()=>n)}(s),pc(o=>uB(o)?qn:om(o)))}(s,n,e,r).pipe(de(o=>(n._resolvedData=o,n.data=eB(n,t).resolve,i&&_B(i)&&(n.data[lm]=i.title),null)))}(o.route,r,n,e)),oi(()=>s++),OS(1),On(o=>s===i.length?R(t):qn))})}(t.paramsInheritanceStrategy,this.environmentInjector),oi({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(u,"",2)}}))}),oi(u=>{const d=new Hne(u.id,this.urlSerializer.serialize(u.extractedUrl),this.urlSerializer.serialize(u.urlAfterRedirects),u.targetSnapshot);this.events.next(d)}))}),ZS(l=>{const u=d=>{const p=[];d.routeConfig?.loadComponent&&!d.routeConfig._loadedComponent&&p.push(this.configLoader.loadComponent(d.routeConfig).pipe(oi(_=>{d.component=_}),de(()=>{})));for(const _ of d.children)p.push(...u(_));return p};return NS(u(l.targetSnapshot.root)).pipe(AI(),Nh(1))}),ZS(()=>this.afterPreactivation()),de(l=>{const u=function ere(n,e,t){const r=_m(n,e._root,t?t._root:void 0);return new XU(r,e)}(t.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s={...l,targetRouterState:u},s}),oi(()=>{this.events.next(new jS)}),((n,e,t,r)=>de(i=>(new cre(e,i.targetRouterState,i.currentRouterState,t,r).activate(n),i)))(this.rootContexts,t.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),Nh(1),oi({next:l=>{o=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new kl(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),t.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{o=!0}}),function dne(n){return $((e,t)=>{Ut(n).subscribe(re(t,()=>t.complete(),Le)),!t.closed&&e.subscribe(t)})}(this.transitionAbortSubject.pipe(oi(l=>{throw l}))),am(()=>{o||a||this.cancelNavigationTransition(s,"",1),this.currentNavigation?.id===s.id&&(this.currentNavigation=null)}),pc(l=>{if(a=!0,oB(l))this.events.next(new gm(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),function rre(n){return oB(n)&&mc(n.url)}(l)?this.events.next(new $S(l.url)):s.resolve(!1);else{this.events.next(new kI(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0));try{s.resolve(t.errorHandler(l))}catch(u){s.reject(u)}}return qn}))}))}cancelNavigationTransition(t,r,i){const s=new gm(t.id,this.urlSerializer.serialize(t.extractedUrl),r,i);this.events.next(s),t.resolve(!1)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function vB(n){return n!==pm}let EB=(()=>{class n{buildTitle(t){let r,i=t.root;for(;void 0!==i;)r=this.getResolvedTitleForRoute(i)??r,i=i.children.find(s=>s.outlet===ft);return r}getResolvedTitleForRoute(t){return t.data[lm]}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:function(){return ke(eie)},providedIn:"root"})}}return n})(),eie=(()=>{class n extends EB{constructor(t){super(),this.title=t}updateTitle(t){const r=this.buildTitle(t);void 0!==r&&this.title.setTitle(r)}static{this.\u0275fac=function(r){return new(r||n)(Ee(vU))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})(),tie=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:function(){return ke(rie)},providedIn:"root"})}}return n})();class nie{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}}let rie=(()=>{class n extends nie{static{this.\u0275fac=function(){let t;return function(i){return(t||(t=Cr(n)))(i||n)}}()}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const $I=new we("",{providedIn:"root",factory:()=>({})});let iie=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:function(){return ke(sie)},providedIn:"root"})}}return n})(),sie=(()=>{class n{shouldProcessUrl(t){return!0}extract(t){return t}merge(t,r){return t}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var wm=function(n){return n[n.COMPLETE=0]="COMPLETE",n[n.FAILED=1]="FAILED",n[n.REDIRECTING=2]="REDIRECTING",n}(wm||{});function IB(n,e){n.events.pipe(Ks(t=>t instanceof kl||t instanceof gm||t instanceof kI||t instanceof Fh),de(t=>t instanceof kl||t instanceof Fh?wm.COMPLETE:t instanceof gm&&(0===t.code||1===t.code)?wm.REDIRECTING:wm.FAILED),Ks(t=>t!==wm.REDIRECTING),Nh(1)).subscribe(()=>{e()})}function oie(n){throw n}function aie(n,e,t){return e.parse("/")}const lie={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},uie={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Qs=(()=>{class n{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.location.getState()?.\u0275routerPageId??this.currentPageId}get events(){return this._events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=ke(QV),this.isNgZoneEnabled=!1,this._events=new W,this.options=ke($I,{optional:!0})||{},this.pendingTasks=ke(ZE),this.errorHandler=this.options.errorHandler||oie,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||aie,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=ke(iie),this.routeReuseStrategy=ke(tie),this.titleStrategy=ke(EB),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=ke($h,{optional:!0})?.flat()??[],this.navigationTransitions=ke(jI),this.urlSerializer=ke(cm),this.location=ke(aS),this.componentInputBindingEnabled=!!ke(FI,{optional:!0}),this.eventsSubscription=new Nt,this.isNgZoneEnabled=ke(Xt)instanceof Xt&&Xt.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new Oh,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=ZU(0,null),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe(t=>{this.lastSuccessfulId=t.id,this.currentPageId=this.browserPageId},t=>{this.console.warn(`Unhandled Navigation Error: ${t}`)}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const t=this.navigationTransitions.events.subscribe(r=>{try{const{currentTransition:i}=this.navigationTransitions;if(null===i)return void(wB(r)&&this._events.next(r));if(r instanceof MI)vB(i.source)&&(this.browserUrlTree=i.extractedUrl);else if(r instanceof Fh)this.rawUrlTree=i.rawUrl;else if(r instanceof QU){if("eager"===this.urlUpdateStrategy){if(!i.extras.skipLocationChange){const s=this.urlHandlingStrategy.merge(i.urlAfterRedirects,i.rawUrl);this.setBrowserUrl(s,i)}this.browserUrlTree=i.urlAfterRedirects}}else if(r instanceof jS)this.currentUrlTree=i.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(i.urlAfterRedirects,i.rawUrl),this.routerState=i.targetRouterState,"deferred"===this.urlUpdateStrategy&&(i.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,i),this.browserUrlTree=i.urlAfterRedirects);else if(r instanceof gm)0!==r.code&&1!==r.code&&(this.navigated=!0),(3===r.code||2===r.code)&&this.restoreHistory(i);else if(r instanceof $S){const s=this.urlHandlingStrategy.merge(r.url,i.currentRawUrl),o={skipLocationChange:i.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||vB(i.source)};this.scheduleNavigation(s,pm,null,o,{resolve:i.resolve,reject:i.reject,promise:i.promise})}r instanceof kI&&this.restoreHistory(i,!0),r instanceof kl&&(this.navigated=!0),wB(r)&&this._events.next(r)}catch(i){this.navigationTransitions.transitionAbortSubject.next(i)}});this.eventsSubscription.add(t)}resetRootComponentType(t){this.routerState.root.component=t,this.navigationTransitions.rootComponentType=t}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const t=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),pm,t)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(t=>{const r="popstate"===t.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{this.navigateToSyncWithBrowser(t.url,r,t.state)},0)}))}navigateToSyncWithBrowser(t,r,i){const s={replaceUrl:!0},o=i?.navigationId?i:null;if(i){const l={...i};delete l.navigationId,delete l.\u0275routerPageId,0!==Object.keys(l).length&&(s.state=l)}const a=this.parseUrl(t);this.scheduleNavigation(a,r,o,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(t){this.config=t.map(YS),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(t,r={}){const{relativeTo:i,queryParams:s,fragment:o,queryParamsHandling:a,preserveFragment:l}=r,u=l?this.currentUrlTree.fragment:o;let p,d=null;switch(a){case"merge":d={...this.currentUrlTree.queryParams,...s};break;case"preserve":d=this.currentUrlTree.queryParams;break;default:d=s||null}null!==d&&(d=this.removeEmptyProps(d));try{p=$U(i?i.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof t[0]||!t[0].startsWith("/"))&&(t=[]),p=this.currentUrlTree.root}return HU(p,t,d,u??null)}navigateByUrl(t,r={skipLocationChange:!1}){const i=mc(t)?t:this.parseUrl(t),s=this.urlHandlingStrategy.merge(i,this.rawUrlTree);return this.scheduleNavigation(s,pm,null,r)}navigate(t,r={skipLocationChange:!1}){return function cie(n){for(let e=0;e<n.length;e++)if(null==n[e])throw new pe(4008,!1)}(t),this.navigateByUrl(this.createUrlTree(t,r),r)}serializeUrl(t){return this.urlSerializer.serialize(t)}parseUrl(t){let r;try{r=this.urlSerializer.parse(t)}catch(i){r=this.malformedUriErrorHandler(i,this.urlSerializer,t)}return r}isActive(t,r){let i;if(i=!0===r?{...lie}:!1===r?{...uie}:r,mc(t))return MU(this.currentUrlTree,t,i);const s=this.parseUrl(t);return MU(this.currentUrlTree,s,i)}removeEmptyProps(t){return Object.keys(t).reduce((r,i)=>{const s=t[i];return null!=s&&(r[i]=s),r},{})}scheduleNavigation(t,r,i,s,o){if(this.disposed)return Promise.resolve(!1);let a,l,u;o?(a=o.resolve,l=o.reject,u=o.promise):u=new Promise((p,_)=>{a=p,l=_});const d=this.pendingTasks.add();return IB(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(d))}),this.navigationTransitions.handleNavigationRequest({source:r,restoredState:i,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,currentBrowserUrl:this.browserUrlTree,rawUrl:t,extras:s,resolve:a,reject:l,promise:u,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),u.catch(p=>Promise.reject(p))}setBrowserUrl(t,r){const i=this.urlSerializer.serialize(t);if(this.location.isCurrentPathEqualTo(i)||r.extras.replaceUrl){const o={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId)};this.location.replaceState(i,"",o)}else{const s={...r.extras.state,...this.generateNgRouterState(r.id,this.browserPageId+1)};this.location.go(i,"",s)}}restoreHistory(t,r=!1){if("computed"===this.canceledNavigationResolution){const s=this.currentPageId-this.browserPageId;0!==s?this.location.historyGo(s):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===s&&(this.resetState(t),this.browserUrlTree=t.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(t),this.resetUrlToCurrentUrlTree())}resetState(t){this.routerState=t.currentRouterState,this.currentUrlTree=t.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,t.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(t,r){return"computed"===this.canceledNavigationResolution?{navigationId:t,\u0275routerPageId:r}:{navigationId:t}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function wB(n){return!(n instanceof jS||n instanceof $S)}let Cm=(()=>{class n{constructor(t,r,i,s,o,a){this.router=t,this.route=r,this.tabIndexAttribute=i,this.renderer=s,this.el=o,this.locationStrategy=a,this.href=null,this.commands=null,this.onChanges=new W,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const l=o.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===l||"area"===l,this.isAnchorElement?this.subscription=t.events.subscribe(u=>{u instanceof kl&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(t){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",t)}ngOnChanges(t){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(t){null!=t?(this.commands=Array.isArray(t)?t:[t],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(t,r,i,s,o){return!!(null===this.urlTree||this.isAnchorElement&&(0!==t||r||i||s||o||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const t=null===this.href?null:function iO(n,e,t){return function U5(n,e){return"src"===e&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===e&&("base"===n||"link"===n)?rO:Tl}(e,t)(n)}(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",t)}applyAttributeValue(t,r){const i=this.renderer,s=this.el.nativeElement;null!==r?i.setAttribute(s,t,r):i.removeAttribute(s,t)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static{this.\u0275fac=function(r){return new(r||n)(_e(Qs),_e(Vh),function tE(n){return function le(n,e){if("class"===e)return n.classes;if("style"===e)return n.styles;const t=n.attrs;if(t){const r=t.length;let i=0;for(;i<r;){const s=t[i];if(Fi(s))break;if(0===s)i+=2;else if("number"==typeof s)for(i++;i<r&&"string"==typeof t[i];)i++;else{if(s===e)return t[i+1];i+=2}}}return null}(_r(),n)}("tabindex"),_e(Na),_e(Is),_e(fc))}}static{this.\u0275dir=Ye({type:n,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(r,i){1&r&&An("click",function(o){return i.onClick(o.button,o.ctrlKey,o.shiftKey,o.altKey,o.metaKey)}),2&r&&qo("target",i.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",xh],skipLocationChange:["skipLocationChange","skipLocationChange",xh],replaceUrl:["replaceUrl","replaceUrl",xh],routerLink:"routerLink"},standalone:!0,features:[yF,Ui]})}}return n})();class CB{}let fie=(()=>{class n{constructor(t,r,i,s,o){this.router=t,this.injector=i,this.preloadingStrategy=s,this.loader=o}setUpPreloading(){this.subscription=this.router.events.pipe(Ks(t=>t instanceof kl),Mh(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(t,r){const i=[];for(const s of r){s.providers&&!s._injector&&(s._injector=Rb(s.providers,t,`Route: ${s.path}`));const o=s._injector??t,a=s._loadedInjector??o;(s.loadChildren&&!s._loadedRoutes&&void 0===s.canLoad||s.loadComponent&&!s._loadedComponent)&&i.push(this.preloadConfig(o,s)),(s.children||s._loadedRoutes)&&i.push(this.processRoutes(a,s.children??s._loadedRoutes))}return C(i).pipe(wr())}preloadConfig(t,r){return this.preloadingStrategy.preload(r,()=>{let i;i=r.loadChildren&&void 0===r.canLoad?this.loader.loadChildren(t,r):R(null);const s=i.pipe(On(o=>null===o?R(void 0):(r._loadedRoutes=o.routes,r._loadedInjector=o.injector,this.processRoutes(o.injector??t,o.routes))));return r.loadComponent&&!r._loadedComponent?C([s,this.loader.loadComponent(r)]).pipe(wr()):s})}static{this.\u0275fac=function(r){return new(r||n)(Ee(Qs),Ee(YV),Ee(Es),Ee(CB),Ee(eD))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();const tD=new we("");let TB=(()=>{class n{constructor(t,r,i,s,o={}){this.urlSerializer=t,this.transitions=r,this.viewportScroller=i,this.zone=s,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof MI?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=t.navigationTrigger,this.restoredId=t.restoredState?t.restoredState.navigationId:0):t instanceof kl?(this.lastId=t.id,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.urlAfterRedirects).fragment)):t instanceof Fh&&0===t.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(t,this.urlSerializer.parse(t.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(t=>{t instanceof YU&&(t.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(t.position):t.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(t.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(t,r){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new YU(t,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static{this.\u0275fac=function(r){!function WO(){throw new Error("invalid")}()}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();function $a(n,e){return{\u0275kind:n,\u0275providers:e}}function bB(){const n=ke(ss);return e=>{const t=n.get(Rh);if(e!==t.components[0])return;const r=n.get(Qs),i=n.get(SB);1===n.get(nD)&&r.initialNavigation(),n.get(DB,null,yt.Optional)?.setUpPreloading(),n.get(tD,null,yt.Optional)?.init(),r.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}const SB=new we("",{factory:()=>new W}),nD=new we("",{providedIn:"root",factory:()=>1}),DB=new we("");function _ie(n){return $a(0,[{provide:DB,useExisting:fie},{provide:CB,useExisting:n}])}const RB=new we("ROUTER_FORROOT_GUARD"),vie=[aS,{provide:cm,useClass:FS},Qs,mm,{provide:Vh,useFactory:function AB(n){return n.routerState.root},deps:[Qs]},eD,[]];function Eie(){return new r2("Router",Qs)}let rD=(()=>{class n{constructor(t){}static forRoot(t,r){return{ngModule:n,providers:[vie,[],{provide:$h,multi:!0,useValue:t},{provide:RB,useFactory:Tie,deps:[[Qs,new vs,new iE]]},{provide:$I,useValue:r||{}},r?.useHash?{provide:fc,useClass:PZ}:{provide:fc,useClass:O2},{provide:tD,useFactory:()=>{const n=ke(Jee),e=ke(Xt),t=ke($I),r=ke(jI),i=ke(cm);return t.scrollOffset&&n.setOffset(t.scrollOffset),new TB(i,r,n,e,t)}},r?.preloadingStrategy?_ie(r.preloadingStrategy).\u0275providers:[],{provide:r2,multi:!0,useFactory:Eie},r?.initialNavigation?Aie(r):[],r?.bindToComponentInputs?$a(8,[rB,{provide:FI,useExisting:rB}]).\u0275providers:[],[{provide:xB,useFactory:bB},{provide:Jb,multi:!0,useExisting:xB}]]}}static forChild(t){return{ngModule:n,providers:[{provide:$h,multi:!0,useValue:t}]}}static{this.\u0275fac=function(r){return new(r||n)(Ee(RB,8))}}static{this.\u0275mod=ei({type:n})}static{this.\u0275inj=pi({})}}return n})();function Tie(n){return"guarded"}function Aie(n){return["disabled"===n.initialNavigation?$a(3,[{provide:Hb,multi:!0,useFactory:()=>{const e=ke(Qs);return()=>{e.setUpLocationChangeListener()}}},{provide:nD,useValue:2}]).\u0275providers:[],"enabledBlocking"===n.initialNavigation?$a(2,[{provide:nD,useValue:0},{provide:Hb,multi:!0,deps:[ss],useFactory:e=>{const t=e.get(RZ,Promise.resolve());return()=>t.then(()=>new Promise(r=>{const i=e.get(Qs),s=e.get(SB);IB(i,()=>{r(!0)}),e.get(jI).afterPreactivation=()=>(r(!0),s.closed?R(void 0):s),i.initialNavigation()}))}}]).\u0275providers:[]]}const xB=new we(""),Sie=[];let Die=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ei({type:n})}static{this.\u0275inj=pi({imports:[rD.forRoot(Sie),rD]})}}return n})(),Rie=(()=>{class n{constructor(){this.title="wedding-app"}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-root"]],decls:29,vars:7,consts:[[1,"grid-container"],[1,"grid-item1"],[1,"avatar-container"],[1,"circular-frame"],["src","assets/images/ratio1-1/picture3-1_1.jpg"],[3,"routerLink"],[1,"grid-item2"]],template:function(r,i){1&r&&(me(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),Tr(4,"img",4),Ie()(),me(5,"ul")(6,"li")(7,"a",5),Se(8,"HOME"),Ie()(),me(9,"li")(10,"a",5),Se(11,"ABOUT"),Ie()(),me(12,"li")(13,"a",5),Se(14,"SCHEDULE"),Ie()(),me(15,"li")(16,"a",5),Se(17,"REGISTRY"),Ie()(),me(18,"li")(19,"a",5),Se(20,"FAQ"),Ie()(),me(21,"li")(22,"a",5),Se(23,"CONTACT"),Ie()(),me(24,"li")(25,"a",5),Se(26,"RSVP"),Ie()()()(),me(27,"div",6),Tr(28,"router-outlet"),Ie()()),2&r&&(Bt(7),Tn("routerLink","Home"),Bt(3),Tn("routerLink","About"),Bt(3),Tn("routerLink","Schedule"),Bt(3),Tn("routerLink","Registry"),Bt(3),Tn("routerLink","FAQ"),Bt(3),Tn("routerLink","Contact"),Bt(3),Tn("routerLink","Rsvp"))},dependencies:[KS,Cm],styles:[".grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:16% auto}.grid-item1[_ngcontent-%COMP%]{grid-column-start:1;grid-column-end:2;font-family:Lora,cursive;background-color:#96a498;color:#fff;min-height:100vh}.grid-item2[_ngcontent-%COMP%]{grid-column-start:2;grid-column-end:3;background-color:#fcfbf4;font-family:Lora,cursive}.avatar-container[_ngcontent-%COMP%]{display:flex;justify-content:center}.circular-frame[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:20px;width:180px;height:180px;border-radius:50%;overflow:hidden}.circular-frame[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:26px;list-style-type:none;margin-top:1em}a[_ngcontent-%COMP%]:link, a[_ngcontent-%COMP%]:visited{color:inherit;text-decoration:none}@media (max-width: 1200px){.circular-frame[_ngcontent-%COMP%]{width:140px;height:140px}ul[_ngcontent-%COMP%]{padding-left:2em}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:20px}}@media (max-width: 1000px){.grid-container[_ngcontent-%COMP%]{grid-template-columns:18% auto}.circular-frame[_ngcontent-%COMP%]{width:120px;height:120px}ul[_ngcontent-%COMP%]{padding-left:1.5em}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:18px}}@media (max-width: 800px){.grid-container[_ngcontent-%COMP%]{grid-template-columns:22% auto}.circular-frame[_ngcontent-%COMP%]{width:110px;height:110px}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:16px}}@media (max-width: 600px){.grid-container[_ngcontent-%COMP%]{grid-template-columns:25% auto}.circular-frame[_ngcontent-%COMP%]{width:90px;height:90px}ul[_ngcontent-%COMP%]{padding-left:1em}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:15px}}@media (max-width: 450px){.circular-frame[_ngcontent-%COMP%]{width:80px;height:80px}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 450px){.circular-frame[_ngcontent-%COMP%]{width:70px;height:70px}ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-size:12px}}"]})}}return n})();var zi=Ge(631);(0,zi.registerVersion)("firebase","10.14.1","app");class Nie extends Nt{constructor(e,t){super()}schedule(e,t=0){return this}}const HI={setInterval(n,e,...t){const{delegate:r}=HI;return r?.setInterval?r.setInterval(n,e,...t):setInterval(n,e,...t)},clearInterval(n){const{delegate:e}=HI;return(e?.clearInterval||clearInterval)(n)},delegate:void 0};class PB extends Nie{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){var r;if(this.closed)return this;this.state=e;const i=this.id,s=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(s,i,t)),this.pending=!0,this.delay=t,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,t),this}requestAsyncId(e,t,r=0){return HI.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,t,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return t;null!=t&&HI.clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,t);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i,r=!1;try{this.work(e)}catch(s){r=!0,i=s||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),i}unsubscribe(){if(!this.closed){const{id:e,scheduler:t}=this,{actions:r}=t;this.work=this.state=this.scheduler=null,this.pending=!1,Fe(r,this),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null,super.unsubscribe()}}}const iD={now:()=>(iD.delegate||Date).now(),delegate:void 0};class Tm{constructor(e,t=Tm.now){this.schedulerActionCtor=e,this.now=t}schedule(e,t=0,r){return new this.schedulerActionCtor(this,e).schedule(r,t)}}Tm.now=iD.now;class NB extends Tm{constructor(e,t=Tm.now){super(e,t),this.actions=[],this._active=!1}flush(e){const{actions:t}=this;if(this._active)return void t.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=t.shift());if(this._active=!1,r){for(;e=t.shift();)e.unsubscribe();throw r}}}const Oie=new class kie extends NB{}(class Mie extends PB{constructor(e,t){super(e,t),this.scheduler=e,this.work=t}schedule(e,t=0){return t>0?super.schedule(e,t):(this.delay=t,this.state=e,this.scheduler.flush(this),this)}execute(e,t){return t>0||this.closed?super.execute(e,t):this._execute(e,t)}requestAsyncId(e,t,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,t,r):(e.flush(this),0)}}),MB=new NB(PB),zI=new ch("ANGULARFIRE2_VERSION");const sD=(n,e)=>{const t=e?[e]:(0,zi.getApps)(),r=[];return t.forEach(i=>{i.container.getProvider(n).instances.forEach(o=>{r.includes(o)||r.push(o)})}),r};class oD{constructor(){return sD(Fie)}}const Fie="app-check";function Hh(){}class OB{zone;delegate;constructor(e,t=Oie){this.zone=e,this.delegate=t}now(){return this.delegate.now()}schedule(e,t,r){const i=this.zone;return this.delegate.schedule(function(o){i.runGuarded(()=>{e.apply(this,[o])})},t,r)}}class Lie{zone;task=null;constructor(e){this.zone=e}call(e,t){const r=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Hh,{},Hh,Hh)),t.pipe(oi({next:r,complete:r,error:r})).subscribe(e).add(r)}unscheduleTask(){setTimeout(()=>{null!=this.task&&"scheduled"===this.task.state&&(this.task.invoke(),this.task=null)},10)}}let aD=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(t){this.ngZone=t,this.outsideAngular=t.runOutsideAngular(()=>new OB(Zone.current)),this.insideAngular=t.run(()=>new OB(Zone.current,MB)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(r){return new(r||n)(Ee(Xt))};static \u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function zh(){const n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error("Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using\nprovideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).");return n}function _c(n){return zh().ngZone.run(()=>n())}function As(n){return function Uie(n){return function(t){return(t=t.lift(new Lie(n.ngZone))).pipe(Vr(n.outsideAngular),nr(n.insideAngular))}}(zh())(n)}const Bie=(n,e)=>function(){const r=arguments;return e&&setTimeout(()=>{"scheduled"===e.state&&e.invoke()},10),_c(()=>n.apply(void 0,r))},jie=(n,e)=>function(){let t;const r=arguments;for(let s=0;s<arguments.length;s++)"function"==typeof r[s]&&(e&&(t||=_c(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",Hh,{},Hh,Hh))),r[s]=Bie(r[s],t));const i=function Vie(n){return zh().ngZone.runOutsideAngular(()=>n())}(()=>n.apply(this,r));if(!e){if(i instanceof lt){const s=zh();return i.pipe(Vr(s.outsideAngular),nr(s.insideAngular))}return _c(()=>i)}return i instanceof lt?i.pipe(As):i instanceof Promise?_c(()=>new Promise((s,o)=>i.then(a=>_c(()=>s(a)),a=>_c(()=>o(a))))):"function"==typeof i&&t?function(){return setTimeout(()=>{t&&"scheduled"===t.state&&t.invoke()},10),i.apply(this,arguments)}:_c(()=>i)};var Ol=Ge(574);Ol.A.registerVersion("firebase","10.14.1","app-compat");const zie=["ngOnDestroy"];class FB{constructor(e){return e}}const WI=new we("angularfire2.app.options"),GI=new we("angularfire2.app.name");function lD(n,e,t){const i="object"==typeof t&&t||{};i.name=i.name||"string"==typeof t&&t||"[DEFAULT]";const o=Ol.A.apps.filter(a=>a&&a.name===i.name)[0]||e.runOutsideAngular(()=>Ol.A.initializeApp(n,i));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){const a=!!module.hot;qie("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new FB(o)}const qie=(n,...e)=>{},Kie={provide:FB,useFactory:lD,deps:[WI,Xt,[new vs,GI]]};let Qie=(()=>{class n{static initializeApp(t,r){return{ngModule:n,providers:[{provide:WI,useValue:t},{provide:GI,useValue:r}]}}constructor(t){Ol.A.registerVersion("angularfire",zI.full,"core"),Ol.A.registerVersion("angularfire",zI.full,"app-compat"),Ol.A.registerVersion("angular",EO.full,t.toString())}static \u0275fac=function(r){return new(r||n)(Ee(zo))};static \u0275mod=ei({type:n});static \u0275inj=pi({providers:[Kie]})}return n})();function LB(n,e,t,r,i){const[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return function Yie(n,e){try{return n.toString()===e.toString()}catch{return n===e}}(i,o)||(VB("error",`${e} was already initialized on the ${t} Firebase App with different settings.${Jie?" You may need to reload as Firebase is not HMR aware.":""}`),VB("warn",{is:i,was:o})),s;{const a=r();return globalThis.\u0275AngularfireInstanceCache.push([n,a,i]),a}}const Jie=typeof module<"u"&&!!module.hot,VB=(n,...e)=>{};globalThis.\u0275AngularfireInstanceCache||=[],Ge(46);class Xie extends W{constructor(e=1/0,t=1/0,r=iD){super(),this._bufferSize=e,this._windowTime=t,this._timestampProvider=r,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=t===1/0,this._bufferSize=Math.max(1,e),this._windowTime=Math.max(1,t)}next(e){const{isStopped:t,_buffer:r,_infiniteTimeWindow:i,_timestampProvider:s,_windowTime:o}=this;t||(r.push(e),!i&&r.push(s.now()+o)),this._trimBuffer(),super.next(e)}_subscribe(e){this._throwIfClosed(),this._trimBuffer();const t=this._innerSubscribe(e),{_infiniteTimeWindow:r,_buffer:i}=this,s=i.slice();for(let o=0;o<s.length&&!e.closed;o+=r?1:2)e.next(s[o]);return this._checkFinalizedStatuses(e),t}_trimBuffer(){const{_bufferSize:e,_timestampProvider:t,_buffer:r,_infiniteTimeWindow:i}=this,s=(i?1:2)*e;if(e<1/0&&s<r.length&&r.splice(0,r.length-s),!i){const o=t.now();let a=0;for(let l=1;l<r.length&&r[l]<=o;l+=2)a=l;a&&r.splice(0,a+1)}}}function UB(n,e,t){let r,i=!1;return n&&"object"==typeof n?({bufferSize:r=1/0,windowTime:e=1/0,refCount:i=!1,scheduler:t}=n):r=n??1/0,k({connector:()=>new Xie(r,e,t),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:i})}function BB(n,e){return x(e)?ye(()=>n,e):ye(()=>n)}const jB=new we("angularfire2.auth.use-emulator"),$B=new we("angularfire2.auth.settings"),HB=new we("angularfire2.auth.tenant-id"),zB=new we("angularfire2.auth.langugage-code"),WB=new we("angularfire2.auth.use-device-language"),GB=new we("angularfire.auth.persistence"),qB=(n,e,t,r,i,s,o,a)=>LB(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{const l=e.runOutsideAngular(()=>n.auth());if(t&&l.useEmulator(...t),r&&(l.tenantId=r),l.languageCode=i,s&&l.useDeviceLanguage(),o)for(const[u,d]of Object.entries(o))l.settings[u]=d;return a&&l.setPersistence(a),l},[t,r,i,s,o,a]);let KB=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(t,r,i,s,o,a,l,u,d,p,_,v){const A=new W,D=R(void 0).pipe(nr(o.outsideAngular),ye(()=>s.runOutsideAngular(()=>Promise.resolve().then(Ge.bind(Ge,46)))),de(()=>lD(t,s,r)),de(P=>qB(P,s,a,u,d,p,l,_)),UB({bufferSize:1,refCount:!1}));if(vI(i))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=R(null);else{D.pipe(Nl()).subscribe();const P=D.pipe(ye(Y=>Y.getRedirectResult().then(ae=>ae,()=>null)),As,UB({bufferSize:1,refCount:!1})),H=D.pipe(ye(Y=>new lt(ae=>({unsubscribe:s.runOutsideAngular(()=>Y.onAuthStateChanged(Te=>ae.next(Te),Te=>ae.error(Te),()=>ae.complete()))})))),V=D.pipe(ye(Y=>new lt(ae=>({unsubscribe:s.runOutsideAngular(()=>Y.onIdTokenChanged(Te=>ae.next(Te),Te=>ae.error(Te),()=>ae.complete()))}))));this.authState=P.pipe(BB(H),Vr(o.outsideAngular),nr(o.insideAngular)),this.user=P.pipe(BB(V),Vr(o.outsideAngular),nr(o.insideAngular)),this.idToken=this.user.pipe(ye(Y=>Y?C(Y.getIdToken()):R(null))),this.idTokenResult=this.user.pipe(ye(Y=>Y?C(Y.getIdTokenResult()):R(null))),this.credential=E(P,A,this.authState.pipe(Ks(Y=>!Y))).pipe(de(Y=>Y?.user?Y:null),Vr(o.outsideAngular),nr(o.insideAngular))}return((n,e,t,r={})=>new Proxy(n,{get:(i,s)=>t.runOutsideAngular(()=>{if(n[s])return r?.spy?.get&&r.spy.get(s,n[s]),n[s];if(zie.indexOf(s)>-1)return()=>{};const o=e.toPromise().then(a=>{const l=a?.[s];return"function"==typeof l?l.bind(a):l?.then?l.then(u=>t.run(()=>u)):t.run(()=>l)});return new Proxy(()=>{},{get:(a,l)=>o[l],apply:(a,l,u)=>o.then(d=>{const p=d?.(...u);return r?.spy?.apply&&r.spy.apply(s,u,p),p})})})}))(this,D,s,{spy:{apply:(P,H,V)=>{(P.startsWith("signIn")||P.startsWith("createUser"))&&V.then(Y=>A.next(Y))}}})}static \u0275fac=function(r){return new(r||n)(Ee(WI),Ee(GI,8),Ee(zo),Ee(Xt),Ee(aD),Ee(jB,8),Ee($B,8),Ee(HB,8),Ee(zB,8),Ee(WB,8),Ee(GB,8),Ee(oD,8))};static \u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();function uD(){return $((n,e)=>{let t,r=!1;n.subscribe(re(e,i=>{const s=t;t=i,r&&e.next([s,i]),r=!0}))})}var yc,JB,Z=Ge(467),cD=Ge(779),Ys=Ge(398),B=Ge(401),QB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},YB={};(function(){var n;function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function i(U,M,F){F||(F=0);var j=Array(16);if("string"==typeof M)for(var z=0;16>z;++z)j[z]=M.charCodeAt(F++)|M.charCodeAt(F++)<<8|M.charCodeAt(F++)<<16|M.charCodeAt(F++)<<24;else for(z=0;16>z;++z)j[z]=M[F++]|M[F++]<<8|M[F++]<<16|M[F++]<<24;var J=U.g[3],O=(M=U.g[0])+(J^(F=U.g[1])&((z=U.g[2])^J))+j[0]+3614090360&4294967295;O=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=(F=(z=(J=(M=F+(O<<7&4294967295|O>>>25))+((O=J+(z^M&(F^z))+j[1]+3905402710&4294967295)<<12&4294967295|O>>>20))+((O=z+(F^J&(M^F))+j[2]+606105819&4294967295)<<17&4294967295|O>>>15))+((O=F+(M^z&(J^M))+j[3]+3250441966&4294967295)<<22&4294967295|O>>>10))+((O=M+(J^F&(z^J))+j[4]+4118548399&4294967295)<<7&4294967295|O>>>25))+((O=J+(z^M&(F^z))+j[5]+1200080426&4294967295)<<12&4294967295|O>>>20))+((O=z+(F^J&(M^F))+j[6]+2821735955&4294967295)<<17&4294967295|O>>>15))+((O=F+(M^z&(J^M))+j[7]+4249261313&4294967295)<<22&4294967295|O>>>10))+((O=M+(J^F&(z^J))+j[8]+1770035416&4294967295)<<7&4294967295|O>>>25))+((O=J+(z^M&(F^z))+j[9]+2336552879&4294967295)<<12&4294967295|O>>>20))+((O=z+(F^J&(M^F))+j[10]+4294925233&4294967295)<<17&4294967295|O>>>15))+((O=F+(M^z&(J^M))+j[11]+2304563134&4294967295)<<22&4294967295|O>>>10))+((O=M+(J^F&(z^J))+j[12]+1804603682&4294967295)<<7&4294967295|O>>>25))+((O=J+(z^M&(F^z))+j[13]+4254626195&4294967295)<<12&4294967295|O>>>20))+((O=z+(F^J&(M^F))+j[14]+2792965006&4294967295)<<17&4294967295|O>>>15))+((O=F+(M^z&(J^M))+j[15]+1236535329&4294967295)<<22&4294967295|O>>>10))+((O=M+(z^J&(F^z))+j[1]+4129170786&4294967295)<<5&4294967295|O>>>27))+((O=J+(F^z&(M^F))+j[6]+3225465664&4294967295)<<9&4294967295|O>>>23))+((O=z+(M^F&(J^M))+j[11]+643717713&4294967295)<<14&4294967295|O>>>18))+((O=F+(J^M&(z^J))+j[0]+3921069994&4294967295)<<20&4294967295|O>>>12))+((O=M+(z^J&(F^z))+j[5]+3593408605&4294967295)<<5&4294967295|O>>>27))+((O=J+(F^z&(M^F))+j[10]+38016083&4294967295)<<9&4294967295|O>>>23))+((O=z+(M^F&(J^M))+j[15]+3634488961&4294967295)<<14&4294967295|O>>>18))+((O=F+(J^M&(z^J))+j[4]+3889429448&4294967295)<<20&4294967295|O>>>12))+((O=M+(z^J&(F^z))+j[9]+568446438&4294967295)<<5&4294967295|O>>>27))+((O=J+(F^z&(M^F))+j[14]+3275163606&4294967295)<<9&4294967295|O>>>23))+((O=z+(M^F&(J^M))+j[3]+4107603335&4294967295)<<14&4294967295|O>>>18))+((O=F+(J^M&(z^J))+j[8]+1163531501&4294967295)<<20&4294967295|O>>>12))+((O=M+(z^J&(F^z))+j[13]+2850285829&4294967295)<<5&4294967295|O>>>27))+((O=J+(F^z&(M^F))+j[2]+4243563512&4294967295)<<9&4294967295|O>>>23))+((O=z+(M^F&(J^M))+j[7]+1735328473&4294967295)<<14&4294967295|O>>>18))+((O=F+(J^M&(z^J))+j[12]+2368359562&4294967295)<<20&4294967295|O>>>12))+((O=M+(F^z^J)+j[5]+4294588738&4294967295)<<4&4294967295|O>>>28))+((O=J+(M^F^z)+j[8]+2272392833&4294967295)<<11&4294967295|O>>>21))+((O=z+(J^M^F)+j[11]+1839030562&4294967295)<<16&4294967295|O>>>16))+((O=F+(z^J^M)+j[14]+4259657740&4294967295)<<23&4294967295|O>>>9))+((O=M+(F^z^J)+j[1]+2763975236&4294967295)<<4&4294967295|O>>>28))+((O=J+(M^F^z)+j[4]+1272893353&4294967295)<<11&4294967295|O>>>21))+((O=z+(J^M^F)+j[7]+4139469664&4294967295)<<16&4294967295|O>>>16))+((O=F+(z^J^M)+j[10]+3200236656&4294967295)<<23&4294967295|O>>>9))+((O=M+(F^z^J)+j[13]+681279174&4294967295)<<4&4294967295|O>>>28))+((O=J+(M^F^z)+j[0]+3936430074&4294967295)<<11&4294967295|O>>>21))+((O=z+(J^M^F)+j[3]+3572445317&4294967295)<<16&4294967295|O>>>16))+((O=F+(z^J^M)+j[6]+76029189&4294967295)<<23&4294967295|O>>>9))+((O=M+(F^z^J)+j[9]+3654602809&4294967295)<<4&4294967295|O>>>28))+((O=J+(M^F^z)+j[12]+3873151461&4294967295)<<11&4294967295|O>>>21))+((O=z+(J^M^F)+j[15]+530742520&4294967295)<<16&4294967295|O>>>16))+((O=F+(z^J^M)+j[2]+3299628645&4294967295)<<23&4294967295|O>>>9))+((O=M+(z^(F|~J))+j[0]+4096336452&4294967295)<<6&4294967295|O>>>26))+((O=J+(F^(M|~z))+j[7]+1126891415&4294967295)<<10&4294967295|O>>>22))+((O=z+(M^(J|~F))+j[14]+2878612391&4294967295)<<15&4294967295|O>>>17))+((O=F+(J^(z|~M))+j[5]+4237533241&4294967295)<<21&4294967295|O>>>11))+((O=M+(z^(F|~J))+j[12]+1700485571&4294967295)<<6&4294967295|O>>>26))+((O=J+(F^(M|~z))+j[3]+2399980690&4294967295)<<10&4294967295|O>>>22))+((O=z+(M^(J|~F))+j[10]+4293915773&4294967295)<<15&4294967295|O>>>17))+((O=F+(J^(z|~M))+j[1]+2240044497&4294967295)<<21&4294967295|O>>>11))+((O=M+(z^(F|~J))+j[8]+1873313359&4294967295)<<6&4294967295|O>>>26))+((O=J+(F^(M|~z))+j[15]+4264355552&4294967295)<<10&4294967295|O>>>22))+((O=z+(M^(J|~F))+j[6]+2734768916&4294967295)<<15&4294967295|O>>>17))+((O=F+(J^(z|~M))+j[13]+1309151649&4294967295)<<21&4294967295|O>>>11))+((J=(M=F+((O=M+(z^(F|~J))+j[4]+4149444226&4294967295)<<6&4294967295|O>>>26))+((O=J+(F^(M|~z))+j[11]+3174756917&4294967295)<<10&4294967295|O>>>22))^((z=J+((O=z+(M^(J|~F))+j[2]+718787259&4294967295)<<15&4294967295|O>>>17))|~M))+j[9]+3951481745&4294967295,U.g[0]=U.g[0]+M&4294967295,U.g[1]=U.g[1]+(z+(O<<21&4294967295|O>>>11))&4294967295,U.g[2]=U.g[2]+z&4294967295,U.g[3]=U.g[3]+J&4294967295}function o(U,M){this.h=M;for(var F=[],j=!0,z=U.length-1;0<=z;z--){var J=0|U[z];j&&J==M||(F[z]=J,j=!1)}this.g=F}(function e(U,M){function F(){}F.prototype=M.prototype,U.D=M.prototype,U.prototype=new F,U.prototype.constructor=U,U.C=function(j,z,J){for(var O=Array(arguments.length-2),sl=2;sl<arguments.length;sl++)O[sl-2]=arguments[sl];return M.prototype[z].apply(j,O)}})(r,function t(){this.blockSize=-1}),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},r.prototype.u=function(U,M){void 0===M&&(M=U.length);for(var F=M-this.blockSize,j=this.B,z=this.h,J=0;J<M;){if(0==z)for(;J<=F;)i(this,U,J),J+=this.blockSize;if("string"==typeof U){for(;J<M;)if(j[z++]=U.charCodeAt(J++),z==this.blockSize){i(this,j),z=0;break}}else for(;J<M;)if(j[z++]=U[J++],z==this.blockSize){i(this,j),z=0;break}}this.h=z,this.o+=M},r.prototype.v=function(){var U=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);U[0]=128;for(var M=1;M<U.length-8;++M)U[M]=0;var F=8*this.o;for(M=U.length-8;M<U.length;++M)U[M]=255&F,F/=256;for(this.u(U),U=Array(16),M=F=0;4>M;++M)for(var j=0;32>j;j+=8)U[F++]=this.g[M]>>>j&255;return U};var a={};function l(U){return-128<=U&&128>U?function s(U,M){var F=a;return Object.prototype.hasOwnProperty.call(F,U)?F[U]:F[U]=M(U)}(U,function(M){return new o([0|M],0>M?-1:0)}):new o([0|U],0>U?-1:0)}function u(U){if(isNaN(U)||!isFinite(U))return p;if(0>U)return P(u(-U));for(var M=[],F=1,j=0;U>=F;j++)M[j]=U/F|0,F*=4294967296;return new o(M,0)}var p=l(0),_=l(1),v=l(16777216);function A(U){if(0!=U.h)return!1;for(var M=0;M<U.g.length;M++)if(0!=U.g[M])return!1;return!0}function D(U){return-1==U.h}function P(U){for(var M=U.g.length,F=[],j=0;j<M;j++)F[j]=~U.g[j];return new o(F,~U.h).add(_)}function H(U,M){return U.add(P(M))}function V(U,M){for(;(65535&U[M])!=U[M];)U[M+1]+=U[M]>>>16,U[M]&=65535,M++}function Y(U,M){this.g=U,this.h=M}function ae(U,M){if(A(M))throw Error("division by zero");if(A(U))return new Y(p,p);if(D(U))return M=ae(P(U),M),new Y(P(M.g),P(M.h));if(D(M))return M=ae(U,P(M)),new Y(P(M.g),M.h);if(30<U.g.length){if(D(U)||D(M))throw Error("slowDivide_ only works with positive integers.");for(var F=_,j=M;0>=j.l(U);)F=Te(F),j=Te(j);var z=$e(F,1),J=$e(j,1);for(j=$e(j,2),F=$e(F,2);!A(j);){var O=J.add(j);0>=O.l(U)&&(z=z.add(F),J=O),j=$e(j,1),F=$e(F,1)}return M=H(U,z.j(M)),new Y(z,M)}for(z=p;0<=U.l(M);){for(F=Math.max(1,Math.floor(U.m()/M.m())),j=48>=(j=Math.ceil(Math.log(F)/Math.LN2))?1:Math.pow(2,j-48),O=(J=u(F)).j(M);D(O)||0<O.l(U);)O=(J=u(F-=j)).j(M);A(J)&&(J=_),z=z.add(J),U=H(U,O)}return new Y(z,U)}function Te(U){for(var M=U.g.length+1,F=[],j=0;j<M;j++)F[j]=U.i(j)<<1|U.i(j-1)>>>31;return new o(F,U.h)}function $e(U,M){var F=M>>5;M%=32;for(var j=U.g.length-F,z=[],J=0;J<j;J++)z[J]=0<M?U.i(J+F)>>>M|U.i(J+F+1)<<32-M:U.i(J+F);return new o(z,U.h)}(n=o.prototype).m=function(){if(D(this))return-P(this).m();for(var U=0,M=1,F=0;F<this.g.length;F++){var j=this.i(F);U+=(0<=j?j:4294967296+j)*M,M*=4294967296}return U},n.toString=function(U){if(2>(U=U||10)||36<U)throw Error("radix out of range: "+U);if(A(this))return"0";if(D(this))return"-"+P(this).toString(U);for(var M=u(Math.pow(U,6)),F=this,j="";;){var z=ae(F,M).g,J=((0<(F=H(F,z.j(M))).g.length?F.g[0]:F.h)>>>0).toString(U);if(A(F=z))return J+j;for(;6>J.length;)J="0"+J;j=J+j}},n.i=function(U){return 0>U?0:U<this.g.length?this.g[U]:this.h},n.l=function(U){return D(U=H(this,U))?-1:A(U)?0:1},n.abs=function(){return D(this)?P(this):this},n.add=function(U){for(var M=Math.max(this.g.length,U.g.length),F=[],j=0,z=0;z<=M;z++){var J=j+(65535&this.i(z))+(65535&U.i(z)),O=(J>>>16)+(this.i(z)>>>16)+(U.i(z)>>>16);j=O>>>16,F[z]=(O&=65535)<<16|(J&=65535)}return new o(F,-2147483648&F[F.length-1]?-1:0)},n.j=function(U){if(A(this)||A(U))return p;if(D(this))return D(U)?P(this).j(P(U)):P(P(this).j(U));if(D(U))return P(this.j(P(U)));if(0>this.l(v)&&0>U.l(v))return u(this.m()*U.m());for(var M=this.g.length+U.g.length,F=[],j=0;j<2*M;j++)F[j]=0;for(j=0;j<this.g.length;j++)for(var z=0;z<U.g.length;z++){var J=this.i(j)>>>16,O=65535&this.i(j),sl=U.i(z)>>>16,Ay=65535&U.i(z);F[2*j+2*z]+=O*Ay,V(F,2*j+2*z),F[2*j+2*z+1]+=J*Ay,V(F,2*j+2*z+1),F[2*j+2*z+1]+=O*sl,V(F,2*j+2*z+1),F[2*j+2*z+2]+=J*sl,V(F,2*j+2*z+2)}for(j=0;j<M;j++)F[j]=F[2*j+1]<<16|F[2*j];for(j=M;j<2*M;j++)F[j]=0;return new o(F,0)},n.A=function(U){return ae(this,U).h},n.and=function(U){for(var M=Math.max(this.g.length,U.g.length),F=[],j=0;j<M;j++)F[j]=this.i(j)&U.i(j);return new o(F,this.h&U.h)},n.or=function(U){for(var M=Math.max(this.g.length,U.g.length),F=[],j=0;j<M;j++)F[j]=this.i(j)|U.i(j);return new o(F,this.h|U.h)},n.xor=function(U){for(var M=Math.max(this.g.length,U.g.length),F=[],j=0;j<M;j++)F[j]=this.i(j)^U.i(j);return new o(F,this.h^U.h)},r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,JB=YB.Md5=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=function d(U,M){if(0==U.length)throw Error("number format error: empty string");if(2>(M=M||10)||36<M)throw Error("radix out of range: "+M);if("-"==U.charAt(0))return P(d(U.substring(1),M));if(0<=U.indexOf("-"))throw Error('number format error: interior "-" character');for(var F=u(Math.pow(M,8)),j=p,z=0;z<U.length;z+=8){var J=Math.min(8,U.length-z),O=parseInt(U.substring(z,z+J),M);8>J?(J=u(Math.pow(M,J)),j=j.j(J).add(u(O))):j=(j=j.j(F)).add(u(O))}return j},yc=YB.Integer=o}).apply(typeof QB<"u"?QB:typeof self<"u"?self:typeof window<"u"?window:{});var XB,Am,ZB,KI,dD,ej,tj,nj,qI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Ha={};(function(){var n,e="function"==typeof Object.defineProperties?Object.defineProperty:function(f,y,I){return f==Array.prototype||f==Object.prototype||(f[y]=I.value),f},r=function t(f){f=["object"==typeof globalThis&&globalThis,f,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof qI&&qI];for(var y=0;y<f.length;++y){var I=f[y];if(I&&I.Math==Math)return I}throw Error("Cannot find global object")}(this);!function i(f,y){if(y)e:{var I=r;f=f.split(".");for(var S=0;S<f.length-1;S++){var G=f[S];if(!(G in I))break e;I=I[G]}(y=y(S=I[f=f[f.length-1]]))!=S&&null!=y&&e(I,f,{configurable:!0,writable:!0,value:y})}}("Array.prototype.values",function(f){return f||function(){return function s(f,y){f instanceof String&&(f+="");var I=0,S=!1,G={next:function(){if(!S&&I<f.length){var ne=I++;return{value:y(ne,f[ne]),done:!1}}return S=!0,{done:!0,value:void 0}}};return G[Symbol.iterator]=function(){return G},G}(this,function(y,I){return I})}});var o=o||{},a=this||self;function l(f){var y=typeof f;return"array"==(y="object"!=y?y:f?Array.isArray(f)?"array":y:"null")||"object"==y&&"number"==typeof f.length}function u(f){var y=typeof f;return"object"==y&&null!=f||"function"==y}function d(f,y,I){return f.call.apply(f.bind,arguments)}function p(f,y,I){if(!f)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var G=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(G,S),f.apply(y,G)}}return function(){return f.apply(y,arguments)}}function _(f,y,I){return(_=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?d:p).apply(null,arguments)}function v(f,y){var I=Array.prototype.slice.call(arguments,1);return function(){var S=I.slice();return S.push.apply(S,arguments),f.apply(this,S)}}function A(f,y){function I(){}I.prototype=y.prototype,f.aa=y.prototype,f.prototype=new I,f.prototype.constructor=f,f.Qb=function(S,G,ne){for(var xe=Array(arguments.length-2),wn=2;wn<arguments.length;wn++)xe[wn-2]=arguments[wn];return y.prototype[G].apply(S,xe)}}function D(f){const y=f.length;if(0<y){const I=Array(y);for(let S=0;S<y;S++)I[S]=f[S];return I}return[]}function P(f,y){for(let I=1;I<arguments.length;I++){const S=arguments[I];if(l(S)){const G=f.length||0,ne=S.length||0;f.length=G+ne;for(let xe=0;xe<ne;xe++)f[G+xe]=S[xe]}else f.push(S)}}function V(f){return/^[\s\xa0]*$/.test(f)}function Y(){var f=a.navigator;return f&&(f=f.userAgent)?f:""}function ae(f){return ae[" "](f),f}ae[" "]=function(){};var Te=!(-1==Y().indexOf("Gecko")||-1!=Y().toLowerCase().indexOf("webkit")&&-1==Y().indexOf("Edge")||-1!=Y().indexOf("Trident")||-1!=Y().indexOf("MSIE")||-1!=Y().indexOf("Edge"));function $e(f,y,I){for(const S in f)y.call(I,f[S],S,f)}function M(f){const y={};for(const I in f)y[I]=f[I];return y}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(f,y){let I,S;for(let G=1;G<arguments.length;G++){for(I in S=arguments[G],S)f[I]=S[I];for(let ne=0;ne<F.length;ne++)I=F[ne],Object.prototype.hasOwnProperty.call(S,I)&&(f[I]=S[I])}}function z(f){var y=1;f=f.split(":");const I=[];for(;0<y&&f.length;)I.push(f.shift()),y--;return f.length&&I.push(f.join(":")),I}function J(f){a.setTimeout(()=>{throw f},0)}function O(){var f=u1;let y=null;return f.g&&(y=f.g,f.g=f.g.next,f.g||(f.h=null),y.next=null),y}var Ay=new class H{constructor(y,I){this.i=y,this.j=I,this.h=0,this.g=null}get(){let y;return 0<this.h?(this.h--,y=this.g,this.g=y.next,y.next=null):y=this.i(),y}}(()=>new OEe,f=>f.reset());class OEe{constructor(){this.next=this.g=this.h=null}set(y,I){this.h=y,this.g=I,this.next=null}reset(){this.next=this.g=this.h=null}}let by,Sy=!1,u1=new class sl{constructor(){this.h=this.g=null}add(y,I){const S=Ay.get();S.set(y,I),this.h?this.h.next=S:this.g=S,this.h=S}},o6=()=>{const f=a.Promise.resolve(void 0);by=()=>{f.then(FEe)}};var FEe=()=>{for(var f;f=O();){try{f.h.call(f.g)}catch(I){J(I)}var y=Ay;y.j(f),100>y.h&&(y.h++,f.next=y.g,y.g=f)}Sy=!1};function Du(){this.s=this.s,this.C=this.C}function Di(f,y){this.type=f,this.g=this.target=y,this.defaultPrevented=!1}Du.prototype.s=!1,Du.prototype.ma=function(){this.s||(this.s=!0,this.N())},Du.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},Di.prototype.h=function(){this.defaultPrevented=!0};var LEe=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var f=!1,y=Object.defineProperty({},"passive",{get:function(){f=!0}});try{const I=()=>{};a.addEventListener("test",I,y),a.removeEventListener("test",I,y)}catch{}return f}();function Dy(f,y){if(Di.call(this,f?f.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,f){var I=this.type=f.type,S=f.changedTouches&&f.changedTouches.length?f.changedTouches[0]:null;if(this.target=f.target||f.srcElement,this.g=y,y=f.relatedTarget){if(Te){e:{try{ae(y.nodeName);var G=!0;break e}catch{}G=!1}G||(y=null)}}else"mouseover"==I?y=f.fromElement:"mouseout"==I&&(y=f.toElement);this.relatedTarget=y,S?(this.clientX=void 0!==S.clientX?S.clientX:S.pageX,this.clientY=void 0!==S.clientY?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=void 0!==f.clientX?f.clientX:f.pageX,this.clientY=void 0!==f.clientY?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0),this.button=f.button,this.key=f.key||"",this.ctrlKey=f.ctrlKey,this.altKey=f.altKey,this.shiftKey=f.shiftKey,this.metaKey=f.metaKey,this.pointerId=f.pointerId||0,this.pointerType="string"==typeof f.pointerType?f.pointerType:VEe[f.pointerType]||"",this.state=f.state,this.i=f,f.defaultPrevented&&Dy.aa.h.call(this)}}A(Dy,Di);var VEe={2:"touch",3:"pen",4:"mouse"};Dy.prototype.h=function(){Dy.aa.h.call(this);var f=this.i;f.preventDefault?f.preventDefault():f.returnValue=!1};var Ry="closure_listenable_"+(1e6*Math.random()|0),UEe=0;function BEe(f,y,I,S,G){this.listener=f,this.proxy=null,this.src=y,this.type=I,this.capture=!!S,this.ha=G,this.key=++UEe,this.da=this.fa=!1}function H0(f){f.da=!0,f.listener=null,f.proxy=null,f.src=null,f.ha=null}function z0(f){this.src=f,this.g={},this.h=0}function c1(f,y){var I=y.type;if(I in f.g){var ne,S=f.g[I],G=Array.prototype.indexOf.call(S,y,void 0);(ne=0<=G)&&Array.prototype.splice.call(S,G,1),ne&&(H0(y),0==f.g[I].length&&(delete f.g[I],f.h--))}}function d1(f,y,I,S){for(var G=0;G<f.length;++G){var ne=f[G];if(!ne.da&&ne.listener==y&&ne.capture==!!I&&ne.ha==S)return G}return-1}z0.prototype.add=function(f,y,I,S,G){var ne=f.toString();(f=this.g[ne])||(f=this.g[ne]=[],this.h++);var xe=d1(f,y,S,G);return-1<xe?(y=f[xe],I||(y.fa=!1)):((y=new BEe(y,this.src,ne,!!S,G)).fa=I,f.push(y)),y};var h1="closure_lm_"+(1e6*Math.random()|0),f1={};function a6(f,y,I,S,G){if(S&&S.once)return u6(f,y,I,S,G);if(Array.isArray(y)){for(var ne=0;ne<y.length;ne++)a6(f,y[ne],I,S,G);return null}return I=_1(I),f&&f[Ry]?f.K(y,I,u(S)?!!S.capture:!!S,G):l6(f,y,I,!1,S,G)}function l6(f,y,I,S,G,ne){if(!y)throw Error("Invalid event type");var xe=u(G)?!!G.capture:!!G,wn=g1(f);if(wn||(f[h1]=wn=new z0(f)),(I=wn.add(y,I,S,xe,ne)).proxy)return I;if(S=function jEe(){const y=$Ee;return function f(I){return y.call(f.src,f.listener,I)}}(),I.proxy=S,S.src=f,S.listener=I,f.addEventListener)LEe||(G=xe),void 0===G&&(G=!1),f.addEventListener(y.toString(),S,G);else if(f.attachEvent)f.attachEvent(d6(y.toString()),S);else{if(!f.addListener||!f.removeListener)throw Error("addEventListener and attachEvent are unavailable.");f.addListener(S)}return I}function u6(f,y,I,S,G){if(Array.isArray(y)){for(var ne=0;ne<y.length;ne++)u6(f,y[ne],I,S,G);return null}return I=_1(I),f&&f[Ry]?f.L(y,I,u(S)?!!S.capture:!!S,G):l6(f,y,I,!0,S,G)}function c6(f,y,I,S,G){if(Array.isArray(y))for(var ne=0;ne<y.length;ne++)c6(f,y[ne],I,S,G);else S=u(S)?!!S.capture:!!S,I=_1(I),f&&f[Ry]?(f=f.i,(y=String(y).toString())in f.g&&-1<(I=d1(ne=f.g[y],I,S,G))&&(H0(ne[I]),Array.prototype.splice.call(ne,I,1),0==ne.length&&(delete f.g[y],f.h--))):f&&(f=g1(f))&&(y=f.g[y.toString()],f=-1,y&&(f=d1(y,I,S,G)),(I=-1<f?y[f]:null)&&p1(I))}function p1(f){if("number"!=typeof f&&f&&!f.da){var y=f.src;if(y&&y[Ry])c1(y.i,f);else{var I=f.type,S=f.proxy;y.removeEventListener?y.removeEventListener(I,S,f.capture):y.detachEvent?y.detachEvent(d6(I),S):y.addListener&&y.removeListener&&y.removeListener(S),(I=g1(y))?(c1(I,f),0==I.h&&(I.src=null,y[h1]=null)):H0(f)}}}function d6(f){return f in f1?f1[f]:f1[f]="on"+f}function $Ee(f,y){if(f.da)f=!0;else{y=new Dy(y,this);var I=f.listener,S=f.ha||f.src;f.fa&&p1(f),f=I.call(S,y)}return f}function g1(f){return(f=f[h1])instanceof z0?f:null}var m1="__closure_events_fn_"+(1e9*Math.random()>>>0);function _1(f){return"function"==typeof f?f:(f[m1]||(f[m1]=function(y){return f.handleEvent(y)}),f[m1])}function Ri(){Du.call(this),this.i=new z0(this),this.M=this,this.F=null}function Yi(f,y){var I,S=f.F;if(S)for(I=[];S;S=S.F)I.push(S);if(f=f.M,S=y.type||y,"string"==typeof y)y=new Di(y,f);else if(y instanceof Di)y.target=y.target||f;else{var G=y;j(y=new Di(S,f),G)}if(G=!0,I)for(var ne=I.length-1;0<=ne;ne--){var xe=y.g=I[ne];G=W0(xe,S,!0,y)&&G}if(G=W0(xe=y.g=f,S,!0,y)&&G,G=W0(xe,S,!1,y)&&G,I)for(ne=0;ne<I.length;ne++)G=W0(xe=y.g=I[ne],S,!1,y)&&G}function W0(f,y,I,S){if(!(y=f.i.g[String(y)]))return!0;y=y.concat();for(var G=!0,ne=0;ne<y.length;++ne){var xe=y[ne];if(xe&&!xe.da&&xe.capture==I){var wn=xe.listener,di=xe.ha||xe.src;xe.fa&&c1(f.i,xe),G=!1!==wn.call(di,S)&&G}}return G&&!S.defaultPrevented}function h6(f,y,I){if("function"==typeof f)I&&(f=_(f,I));else{if(!f||"function"!=typeof f.handleEvent)throw Error("Invalid listener argument");f=_(f.handleEvent,f)}return 2147483647<Number(y)?-1:a.setTimeout(f,y||0)}function f6(f){f.g=h6(()=>{f.g=null,f.i&&(f.i=!1,f6(f))},f.l);const y=f.h;f.h=null,f.m.apply(null,y)}A(Ri,Du),Ri.prototype[Ry]=!0,Ri.prototype.removeEventListener=function(f,y,I,S){c6(this,f,y,I,S)},Ri.prototype.N=function(){if(Ri.aa.N.call(this),this.i){var y,f=this.i;for(y in f.g){for(var I=f.g[y],S=0;S<I.length;S++)H0(I[S]);delete f.g[y],f.h--}}this.F=null},Ri.prototype.K=function(f,y,I,S){return this.i.add(String(f),y,!1,I,S)},Ri.prototype.L=function(f,y,I,S){return this.i.add(String(f),y,!0,I,S)};class HEe extends Du{constructor(y,I){super(),this.m=y,this.l=I,this.h=null,this.i=!1,this.g=null}j(y){this.h=arguments,this.g?this.i=!0:f6(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xy(f){Du.call(this),this.h=f,this.g={}}A(xy,Du);var p6=[];function g6(f){$e(f.g,function(y,I){this.g.hasOwnProperty(I)&&p1(y)},f),f.g={}}xy.prototype.N=function(){xy.aa.N.call(this),g6(this)},xy.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var y1=a.JSON.stringify,zEe=a.JSON.parse,WEe=class{stringify(f){return a.JSON.stringify(f,void 0)}parse(f){return a.JSON.parse(f,void 0)}};function v1(){}function _6(){}v1.prototype.h=null;var Py={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function E1(){Di.call(this,"d")}function I1(){Di.call(this,"c")}A(E1,Di),A(I1,Di);var hd={},y6=null;function G0(){return y6=y6||new Ri}function v6(f){Di.call(this,hd.La,f)}function Ny(f){const y=G0();Yi(y,new v6(y))}function E6(f,y){Di.call(this,hd.STAT_EVENT,f),this.stat=y}function Ji(f){const y=G0();Yi(y,new E6(y,f))}function I6(f,y){Di.call(this,hd.Ma,f),this.size=y}function My(f,y){if("function"!=typeof f)throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){f()},y)}function ky(){this.g=!0}function fp(f,y,I,S){f.info(function(){return"XMLHTTP TEXT ("+y+"): "+function QEe(f,y){if(!f.g)return y;if(!y)return null;try{var I=JSON.parse(y);if(I)for(f=0;f<I.length;f++)if(Array.isArray(I[f])){var S=I[f];if(!(2>S.length)){var G=S[1];if(Array.isArray(G)&&!(1>G.length)){var ne=G[0];if("noop"!=ne&&"stop"!=ne&&"close"!=ne)for(var xe=1;xe<G.length;xe++)G[xe]=""}}}return y1(I)}catch{return y}}(f,I)+(S?" "+S:"")})}hd.La="serverreachability",A(v6,Di),hd.STAT_EVENT="statevent",A(E6,Di),hd.Ma="timingevent",A(I6,Di),ky.prototype.xa=function(){this.g=!1},ky.prototype.info=function(){};var w1,q0={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},w6={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function K0(){}function Ru(f,y,I,S){this.j=f,this.i=y,this.l=I,this.R=S||1,this.U=new xy(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new C6}function C6(){this.i=null,this.g="",this.h=!1}A(K0,v1),K0.prototype.g=function(){return new XMLHttpRequest},K0.prototype.i=function(){return{}},w1=new K0;var T6={},C1={};function T1(f,y,I){f.L=1,f.v=X0(ol(y)),f.m=I,f.P=!0,A6(f,null)}function A6(f,y){f.F=Date.now(),Q0(f),f.A=ol(f.v);var I=f.A,S=f.R;Array.isArray(S)||(S=[String(S)]),U6(I.i,"t",S),f.C=0,I=f.j.J,f.h=new C6,f.g=r9(f.j,I?y:null,!f.m),0<f.O&&(f.M=new HEe(_(f.Y,f,f.g),f.O)),y=f.U,I=f.g,S=f.ca;var G="readystatechange";Array.isArray(G)||(G&&(p6[0]=G.toString()),G=p6);for(var ne=0;ne<G.length;ne++){var xe=a6(I,G[ne],S||y.handleEvent,!1,y.h||y);if(!xe)break;y.g[xe.key]=xe}y=f.H?M(f.H):{},f.m?(f.u||(f.u="POST"),y["Content-Type"]="application/x-www-form-urlencoded",f.g.ea(f.A,f.u,f.m,y)):(f.u="GET",f.g.ea(f.A,f.u,null,y)),Ny(),function GEe(f,y,I,S,G,ne){f.info(function(){if(f.g)if(ne)for(var xe="",wn=ne.split("&"),di=0;di<wn.length;di++){var Kt=wn[di].split("=");if(1<Kt.length){var xi=Kt[0];Kt=Kt[1];var Pi=xi.split("_");xe=2<=Pi.length&&"type"==Pi[1]?xe+(xi+"=")+Kt+"&":xe+(xi+"=redacted&")}}else xe=null;else xe=ne;return"XMLHTTP REQ ("+S+") [attempt "+G+"]: "+y+"\n"+I+"\n"+xe})}(f.i,f.u,f.A,f.l,f.R,f.m)}function b6(f){return!!f.g&&"GET"==f.u&&2!=f.L&&f.j.Ca}function YEe(f,y){var I=f.C,S=y.indexOf("\n",I);return-1==S?C1:(I=Number(y.substring(I,S)),isNaN(I)?T6:(S+=1)+I>y.length?C1:(y=y.slice(S,S+I),f.C=S+I,y))}function Q0(f){f.S=Date.now()+f.I,S6(f,f.I)}function S6(f,y){if(null!=f.B)throw Error("WatchDog timer not null");f.B=My(_(f.ba,f),y)}function A1(f){f.B&&(a.clearTimeout(f.B),f.B=null)}function Oy(f){0==f.j.G||f.J||Z6(f.j,f)}function fd(f){A1(f);var y=f.M;y&&"function"==typeof y.ma&&y.ma(),f.M=null,g6(f.U),f.g&&(y=f.g,f.g=null,y.abort(),y.ma())}function b1(f,y){try{var I=f.j;if(0!=I.G&&(I.g==f||S1(I.h,f)))if(!f.K&&S1(I.h,f)&&3==I.G){try{var S=I.Da.g.parse(y)}catch{S=null}if(Array.isArray(S)&&3==S.length){var G=S;if(0==G[0]){e:if(!I.u){if(I.g){if(!(I.g.F+3e3<f.F))break e;rT(I),tT(I)}P1(I),Ji(18)}}else I.za=G[1],0<I.za-I.T&&37500>G[2]&&I.F&&0==I.v&&!I.C&&(I.C=My(_(I.Za,I),6e3));if(1>=x6(I.h)&&I.ca){try{I.ca()}catch{}I.ca=void 0}}else gd(I,11)}else if((f.K||I.g==f)&&rT(I),!V(y))for(G=I.Da.g.parse(y),y=0;y<G.length;y++){let Kt=G[y];if(I.T=Kt[0],Kt=Kt[1],2==I.G)if("c"==Kt[0]){I.K=Kt[1],I.ia=Kt[2];const xi=Kt[3];null!=xi&&(I.la=xi,I.j.info("VER="+I.la));const Pi=Kt[4];null!=Pi&&(I.Aa=Pi,I.j.info("SVER="+I.Aa));const mp=Kt[5];null!=mp&&"number"==typeof mp&&0<mp&&(I.L=S=1.5*mp,I.j.info("backChannelRequestTimeoutMs_="+S)),S=I;const xo=f.g;if(xo){const sT=xo.g?xo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(sT){var ne=S.h;ne.g||-1==sT.indexOf("spdy")&&-1==sT.indexOf("quic")&&-1==sT.indexOf("h2")||(ne.j=ne.l,ne.g=new Set,ne.h&&(D1(ne,ne.h),ne.h=null))}if(S.D){const M1=xo.g?xo.g.getResponseHeader("X-HTTP-Session-Id"):null;M1&&(S.ya=M1,zn(S.I,S.D,M1))}}I.G=3,I.l&&I.l.ua(),I.ba&&(I.R=Date.now()-f.F,I.j.info("Handshake RTT: "+I.R+"ms"));var xe=f;if((S=I).qa=n9(S,S.J?S.ia:null,S.W),xe.K){P6(S.h,xe);var wn=xe,di=S.L;di&&(wn.I=di),wn.B&&(A1(wn),Q0(wn)),S.g=xe}else J6(S);0<I.i.length&&nT(I)}else"stop"!=Kt[0]&&"close"!=Kt[0]||gd(I,7);else 3==I.G&&("stop"==Kt[0]||"close"==Kt[0]?"stop"==Kt[0]?gd(I,7):x1(I):"noop"!=Kt[0]&&I.l&&I.l.ta(Kt),I.v=0)}Ny()}catch{}}function D6(f){this.l=f||10,f=a.PerformanceNavigationTiming?0<(f=a.performance.getEntriesByType("navigation")).length&&("hq"==f[0].nextHopProtocol||"h2"==f[0].nextHopProtocol):!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=f?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function R6(f){return!!f.h||!!f.g&&f.g.size>=f.j}function x6(f){return f.h?1:f.g?f.g.size:0}function S1(f,y){return f.h?f.h==y:!!f.g&&f.g.has(y)}function D1(f,y){f.g?f.g.add(y):f.h=y}function P6(f,y){f.h&&f.h==y?f.h=null:f.g&&f.g.has(y)&&f.g.delete(y)}function N6(f){if(null!=f.h)return f.i.concat(f.h.D);if(null!=f.g&&0!==f.g.size){let y=f.i;for(const I of f.g.values())y=y.concat(I.D);return y}return D(f.i)}function M6(f,y){if(f.forEach&&"function"==typeof f.forEach)f.forEach(y,void 0);else if(l(f)||"string"==typeof f)Array.prototype.forEach.call(f,y,void 0);else for(var I=function ZEe(f){if(f.na&&"function"==typeof f.na)return f.na();if(!f.V||"function"!=typeof f.V){if(typeof Map<"u"&&f instanceof Map)return Array.from(f.keys());if(!(typeof Set<"u"&&f instanceof Set)){if(l(f)||"string"==typeof f){var y=[];f=f.length;for(var I=0;I<f;I++)y.push(I);return y}y=[],I=0;for(const S in f)y[I++]=S;return y}}}(f),S=function XEe(f){if(f.V&&"function"==typeof f.V)return f.V();if(typeof Map<"u"&&f instanceof Map||typeof Set<"u"&&f instanceof Set)return Array.from(f.values());if("string"==typeof f)return f.split("");if(l(f)){for(var y=[],I=f.length,S=0;S<I;S++)y.push(f[S]);return y}for(S in y=[],I=0,f)y[I++]=f[S];return y}(f),G=S.length,ne=0;ne<G;ne++)y.call(void 0,S[ne],I&&I[ne],f)}Ru.prototype.ca=function(f){f=f.target;const y=this.M;y&&3==al(f)?y.j():this.Y(f)},Ru.prototype.Y=function(f){try{if(f==this.g)e:{const Pi=al(this.g);var y=this.g.Ba();if(this.g.Z(),!(3>Pi)&&(3!=Pi||this.g&&(this.h.h||this.g.oa()||G6(this.g)))){this.J||4!=Pi||7==y||Ny(),A1(this);var I=this.g.Z();this.X=I;t:if(b6(this)){var S=G6(this.g);f="";var G=S.length,ne=4==al(this.g);if(!this.h.i){if(typeof TextDecoder>"u"){fd(this),Oy(this);var xe="";break t}this.h.i=new a.TextDecoder}for(y=0;y<G;y++)this.h.h=!0,f+=this.h.i.decode(S[y],{stream:!(ne&&y==G-1)});S.length=0,this.h.g+=f,this.C=0,xe=this.h.g}else xe=this.g.oa();if(this.o=200==I,function qEe(f,y,I,S,G,ne,xe){f.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+G+"]: "+y+"\n"+I+"\n"+ne+" "+xe})}(this.i,this.u,this.A,this.l,this.R,Pi,I),this.o){if(this.T&&!this.K){t:{if(this.g){var wn,di=this.g;if((wn=di.g?di.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!V(wn)){var Kt=wn;break t}}Kt=null}if(!(I=Kt)){this.o=!1,this.s=3,Ji(12),fd(this),Oy(this);break e}fp(this.i,this.l,I,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,b1(this,I)}if(this.P){let xo;for(I=!0;!this.J&&this.C<xe.length;){if(xo=YEe(this,xe),xo==C1){4==Pi&&(this.s=4,Ji(14),I=!1),fp(this.i,this.l,null,"[Incomplete Response]");break}if(xo==T6){this.s=4,Ji(15),fp(this.i,this.l,xe,"[Invalid Chunk]"),I=!1;break}fp(this.i,this.l,xo,null),b1(this,xo)}if(b6(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=Pi||0!=xe.length||this.h.h||(this.s=1,Ji(16),I=!1),this.o=this.o&&I,I){if(0<xe.length&&!this.W){this.W=!0;var xi=this.j;xi.g==this&&xi.ba&&!xi.M&&(xi.j.info("Great, no buffering proxy detected. Bytes received: "+xe.length),N1(xi),xi.M=!0,Ji(11))}}else fp(this.i,this.l,xe,"[Invalid Chunked Response]"),fd(this),Oy(this)}else fp(this.i,this.l,xe,null),b1(this,xe);4==Pi&&fd(this),this.o&&!this.J&&(4==Pi?Z6(this.j,this):(this.o=!1,Q0(this)))}else(function fIe(f){const y={};f=(f.g&&2<=al(f)&&f.g.getAllResponseHeaders()||"").split("\r\n");for(let S=0;S<f.length;S++){if(V(f[S]))continue;var I=z(f[S]);const G=I[0];if("string"!=typeof(I=I[1]))continue;I=I.trim();const ne=y[G]||[];y[G]=ne,ne.push(I)}!function U(f,y){for(const I in f)y.call(void 0,f[I],I,f)}(y,function(S){return S.join(", ")})})(this.g),400==I&&0<xe.indexOf("Unknown SID")?(this.s=3,Ji(12)):(this.s=0,Ji(13)),fd(this),Oy(this)}}}catch{}},Ru.prototype.cancel=function(){this.J=!0,fd(this)},Ru.prototype.ba=function(){this.B=null;const f=Date.now();0<=f-this.S?(function KEe(f,y){f.info(function(){return"TIMEOUT: "+y})}(this.i,this.A),2!=this.L&&(Ny(),Ji(17)),fd(this),this.s=2,Oy(this)):S6(this,this.S-f)},D6.prototype.cancel=function(){if(this.i=N6(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const f of this.g.values())f.cancel();this.g.clear()}};var k6=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function pd(f){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,f instanceof pd){this.h=f.h,Y0(this,f.j),this.o=f.o,this.g=f.g,J0(this,f.s),this.l=f.l;var y=f.i,I=new Vy;I.i=y.i,y.g&&(I.g=new Map(y.g),I.h=y.h),O6(this,I),this.m=f.m}else f&&(y=String(f).match(k6))?(this.h=!1,Y0(this,y[1]||"",!0),this.o=Fy(y[2]||""),this.g=Fy(y[3]||"",!0),J0(this,y[4]),this.l=Fy(y[5]||"",!0),O6(this,y[6]||"",!0),this.m=Fy(y[7]||"")):(this.h=!1,this.i=new Vy(null,this.h))}function ol(f){return new pd(f)}function Y0(f,y,I){f.j=I?Fy(y,!0):y,f.j&&(f.j=f.j.replace(/:$/,""))}function J0(f,y){if(y){if(y=Number(y),isNaN(y)||0>y)throw Error("Bad port number "+y);f.s=y}else f.s=null}function O6(f,y,I){y instanceof Vy?(f.i=y,function oIe(f,y){y&&!f.j&&(xu(f),f.i=null,f.g.forEach(function(I,S){var G=S.toLowerCase();S!=G&&(L6(this,S),U6(this,G,I))},f)),f.j=y}(f.i,f.h)):(I||(y=Ly(y,iIe)),f.i=new Vy(y,f.h))}function zn(f,y,I){f.i.set(y,I)}function X0(f){return zn(f,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),f}function Fy(f,y){return f?y?decodeURI(f.replace(/%25/g,"%2525")):decodeURIComponent(f):""}function Ly(f,y,I){return"string"==typeof f?(f=encodeURI(f).replace(y,tIe),I&&(f=f.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),f):null}function tIe(f){return"%"+((f=f.charCodeAt(0))>>4&15).toString(16)+(15&f).toString(16)}pd.prototype.toString=function(){var f=[],y=this.j;y&&f.push(Ly(y,F6,!0),":");var I=this.g;return(I||"file"==y)&&(f.push("//"),(y=this.o)&&f.push(Ly(y,F6,!0),"@"),f.push(encodeURIComponent(String(I)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(I=this.s)&&f.push(":",String(I))),(I=this.l)&&(this.g&&"/"!=I.charAt(0)&&f.push("/"),f.push(Ly(I,"/"==I.charAt(0)?rIe:nIe,!0))),(I=this.i.toString())&&f.push("?",I),(I=this.m)&&f.push("#",Ly(I,sIe)),f.join("")};var f,F6=/[#\/\?@]/g,nIe=/[#\?:]/g,rIe=/[#\?]/g,iIe=/[#\?@]/g,sIe=/#/g;function Vy(f,y){this.h=this.g=null,this.i=f||null,this.j=!!y}function xu(f){f.g||(f.g=new Map,f.h=0,f.i&&function eIe(f,y){if(f){f=f.split("&");for(var I=0;I<f.length;I++){var S=f[I].indexOf("="),G=null;if(0<=S){var ne=f[I].substring(0,S);G=f[I].substring(S+1)}else ne=f[I];y(ne,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}(f.i,function(y,I){f.add(decodeURIComponent(y.replace(/\+/g," ")),I)}))}function L6(f,y){xu(f),y=pp(f,y),f.g.has(y)&&(f.i=null,f.h-=f.g.get(y).length,f.g.delete(y))}function V6(f,y){return xu(f),y=pp(f,y),f.g.has(y)}function U6(f,y,I){L6(f,y),0<I.length&&(f.i=null,f.g.set(pp(f,y),D(I)),f.h+=I.length)}function pp(f,y){return y=String(y),f.j&&(y=y.toLowerCase()),y}function Pu(f,y,I,S,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),S(I)}catch{}}function uIe(){this.g=new WEe}function cIe(f,y,I){const S=I||"";try{M6(f,function(G,ne){let xe=G;u(G)&&(xe=y1(G)),y.push(S+ne+"="+encodeURIComponent(xe))})}catch(G){throw y.push(S+"type="+encodeURIComponent("_badmap")),G}}function Uy(f){this.l=f.Ub||null,this.j=f.eb||!1}function Z0(f,y){Ri.call(this),this.D=f,this.o=y,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function B6(f){f.j.read().then(f.Pa.bind(f)).catch(f.ga.bind(f))}function By(f){f.readyState=4,f.l=null,f.j=null,f.v=null,jy(f)}function jy(f){f.onreadystatechange&&f.onreadystatechange.call(f)}function j6(f){let y="";return $e(f,function(I,S){y+=S,y+=":",y+=I,y+="\r\n"}),y}function R1(f,y,I){e:{for(S in I){var S=!1;break e}S=!0}S||(I=j6(I),"string"==typeof f?null!=I&&encodeURIComponent(String(I)):zn(f,y,I))}function fr(f){Ri.call(this),this.headers=new Map,this.o=f||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(n=Vy.prototype).add=function(f,y){xu(this),this.i=null,f=pp(this,f);var I=this.g.get(f);return I||this.g.set(f,I=[]),I.push(y),this.h+=1,this},n.forEach=function(f,y){xu(this),this.g.forEach(function(I,S){I.forEach(function(G){f.call(y,G,S,this)},this)},this)},n.na=function(){xu(this);const f=Array.from(this.g.values()),y=Array.from(this.g.keys()),I=[];for(let S=0;S<y.length;S++){const G=f[S];for(let ne=0;ne<G.length;ne++)I.push(y[S])}return I},n.V=function(f){xu(this);let y=[];if("string"==typeof f)V6(this,f)&&(y=y.concat(this.g.get(pp(this,f))));else{f=Array.from(this.g.values());for(let I=0;I<f.length;I++)y=y.concat(f[I])}return y},n.set=function(f,y){return xu(this),this.i=null,V6(this,f=pp(this,f))&&(this.h-=this.g.get(f).length),this.g.set(f,[y]),this.h+=1,this},n.get=function(f,y){return f&&0<(f=this.V(f)).length?String(f[0]):y},n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const f=[],y=Array.from(this.g.keys());for(var I=0;I<y.length;I++){var S=y[I];const ne=encodeURIComponent(String(S)),xe=this.V(S);for(S=0;S<xe.length;S++){var G=ne;""!==xe[S]&&(G+="="+encodeURIComponent(String(xe[S]))),f.push(G)}}return this.i=f.join("&")},A(Uy,v1),Uy.prototype.g=function(){return new Z0(this.l,this.j)},Uy.prototype.i=(f={},function(){return f}),A(Z0,Ri),(n=Z0.prototype).open=function(f,y){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=f,this.A=y,this.readyState=1,jy(this)},n.send=function(f){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const y={headers:this.u,method:this.B,credentials:this.m,cache:void 0};f&&(y.body=f),(this.D||a).fetch(new Request(this.A,y)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,By(this)),this.readyState=0},n.Sa=function(f){if(this.g&&(this.l=f,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=f.headers,this.readyState=2,jy(this)),this.g&&(this.readyState=3,jy(this),this.g)))if("arraybuffer"===this.responseType)f.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in f){if(this.j=f.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;B6(this)}else f.text().then(this.Ra.bind(this),this.ga.bind(this))},n.Pa=function(f){if(this.g){if(this.o&&f.value)this.response.push(f.value);else if(!this.o){var y=f.value?f.value:new Uint8Array(0);(y=this.v.decode(y,{stream:!f.done}))&&(this.response=this.responseText+=y)}f.done?By(this):jy(this),3==this.readyState&&B6(this)}},n.Ra=function(f){this.g&&(this.response=this.responseText=f,By(this))},n.Qa=function(f){this.g&&(this.response=f,By(this))},n.ga=function(){this.g&&By(this)},n.setRequestHeader=function(f,y){this.u.append(f,y)},n.getResponseHeader=function(f){return this.h&&this.h.get(f.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const f=[],y=this.h.entries();for(var I=y.next();!I.done;)f.push((I=I.value)[0]+": "+I[1]),I=y.next();return f.join("\r\n")},Object.defineProperty(Z0.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(f){this.m=f?"include":"same-origin"}}),A(fr,Ri);var dIe=/^https?$/i,hIe=["POST","PUT"];function $6(f,y){f.h=!1,f.g&&(f.j=!0,f.g.abort(),f.j=!1),f.l=y,f.m=5,H6(f),eT(f)}function H6(f){f.A||(f.A=!0,Yi(f,"complete"),Yi(f,"error"))}function z6(f){if(f.h&&typeof o<"u"&&(!f.v[1]||4!=al(f)||2!=f.Z()))if(f.u&&4==al(f))h6(f.Ea,0,f);else if(Yi(f,"readystatechange"),4==al(f)){f.h=!1;try{const xe=f.Z();e:switch(xe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var y=!0;break e;default:y=!1}var I;if(!(I=y)){var S;if(S=0===xe){var G=String(f.D).match(k6)[1]||null;!G&&a.self&&a.self.location&&(G=a.self.location.protocol.slice(0,-1)),S=!dIe.test(G?G.toLowerCase():"")}I=S}if(I)Yi(f,"complete"),Yi(f,"success");else{f.m=6;try{var ne=2<al(f)?f.g.statusText:""}catch{ne=""}f.l=ne+" ["+f.Z()+"]",H6(f)}}finally{eT(f)}}}function eT(f,y){if(f.g){W6(f);const I=f.g,S=f.v[0]?()=>{}:null;f.g=null,f.v=null,y||Yi(f,"ready");try{I.onreadystatechange=S}catch{}}}function W6(f){f.I&&(a.clearTimeout(f.I),f.I=null)}function al(f){return f.g?f.g.readyState:0}function G6(f){try{if(!f.g)return null;if("response"in f.g)return f.g.response;switch(f.H){case"":case"text":return f.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in f.g)return f.g.mozResponseArrayBuffer}return null}catch{return null}}function $y(f,y,I){return I&&I.internalChannelParams&&I.internalChannelParams[f]||y}function q6(f){this.Aa=0,this.i=[],this.j=new ky,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$y("failFast",!1,f),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$y("baseRetryDelayMs",5e3,f),this.cb=$y("retryDelaySeedMs",1e4,f),this.Wa=$y("forwardChannelMaxRetries",2,f),this.wa=$y("forwardChannelRequestTimeoutMs",2e4,f),this.pa=f&&f.xmlHttpFactory||void 0,this.Xa=f&&f.Tb||void 0,this.Ca=f&&f.useFetchStreams||!1,this.L=void 0,this.J=f&&f.supportsCrossDomainXhr||!1,this.K="",this.h=new D6(f&&f.concurrentRequestLimit),this.Da=new uIe,this.P=f&&f.fastHandshake||!1,this.O=f&&f.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=f&&f.Rb||!1,f&&f.xa&&this.j.xa(),f&&f.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&f&&f.detectBufferingProxy||!1,this.ja=void 0,f&&f.longPollingTimeout&&0<f.longPollingTimeout&&(this.ja=f.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function x1(f){if(K6(f),3==f.G){var y=f.U++,I=ol(f.I);if(zn(I,"SID",f.K),zn(I,"RID",y),zn(I,"TYPE","terminate"),Hy(f,I),(y=new Ru(f,f.j,y)).L=2,y.v=X0(ol(I)),I=!1,a.navigator&&a.navigator.sendBeacon)try{I=a.navigator.sendBeacon(y.v.toString(),"")}catch{}!I&&a.Image&&((new Image).src=y.v,I=!0),I||(y.g=r9(y.j,null),y.g.ea(y.v)),y.F=Date.now(),Q0(y)}t9(f)}function tT(f){f.g&&(N1(f),f.g.cancel(),f.g=null)}function K6(f){tT(f),f.u&&(a.clearTimeout(f.u),f.u=null),rT(f),f.h.cancel(),f.s&&("number"==typeof f.s&&a.clearTimeout(f.s),f.s=null)}function nT(f){if(!R6(f.h)&&!f.s){f.s=!0;var y=f.Ga;by||o6(),Sy||(by(),Sy=!0),u1.add(y,f),f.B=0}}function Q6(f,y){var I;I=y?y.l:f.U++;const S=ol(f.I);zn(S,"SID",f.K),zn(S,"RID",I),zn(S,"AID",f.T),Hy(f,S),f.m&&f.o&&R1(S,f.m,f.o),I=new Ru(f,f.j,I,f.B+1),null===f.m&&(I.H=f.o),y&&(f.i=y.D.concat(f.i)),y=Y6(f,I,1e3),I.I=Math.round(.5*f.wa)+Math.round(.5*f.wa*Math.random()),D1(f.h,I),T1(I,S,y)}function Hy(f,y){f.H&&$e(f.H,function(I,S){zn(y,S,I)}),f.l&&M6({},function(I,S){zn(y,S,I)})}function Y6(f,y,I){I=Math.min(f.i.length,I);var S=f.l?_(f.l.Na,f.l,f):null;e:{var G=f.i;let ne=-1;for(;;){const xe=["count="+I];-1==ne?0<I?(ne=G[0].g,xe.push("ofs="+ne)):ne=0:xe.push("ofs="+ne);let wn=!0;for(let di=0;di<I;di++){let Kt=G[di].g;const xi=G[di].map;if(Kt-=ne,0>Kt)ne=Math.max(0,G[di].g-100),wn=!1;else try{cIe(xi,xe,"req"+Kt+"_")}catch{S&&S(xi)}}if(wn){S=xe.join("&");break e}}}return f=f.i.splice(0,I),y.D=f,S}function J6(f){if(!f.g&&!f.u){f.Y=1;var y=f.Fa;by||o6(),Sy||(by(),Sy=!0),u1.add(y,f),f.v=0}}function P1(f){return!(f.g||f.u||3<=f.v||(f.Y++,f.u=My(_(f.Fa,f),e9(f,f.v)),f.v++,0))}function N1(f){null!=f.A&&(a.clearTimeout(f.A),f.A=null)}function X6(f){f.g=new Ru(f,f.j,"rpc",f.Y),null===f.m&&(f.g.H=f.o),f.g.O=0;var y=ol(f.qa);zn(y,"RID","rpc"),zn(y,"SID",f.K),zn(y,"AID",f.T),zn(y,"CI",f.F?"0":"1"),!f.F&&f.ja&&zn(y,"TO",f.ja),zn(y,"TYPE","xmlhttp"),Hy(f,y),f.m&&f.o&&R1(y,f.m,f.o),f.L&&(f.g.I=f.L);var I=f.g;f=f.ia,I.L=1,I.v=X0(ol(y)),I.m=null,I.P=!0,A6(I,f)}function rT(f){null!=f.C&&(a.clearTimeout(f.C),f.C=null)}function Z6(f,y){var I=null;if(f.g==y){rT(f),N1(f),f.g=null;var S=2}else{if(!S1(f.h,y))return;I=y.D,P6(f.h,y),S=1}if(0!=f.G)if(y.o)if(1==S){I=y.m?y.m.length:0,y=Date.now()-y.F;var G=f.B;Yi(S=G0(),new I6(S,I)),nT(f)}else J6(f);else if(3==(G=y.s)||0==G&&0<y.X||!(1==S&&function pIe(f,y){return!(x6(f.h)>=f.h.j-(f.s?1:0)||(f.s?(f.i=y.D.concat(f.i),0):1==f.G||2==f.G||f.B>=(f.Va?0:f.Wa)||(f.s=My(_(f.Ga,f,y),e9(f,f.B)),f.B++,0)))}(f,y)||2==S&&P1(f)))switch(I&&0<I.length&&(y=f.h,y.i=y.i.concat(I)),G){case 1:gd(f,5);break;case 4:gd(f,10);break;case 3:gd(f,6);break;default:gd(f,2)}}function e9(f,y){let I=f.Ta+Math.floor(Math.random()*f.cb);return f.isActive()||(I*=2),I*y}function gd(f,y){if(f.j.info("Error code "+y),2==y){var I=_(f.fb,f),S=f.Xa;const G=!S;S=new pd(S||"//www.google.com/images/cleardot.gif"),a.location&&"http"==a.location.protocol||Y0(S,"https"),X0(S),G?function aIe(f,y){const I=new ky;if(a.Image){const S=new Image;S.onload=v(Pu,I,"TestLoadImage: loaded",!0,y,S),S.onerror=v(Pu,I,"TestLoadImage: error",!1,y,S),S.onabort=v(Pu,I,"TestLoadImage: abort",!1,y,S),S.ontimeout=v(Pu,I,"TestLoadImage: timeout",!1,y,S),a.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=f}else y(!1)}(S.toString(),I):function lIe(f,y){new ky;const S=new AbortController,G=setTimeout(()=>{S.abort(),Pu(0,0,!1,y)},1e4);fetch(f,{signal:S.signal}).then(ne=>{clearTimeout(G),Pu(0,0,!!ne.ok,y)}).catch(()=>{clearTimeout(G),Pu(0,0,!1,y)})}(S.toString(),I)}else Ji(2);f.G=0,f.l&&f.l.sa(y),t9(f),K6(f)}function t9(f){if(f.G=0,f.ka=[],f.l){const y=N6(f.h);(0!=y.length||0!=f.i.length)&&(P(f.ka,y),P(f.ka,f.i),f.h.i.length=0,D(f.i),f.i.length=0),f.l.ra()}}function n9(f,y,I){var S=I instanceof pd?ol(I):new pd(I);if(""!=S.g)y&&(S.g=y+"."+S.g),J0(S,S.s);else{var G=a.location;S=G.protocol,y=y?y+"."+G.hostname:G.hostname,G=+G.port;var ne=new pd(null);S&&Y0(ne,S),y&&(ne.g=y),G&&J0(ne,G),I&&(ne.l=I),S=ne}return y=f.ya,(I=f.D)&&y&&zn(S,I,y),zn(S,"VER",f.la),Hy(f,S),S}function r9(f,y,I){if(y&&!f.J)throw Error("Can't create secondary domain capable XhrIo object.");return(y=new fr(f.Ca&&!f.pa?new Uy({eb:I}):f.pa)).Ha(f.J),y}function i9(){}function iT(){}function Ms(f,y){Ri.call(this),this.g=new q6(y),this.l=f,this.h=y&&y.messageUrlParams||null,f=y&&y.messageHeaders||null,y&&y.clientProtocolHeaderRequired&&(f?f["X-Client-Protocol"]="webchannel":f={"X-Client-Protocol":"webchannel"}),this.g.o=f,f=y&&y.initMessageHeaders||null,y&&y.messageContentType&&(f?f["X-WebChannel-Content-Type"]=y.messageContentType:f={"X-WebChannel-Content-Type":y.messageContentType}),y&&y.va&&(f?f["X-WebChannel-Client-Profile"]=y.va:f={"X-WebChannel-Client-Profile":y.va}),this.g.S=f,(f=y&&y.Sb)&&!V(f)&&(this.g.m=f),this.v=y&&y.supportsCrossDomainXhr||!1,this.u=y&&y.sendRawJson||!1,(y=y&&y.httpSessionIdParam)&&!V(y)&&(this.g.D=y,null!==(f=this.h)&&y in f&&y in(f=this.h)&&delete f[y]),this.j=new gp(this)}function s9(f){E1.call(this),f.__headers__&&(this.headers=f.__headers__,this.statusCode=f.__status__,delete f.__headers__,delete f.__status__);var y=f.__sm__;if(y){e:{for(const I in y){f=I;break e}f=void 0}(this.i=f)&&(f=this.i,y=null!==y&&f in y?y[f]:void 0),this.data=y}else this.data=f}function o9(){I1.call(this),this.status=1}function gp(f){this.g=f}(n=fr.prototype).Ha=function(f){this.J=f},n.ea=function(f,y,I,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+f);y=y?y.toUpperCase():"GET",this.D=f,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():w1.g(),this.v=function m6(f){return f.h||(f.h=f.i())}(this.o?this.o:w1),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(y,String(f),!0),this.B=!1}catch(ne){return void $6(this,ne)}if(f=I||"",I=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var G in S)I.set(G,S[G]);else{if("function"!=typeof S.keys||"function"!=typeof S.get)throw Error("Unknown input type for opt_headers: "+String(S));for(const ne of S.keys())I.set(ne,S.get(ne))}S=Array.from(I.keys()).find(ne=>"content-type"==ne.toLowerCase()),G=a.FormData&&f instanceof a.FormData,!(0<=Array.prototype.indexOf.call(hIe,y,void 0))||S||G||I.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ne,xe]of I)this.g.setRequestHeader(ne,xe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{W6(this),this.u=!0,this.g.send(f),this.u=!1}catch(ne){$6(this,ne)}},n.abort=function(f){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=f||7,Yi(this,"complete"),Yi(this,"abort"),eT(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),eT(this,!0)),fr.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?z6(this):this.bb())},n.bb=function(){z6(this)},n.isActive=function(){return!!this.g},n.Z=function(){try{return 2<al(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(f){if(this.g){var y=this.g.responseText;return f&&0==y.indexOf(f)&&(y=y.substring(f.length)),zEe(y)}},n.Ba=function(){return this.m},n.Ka=function(){return"string"==typeof this.l?this.l:String(this.l)},(n=q6.prototype).la=8,n.G=1,n.connect=function(f,y,I,S){Ji(0),this.W=f,this.H=y||{},I&&void 0!==S&&(this.H.OSID=I,this.H.OAID=S),this.F=this.X,this.I=n9(this,null,this.W),nT(this)},n.Ga=function(f){if(this.s)if(this.s=null,1==this.G){if(!f){this.U=Math.floor(1e5*Math.random()),f=this.U++;const G=new Ru(this,this.j,f);let ne=this.o;if(this.S&&(ne?(ne=M(ne),j(ne,this.S)):ne=this.S),null!==this.m||this.O||(G.H=ne,ne=null),this.P)e:{for(var y=0,I=0;I<this.i.length;I++){var S=this.i[I];if(void 0===(S="__data__"in S.map&&"string"==typeof(S=S.map.__data__)?S.length:void 0))break;if(4096<(y+=S)){y=I;break e}if(4096===y||I===this.i.length-1){y=I+1;break e}}y=1e3}else y=1e3;y=Y6(this,G,y),zn(I=ol(this.I),"RID",f),zn(I,"CVER",22),this.D&&zn(I,"X-HTTP-Session-Id",this.D),Hy(this,I),ne&&(this.O?y="headers="+encodeURIComponent(String(j6(ne)))+"&"+y:this.m&&R1(I,this.m,ne)),D1(this.h,G),this.Ua&&zn(I,"TYPE","init"),this.P?(zn(I,"$req",y),zn(I,"SID","null"),G.T=!0,T1(G,I,null)):T1(G,I,y),this.G=2}}else 3==this.G&&(f?Q6(this,f):0==this.i.length||R6(this.h)||Q6(this))},n.Fa=function(){if(this.u=null,X6(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var f=2*this.R;this.j.info("BP detection timer enabled: "+f),this.A=My(_(this.ab,this),f)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ji(10),tT(this),X6(this))},n.Za=function(){null!=this.C&&(this.C=null,tT(this),P1(this),Ji(19))},n.fb=function(f){f?(this.j.info("Successfully pinged google.com"),Ji(2)):(this.j.info("Failed to ping google.com"),Ji(1))},n.isActive=function(){return!!this.l&&this.l.isActive(this)},(n=i9.prototype).ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){},iT.prototype.g=function(f,y){return new Ms(f,y)},A(Ms,Ri),Ms.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ms.prototype.close=function(){x1(this.g)},Ms.prototype.o=function(f){var y=this.g;if("string"==typeof f){var I={};I.__data__=f,f=I}else this.u&&((I={}).__data__=y1(f),f=I);y.i.push(new class{constructor(f,y){this.g=f,this.map=y}}(y.Ya++,f)),3==y.G&&nT(y)},Ms.prototype.N=function(){this.g.l=null,delete this.j,x1(this.g),delete this.g,Ms.aa.N.call(this)},A(s9,E1),A(o9,I1),A(gp,i9),gp.prototype.ua=function(){Yi(this.g,"a")},gp.prototype.ta=function(f){Yi(this.g,new s9(f))},gp.prototype.sa=function(f){Yi(this.g,new o9)},gp.prototype.ra=function(){Yi(this.g,"b")},iT.prototype.createWebChannel=iT.prototype.g,Ms.prototype.send=Ms.prototype.o,Ms.prototype.open=Ms.prototype.m,Ms.prototype.close=Ms.prototype.close,nj=Ha.createWebChannelTransport=function(){return new iT},tj=Ha.getStatEventTarget=function(){return G0()},ej=Ha.Event=hd,dD=Ha.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},q0.NO_ERROR=0,q0.TIMEOUT=8,q0.HTTP_ERROR=6,KI=Ha.ErrorCode=q0,w6.COMPLETE="complete",ZB=Ha.EventType=w6,_6.EventType=Py,Py.OPEN="a",Py.CLOSE="b",Py.ERROR="c",Py.MESSAGE="d",Ri.prototype.listen=Ri.prototype.K,Am=Ha.WebChannel=_6,Ha.FetchXmlHttpFactory=Uy,fr.prototype.listenOnce=fr.prototype.L,fr.prototype.getLastError=fr.prototype.Ka,fr.prototype.getLastErrorCode=fr.prototype.Ba,fr.prototype.getStatus=fr.prototype.Z,fr.prototype.getResponseJson=fr.prototype.Oa,fr.prototype.getResponseText=fr.prototype.oa,fr.prototype.send=fr.prototype.ea,fr.prototype.setWithCredentials=fr.prototype.Ha,XB=Ha.XhrIo=fr}).apply(typeof qI<"u"?qI:typeof self<"u"?self:typeof window<"u"?window:{});const rj="@firebase/firestore";class Wr{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wr.UNAUTHENTICATED=new Wr(null),Wr.GOOGLE_CREDENTIALS=new Wr("google-credentials-uid"),Wr.FIRST_PARTY=new Wr("first-party-uid"),Wr.MOCK_USER=new Wr("mock-user");let Wh="10.14.0";const Fl=new Ys.Vy("@firebase/firestore");function Gh(){return Fl.logLevel}function fe(n,...e){if(Fl.logLevel<=Ys.$b.DEBUG){const t=e.map(hD);Fl.debug(`Firestore (${Wh}): ${n}`,...t)}}function vr(n,...e){if(Fl.logLevel<=Ys.$b.ERROR){const t=e.map(hD);Fl.error(`Firestore (${Wh}): ${n}`,...t)}}function bs(n,...e){if(Fl.logLevel<=Ys.$b.WARN){const t=e.map(hD);Fl.warn(`Firestore (${Wh}): ${n}`,...t)}}function hD(n){if("string"==typeof n)return n;try{return JSON.stringify(n)}catch{return n}}function Oe(n="Unexpected state"){const e=`FIRESTORE (${Wh}) INTERNAL ASSERTION FAILED: `+n;throw vr(e),new Error(e)}function Ue(n,e){n||Oe()}function De(n,e){return n}const te={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ce extends B.g{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Gr{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class ij{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class rse{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Wr.UNAUTHENTICATED))}shutdown(){}}class ise{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class sse{constructor(e){this.t=e,this.currentUser=Wr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){var r=this;Ue(void 0===this.o);let i=this.i;const s=u=>this.i!==i?(i=this.i,t(u)):Promise.resolve();let o=new Gr;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Gr,e.enqueueRetryable(()=>s(this.currentUser))};const a=()=>{const u=o;e.enqueueRetryable((0,Z.A)(function*(){yield u.promise,yield s(r.currentUser)}))},l=u=>{fe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),a())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(fe("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Gr)}},0),a()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(fe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ue("string"==typeof r.accessToken),new ij(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ue(null===e||"string"==typeof e),new Wr(e)}}class ose{constructor(e,t,r){this.l=e,this.h=t,this.P=r,this.type="FirstParty",this.user=Wr.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class ase{constructor(e,t,r){this.l=e,this.h=t,this.P=r}getToken(){return Promise.resolve(new ose(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable(()=>t(Wr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class sj{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class lse{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){Ue(void 0===this.o);const r=s=>{null!=s.error&&fe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.R;return this.R=s.token,fe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{fe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.A.getImmediate({optional:!0});s?i(s):fe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(Ue("string"==typeof t.token),this.R=t.token,new sj(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function use(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&"function"==typeof e.getRandomValues)e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}class oj{static newId(){const t=62*Math.floor(256/62);let r="";for(;r.length<20;){const i=use(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(i[s]%62))}return r}}function st(n,e){return n<e?-1:n>e?1:0}function qh(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function aj(n){return n+"\0"}class Qn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ce(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ce(te.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ce(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ce(te.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Qn.fromMillis(Date.now())}static fromDate(e){return Qn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*t));return new Qn(t,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class We{constructor(e){this.timestamp=e}static fromTimestamp(e){return new We(e)}static min(){return new We(new Qn(0,0))}static max(){return new We(new Qn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class bm{constructor(e,t,r){void 0===t?t=0:t>e.length&&Oe(),void 0===r?r=e.length-t:r>e.length-t&&Oe(),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===bm.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof bm?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return this.construct(this.segments,this.offset+(e=void 0===e?1:e),this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=e.get(i),o=t.get(i);if(s<o)return-1;if(s>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class Lt extends bm{construct(e,t,r){return new Lt(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new ce(te.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new Lt(t)}static emptyPath(){return new Lt([])}}const cse=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class jn extends bm{construct(e,t,r){return new jn(e,t,r)}static isValidIdentifier(e){return cse.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),jn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new jn(["__name__"])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(0===r.length)throw new ce(te.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const a=e[i];if("\\"===a){if(i+1===e.length)throw new ce(te.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const l=e[i+1];if("\\"!==l&&"."!==l&&"`"!==l)throw new ce(te.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else"`"===a?(o=!o,i++):"."!==a||o?(r+=a,i++):(s(),i++)}if(s(),o)throw new ce(te.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new jn(t)}static emptyPath(){return new jn([])}}class Pe{constructor(e){this.path=e}static fromPath(e){return new Pe(Lt.fromString(e))}static fromName(e){return new Pe(Lt.fromString(e).popFirst(5))}static empty(){return new Pe(Lt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Lt.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Lt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Pe(new Lt(e.slice()))}}class Kh{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function fD(n){return n.fields.find(e=>2===e.kind)}function vc(n){return n.fields.filter(e=>2!==e.kind)}Kh.UNKNOWN_ID=-1;class Ec{constructor(e,t){this.fieldPath=e,this.kind=t}}class Qh{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Qh(0,Ss.min())}}function lj(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=We.fromTimestamp(1e9===r?new Qn(t+1,0):new Qn(t,r));return new Ss(i,Pe.empty(),e)}function uj(n){return new Ss(n.readTime,n.key,-1)}class Ss{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Ss(We.min(),Pe.empty(),-1)}static max(){return new Ss(We.max(),Pe.empty(),-1)}}function pD(n,e){let t=n.readTime.compareTo(e.readTime);return 0!==t?t:(t=Pe.comparator(n.documentKey,e.documentKey),0!==t?t:st(n.largestBatchId,e.largestBatchId))}const cj="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class dj{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}function Ll(n){return gD.apply(this,arguments)}function gD(){return(gD=(0,Z.A)(function*(n){if(n.code!==te.FAILED_PRECONDITION||n.message!==cj)throw n;fe("LocalStore","Unexpectedly lost primary lease")})).apply(this,arguments)}class q{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Oe(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new q((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof q?t:q.resolve(t)}catch(t){return q.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):q.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):q.reject(t)}static resolve(e){return new q((t,r)=>{t(e)})}static reject(e){return new q((t,r)=>{r(e)})}static waitFor(e){return new q((t,r)=>{let i=0,s=0,o=!1;e.forEach(a=>{++i,a.next(()=>{++s,o&&s===i&&t()},l=>r(l))}),o=!0,s===i&&t()})}static or(e){let t=q.resolve(!1);for(const r of e)t=t.next(i=>i?q.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new q((r,i)=>{const s=e.length,o=new Array(s);let a=0;for(let l=0;l<s;l++){const u=l;t(e[u]).next(d=>{o[u]=d,++a,a===s&&r(o)},d=>i(d))}})}static doWhile(e,t){return new q((r,i)=>{const s=()=>{!0===e()?t().next(()=>{s()},i):r()};s()})}}class QI{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new Gr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Sm(e,t.error)):this.V.resolve()},this.transaction.onerror=r=>{const i=mD(r.target.error);this.V.reject(new Sm(e,i))}}static open(e,t,r,i){try{return new QI(t,e.transaction(i,r))}catch(s){throw new Sm(t,s)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(fe("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new pse(t)}}class Zo{constructor(e,t,r){this.name=e,this.version=t,this.p=r,12.2===Zo.S((0,B.ZQ)())&&vr("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return fe("SimpleDb","Removing database:",e),Ic(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,B.zW)())return!1;if(Zo.v())return!0;const e=(0,B.ZQ)(),t=Zo.S(e),r=0<t&&t<10,i=hj(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static v(){var e;return typeof process<"u"&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.C)}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}M(e){var t=this;return(0,Z.A)(function*(){return t.db||(fe("SimpleDb","Opening database:",t.name),t.db=yield new Promise((r,i)=>{const s=indexedDB.open(t.name,t.version);s.onsuccess=o=>{r(o.target.result)},s.onblocked=()=>{i(new Sm(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=o=>{const a=o.target.error;i("VersionError"===a.name?new ce(te.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):"InvalidStateError"===a.name?new ce(te.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+a):new Sm(e,a))},s.onupgradeneeded=o=>{fe("SimpleDb",'Database "'+t.name+'" requires upgrade from version:',o.oldVersion),t.p.O(o.target.result,s.transaction,o.oldVersion,t.version).next(()=>{fe("SimpleDb","Database upgrade to version "+t.version+" complete")})}})),t.N&&(t.db.onversionchange=r=>t.N(r)),t.db})()}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}runTransaction(e,t,r,i){var s=this;return(0,Z.A)(function*(){const o="readonly"===t;let a=0;for(;;){++a;try{s.db=yield s.M(e);const l=QI.open(s.db,e,o?"readonly":"readwrite",r),u=i(l).next(d=>(l.g(),d)).catch(d=>(l.abort(d),q.reject(d))).toPromise();return u.catch(()=>{}),yield l.m,u}catch(l){const u=l,d="FirebaseError"!==u.name&&a<3;if(fe("SimpleDb","Transaction failed with error:",u.message,"Retrying:",d),s.close(),!d)return Promise.reject(u)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}function hj(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class fse{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Ic(this.B.delete())}}class Sm extends ce{constructor(e,t){super(te.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Vl(n){return"IndexedDbTransactionError"===n.name}class pse{constructor(e){this.store=e}put(e,t){let r;return void 0!==t?(fe("SimpleDb","PUT",this.store.name,e,t),r=this.store.put(t,e)):(fe("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ic(r)}add(e){return fe("SimpleDb","ADD",this.store.name,e,e),Ic(this.store.add(e))}get(e){return Ic(this.store.get(e)).next(t=>(void 0===t&&(t=null),fe("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return fe("SimpleDb","DELETE",this.store.name,e),Ic(this.store.delete(e))}count(){return fe("SimpleDb","COUNT",this.store.name),Ic(this.store.count())}U(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if("function"==typeof i.getAll){const s=i.getAll(r.range);return new q((o,a)=>{s.onerror=l=>{a(l.target.error)},s.onsuccess=l=>{o(l.target.result)}})}{const s=this.cursor(r),o=[];return this.W(s,(a,l)=>{o.push(l)}).next(()=>o)}}G(e,t){const r=this.store.getAll(e,null===t?void 0:t);return new q((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}j(e,t){fe("SimpleDb","DELETE ALL",this.store.name);const r=this.options(e,t);r.H=!1;const i=this.cursor(r);return this.W(i,(s,o,a)=>a.delete())}J(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.W(i,t)}Y(e){const t=this.cursor({});return new q((r,i)=>{t.onerror=s=>{const o=mD(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(a=>{a?o.continue():r()}):r()}})}W(e,t){const r=[];return new q((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const a=o.target.result;if(!a)return void i();const l=new fse(a),u=t(a.primaryKey,a.value,l);if(u instanceof q){const d=u.catch(p=>(l.done(),q.reject(p)));r.push(d)}l.isDone?i():null===l.K?a.continue():a.continue(l.K)}}).next(()=>q.waitFor(r))}options(e,t){let r;return void 0!==e&&("string"==typeof e?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.H?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ic(n){return new q((e,t)=>{n.onsuccess=r=>{e(r.target.result)},n.onerror=r=>{const i=mD(r.target.error);t(i)}})}let fj=!1;function mD(n){const e=Zo.S((0,B.ZQ)());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return fj||(fj=!0,setTimeout(()=>{throw r},0)),r}}return n}class gse{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}X(e){var t=this;fe("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(0,Z.A)(function*(){t.task=null;try{fe("IndexBackfiller",`Documents written: ${yield t.Z.ee()}`)}catch(r){Vl(r)?fe("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",r):yield Ll(r)}yield t.X(6e4)}))}}class mse{constructor(e,t){this.localStore=e,this.persistence=t}ee(e=50){var t=this;return(0,Z.A)(function*(){return t.persistence.runTransaction("Backfill Indexes","readwrite-primary",r=>t.te(r,e))})()}te(e,t){const r=new Set;let i=t,s=!0;return q.doWhile(()=>!0===s&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(null!==o&&!r.has(o))return fe("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,i).next(a=>{i-=a,r.add(o)});s=!1})).next(()=>t-i)}ne(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(i,s)).next(a=>(fe("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(e,t,a))).next(()=>o.size)}))}re(e,t){let r=e;return t.changes.forEach((i,s)=>{const o=uj(s);pD(o,r)>0&&(r=o)}),new Ss(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}let Ds=(()=>{class n{constructor(t,r){this.previousValue=t,r&&(r.sequenceNumberHandler=i=>this.ie(i),this.se=i=>r.writeSequenceNumber(i))}ie(t){return this.previousValue=Math.max(t,this.previousValue),this.previousValue}next(){const t=++this.previousValue;return this.se&&this.se(t),t}}return n.oe=-1,n})();function Dm(n){return null==n}function Rm(n){return 0===n&&1/n==-1/0}function pj(n){return"number"==typeof n&&Number.isInteger(n)&&!Rm(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function Ii(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=gj(e)),e=_se(n.get(t),e);return gj(e)}function _se(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="\x01\x10";break;case"\x01":t+="\x01\x11";break;default:t+=s}}return t}function gj(n){return n+"\x01\x01"}function ea(n){const e=n.length;if(Ue(e>=2),2===e)return Ue("\x01"===n.charAt(0)&&"\x01"===n.charAt(1)),Lt.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf("\x01",s);switch((o<0||o>t)&&Oe(),n.charAt(o+1)){case"\x01":const a=n.substring(s,o);let l;0===i.length?l=a:(i+=a,l=i,i=""),r.push(l);break;case"\x10":i+=n.substring(s,o),i+="\0";break;case"\x11":i+=n.substring(s,o+1);break;default:Oe()}s=o+2}return new Lt(r)}const mj=["userId","batchId"];function YI(n,e){return[n,Ii(e)]}function _j(n,e,t){return[n,Ii(e),t]}const yse={},vse=["prefixPath","collectionGroup","readTime","documentId"],Ese=["prefixPath","collectionGroup","documentId"],Ise=["collectionGroup","readTime","prefixPath","documentId"],wse=["canonicalId","targetId"],Cse=["targetId","path"],Tse=["path","targetId"],Ase=["collectionId","parent"],bse=["indexId","uid"],Sse=["uid","sequenceNumber"],Dse=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Rse=["indexId","uid","orderedDocumentKey"],xse=["userId","collectionPath","documentId"],Pse=["userId","collectionPath","largestBatchId"],Nse=["userId","collectionGroup","largestBatchId"],yj=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],Mse=[...yj,"documentOverlays"],vj=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ej=vj,_D=[...Ej,"indexConfiguration","indexState","indexEntries"],kse=_D,Ose=[..._D,"globals"];class yD extends dj{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Or(n,e){const t=De(n);return Zo.F(t._e,e)}function Ij(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function Ul(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function Cj(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}class Dn{constructor(e,t){this.comparator=e,this.root=t||ai.EMPTY}insert(e,t){return new Dn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ai.BLACK,null,null))}remove(e){return new Dn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ai.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new JI(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new JI(this.root,e,this.comparator,!1)}getReverseIterator(){return new JI(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new JI(this.root,e,this.comparator,!0)}}class JI{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ai{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??ai.RED,this.left=i??ai.EMPTY,this.right=s??ai.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new ai(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===s?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return ai.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key)){if(i.right.isEmpty())return ai.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ai.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ai.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw Oe();const e=this.left.check();if(e!==this.right.check())throw Oe();return e+(this.isRed()?0:1)}}ai.EMPTY=null,ai.RED=!0,ai.BLACK=!1,ai.EMPTY=new class{constructor(){this.size=0}get key(){throw Oe()}get value(){throw Oe()}get color(){throw Oe()}get left(){throw Oe()}get right(){throw Oe()}copy(e,t,r,i,s){return this}insert(e,t,r){return new ai(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class dn{constructor(e){this.comparator=e,this.data=new Dn(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new Tj(this.data.getIterator())}getIteratorFrom(e){return new Tj(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof dn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(0!==this.comparator(i,s))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new dn(this.comparator);return t.data=e,t}}class Tj{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Yh(n){return n.hasNext()?n.getNext():void 0}class ls{constructor(e){this.fields=e,e.sort(jn.comparator)}static empty(){return new ls([])}unionWith(e){let t=new dn(jn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new ls(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return qh(this.fields,e.fields,(t,r)=>t.isEqual(r))}}class Aj extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class dr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Aj("Invalid base64 string: "+s):s}}(e);return new dr(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new dr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}dr.EMPTY_BYTE_STRING=new dr("");const Lse=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function za(n){if(Ue(!!n),"string"==typeof n){let e=0;const t=Lse.exec(n);if(Ue(!!t),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Yn(n.seconds),nanos:Yn(n.nanos)}}function Yn(n){return"number"==typeof n?n:"string"==typeof n?Number(n):0}function Wa(n){return"string"==typeof n?dr.fromBase64String(n):dr.fromUint8Array(n)}function XI(n){var e,t;return"server_timestamp"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function ZI(n){const e=n.mapValue.fields.__previous_value__;return XI(e)?ZI(e):e}function xm(n){const e=za(n.mapValue.fields.__local_write_time__.timestampValue);return new Qn(e.seconds,e.nanos)}class Vse{constructor(e,t,r,i,s,o,a,l,u){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=l,this.useFetchStreams=u}}class Bl{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new Bl("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof Bl&&e.projectId===this.projectId&&e.database===this.database}}const jl={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ew={nullValue:"NULL_VALUE"};function $l(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?XI(n)?4:xj(n)?9007199254740991:rw(n)?10:11:Oe()}function ta(n,e){if(n===e)return!0;const t=$l(n);if(t!==$l(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return xm(n).isEqual(xm(e));case 3:return function(i,s){if("string"==typeof i.timestampValue&&"string"==typeof s.timestampValue&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=za(i.timestampValue),a=za(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return s=e,Wa(n.bytesValue).isEqual(Wa(s.bytesValue));case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Yn(i.geoPointValue.latitude)===Yn(s.geoPointValue.latitude)&&Yn(i.geoPointValue.longitude)===Yn(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Yn(i.integerValue)===Yn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Yn(i.doubleValue),a=Yn(s.doubleValue);return o===a?Rm(o)===Rm(a):isNaN(o)&&isNaN(a)}return!1}(n,e);case 9:return qh(n.arrayValue.values||[],e.arrayValue.values||[],ta);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},a=s.mapValue.fields||{};if(Ij(o)!==Ij(a))return!1;for(const l in o)if(o.hasOwnProperty(l)&&(void 0===a[l]||!ta(o[l],a[l])))return!1;return!0}(n,e);default:return Oe()}var s}function Pm(n,e){return void 0!==(n.values||[]).find(t=>ta(t,e))}function Hl(n,e){if(n===e)return 0;const t=$l(n),r=$l(e);if(t!==r)return st(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return st(n.booleanValue,e.booleanValue);case 2:return function(s,o){const a=Yn(s.integerValue||s.doubleValue),l=Yn(o.integerValue||o.doubleValue);return a<l?-1:a>l?1:a===l?0:isNaN(a)?isNaN(l)?0:-1:1}(n,e);case 3:return bj(n.timestampValue,e.timestampValue);case 4:return bj(xm(n),xm(e));case 5:return st(n.stringValue,e.stringValue);case 6:return function(s,o){const a=Wa(s),l=Wa(o);return a.compareTo(l)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const a=s.split("/"),l=o.split("/");for(let u=0;u<a.length&&u<l.length;u++){const d=st(a[u],l[u]);if(0!==d)return d}return st(a.length,l.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const a=st(Yn(s.latitude),Yn(o.latitude));return 0!==a?a:st(Yn(s.longitude),Yn(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return Sj(n.arrayValue,e.arrayValue);case 10:return function(s,o){var a,l,u,d;const v=null===(a=(s.fields||{}).value)||void 0===a?void 0:a.arrayValue,A=null===(l=(o.fields||{}).value)||void 0===l?void 0:l.arrayValue,D=st((null===(u=v?.values)||void 0===u?void 0:u.length)||0,(null===(d=A?.values)||void 0===d?void 0:d.length)||0);return 0!==D?D:Sj(v,A)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===jl.mapValue&&o===jl.mapValue)return 0;if(s===jl.mapValue)return 1;if(o===jl.mapValue)return-1;const a=s.fields||{},l=Object.keys(a),u=o.fields||{},d=Object.keys(u);l.sort(),d.sort();for(let p=0;p<l.length&&p<d.length;++p){const _=st(l[p],d[p]);if(0!==_)return _;const v=Hl(a[l[p]],u[d[p]]);if(0!==v)return v}return st(l.length,d.length)}(n.mapValue,e.mapValue);default:throw Oe()}}function bj(n,e){if("string"==typeof n&&"string"==typeof e&&n.length===e.length)return st(n,e);const t=za(n),r=za(e),i=st(t.seconds,r.seconds);return 0!==i?i:st(t.nanos,r.nanos)}function Sj(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=Hl(t[i],r[i]);if(s)return s}return st(t.length,r.length)}function Jh(n){return vD(n)}function vD(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=za(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?Wa(n.bytesValue).toBase64():"referenceValue"in n?Pe.fromName(n.referenceValue).toString():"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=vD(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${vD(t.fields[o])}`;return i+"}"}(n.mapValue):Oe()}function wc(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function ED(n){return!!n&&"integerValue"in n}function Nm(n){return!!n&&"arrayValue"in n}function Dj(n){return!!n&&"nullValue"in n}function Rj(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function nw(n){return!!n&&"mapValue"in n}function rw(n){var e,t;return"__vector__"===(null===(t=((null===(e=n?.mapValue)||void 0===e?void 0:e.fields)||{}).__type__)||void 0===t?void 0:t.stringValue)}function Mm(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&"object"==typeof n.timestampValue)return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return Ul(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=Mm(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Mm(n.arrayValue.values[t]);return e}return Object.assign({},n)}function xj(n){return"__max__"===(((n.mapValue||{}).fields||{}).__type__||{}).stringValue}const Pj={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Use(n){return"nullValue"in n?ew:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?wc(Bl.empty(),Pe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?rw(n)?Pj:{mapValue:{}}:Oe()}function Bse(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?wc(Bl.empty(),Pe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Pj:"mapValue"in n?rw(n)?{mapValue:{}}:jl:Oe()}function Nj(n,e){const t=Hl(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function Mj(n,e){const t=Hl(n.value,e.value);return 0!==t?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}class li{constructor(e){this.value=e}static empty(){return new li({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!nw(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Mm(t)}setAll(e){let t=jn.emptyPath(),r={},i=[];e.forEach((o,a)=>{if(!t.isImmediateParentOf(a)){const l=this.getFieldsMap(t);this.applyChanges(l,r,i),r={},i=[],t=a.popLast()}o?r[a.lastSegment()]=Mm(o):i.push(a.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());nw(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return ta(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];nw(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){Ul(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new li(Mm(this.value))}}function kj(n){const e=[];return Ul(n.fields,(t,r)=>{const i=new jn([t]);if(nw(r)){const s=kj(r.mapValue).fields;if(0===s.length)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new ls(e)}class $n{constructor(e,t,r,i,s,o,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(e){return new $n(e,0,We.min(),We.min(),We.min(),li.empty(),0)}static newFoundDocument(e,t,r,i){return new $n(e,1,t,We.min(),r,i,0)}static newNoDocument(e,t){return new $n(e,2,t,We.min(),We.min(),li.empty(),0)}static newUnknownDocument(e,t){return new $n(e,3,t,We.min(),We.min(),li.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(We.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=li.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=li.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=We.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof $n&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new $n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class zl{constructor(e,t){this.position=e,this.inclusive=t}}function Oj(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(r=s.field.isKeyField()?Pe.comparator(Pe.fromName(o.referenceValue),t.key):Hl(o,t.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Fj(n,e){if(null===n)return null===e;if(null===e||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!ta(n.position[t],e.position[t]))return!1;return!0}class km{constructor(e,t="asc"){this.field=e,this.dir=t}}function jse(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}class Lj{}class Vt extends Lj{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,r):new $se(e,t,r):"array-contains"===t?new Wse(e,r):"in"===t?new Hj(e,r):"not-in"===t?new Gse(e,r):"array-contains-any"===t?new qse(e,r):new Vt(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new Hse(e,r):new zse(e,r)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(Hl(t,this.value)):null!==t&&$l(this.value)===$l(t)&&this.matchesComparison(Hl(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return Oe()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ln extends Lj{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new ln(e,t)}matches(e){return Xh(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Xh(n){return"and"===n.op}function ID(n){return"or"===n.op}function wD(n){return Vj(n)&&Xh(n)}function Vj(n){for(const e of n.filters)if(e instanceof ln)return!1;return!0}function CD(n){if(n instanceof Vt)return n.field.canonicalString()+n.op.toString()+Jh(n.value);if(wD(n))return n.filters.map(e=>CD(e)).join(",");{const e=n.filters.map(t=>CD(t)).join(",");return`${n.op}(${e})`}}function Uj(n,e){return n instanceof Vt?(r=n,(i=e)instanceof Vt&&r.op===i.op&&r.field.isEqual(i.field)&&ta(r.value,i.value)):n instanceof ln?function(r,i){return i instanceof ln&&r.op===i.op&&r.filters.length===i.filters.length&&r.filters.reduce((s,o,a)=>s&&Uj(o,i.filters[a]),!0)}(n,e):void Oe();var r,i}function Bj(n,e){const t=n.filters.concat(e);return ln.create(t,n.op)}function jj(n){return n instanceof Vt?`${(t=n).field.canonicalString()} ${t.op} ${Jh(t.value)}`:n instanceof ln?function(t){return t.op.toString()+" {"+t.getFilters().map(jj).join(" ,")+"}"}(n):"Filter";var t}class $se extends Vt{constructor(e,t,r){super(e,t,r),this.key=Pe.fromName(r.referenceValue)}matches(e){const t=Pe.comparator(e.key,this.key);return this.matchesComparison(t)}}class Hse extends Vt{constructor(e,t){super(e,"in",t),this.keys=$j(0,t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class zse extends Vt{constructor(e,t){super(e,"not-in",t),this.keys=$j(0,t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function $j(n,e){var t;return((null===(t=e.arrayValue)||void 0===t?void 0:t.values)||[]).map(r=>Pe.fromName(r.referenceValue))}class Wse extends Vt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Nm(t)&&Pm(t.arrayValue,this.value)}}class Hj extends Vt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Pm(this.value.arrayValue,t)}}class Gse extends Vt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Pm(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!Pm(this.value.arrayValue,t)}}class qse extends Vt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Nm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>Pm(this.value.arrayValue,r))}}class Kse{constructor(e,t=null,r=[],i=[],s=null,o=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}}function TD(n,e=null,t=[],r=[],i=null,s=null,o=null){return new Kse(n,e,t,r,i,s,o)}function Cc(n){const e=De(n);if(null===e.ue){let t=e.path.canonicalString();null!==e.collectionGroup&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>CD(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>{return(s=r).field.canonicalString()+s.dir;var s}).join(","),Dm(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>Jh(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>Jh(r)).join(",")),e.ue=t}return e.ue}function Om(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!jse(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Uj(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Fj(n.startAt,e.startAt)&&Fj(n.endAt,e.endAt)}function iw(n){return Pe.isDocumentKey(n.path)&&null===n.collectionGroup&&0===n.filters.length}function sw(n,e){return n.filters.filter(t=>t instanceof Vt&&t.field.isEqual(e))}function zj(n,e,t){let r=ew,i=!0;for(const s of sw(n,e)){let o=ew,a=!0;switch(s.op){case"<":case"<=":o=Use(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=ew}Nj({value:r,inclusive:i},{value:o,inclusive:a})<0&&(r=o,i=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];Nj({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}return{value:r,inclusive:i}}function Wj(n,e,t){let r=jl,i=!0;for(const s of sw(n,e)){let o=jl,a=!0;switch(s.op){case">=":case">":o=Bse(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=jl}Mj({value:r,inclusive:i},{value:o,inclusive:a})>0&&(r=o,i=a)}if(null!==t)for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];Mj({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}return{value:r,inclusive:i}}class Ga{constructor(e,t=null,r=[],i=[],s=null,o="F",a=null,l=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=l,this.ce=null,this.le=null,this.he=null}}function Gj(n,e,t,r,i,s,o,a){return new Ga(n,e,t,r,i,s,o,a)}function Zh(n){return new Ga(n)}function qj(n){return 0===n.filters.length&&null===n.limit&&null==n.startAt&&null==n.endAt&&(0===n.explicitOrderBy.length||1===n.explicitOrderBy.length&&n.explicitOrderBy[0].field.isKeyField())}function AD(n){return null!==n.collectionGroup}function ef(n){const e=De(n);if(null===e.ce){e.ce=[];const t=new Set;for(const s of e.explicitOrderBy)e.ce.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new dn(jn.comparator);return o.filters.forEach(l=>{l.getFlattenedFilters().forEach(u=>{u.isInequality()&&(a=a.add(u.field))})}),a})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.ce.push(new km(s,r))}),t.has(jn.keyField().canonicalString())||e.ce.push(new km(jn.keyField(),r))}return e.ce}function wi(n){const e=De(n);return e.le||(e.le=function Qj(n,e){if("F"===n.limitType)return TD(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>new km(i.field,"desc"===i.dir?"asc":"desc"));const t=n.endAt?new zl(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new zl(n.startAt.position,n.startAt.inclusive):null;return TD(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}(e,ef(n))),e.le}function bD(n,e){const t=n.filters.concat([e]);return new Ga(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ow(n,e,t){return new Ga(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Fm(n,e){return Om(wi(n),wi(e))&&n.limitType===e.limitType}function Yj(n){return`${Cc(wi(n))}|lt:${n.limitType}`}function tf(n){return`Query(target=${function(t){let r=t.path.canonicalString();return null!==t.collectionGroup&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>jj(i)).join(", ")}]`),Dm(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>{return`${(o=i).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>Jh(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>Jh(i)).join(",")),`Target(${r})`}(wi(n))}; limitType=${n.limitType})`}function Lm(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return null!==r.collectionGroup?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):Pe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of ef(r))if(!s.field.isKeyField()&&null===i.data.field(s.field))return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&(i=e,!((r=n).startAt&&!function(o,a,l){const u=Oj(o,a,l);return o.inclusive?u<=0:u<0}(r.startAt,ef(r),i)||r.endAt&&!function(o,a,l){const u=Oj(o,a,l);return o.inclusive?u>=0:u>0}(r.endAt,ef(r),i)));var r,i}function Jj(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Xj(n){return(e,t)=>{let r=!1;for(const i of ef(n)){const s=Qse(i,e,t);if(0!==s)return s;r=r||i.field.isKeyField()}return 0}}function Qse(n,e,t){const r=n.field.isKeyField()?Pe.comparator(e.key,t.key):function(s,o,a){const l=o.data.field(s),u=a.data.field(s);return null!==l&&null!==u?Hl(l,u):Oe()}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return Oe()}}class qa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r)for(const[i,s]of r)if(this.equalsFn(i,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){Ul(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return Cj(this.inner)}size(){return this.innerSize}}const Yse=new Dn(Pe.comparator);function us(){return Yse}const Zj=new Dn(Pe.comparator);function Vm(...n){let e=Zj;for(const t of n)e=e.insert(t.key,t);return e}function e$(n){let e=Zj;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function na(){return Um()}function t$(){return Um()}function Um(){return new qa(n=>n.toString(),(n,e)=>n.isEqual(e))}const Jse=new Dn(Pe.comparator),Xse=new dn(Pe.comparator);function pt(...n){let e=Xse;for(const t of n)e=e.add(t);return e}const Zse=new dn(st);function SD(){return Zse}function DD(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Rm(e)?"-0":e}}function n$(n){return{integerValue:""+n}}function r$(n,e){return pj(e)?n$(e):DD(n,e)}class aw{constructor(){this._=void 0}}function eoe(n,e,t){return n instanceof nf?function(i,s){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&XI(s)&&(s=ZI(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(t,e):n instanceof Tc?s$(n,e):n instanceof Ac?o$(n,e):function(i,s){const o=i$(i,s),a=a$(o)+a$(i.Pe);return ED(o)&&ED(i.Pe)?n$(a):DD(i.serializer,a)}(n,e)}function toe(n,e,t){return n instanceof Tc?s$(n,e):n instanceof Ac?o$(n,e):t}function i$(n,e){return n instanceof rf?ED(r=e)||(s=r)&&"doubleValue"in s?e:{integerValue:0}:null;var r,s}class nf extends aw{}class Tc extends aw{constructor(e){super(),this.elements=e}}function s$(n,e){const t=l$(e);for(const r of n.elements)t.some(i=>ta(i,r))||t.push(r);return{arrayValue:{values:t}}}class Ac extends aw{constructor(e){super(),this.elements=e}}function o$(n,e){let t=l$(e);for(const r of n.elements)t=t.filter(i=>!ta(i,r));return{arrayValue:{values:t}}}class rf extends aw{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function a$(n){return Yn(n.integerValue||n.doubleValue)}function l$(n){return Nm(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}class Bm{constructor(e,t){this.field=e,this.transform=t}}class roe{constructor(e,t){this.version=e,this.transformResults=t}}class Jn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Jn}static exists(e){return new Jn(void 0,e)}static updateTime(e){return new Jn(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function lw(n,e){return void 0!==n.updateTime?e.isFoundDocument()&&e.version.isEqual(n.updateTime):void 0===n.exists||n.exists===e.isFoundDocument()}class uw{}function u$(n,e){if(!n.hasLocalMutations||e&&0===e.fields.length)return null;if(null===e)return n.isNoDocument()?new af(n.key,Jn.none()):new sf(n.key,n.data,Jn.none());{const t=n.data,r=li.empty();let i=new dn(jn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);null===o&&s.length>1&&(s=s.popLast(),o=t.field(s)),null===o?r.delete(s):r.set(s,o),i=i.add(s)}return new Ka(n.key,r,new ls(i.toArray()),Jn.none())}}function ioe(n,e,t){n instanceof sf?function(i,s,o){const a=i.value.clone(),l=h$(i.fieldTransforms,s,o.transformResults);a.setAll(l),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,e,t):n instanceof Ka?function(i,s,o){if(!lw(i.precondition,s))return void s.convertToUnknownDocument(o.version);const a=h$(i.fieldTransforms,s,o.transformResults),l=s.data;l.setAll(d$(i)),l.setAll(a),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):e.convertToNoDocument(t.version).setHasCommittedMutations()}function jm(n,e,t,r){return n instanceof sf?function(s,o,a,l){if(!lw(s.precondition,o))return a;const u=s.value.clone(),d=f$(s.fieldTransforms,l,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(n,e,t,r):n instanceof Ka?function(s,o,a,l){if(!lw(s.precondition,o))return a;const u=f$(s.fieldTransforms,l,o),d=o.data;return d.setAll(d$(s)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null===a?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(n,e,t,r):(a=t,lw(n.precondition,o=e)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a);var o,a}function soe(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=i$(r.transform,i||null);null!=s&&(null===t&&(t=li.empty()),t.set(r.field,s))}return t||null}function c$(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&(i=e.fieldTransforms,!!(void 0===(r=n.fieldTransforms)&&void 0===i||r&&i&&qh(r,i,(s,o)=>function noe(n,e){return n.field.isEqual(e.field)&&(i=e.transform,(r=n.transform)instanceof Tc&&i instanceof Tc||r instanceof Ac&&i instanceof Ac?qh(r.elements,i.elements,ta):r instanceof rf&&i instanceof rf?ta(r.Pe,i.Pe):r instanceof nf&&i instanceof nf);var r,i}(s,o))))&&(0===n.type?n.value.isEqual(e.value):1!==n.type||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask));var r,i}class sf extends uw{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ka extends uw{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function d$(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function h$(n,e,t){const r=new Map;Ue(n.length===t.length);for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,a=e.data.field(s.field);r.set(s.field,toe(o,a,t[i]))}return r}function f$(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,eoe(s,o,e))}return r}class af extends uw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class RD extends uw{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class xD{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&ioe(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=jm(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=jm(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=t$();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let a=this.applyToLocalView(o,s.mutatedFields);a=t.has(i.key)?null:a;const l=u$(o,a);null!==l&&r.set(i.key,l),o.isValidDocument()||o.convertToNoDocument(We.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),pt())}isEqual(e){return this.batchId===e.batchId&&qh(this.mutations,e.mutations,(t,r)=>c$(t,r))&&qh(this.baseMutations,e.baseMutations,(t,r)=>c$(t,r))}}class PD{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){Ue(e.mutations.length===r.length);let i=Jse;const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new PD(e,t,r,i)}}class ND{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ooe{constructor(e,t){this.count=e,this.unchangedNames=t}}var br,$t;function g$(n){switch(n){default:return Oe();case te.CANCELLED:case te.UNKNOWN:case te.DEADLINE_EXCEEDED:case te.RESOURCE_EXHAUSTED:case te.INTERNAL:case te.UNAVAILABLE:case te.UNAUTHENTICATED:return!1;case te.INVALID_ARGUMENT:case te.NOT_FOUND:case te.ALREADY_EXISTS:case te.PERMISSION_DENIED:case te.FAILED_PRECONDITION:case te.ABORTED:case te.OUT_OF_RANGE:case te.UNIMPLEMENTED:case te.DATA_LOSS:return!0}}function m$(n){if(void 0===n)return vr("GRPC error has no .code"),te.UNKNOWN;switch(n){case br.OK:return te.OK;case br.CANCELLED:return te.CANCELLED;case br.UNKNOWN:return te.UNKNOWN;case br.DEADLINE_EXCEEDED:return te.DEADLINE_EXCEEDED;case br.RESOURCE_EXHAUSTED:return te.RESOURCE_EXHAUSTED;case br.INTERNAL:return te.INTERNAL;case br.UNAVAILABLE:return te.UNAVAILABLE;case br.UNAUTHENTICATED:return te.UNAUTHENTICATED;case br.INVALID_ARGUMENT:return te.INVALID_ARGUMENT;case br.NOT_FOUND:return te.NOT_FOUND;case br.ALREADY_EXISTS:return te.ALREADY_EXISTS;case br.PERMISSION_DENIED:return te.PERMISSION_DENIED;case br.FAILED_PRECONDITION:return te.FAILED_PRECONDITION;case br.ABORTED:return te.ABORTED;case br.OUT_OF_RANGE:return te.OUT_OF_RANGE;case br.UNIMPLEMENTED:return te.UNIMPLEMENTED;case br.DATA_LOSS:return te.DATA_LOSS;default:return Oe()}}($t=br||(br={}))[$t.OK=0]="OK",$t[$t.CANCELLED=1]="CANCELLED",$t[$t.UNKNOWN=2]="UNKNOWN",$t[$t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$t[$t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$t[$t.NOT_FOUND=5]="NOT_FOUND",$t[$t.ALREADY_EXISTS=6]="ALREADY_EXISTS",$t[$t.PERMISSION_DENIED=7]="PERMISSION_DENIED",$t[$t.UNAUTHENTICATED=16]="UNAUTHENTICATED",$t[$t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$t[$t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$t[$t.ABORTED=10]="ABORTED",$t[$t.OUT_OF_RANGE=11]="OUT_OF_RANGE",$t[$t.UNIMPLEMENTED=12]="UNIMPLEMENTED",$t[$t.INTERNAL=13]="INTERNAL",$t[$t.UNAVAILABLE=14]="UNAVAILABLE",$t[$t.DATA_LOSS=15]="DATA_LOSS";function _$(){return new TextEncoder}const aoe=new yc([4294967295,4294967295],0);function y$(n){const e=_$().encode(n),t=new JB;return t.update(e),new Uint8Array(t.digest())}function v$(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new yc([t,r],0),new yc([i,s],0)]}class MD{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new $m(`Invalid padding: ${t}`);if(r<0)throw new $m(`Invalid hash count: ${r}`);if(e.length>0&&0===this.hashCount)throw new $m(`Invalid hash count: ${r}`);if(0===e.length&&0!==t)throw new $m(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=yc.fromNumber(this.Ie)}Ee(e,t,r){let i=e.add(t.multiply(yc.fromNumber(r)));return 1===i.compare(aoe)&&(i=new yc([i.getBits(0),i.getBits(1)],0)),i.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=y$(e),[r,i]=v$(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);if(!this.de(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new MD(s,i,t);return r.forEach(a=>o.insert(a)),o}insert(e){if(0===this.Ie)return;const t=y$(e),[r,i]=v$(t);for(let s=0;s<this.hashCount;s++){const o=this.Ee(r,i,s);this.Ae(o)}}Ae(e){const t=Math.floor(e/8);this.bitmap[t]|=1<<e%8}}class $m extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Hm{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,zm.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Hm(We.min(),i,new Dn(st),us(),pt())}}class zm{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new zm(r,t,pt(),pt(),pt())}}class dw{constructor(e,t,r,i){this.Re=e,this.removedTargetIds=t,this.key=r,this.Ve=i}}class E${constructor(e,t){this.targetId=e,this.me=t}}class I${constructor(e,t,r=dr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class w${constructor(){this.fe=0,this.ge=T$(),this.pe=dr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=pt(),t=pt(),r=pt();return this.ge.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:Oe()}}),new zm(this.pe,this.ye,e,t,r)}Ce(){this.we=!1,this.ge=T$()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ue(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class loe{constructor(e){this.Le=e,this.Be=new Map,this.ke=us(),this.qe=C$(),this.Qe=new Dn(st)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,t=>{const r=this.Ge(t);switch(e.state){case 0:this.ze(t)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),r.De(e.resumeToken));break;default:Oe()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach((r,i)=>{this.ze(i)&&t(i)})}He(e){const t=e.targetId,r=e.me.count,i=this.Je(t);if(i){const s=i.target;if(iw(s))if(0===r){const o=new Pe(s.path);this.Ue(t,o,$n.newNoDocument(o,We.min()))}else Ue(1===r);else{const o=this.Ye(t);if(o!==r){const a=this.Ze(e),l=a?this.Xe(a,e,o):1;0!==l&&(this.je(t),this.Qe=this.Qe.insert(t,2===l?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch"))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,a;try{o=Wa(r).toUint8Array()}catch(l){if(l instanceof Aj)return bs("Decoding the base64 bloom filter in existence filter failed ("+l.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw l}try{a=new MD(o,i,s)}catch(l){return bs(l instanceof $m?"BloomFilter error: ":"Applying bloom filter failed: ",l),null}return 0===a.Ie?null:a}Xe(e,t,r){return t.me.count===r-this.nt(e,t.targetId)?0:2}nt(e,t){const r=this.Le.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(a)||(this.Ue(t,s,null),i++)}),i}rt(e){const t=new Map;this.Be.forEach((s,o)=>{const a=this.Je(o);if(a){if(s.current&&iw(a.target)){const l=new Pe(a.target.path);null!==this.ke.get(l)||this.it(o,l)||this.Ue(o,l,$n.newNoDocument(l,e))}s.be&&(t.set(o,s.ve()),s.Ce())}});let r=pt();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(l=>{const u=this.Je(l);return!u||"TargetPurposeLimboResolution"===u.purpose||(a=!1,!1)}),a&&(r=r.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(e));const i=new Hm(e,t,this.Qe,this.ke,r);return this.ke=us(),this.qe=C$(),this.Qe=new Dn(st),i}$e(e,t){if(!this.ze(e))return;const r=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,r),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,r){if(!this.ze(e))return;const i=this.Ge(e);this.it(e,t)?i.Fe(t,1):i.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),r&&(this.ke=this.ke.insert(t,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new w$,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new dn(st),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||fe("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new w$),this.Le.getRemoteKeysForTarget(e).forEach(t=>{this.Ue(e,t,null)})}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function C$(){return new Dn(Pe.comparator)}function T$(){return new Dn(Pe.comparator)}const uoe={asc:"ASCENDING",desc:"DESCENDING"},coe={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},doe={and:"AND",or:"OR"};class hoe{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function kD(n,e){return n.useProto3Json||Dm(e)?e:{value:e}}function lf(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function A$(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function foe(n,e){return lf(n,e.toTimestamp())}function Er(n){return Ue(!!n),We.fromTimestamp(function(t){const r=za(t);return new Qn(r.seconds,r.nanos)}(n))}function OD(n,e){return FD(n,e).canonicalString()}function FD(n,e){const t=(i=n,new Lt(["projects",i.projectId,"databases",i.database])).child("documents");var i;return void 0===e?t:t.child(e)}function b$(n){const e=Lt.fromString(n);return Ue(L$(e)),e}function Wm(n,e){return OD(n.databaseId,e.path)}function ra(n,e){const t=b$(e);if(t.get(1)!==n.databaseId.projectId)throw new ce(te.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new ce(te.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new Pe(R$(t))}function S$(n,e){return OD(n.databaseId,e)}function D$(n){const e=b$(n);return 4===e.length?Lt.emptyPath():R$(e)}function LD(n){return new Lt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function R$(n){return Ue(n.length>4&&"documents"===n.get(4)),n.popFirst(5)}function x$(n,e,t){return{name:Wm(n,e),fields:t.value.mapValue.fields}}function P$(n,e,t){const r=ra(n,e.name),i=Er(e.updateTime),s=e.createTime?Er(e.createTime):We.min(),o=new li({mapValue:{fields:e.fields}}),a=$n.newFoundDocument(r,i,s,o);return t&&a.setHasCommittedMutations(),t?a.setHasCommittedMutations():a}function Gm(n,e){let t;if(e instanceof sf)t={update:x$(n,e.key,e.value)};else if(e instanceof af)t={delete:Wm(n,e.key)};else if(e instanceof Ka)t={update:x$(n,e.key,e.data),updateMask:Ioe(e.fieldMask)};else{if(!(e instanceof RD))return Oe();t={verify:Wm(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const a=o.transform;if(a instanceof nf)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof Tc)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof Ac)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof rf)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw Oe()}(0,r))),e.precondition.isNone||(t.currentDocument=void 0!==(s=e.precondition).updateTime?{updateTime:foe(n,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:Oe()),t;var s}function VD(n,e){const t=e.currentDocument?void 0!==(s=e.currentDocument).updateTime?Jn.updateTime(Er(s.updateTime)):void 0!==s.exists?Jn.exists(s.exists):Jn.none():Jn.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,a){let l=null;"setToServerValue"in a?(Ue("REQUEST_TIME"===a.setToServerValue),l=new nf):"appendMissingElements"in a?l=new Tc(a.appendMissingElements.values||[]):"removeAllFromArray"in a?l=new Ac(a.removeAllFromArray.values||[]):"increment"in a?l=new rf(o,a.increment):Oe();const u=jn.fromServerFormat(a.fieldPath);return new Bm(u,l)}(n,i)):[];var s;if(e.update){const i=ra(n,e.update.name),s=new li({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=new ls((e.updateMask.fieldPaths||[]).map(d=>jn.fromServerFormat(d)));return new Ka(i,s,o,t,r)}return new sf(i,s,t,r)}if(e.delete){const i=ra(n,e.delete);return new af(i,t)}if(e.verify){const i=ra(n,e.verify);return new RD(i,t)}return Oe()}function N$(n,e){return{documents:[S$(n,e.path)]}}function hw(n,e){const t={structuredQuery:{}},r=e.path;let i;null!==e.collectionGroup?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=S$(n,i);const s=function(u){if(0!==u.length)return F$(ln.create(u,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(u){if(0!==u.length)return u.map(d=>{return{field:Wl((_=d).field),direction:yoe(_.dir)};var _})}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const a=kD(n,e.limit);return null!==a&&(t.structuredQuery.limit=a),e.startAt&&(t.structuredQuery.startAt={before:(u=e.startAt).inclusive,values:u.position}),e.endAt&&(t.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:t,parent:i};var u}function k$(n){let e=D$(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){Ue(1===r);const d=t.from[0];d.allDescendants?i=d.collectionId:e=e.child(d.collectionId)}let s=[];t.where&&(s=function(p){const _=O$(p);return _ instanceof ln&&wD(_)?_.getFilters():[_]}(t.where));let o=[];t.orderBy&&(o=t.orderBy.map(_=>{return new km(uf((A=_).field),function(P){switch(P){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(A.direction));var A}));let a=null;t.limit&&(a=function(p){let _;return _="object"==typeof p?p.value:p,Dm(_)?null:_}(t.limit));let l=null;var p;t.startAt&&(l=new zl((p=t.startAt).values||[],!!p.before));let u=null;return t.endAt&&(u=function(p){return new zl(p.values||[],!p.before)}(t.endAt)),Gj(e,i,o,s,a,"F",l,u)}function O$(n){return void 0!==n.unaryFilter?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=uf(t.unaryFilter.field);return Vt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=uf(t.unaryFilter.field);return Vt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=uf(t.unaryFilter.field);return Vt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=uf(t.unaryFilter.field);return Vt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return Oe()}}(n):void 0!==n.fieldFilter?Vt.create(uf((t=n).fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Oe()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==n.compositeFilter?function(t){return ln.create(t.compositeFilter.filters.map(r=>O$(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Oe()}}(t.compositeFilter.op))}(n):Oe();var t}function yoe(n){return uoe[n]}function voe(n){return coe[n]}function Eoe(n){return doe[n]}function Wl(n){return{fieldPath:n.canonicalString()}}function uf(n){return jn.fromServerFormat(n.fieldPath)}function F$(n){return n instanceof Vt?function(t){if("=="===t.op){if(Rj(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NAN"}};if(Dj(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NULL"}}}else if("!="===t.op){if(Rj(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NOT_NAN"}};if(Dj(t.value))return{unaryFilter:{field:Wl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wl(t.field),op:voe(t.op),value:t.value}}}(n):n instanceof ln?function(t){const r=t.getFilters().map(i=>F$(i));return 1===r.length?r[0]:{compositeFilter:{op:Eoe(t.op),filters:r}}}(n):Oe()}function Ioe(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function L$(n){return n.length>=4&&"projects"===n.get(0)&&"databases"===n.get(2)}class Qa{constructor(e,t,r,i,s=We.min(),o=We.min(),a=dr.EMPTY_BYTE_STRING,l=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=l}withSequenceNumber(e){return new Qa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Qa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Qa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class V${constructor(e){this.ct=e}}function U$(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:fw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document={name:Wm(s=n.ct,(o=e).key),fields:o.data.value.mapValue.fields,updateTime:lf(s,o.version.toTimestamp()),createTime:lf(s,o.createTime.toTimestamp())};else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:bc(e.version)};else{if(!e.isUnknownDocument())return Oe();r.unknownDocument={path:t.path.toArray(),version:bc(e.version)}}var s,o;return r}function fw(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function bc(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function Sc(n){const e=new Qn(n.seconds,n.nanoseconds);return We.fromTimestamp(e)}function Dc(n,e){const t=(e.baseMutations||[]).map(s=>VD(n.ct,s));for(let s=0;s<e.mutations.length-1;++s)s+1<e.mutations.length&&void 0!==e.mutations[s+1].transform&&(e.mutations[s].updateTransforms=e.mutations[s+1].transform.fieldTransforms,e.mutations.splice(s+1,1),++s);const r=e.mutations.map(s=>VD(n.ct,s)),i=Qn.fromMillis(e.localWriteTimeMs);return new xD(e.batchId,i,t,r)}function qm(n){const e=Sc(n.readTime),t=void 0!==n.lastLimboFreeSnapshotVersion?Sc(n.lastLimboFreeSnapshotVersion):We.min();let r;return r=void 0!==n.query.documents?(Ue(1===(s=n.query).documents.length),wi(Zh(D$(s.documents[0])))):function(s){return wi(k$(s))}(n.query),new Qa(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,dr.fromBase64String(n.resumeToken));var s}function B$(n,e){const t=bc(e.snapshotVersion),r=bc(e.lastLimboFreeSnapshotVersion);let i;i=iw(e.target)?N$(n.ct,e.target):hw(n.ct,e.target)._t;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Cc(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function UD(n){const e=k$({parent:n.parent,structuredQuery:n.structuredQuery});return"LAST"===n.limitType?ow(e,e.limit,"L"):e}function BD(n,e){return new ND(e.largestBatchId,VD(n.ct,e.overlayMutation))}function j$(n,e){const t=e.path.lastSegment();return[n,Ii(e.path.popLast()),t]}function $$(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:bc(r.readTime),documentKey:Ii(r.documentKey.path),largestBatchId:r.largestBatchId}}class Coe{getBundleMetadata(e,t){return H$(e).get(t).next(r=>{if(r)return{id:(s=r).bundleId,createTime:Sc(s.createTime),version:s.version};var s})}saveBundleMetadata(e,t){return H$(e).put({bundleId:(i=t).id,createTime:bc(Er(i.createTime)),version:i.version});var i}getNamedQuery(e,t){return z$(e).get(t).next(r=>{if(r)return{name:(s=r).name,query:UD(s.bundledQuery),readTime:Sc(s.readTime)};var s})}saveNamedQuery(e,t){return z$(e).put({name:(i=t).name,readTime:bc(Er(i.readTime)),bundledQuery:i.bundledQuery});var i}}function H$(n){return Or(n,"bundles")}function z$(n){return Or(n,"namedQueries")}class pw{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){return new pw(e,t.uid||"")}getOverlay(e,t){return Km(e).get(j$(this.userId,t)).next(r=>r?BD(this.serializer,r):null)}getOverlays(e,t){const r=na();return q.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,o)=>{const a=new ND(t,o);i.push(this.ht(e,a))}),q.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(o=>i.add(Ii(o.getCollectionPath())));const s=[];return i.forEach(o=>{const a=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(Km(e).j("collectionPathOverlayIndex",a))}),q.waitFor(s)}getOverlaysForCollection(e,t,r){const i=na(),s=Ii(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Km(e).U("collectionPathOverlayIndex",o).next(a=>{for(const l of a){const u=BD(this.serializer,l);i.set(u.getKey(),u)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=na();let o;const a=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Km(e).J({index:"collectionGroupOverlayIndex",range:a},(l,u,d)=>{const p=BD(this.serializer,u);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):d.done()}).next(()=>s)}ht(e,t){return Km(e).put(function(i,s,o){const[a,l,u]=j$(s,o.mutation.key);return{userId:s,collectionPath:l,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Gm(i.ct,o.mutation)}}(this.serializer,this.userId,t))}}function Km(n){return Or(n,"documentOverlays")}class Toe{Pt(e){return Or(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(t=>{const r=t?.value;return r?dr.fromUint8Array(r):dr.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class Rc{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Yn(e.integerValue));else if("doubleValue"in e){const r=Yn(e.doubleValue);isNaN(r)?this.dt(t,13):(this.dt(t,15),Rm(r)?t.At(0):t.At(r))}else if("timestampValue"in e){let r=e.timestampValue;this.dt(t,20),"string"==typeof r&&(r=za(r)),t.Rt(`${r.seconds||""}`),t.At(r.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Wa(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.dt(t,45),t.At(r.latitude||0),t.At(r.longitude||0)}else"mapValue"in e?xj(e)?this.dt(t,Number.MAX_SAFE_INTEGER):rw(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):Oe()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const r=e.fields||{};this.dt(t,55);for(const i of Object.keys(r))this.Vt(i,t),this.Tt(r[i],t)}wt(e,t){var r,i;const s=e.fields||{};this.dt(t,53);const o="value",a=(null===(i=null===(r=s[o].arrayValue)||void 0===r?void 0:r.values)||void 0===i?void 0:i.length)||0;this.dt(t,15),t.At(Yn(a)),this.Vt(o,t),this.Tt(s[o],t)}bt(e,t){const r=e.values||[];this.dt(t,50);for(const i of r)this.Tt(i,t)}yt(e,t){this.dt(t,37),Pe.fromName(e).path.forEach(r=>{this.dt(t,60),this.Dt(r,t)})}dt(e,t){e.At(t)}ft(e){e.At(2)}}function Aoe(n){if(0===n)return 8;let e=0;return!(n>>4)&&(e+=4,n<<=4),!(n>>6)&&(e+=2,n<<=2),!(n>>7)&&(e+=1),e}function W$(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=Aoe(255&r[s]);if(i+=o,8!==o)break}return i}(n);return Math.ceil(e/8)}Rc.vt=new Rc;class boe{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ft(r.value),r=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Ot(r.value),r=t.next();this.Nt()}Lt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ft(r);else if(r<2048)this.Ft(960|r>>>6),this.Ft(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r);else{const i=t.codePointAt(0);this.Ft(240|i>>>18),this.Ft(128|63&i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i)}}this.Mt()}Bt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Ot(r);else if(r<2048)this.Ot(960|r>>>6),this.Ot(128|63&r);else if(t<"\ud800"||"\udbff"<t)this.Ot(480|r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r);else{const i=t.codePointAt(0);this.Ot(240|i>>>18),this.Ot(128|63&i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i)}}this.Nt()}kt(e){const t=this.qt(e),r=W$(t);this.Qt(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}Kt(e){const t=this.qt(e),r=W$(t);this.Qt(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=0!=(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}Ft(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;0===t?(this.Gt(0),this.Gt(255)):255===t?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class Soe{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class Doe{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Qm{constructor(){this.jt=new boe,this.Ht=new Soe(this.jt),this.Jt=new Doe(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return 0===e?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}class xc{constructor(e,t,r,i){this.indexId=e,this.documentKey=t,this.arrayValue=r,this.directionalValue=i}Zt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,r=new Uint8Array(t);return r.set(this.directionalValue,0),t!==e?r.set([0],this.directionalValue.length):++r[r.length-1],new xc(this.indexId,this.documentKey,this.arrayValue,r)}}function Gl(n,e){let t=n.indexId-e.indexId;return 0!==t?t:(t=G$(n.arrayValue,e.arrayValue),0!==t?t:(t=G$(n.directionalValue,e.directionalValue),0!==t?t:Pe.comparator(n.documentKey,e.documentKey)))}function G$(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(0!==r)return r}return n.length-e.length}class q${constructor(e){this.Xt=new dn((t,r)=>jn.comparator(t.field,r.field)),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Xt=this.Xt.add(r):this.tn.push(r)}}get nn(){return this.Xt.size>1}rn(e){if(Ue(e.collectionGroup===this.collectionId),this.nn)return!1;const t=fD(e);if(void 0!==t&&!this.sn(t))return!1;const r=vc(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.sn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.Xt.size>0){const a=this.Xt.getIterator().getNext();if(!i.has(a.field.canonicalString())){const l=r[s];if(!this.on(a,l)||!this._n(this.en[o++],l))return!1}++s}for(;s<r.length;++s)if(o>=this.en.length||!this._n(this.en[o++],r[s]))return!1;return!0}an(){if(this.nn)return null;let e=new dn(jn.comparator);const t=[];for(const r of this.tn)if(!r.field.isKeyField())if("array-contains"===r.op||"array-contains-any"===r.op)t.push(new Ec(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Ec(r.field,0))}for(const r of this.en)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Ec(r.field,"asc"===r.dir?0:1)));return new Kh(Kh.UNKNOWN_ID,this.collectionId,t,Qh.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){return!(void 0===e||!e.field.isEqual(t.fieldPath))&&2===t.kind==("array-contains"===e.op||"array-contains-any"===e.op)}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function K$(n){var e,t;if(Ue(n instanceof Vt||n instanceof ln),n instanceof Vt){if(n instanceof Hj){const i=(null===(t=null===(e=n.value.arrayValue)||void 0===e?void 0:e.values)||void 0===t?void 0:t.map(s=>Vt.create(n.field,"==",s)))||[];return ln.create(i,"or")}return n}const r=n.filters.map(i=>K$(i));return ln.create(r,n.op)}function Roe(n){if(0===n.getFilters().length)return[];const e=HD(K$(n));return Ue(Q$(e)),jD(e)||$D(e)?[e]:e.getFilters()}function jD(n){return n instanceof Vt}function $D(n){return n instanceof ln&&wD(n)}function Q$(n){return jD(n)||$D(n)||function(t){if(t instanceof ln&&ID(t)){for(const r of t.getFilters())if(!jD(r)&&!$D(r))return!1;return!0}return!1}(n)}function HD(n){if(Ue(n instanceof Vt||n instanceof ln),n instanceof Vt)return n;if(1===n.filters.length)return HD(n.filters[0]);const e=n.filters.map(r=>HD(r));let t=ln.create(e,n.op);return t=gw(t),Q$(t)?t:(Ue(t instanceof ln),Ue(Xh(t)),Ue(t.filters.length>1),t.filters.reduce((r,i)=>zD(r,i)))}function zD(n,e){let t;return Ue(n instanceof Vt||n instanceof ln),Ue(e instanceof Vt||e instanceof ln),t=n instanceof Vt?e instanceof Vt?ln.create([n,e],"and"):Y$(n,e):e instanceof Vt?Y$(e,n):function(i,s){if(Ue(i.filters.length>0&&s.filters.length>0),Xh(i)&&Xh(s))return Bj(i,s.getFilters());const o=ID(i)?i:s,a=ID(i)?s:i,l=o.filters.map(u=>zD(u,a));return ln.create(l,"or")}(n,e),gw(t)}function Y$(n,e){if(Xh(e))return Bj(e,n.getFilters());{const t=e.filters.map(r=>zD(n,r));return ln.create(t,"or")}}function gw(n){if(Ue(n instanceof Vt||n instanceof ln),n instanceof Vt)return n;const e=n.getFilters();if(1===e.length)return gw(e[0]);if(Vj(n))return n;const t=e.map(i=>gw(i)),r=[];return t.forEach(i=>{i instanceof Vt?r.push(i):i instanceof ln&&(i.op===n.op?r.push(...i.filters):r.push(i))}),1===r.length?r[0]:ln.create(r,n.op)}class xoe{constructor(){this.un=new WD}addToCollectionParentIndex(e,t){return this.un.add(t),q.resolve()}getCollectionParents(e,t){return q.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return q.resolve()}deleteFieldIndex(e,t){return q.resolve()}deleteAllFieldIndexes(e){return q.resolve()}createTargetIndexes(e,t){return q.resolve()}getDocumentsMatchingTarget(e,t){return q.resolve(null)}getIndexType(e,t){return q.resolve(0)}getFieldIndexes(e,t){return q.resolve([])}getNextCollectionGroupToUpdate(e){return q.resolve(null)}getMinOffset(e,t){return q.resolve(Ss.min())}getMinOffsetFromCollectionGroup(e,t){return q.resolve(Ss.min())}updateCollectionGroup(e,t,r){return q.resolve()}updateIndexEntries(e,t){return q.resolve()}}class WD{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new dn(Lt.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new dn(Lt.comparator)).toArray()}}const mw=new Uint8Array(0);class Poe{constructor(e,t){this.databaseId=t,this.cn=new WD,this.ln=new qa(r=>Cc(r),(r,i)=>Om(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.cn.add(t)});const s={collectionId:r,parent:Ii(i)};return J$(e).put(s)}return q.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[aj(t),""],!1,!0);return J$(e).U(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;r.push(ea(o.parent))}return r})}addFieldIndex(e,t){const r=Ym(e),i={indexId:(a=t).indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(l=>[l.fieldPath.canonicalString(),l.kind])};var a;delete i.indexId;const s=r.add(i);if(t.indexState){const o=df(e);return s.next(a=>{o.put($$(a,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=Ym(e),i=df(e),s=cf(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Ym(e),r=cf(e),i=df(e);return t.j().next(()=>r.j()).next(()=>i.j())}createTargetIndexes(e,t){return q.forEach(this.hn(t),r=>this.getIndexType(e,r).next(i=>{if(0===i||1===i){const s=new q$(r).an();if(null!=s)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=cf(e);let i=!0;const s=new Map;return q.forEach(this.hn(t),o=>this.Pn(e,o).next(a=>{i&&(i=!!a),s.set(o,a)})).next(()=>{if(i){let o=pt();const a=[];return q.forEach(s,(l,u)=>{var Y;fe("IndexedDbIndexManager",`Using index ${Y=l,`id=${Y.indexId}|cg=${Y.collectionGroup}|f=${Y.fields.map(ae=>`${ae.fieldPath}:${ae.kind}`).join(",")}`} to execute ${Cc(t)}`);const d=function(Y,ae){const Te=fD(ae);if(void 0===Te)return null;for(const $e of sw(Y,Te.fieldPath))switch($e.op){case"array-contains-any":return $e.value.arrayValue.values||[];case"array-contains":return[$e.value]}return null}(u,l),p=function(Y,ae){const Te=new Map;for(const $e of vc(ae))for(const U of sw(Y,$e.fieldPath))switch(U.op){case"==":case"in":Te.set($e.fieldPath.canonicalString(),U.value);break;case"not-in":case"!=":return Te.set($e.fieldPath.canonicalString(),U.value),Array.from(Te.values())}return null}(u,l),_=function(Y,ae){const Te=[];let $e=!0;for(const U of vc(ae)){const M=0===U.kind?zj(Y,U.fieldPath,Y.startAt):Wj(Y,U.fieldPath,Y.startAt);Te.push(M.value),$e&&($e=M.inclusive)}return new zl(Te,$e)}(u,l),v=function(Y,ae){const Te=[];let $e=!0;for(const U of vc(ae)){const M=0===U.kind?Wj(Y,U.fieldPath,Y.endAt):zj(Y,U.fieldPath,Y.endAt);Te.push(M.value),$e&&($e=M.inclusive)}return new zl(Te,$e)}(u,l),A=this.In(l,u,_),D=this.In(l,u,v),P=this.Tn(l,u,p),H=this.En(l.indexId,d,A,_.inclusive,D,v.inclusive,P);return q.forEach(H,V=>r.G(V,t.limit).next(Y=>{Y.forEach(ae=>{const Te=Pe.fromSegments(ae.documentKey);o.has(Te)||(o=o.add(Te),a.push(Te))})}))}).next(()=>a)}return q.resolve(null)})}hn(e){let t=this.ln.get(e);return t||(t=0===e.filters.length?[e]:Roe(ln.create(e.filters,"and")).map(r=>TD(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,t),t)}En(e,t,r,i,s,o,a){const l=(null!=t?t.length:1)*Math.max(r.length,s.length),u=l/(null!=t?t.length:1),d=[];for(let p=0;p<l;++p){const _=t?this.dn(t[p/u]):mw,v=this.An(e,_,r[p%u],i),A=this.Rn(e,_,s[p%u],o),D=a.map(P=>this.An(e,_,P,!0));d.push(...this.createRange(v,A,D))}return d}An(e,t,r,i){const s=new xc(e,Pe.empty(),t,r);return i?s:s.Zt()}Rn(e,t,r,i){const s=new xc(e,Pe.empty(),t,r);return i?s.Zt():s}Pn(e,t){const r=new q$(t),i=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const a of s)r.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(e,t){let r=2;const i=this.hn(t);return q.forEach(i,s=>this.Pn(e,s).next(o=>{o?0!==r&&o.fields.length<function(l){let u=new dn(jn.comparator),d=!1;for(const p of l.filters)for(const _ of p.getFlattenedFilters())_.field.isKeyField()||("array-contains"===_.op||"array-contains-any"===_.op?d=!0:u=u.add(_.field));for(const p of l.orderBy)p.field.isKeyField()||(u=u.add(p.field));return u.size+(d?1:0)}(s)&&(r=1):r=0})).next(()=>null!==t.limit&&i.length>1&&2===r?1:r)}Vn(e,t){const r=new Qm;for(const i of vc(e)){const s=t.data.field(i.fieldPath);if(null==s)return null;const o=r.Yt(i.kind);Rc.vt.It(s,o)}return r.zt()}dn(e){const t=new Qm;return Rc.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const r=new Qm;return Rc.vt.It(wc(this.databaseId,t),r.Yt(function(s){const o=vc(s);return 0===o.length?0:o[o.length-1].kind}(e))),r.zt()}Tn(e,t,r){if(null===r)return[];let i=[];i.push(new Qm);let s=0;for(const o of vc(e)){const a=r[s++];for(const l of i)if(this.fn(t,o.fieldPath)&&Nm(a))i=this.gn(i,o,a);else{const u=l.Yt(o.kind);Rc.vt.It(a,u)}}return this.pn(i)}In(e,t,r){return this.Tn(e,t,r.position)}pn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].zt();return t}gn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const a of i){const l=new Qm;l.seed(a.zt()),Rc.vt.It(o,l.Yt(t.kind)),s.push(l)}return s}fn(e,t){return!!e.filters.find(r=>r instanceof Vt&&r.field.isEqual(t)&&("in"===r.op||"not-in"===r.op))}getFieldIndexes(e,t){const r=Ym(e),i=df(e);return(t?r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):r.U()).next(s=>{const o=[];return q.forEach(s,a=>i.get([a.indexId,this.uid]).next(l=>{o.push(function(d,p){const _=p?new Qh(p.sequenceNumber,new Ss(Sc(p.readTime),new Pe(ea(p.documentKey)),p.largestBatchId)):Qh.empty(),v=d.fields.map(([A,D])=>new Ec(jn.fromServerFormat(A),D));return new Kh(d.indexId,d.collectionGroup,v,_)}(a,l))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>0===t.length?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return 0!==s?s:st(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=Ym(e),s=df(e);return this.yn(e).next(o=>i.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(a=>q.forEach(a,l=>s.put($$(l.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return q.forEach(t,(i,s)=>{const o=r.get(i.collectionGroup);return(o?q.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(a=>(r.set(i.collectionGroup,a),q.forEach(a,l=>this.wn(e,i,l).next(u=>{const d=this.Sn(s,l);return u.isEqual(d)?q.resolve():this.bn(e,s,l,u,d)}))))})}Dn(e,t,r,i){return cf(e).put({indexId:i.indexId,uid:this.uid,arrayValue:i.arrayValue,directionalValue:i.directionalValue,orderedDocumentKey:this.mn(r,t.key),documentKey:t.key.path.toArray()})}vn(e,t,r,i){return cf(e).delete([i.indexId,this.uid,i.arrayValue,i.directionalValue,this.mn(r,t.key),t.key.path.toArray()])}wn(e,t,r){const i=cf(e);let s=new dn(Gl);return i.J({index:"documentKeyIndex",range:IDBKeyRange.only([r.indexId,this.uid,this.mn(r,t)])},(o,a)=>{s=s.add(new xc(r.indexId,t,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(e,t){let r=new dn(Gl);const i=this.Vn(t,e);if(null==i)return r;const s=fD(t);if(null!=s){const o=e.data.field(s.fieldPath);if(Nm(o))for(const a of o.arrayValue.values||[])r=r.add(new xc(t.indexId,e.key,this.dn(a),i))}else r=r.add(new xc(t.indexId,e.key,mw,i));return r}bn(e,t,r,i,s){fe("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const o=[];return function(l,u,d,p,_){const v=l.getIterator(),A=u.getIterator();let D=Yh(v),P=Yh(A);for(;D||P;){let H=!1,V=!1;if(D&&P){const Y=d(D,P);Y<0?V=!0:Y>0&&(H=!0)}else null!=D?V=!0:H=!0;H?(p(P),P=Yh(A)):V?(_(D),D=Yh(v)):(D=Yh(v),P=Yh(A))}}(i,s,Gl,a=>{o.push(this.Dn(e,t,r,a))},a=>{o.push(this.vn(e,t,r,a))}),q.waitFor(o)}yn(e){let t=1;return df(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,a)=>Gl(o,a)).filter((o,a,l)=>!a||0!==Gl(o,l[a-1]));const i=[];i.push(e);for(const o of r){const a=Gl(o,e),l=Gl(o,t);if(0===a)i[0]=e.Zt();else if(a>0&&l<0)i.push(o),i.push(o.Zt());else if(l>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Cn(i[o],i[o+1]))return[];s.push(IDBKeyRange.bound([i[o].indexId,this.uid,i[o].arrayValue,i[o].directionalValue,mw,[]],[i[o+1].indexId,this.uid,i[o+1].arrayValue,i[o+1].directionalValue,mw,[]]))}return s}Cn(e,t){return Gl(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(X$)}getMinOffset(e,t){return q.mapArray(this.hn(t),r=>this.Pn(e,r).next(i=>i||Oe())).next(X$)}}function J$(n){return Or(n,"collectionParents")}function cf(n){return Or(n,"indexEntries")}function Ym(n){return Or(n,"indexConfiguration")}function df(n){return Or(n,"indexState")}function X$(n){Ue(0!==n.length);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;pD(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new Ss(e.readTime,e.documentKey,t)}const Z$={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Ci{constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}static withCacheSize(e){return new Ci(e,Ci.DEFAULT_COLLECTION_PERCENTILE,Ci.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function eH(n,e,t){const r=n.store("mutations"),i=n.store("documentMutations"),s=[],o=IDBKeyRange.only(t.batchId);let a=0;const l=r.J({range:o},(d,p,_)=>(a++,_.delete()));s.push(l.next(()=>{Ue(1===a)}));const u=[];for(const d of t.mutations){const p=_j(e,d.key.path,t.batchId);s.push(i.delete(p)),u.push(d.key)}return q.waitFor(s).next(()=>u)}function _w(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw Oe();e=n.noDocument}return JSON.stringify(e).length}Ci.DEFAULT_COLLECTION_PERCENTILE=10,Ci.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ci.DEFAULT=new Ci(41943040,Ci.DEFAULT_COLLECTION_PERCENTILE,Ci.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ci.DISABLED=new Ci(-1,0,0);class yw{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.Fn={}}static lt(e,t,r,i){Ue(""!==e.uid);const s=e.isAuthenticated()?e.uid:"";return new yw(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ql(e).J({index:"userMutationsIndex",range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=hf(e),o=ql(e);return o.add({}).next(a=>{Ue("number"==typeof a);const l=new xD(a,t,r,i),u=function(v,A,D){const P=D.baseMutations.map(V=>Gm(v.ct,V)),H=D.mutations.map(V=>Gm(v.ct,V));return{userId:A,batchId:D.batchId,localWriteTimeMs:D.localWriteTime.toMillis(),baseMutations:P,mutations:H}}(this.serializer,this.userId,l),d=[];let p=new dn((_,v)=>st(_.canonicalString(),v.canonicalString()));for(const _ of i){const v=_j(this.userId,_.key.path,a);p=p.add(_.key.path.popLast()),d.push(o.put(u)),d.push(s.put(v,yse))}return p.forEach(_=>{d.push(this.indexManager.addToCollectionParentIndex(e,_))}),e.addOnCommittedListener(()=>{this.Fn[a]=l.keys()}),q.waitFor(d).next(()=>l)})}lookupMutationBatch(e,t){return ql(e).get(t).next(r=>r?(Ue(r.userId===this.userId),Dc(this.serializer,r)):null)}Mn(e,t){return this.Fn[t]?q.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.Fn[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return ql(e).J({index:"userMutationsIndex",range:i},(o,a,l)=>{a.userId===this.userId&&(Ue(a.batchId>=r),s=Dc(this.serializer,a)),l.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=-1;return ql(e).J({index:"userMutationsIndex",range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ql(e).U("userMutationsIndex",t).next(r=>r.map(i=>Dc(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=YI(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return hf(e).J({range:i},(o,a,l)=>{const[u,d,p]=o,_=ea(d);if(u===this.userId&&t.path.isEqual(_))return ql(e).get(p).next(v=>{if(!v)throw Oe();Ue(v.userId===this.userId),s.push(Dc(this.serializer,v))});l.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dn(st);const i=[];return t.forEach(s=>{const o=YI(this.userId,s.path),a=IDBKeyRange.lowerBound(o),l=hf(e).J({range:a},(u,d,p)=>{const[_,v,A]=u,D=ea(v);_===this.userId&&s.path.isEqual(D)?r=r.add(A):p.done()});i.push(l)}),q.waitFor(i).next(()=>this.xn(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=YI(this.userId,r),o=IDBKeyRange.lowerBound(s);let a=new dn(st);return hf(e).J({range:o},(l,u,d)=>{const[p,_,v]=l,A=ea(_);p===this.userId&&r.isPrefixOf(A)?A.length===i&&(a=a.add(v)):d.done()}).next(()=>this.xn(e,a))}xn(e,t){const r=[],i=[];return t.forEach(s=>{i.push(ql(e).get(s).next(o=>{if(null===o)throw Oe();Ue(o.userId===this.userId),r.push(Dc(this.serializer,o))}))}),q.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return eH(e._e,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.On(t.batchId)}),q.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return q.resolve();const r=IDBKeyRange.lowerBound([this.userId]),i=[];return hf(e).J({range:r},(s,o,a)=>{if(s[0]===this.userId){const l=ea(s[1]);i.push(l)}else a.done()}).next(()=>{Ue(0===i.length)})})}containsKey(e,t){return tH(e,this.userId,t)}Nn(e){return nH(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function tH(n,e,t){const r=YI(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return hf(n).J({range:s,H:!0},(a,l,u)=>{const[d,p,_]=a;d===e&&p===i&&(o=!0),u.done()}).next(()=>o)}function ql(n){return Or(n,"mutations")}function hf(n){return Or(n,"documentMutations")}function nH(n){return Or(n,"mutationQueues")}class Pc{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Pc(0)}static kn(){return new Pc(-1)}}class Noe{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next(t=>{const r=new Pc(t.highestTargetId);return t.highestTargetId=r.next(),this.Qn(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(t=>We.fromTimestamp(new Qn(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.qn(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Qn(e,i)))}addTargetData(e,t){return this.Kn(e,t).next(()=>this.qn(e).next(r=>(r.targetCount+=1,this.$n(t,r),this.Qn(e,r))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>ff(e).delete(t.targetId)).next(()=>this.qn(e)).next(r=>(Ue(r.targetCount>0),r.targetCount-=1,this.Qn(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return ff(e).J((o,a)=>{const l=qm(a);l.sequenceNumber<=t&&null===r.get(l.targetId)&&(i++,s.push(this.removeTargetData(e,l)))}).next(()=>q.waitFor(s)).next(()=>i)}forEachTarget(e,t){return ff(e).J((r,i)=>{const s=qm(i);t(s)})}qn(e){return rH(e).get("targetGlobalKey").next(t=>(Ue(null!==t),t))}Qn(e,t){return rH(e).put("targetGlobalKey",t)}Kn(e,t){return ff(e).put(B$(this.serializer,t))}$n(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.qn(e).next(t=>t.targetCount)}getTargetData(e,t){const r=Cc(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return ff(e).J({range:i,index:"queryTargetsIndex"},(o,a,l)=>{const u=qm(a);Om(t,u.target)&&(s=u,l.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Kl(e);return t.forEach(o=>{const a=Ii(o.path);i.push(s.put({targetId:r,path:a})),i.push(this.referenceDelegate.addReference(e,r,o))}),q.waitFor(i)}removeMatchingKeys(e,t,r){const i=Kl(e);return q.forEach(t,s=>{const o=Ii(s.path);return q.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Kl(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Kl(e);let s=pt();return i.J({range:r,H:!0},(o,a,l)=>{const u=ea(o[1]),d=new Pe(u);s=s.add(d)}).next(()=>s)}containsKey(e,t){const r=Ii(t.path),i=IDBKeyRange.bound([r],[aj(r)],!1,!0);let s=0;return Kl(e).J({index:"documentTargetsIndex",H:!0,range:i},([o,a],l,u)=>{0!==o&&(s++,u.done())}).next(()=>s>0)}ot(e,t){return ff(e).get(t).next(r=>r?qm(r):null)}}function ff(n){return Or(n,"targets")}function rH(n){return Or(n,"targetGlobal")}function Kl(n){return Or(n,"targetDocuments")}function iH([n,e],[t,r]){const i=st(n,t);return 0===i?st(e,r):i}class Moe{constructor(e){this.Un=e,this.buffer=new dn(iH),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();iH(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class sH{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.jn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return null!==this.jn}Hn(e){var t=this;fe("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(0,Z.A)(function*(){t.jn=null;try{yield t.localStore.collectGarbage(t.garbageCollector)}catch(r){Vl(r)?fe("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",r):yield Ll(r)}yield t.Hn(3e5)}))}}class koe{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(0===t)return q.resolve(Ds.oe);const r=new Moe(t);return this.Jn.forEachTarget(e,i=>r.zn(i.sequenceNumber)).next(()=>this.Jn.Zn(e,i=>r.zn(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.Jn.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector","Garbage collection skipped; disabled"),q.resolve(Z$)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(fe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Z$):this.Xn(e,t))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let r,i,s,o,a,l,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(fe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(r=p,a=Date.now(),this.removeTargets(e,r,t))).next(p=>(s=p,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(p=>(u=Date.now(),Gh()<=Ys.$b.DEBUG&&fe("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${o-d}ms\n\tDetermined least recently used ${i} in `+(a-o)+`ms\n\tRemoved ${s} targets in `+(l-a)+`ms\n\tRemoved ${p} documents in `+(u-l)+`ms\nTotal Duration: ${u-d}ms`),q.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}class Ooe{constructor(e,t){this.db=e,this.garbageCollector=function oH(n,e){return new koe(n,e)}(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}er(e){let t=0;return this.Zn(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,(r,i)=>t(i))}addReference(e,t,r){return vw(e,r)}removeReference(e,t,r){return vw(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return vw(e,t)}nr(e,t){return function(i,s){let o=!1;return nH(i).Y(a=>tH(i,a,s).next(l=>(l&&(o=!0),q.resolve(!l)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.tr(e,(o,a)=>{if(a<=t){const l=this.nr(e,o).next(u=>{if(!u)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,We.min()),Kl(e).delete([0,Ii(o.path)])))});i.push(l)}}).next(()=>q.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return vw(e,t)}tr(e,t){const r=Kl(e);let i,s=Ds.oe;return r.J({index:"documentTargetsIndex"},([o,a],{path:l,sequenceNumber:u})=>{0===o?(s!==Ds.oe&&t(new Pe(ea(i)),s),s=u,i=l):s=Ds.oe}).next(()=>{s!==Ds.oe&&t(new Pe(ea(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function vw(n,e){return Kl(n).put((i=n.currentSequenceNumber,{targetId:0,path:Ii(e.path),sequenceNumber:i}));var i}class aH{constructor(){this.changes=new qa(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,$n.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return void 0!==r?q.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Foe{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Nc(e).put(r)}removeEntry(e,t,r){return Nc(e).delete(function(s,o){const a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],fw(o),a[a.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.rr(e,r)))}getEntry(e,t){let r=$n.newInvalidDocument(t);return Nc(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Jm(t))},(i,s)=>{r=this.ir(t,s)}).next(()=>r)}sr(e,t){let r={size:0,document:$n.newInvalidDocument(t)};return Nc(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(Jm(t))},(i,s)=>{r={document:this.ir(t,s),size:_w(s)}}).next(()=>r)}getEntries(e,t){let r=us();return this._r(e,t,(i,s)=>{const o=this.ir(i,s);r=r.insert(i,o)}).next(()=>r)}ar(e,t){let r=us(),i=new Dn(Pe.comparator);return this._r(e,t,(s,o)=>{const a=this.ir(s,o);r=r.insert(s,a),i=i.insert(s,_w(o))}).next(()=>({documents:r,ur:i}))}_r(e,t,r){if(t.isEmpty())return q.resolve();let i=new dn(dH);t.forEach(l=>i=i.add(l));const s=IDBKeyRange.bound(Jm(i.first()),Jm(i.last())),o=i.getIterator();let a=o.getNext();return Nc(e).J({index:"documentKeyIndex",range:s},(l,u,d)=>{const p=Pe.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;a&&dH(a,p)<0;)r(a,null),a=o.getNext();a&&a.isEqual(p)&&(r(a,u),a=o.hasNext()?o.getNext():null),a?d.$(Jm(a)):d.done()}).next(()=>{for(;a;)r(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,a=[o.popLast().toArray(),o.lastSegment(),fw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],l=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Nc(e).U(IDBKeyRange.bound(a,l,!0)).next(u=>{s?.incrementDocumentReadCount(u.length);let d=us();for(const p of u){const _=this.ir(Pe.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);_.isFoundDocument()&&(Lm(t,_)||i.has(_.key))&&(d=d.insert(_.key,_))}return d})}getAllFromCollectionGroup(e,t,r,i){let s=us();const o=cH(t,r),a=cH(t,Ss.max());return Nc(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(l,u,d)=>{const p=this.ir(Pe.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);s=s.insert(p.key,p),s.size===i&&d.done()}).next(()=>s)}newChangeBuffer(e){return new Loe(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return uH(e).get("remoteDocumentGlobalKey").next(t=>(Ue(!!t),t))}rr(e,t){return uH(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const r=function woe(n,e){let t;if(e.document)t=P$(n.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=Pe.fromSegments(e.noDocument.path),i=Sc(e.noDocument.readTime);t=$n.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Oe();{const r=Pe.fromSegments(e.unknownDocument.path),i=Sc(e.unknownDocument.version);t=$n.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Qn(i[0],i[1]);return We.fromTimestamp(s)}(e.readTime)),t}(this.serializer,t);if(!r.isNoDocument()||!r.version.isEqual(We.min()))return r}return $n.newInvalidDocument(e)}}function lH(n){return new Foe(n)}class Loe extends aH{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new qa(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new dn((s,o)=>st(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const a=this.lr.get(s);if(t.push(this.cr.removeEntry(e,s,a.readTime)),o.isValidDocument()){const l=U$(this.cr.serializer,o);i=i.add(s.path.popLast());const u=_w(l);r+=u-a.size,t.push(this.cr.addEntry(e,s,l))}else if(r-=a.size,this.trackRemovals){const l=U$(this.cr.serializer,o.convertToNoDocument(We.min()));t.push(this.cr.addEntry(e,s,l))}}),i.forEach(s=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.cr.updateMetadata(e,r)),q.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next(r=>(this.lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.cr.ar(e,t).next(({documents:r,ur:i})=>(i.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function uH(n){return Or(n,"remoteDocumentGlobal")}function Nc(n){return Or(n,"remoteDocumentsV14")}function Jm(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function cH(n,e){const t=e.documentKey.path.toArray();return[n,fw(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function dH(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=st(t[s],r[s]),i)return i;return i=st(t.length,r.length),i||(i=st(t[t.length-2],r[r.length-2]),i||st(t[t.length-1],r[r.length-1]))}class Voe{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class hH{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(null!==r&&jm(r.mutation,i,ls.empty(),Qn.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,pt()).next(()=>r))}getLocalViewOfDocuments(e,t,r=pt()){const i=na();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Vm();return s.forEach((a,l)=>{o=o.insert(a,l.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=na();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,pt()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,a)=>{t.set(o,a)})})}computeViews(e,t,r,i){let s=us();const o=Um(),a=Um();return t.forEach((l,u)=>{const d=r.get(u.key);i.has(u.key)&&(void 0===d||d.mutation instanceof Ka)?s=s.insert(u.key,u):void 0!==d?(o.set(u.key,d.mutation.getFieldMask()),jm(d.mutation,u,d.mutation.getFieldMask(),Qn.now())):o.set(u.key,ls.empty())}),this.recalculateAndSaveOverlays(e,s).next(l=>(l.forEach((u,d)=>o.set(u,d)),t.forEach((u,d)=>{var p;return a.set(u,new Voe(d,null!==(p=o.get(u))&&void 0!==p?p:null))}),a))}recalculateAndSaveOverlays(e,t){const r=Um();let i=new Dn((o,a)=>o-a),s=pt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const a of o)a.keys().forEach(l=>{const u=t.get(l);if(null===u)return;let d=r.get(l)||ls.empty();d=a.applyToLocalView(u,d),r.set(l,d);const p=(i.get(a.batchId)||pt()).add(l);i=i.insert(a.batchId,p)})}).next(()=>{const o=[],a=i.getReverseIterator();for(;a.hasNext();){const l=a.getNext(),u=l.key,d=l.value,p=t$();d.forEach(_=>{if(!s.has(_)){const v=u$(t.get(_),r.get(_));null!==v&&p.set(_,v),s=s.add(_)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,p))}return q.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return Pe.isDocumentKey((o=t).path)&&null===o.collectionGroup&&0===o.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):AD(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i);var o}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):q.resolve(na());let a=-1,l=s;return o.next(u=>q.forEach(u,(d,p)=>(a<p.largestBatchId&&(a=p.largestBatchId),s.get(d)?q.resolve():this.remoteDocumentCache.getEntry(e,d).next(_=>{l=l.insert(d,_)}))).next(()=>this.populateOverlays(e,u,s)).next(()=>this.computeViews(e,l,u,pt())).next(d=>({batchId:a,changes:e$(d)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Pe(t)).next(r=>{let i=Vm();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Vm();return this.indexManager.getCollectionParents(e,s).next(a=>q.forEach(a,l=>{const u=(p=t,_=l.child(s),new Ga(_,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt));var p,_;return this.getDocumentsMatchingCollectionQuery(e,u,r,i).next(d=>{d.forEach((p,_)=>{o=o.insert(p,_)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((l,u)=>{const d=u.getKey();null===o.get(d)&&(o=o.insert(d,$n.newInvalidDocument(d)))});let a=Vm();return o.forEach((l,u)=>{const d=s.get(l);void 0!==d&&jm(d.mutation,u,ls.empty(),Qn.now()),Lm(t,u)&&(a=a.insert(l,u))}),a})}}class Uoe{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return q.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,{id:(i=t).id,version:i.version,createTime:Er(i.createTime)}),q.resolve();var i}getNamedQuery(e,t){return q.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,{name:(i=t).name,query:UD(i.bundledQuery),readTime:Er(i.readTime)}),q.resolve();var i}}class Boe{constructor(){this.overlays=new Dn(Pe.comparator),this.Ir=new Map}getOverlay(e,t){return q.resolve(this.overlays.get(t))}getOverlays(e,t){const r=na();return q.forEach(t,i=>this.getOverlay(e,i).next(s=>{null!==s&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.ht(e,t,s)}),q.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Ir.get(r);return void 0!==i&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(r)),q.resolve()}getOverlaysForCollection(e,t,r){const i=na(),s=t.length+1,o=new Pe(t.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){const l=a.getNext().value,u=l.getKey();if(!t.isPrefixOf(u.path))break;u.path.length===s&&l.largestBatchId>r&&i.set(l.getKey(),l)}return q.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new Dn((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===t&&u.largestBatchId>r){let d=s.get(u.largestBatchId);null===d&&(d=na(),s=s.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const a=na(),l=s.getIterator();for(;l.hasNext()&&(l.getNext().value.forEach((u,d)=>a.set(u,d)),!(a.size()>=i)););return q.resolve(a)}ht(e,t,r){const i=this.overlays.get(r.key);if(null!==i){const o=this.Ir.get(i.largestBatchId).delete(r.key);this.Ir.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new ND(t,r));let s=this.Ir.get(t);void 0===s&&(s=pt(),this.Ir.set(t,s)),this.Ir.set(t,s.add(r.key))}}class joe{constructor(){this.sessionToken=dr.EMPTY_BYTE_STRING}getSessionToken(e){return q.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,q.resolve()}}class GD{constructor(){this.Tr=new dn(qr.Er),this.dr=new dn(qr.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const r=new qr(e,t);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.Vr(new qr(e,t))}mr(e,t){e.forEach(r=>this.removeReference(r,t))}gr(e){const t=new Pe(new Lt([])),r=new qr(t,e),i=new qr(t,e+1),s=[];return this.dr.forEachInRange([r,i],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Pe(new Lt([])),r=new qr(t,e),i=new qr(t,e+1);let s=pt();return this.dr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new qr(e,0),r=this.Tr.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class qr{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Pe.comparator(e.key,t.key)||st(e.wr,t.wr)}static Ar(e,t){return st(e.wr,t.wr)||Pe.comparator(e.key,t.key)}}class $oe{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new dn(qr.Er)}checkEmpty(e){return q.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){const s=this.Sr;this.Sr++;const o=new xD(s,t,r,i);this.mutationQueue.push(o);for(const a of i)this.br=this.br.add(new qr(a.key,s)),this.indexManager.addToCollectionParentIndex(e,a.key.path.popLast());return q.resolve(o)}lookupMutationBatch(e,t){return q.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const i=this.vr(t+1),s=i<0?0:i;return q.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return q.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return q.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new qr(t,0),i=new qr(t,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([r,i],o=>{const a=this.Dr(o.wr);s.push(a)}),q.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new dn(st);return t.forEach(i=>{const s=new qr(i,0),o=new qr(i,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{r=r.add(a.wr)})}),q.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;Pe.isDocumentKey(s)||(s=s.child(""));const o=new qr(new Pe(s),0);let a=new dn(st);return this.br.forEachWhile(l=>{const u=l.key.path;return!!r.isPrefixOf(u)&&(u.length===i&&(a=a.add(l.wr)),!0)},o),q.resolve(this.Cr(a))}Cr(e){const t=[];return e.forEach(r=>{const i=this.Dr(r);null!==i&&t.push(i)}),t}removeMutationBatch(e,t){Ue(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let r=this.br;return q.forEach(t.mutations,i=>{const s=new qr(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,t){const r=new qr(t,0),i=this.br.firstAfterOrEqual(r);return q.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return q.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Hoe{constructor(e){this.Mr=e,this.docs=new Dn(Pe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.Mr(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return q.resolve(r?r.document.mutableCopy():$n.newInvalidDocument(t))}getEntries(e,t){let r=us();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():$n.newInvalidDocument(i))}),q.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=us();const o=t.path,a=new Pe(o.child("")),l=this.docs.getIteratorFrom(a);for(;l.hasNext();){const{key:u,value:{document:d}}=l.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||pD(uj(d),r)<=0||(i.has(d.key)||Lm(t,d))&&(s=s.insert(d.key,d.mutableCopy()))}return q.resolve(s)}getAllFromCollectionGroup(e,t,r,i){Oe()}Or(e,t){return q.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new zoe(this)}getSize(e){return q.resolve(this.size)}}class zoe extends aH{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.cr.addEntry(e,i)):this.cr.removeEntry(r)}),q.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class Woe{constructor(e){this.persistence=e,this.Nr=new qa(t=>Cc(t),Om),this.lastRemoteSnapshotVersion=We.min(),this.highestTargetId=0,this.Lr=0,this.Br=new GD,this.targetCount=0,this.kr=Pc.Bn()}forEachTarget(e,t){return this.Nr.forEach((r,i)=>t(i)),q.resolve()}getLastRemoteSnapshotVersion(e){return q.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return q.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),q.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.Lr&&(this.Lr=t),q.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Pc(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,q.resolve()}updateTargetData(e,t){return this.Kn(t),q.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,q.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),q.waitFor(s).next(()=>i)}getTargetCount(e){return q.resolve(this.targetCount)}getTargetData(e,t){const r=this.Nr.get(t)||null;return q.resolve(r)}addMatchingKeys(e,t,r){return this.Br.Rr(t,r),q.resolve()}removeMatchingKeys(e,t,r){this.Br.mr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),q.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),q.resolve()}getMatchingKeysForTargetId(e,t){const r=this.Br.yr(t);return q.resolve(r)}containsKey(e,t){return q.resolve(this.Br.containsKey(t))}}class qD{constructor(e,t){this.qr={},this.overlays={},this.Qr=new Ds(0),this.Kr=!1,this.Kr=!0,this.$r=new joe,this.referenceDelegate=e(this),this.Ur=new Woe(this),this.indexManager=new xoe,this.remoteDocumentCache=new Hoe(r=>this.referenceDelegate.Wr(r)),this.serializer=new V$(t),this.Gr=new Uoe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Boe,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.qr[e.toKey()];return r||(r=new $oe(t,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,r){fe("MemoryPersistence","Starting transaction:",e);const i=new Goe(this.Qr.next());return this.referenceDelegate.zr(),r(i).next(s=>this.referenceDelegate.jr(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Hr(e,t){return q.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,t)))}}class Goe extends dj{constructor(e){super(),this.currentSequenceNumber=e}}class Ew{constructor(e){this.persistence=e,this.Jr=new GD,this.Yr=null}static Zr(e){return new Ew(e)}get Xr(){if(this.Yr)return this.Yr;throw Oe()}addReference(e,t,r){return this.Jr.addReference(r,t),this.Xr.delete(r.toString()),q.resolve()}removeReference(e,t,r){return this.Jr.removeReference(r,t),this.Xr.add(r.toString()),q.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),q.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach(i=>this.Xr.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.Xr.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return q.forEach(this.Xr,r=>{const i=Pe.fromPath(r);return this.ei(e,i).next(s=>{s||t.removeEntry(i,We.min())})}).next(()=>(this.Yr=null,t.apply(e)))}updateLimboDocument(e,t){return this.ei(e,t).next(r=>{r?this.Xr.delete(t.toString()):this.Xr.add(t.toString())})}Wr(e){return 0}ei(e,t){return q.or([()=>q.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class qoe{constructor(e){this.serializer=e}O(e,t,r,i){const s=new QI("createOrUpgrade",t);var l;r<1&&i>=1&&(e.createObjectStore("owner"),(l=e).createObjectStore("mutationQueues",{keyPath:"userId"}),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",mj,{unique:!0}),l.createObjectStore("documentMutations"),fH(e),function(l){l.createObjectStore("remoteDocuments")}(e));let o=q.resolve();return r<3&&i>=3&&(0!==r&&(function(l){l.deleteObjectStore("targetDocuments"),l.deleteObjectStore("targets"),l.deleteObjectStore("targetGlobal")}(e),fH(e)),o=o.next(()=>function(l){const u=l.store("targetGlobal"),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:We.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",d)}(s))),r<4&&i>=4&&(0!==r&&(o=o.next(()=>function(l,u){return u.store("mutations").U().next(d=>{l.deleteObjectStore("mutations"),l.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",mj,{unique:!0});const p=u.store("mutations"),_=d.map(v=>p.put(v));return q.waitFor(_)})}(e,s))),o=o.next(()=>{!function(l){l.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),r<5&&i>=5&&(o=o.next(()=>this.ni(s))),r<6&&i>=6&&(o=o.next(()=>(function(l){l.createObjectStore("remoteDocumentGlobal")}(e),this.ri(s)))),r<7&&i>=7&&(o=o.next(()=>this.ii(s))),r<8&&i>=8&&(o=o.next(()=>this.si(e,s))),r<9&&i>=9&&(o=o.next(()=>{!function(l){l.objectStoreNames.contains("remoteDocumentChanges")&&l.deleteObjectStore("remoteDocumentChanges")}(e)})),r<10&&i>=10&&(o=o.next(()=>this.oi(s))),r<11&&i>=11&&(o=o.next(()=>{(function(l){l.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(l){l.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),r<12&&i>=12&&(o=o.next(()=>{!function(l){const u=l.createObjectStore("documentOverlays",{keyPath:xse});u.createIndex("collectionPathOverlayIndex",Pse,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",Nse,{unique:!1})}(e)})),r<13&&i>=13&&(o=o.next(()=>function(l){const u=l.createObjectStore("remoteDocumentsV14",{keyPath:vse});u.createIndex("documentKeyIndex",Ese),u.createIndex("collectionGroupIndex",Ise)}(e)).next(()=>this._i(e,s)).next(()=>e.deleteObjectStore("remoteDocuments"))),r<14&&i>=14&&(o=o.next(()=>this.ai(e,s))),r<15&&i>=15&&(o=o.next(()=>function(l){l.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),l.createObjectStore("indexState",{keyPath:bse}).createIndex("sequenceNumberIndex",Sse,{unique:!1}),l.createObjectStore("indexEntries",{keyPath:Dse}).createIndex("documentKeyIndex",Rse,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore("indexState").clear()}).next(()=>{t.objectStore("indexEntries").clear()})),r<17&&i>=17&&(o=o.next(()=>{!function(l){l.createObjectStore("globals",{keyPath:"name"})}(e)})),o}ri(e){let t=0;return e.store("remoteDocuments").J((r,i)=>{t+=_w(i)}).next(()=>{const r={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",r)})}ni(e){const t=e.store("mutationQueues"),r=e.store("mutations");return t.U().next(i=>q.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return r.U("userMutationsIndex",o).next(a=>q.forEach(a,l=>{Ue(l.userId===s.userId);const u=Dc(this.serializer,l);return eH(e,s.userId,u).next(()=>{})}))}))}ii(e){const t=e.store("targetDocuments"),r=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(i=>{const s=[];return r.J((o,a)=>{const l=new Lt(o),u=[0,Ii(l)];s.push(t.get(u).next(d=>d?q.resolve():t.put({targetId:0,path:Ii(l),sequenceNumber:i.highestListenSequenceNumber})))}).next(()=>q.waitFor(s))})}si(e,t){e.createObjectStore("collectionParents",{keyPath:Ase});const r=t.store("collectionParents"),i=new WD,s=o=>{if(i.add(o)){const a=o.lastSegment(),l=o.popLast();return r.put({collectionId:a,parent:Ii(l)})}};return t.store("remoteDocuments").J({H:!0},(o,a)=>{const l=new Lt(o);return s(l.popLast())}).next(()=>t.store("documentMutations").J({H:!0},([o,a,l],u)=>{const d=ea(a);return s(d.popLast())}))}oi(e){const t=e.store("targets");return t.J((r,i)=>{const s=qm(i),o=B$(this.serializer,s);return t.put(o)})}_i(e,t){const r=t.store("remoteDocuments"),i=[];return r.J((s,o)=>{const a=t.store("remoteDocumentsV14"),l=(p=o,p.document?new Pe(Lt.fromString(p.document.name).popFirst(5)):p.noDocument?Pe.fromSegments(p.noDocument.path):p.unknownDocument?Pe.fromSegments(p.unknownDocument.path):Oe()).path.toArray(),u={prefixPath:l.slice(0,l.length-2),collectionGroup:l[l.length-2],documentId:l[l.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};var p;i.push(a.put(u))}).next(()=>q.waitFor(i))}ai(e,t){const r=t.store("mutations"),i=lH(this.serializer),s=new qD(Ew.Zr,this.serializer.ct);return r.U().next(o=>{const a=new Map;return o.forEach(l=>{var u;let d=null!==(u=a.get(l.userId))&&void 0!==u?u:pt();Dc(this.serializer,l).keys().forEach(p=>d=d.add(p)),a.set(l.userId,d)}),q.forEach(a,(l,u)=>{const d=new Wr(u),p=pw.lt(this.serializer,d),_=s.getIndexManager(d),v=yw.lt(d,this.serializer,_,s.referenceDelegate);return new hH(i,v,p,_).recalculateAndSaveOverlaysForDocumentKeys(new yD(t,Ds.oe),l).next()})})}}function fH(n){n.createObjectStore("targetDocuments",{keyPath:Cse}).createIndex("documentTargetsIndex",Tse,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",wse,{unique:!0}),n.createObjectStore("targetGlobal")}const KD="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class QD{constructor(e,t,r,i,s,o,a,l,u,d,p=17){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.ui=s,this.window=o,this.document=a,this.ci=u,this.li=d,this.hi=p,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=_=>Promise.resolve(),!QD.D())throw new ce(te.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ooe(this,i),this.Ai=t+"main",this.serializer=new V$(l),this.Ri=new Zo(this.Ai,this.hi,new qoe(this.serializer)),this.$r=new Toe,this.Ur=new Noe(this.referenceDelegate,this.serializer),this.remoteDocumentCache=lH(this.serializer),this.Gr=new Coe,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,!1===d&&vr("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ce(te.FAILED_PRECONDITION,KD);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Ds(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){var t=this;return this.di=function(){var r=(0,Z.A)(function*(i){if(t.started)return e(i)});return function(i){return r.apply(this,arguments)}}(),e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(function(){var t=(0,Z.A)(function*(r){null===r.newVersion&&(yield e())});return function(r){return t.apply(this,arguments)}}())}setNetworkEnabled(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget((0,Z.A)(function*(){t.started&&(yield t.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>ww(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(t=>{t||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(t=>this.isPrimary&&!t?this.bi(e).next(()=>!1):!!t&&this.Di(e).next(()=>!0))).catch(e=>{if(Vl(e))return fe("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return fe("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return Xm(e).get("owner").next(t=>q.resolve(this.vi(t)))}Ci(e){return ww(e).delete(this.clientId)}Fi(){var e=this;return(0,Z.A)(function*(){if(e.isPrimary&&!e.Mi(e.Ei,18e5)){e.Ei=Date.now();const t=yield e.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",r=>{const i=Or(r,"clientMetadata");return i.U().next(s=>{const o=e.xi(s,18e5),a=s.filter(l=>-1===o.indexOf(l));return q.forEach(a,l=>i.delete(l.clientId)).next(()=>a)})}).catch(()=>[]);if(e.Vi)for(const r of t)e.Vi.removeItem(e.Oi(r.clientId))}})()}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?q.resolve(!0):Xm(e).get("owner").next(t=>{if(null!==t&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new ce(te.FAILED_PRECONDITION,KD);return!1}}return!(!this.networkEnabled||!this.inForeground)||ww(e).U().next(r=>void 0===this.xi(r,5e3).find(i=>!(this.clientId===i.clientId||!(!this.networkEnabled&&i.networkEnabled||!this.inForeground&&i.inForeground&&this.networkEnabled===i.networkEnabled))))}).next(t=>(this.isPrimary!==t&&fe("IndexedDbPersistence",`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}shutdown(){var e=this;return(0,Z.A)(function*(){e.Kr=!1,e.Li(),e.Ti&&(e.Ti.cancel(),e.Ti=null),e.Bi(),e.ki(),yield e.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{const r=new yD(t,Ds.oe);return e.bi(r).next(()=>e.Ci(r))}),e.Ri.close(),e.qi()})()}xi(e,t){return e.filter(r=>this.Mi(r.updateTimeMs,t)&&!this.Ni(r.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>ww(e).U().next(t=>this.xi(t,18e5).map(r=>r.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return yw.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Poe(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return pw.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,r){fe("IndexedDbPersistence","Starting transaction:",e);const i="readonly"===t?"readonly":"readwrite",s=17===(l=this.hi)?Ose:16===l?kse:15===l?_D:14===l?Ej:13===l?vj:12===l?Mse:11===l?yj:void Oe();var l;let o;return this.Ri.runTransaction(e,i,s,a=>(o=new yD(a,this.Qr?this.Qr.next():Ds.oe),"readwrite-primary"===t?this.wi(o).next(l=>!!l||this.Si(o)).next(l=>{if(!l)throw vr(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ce(te.FAILED_PRECONDITION,cj);return r(o)}).next(l=>this.Di(o).next(()=>l)):this.Ki(o).next(()=>r(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(e){return Xm(e).get("owner").next(t=>{if(null!==t&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)&&!this.vi(t)&&!(this.li||this.allowTabSynchronization&&t.allowTabSynchronization))throw new ce(te.FAILED_PRECONDITION,KD)})}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Xm(e).put("owner",t)}static D(){return Zo.D()}bi(e){const t=Xm(e);return t.get("owner").next(r=>this.vi(r)?(fe("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):q.resolve())}Mi(e,t){const r=Date.now();return!(e<r-t||e>r&&(vr(`Detected an update time that is in the future: ${e} > ${r}`),1))}fi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground="visible"===this.document.visibilityState)}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Pi=()=>{this.Li();const t=/(?:Version|Mobile)\/1[456]/;(0,B.nr)()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const r=null!==(null===(t=this.Vi)||void 0===t?void 0:t.getItem(this.Oi(e)));return fe("IndexedDbPersistence",`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return vr("IndexedDbPersistence","Failed to get zombied client id.",r),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){vr("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Xm(n){return Or(n,"owner")}function ww(n){return Or(n,"clientMetadata")}function YD(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}class JD{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.$i=r,this.Ui=i}static Wi(e,t){let r=pt(),i=pt();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new JD(e,t.fromCache,r,i)}}class Koe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class pH{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=(0,B.nr)()?8:hj((0,B.ZQ)())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.Yi(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new Koe;return this.Xi(e,t,o).next(a=>{if(s.result=a,this.zi)return this.es(e,t,o,a.size)})}).next(()=>s.result)}es(e,t,r,i){return r.documentReadCount<this.ji?(Gh()<=Ys.$b.DEBUG&&fe("QueryEngine","SDK will not create cache indexes for query:",tf(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),q.resolve()):(Gh()<=Ys.$b.DEBUG&&fe("QueryEngine","Query:",tf(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.Hi*i?(Gh()<=Ys.$b.DEBUG&&fe("QueryEngine","The SDK decides to create cache indexes for query:",tf(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,wi(t))):q.resolve())}Yi(e,t){if(qj(t))return q.resolve(null);let r=wi(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(t=ow(t,null,"F"),r=wi(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=pt(...s);return this.Ji.getDocuments(e,o).next(a=>this.indexManager.getMinOffset(e,r).next(l=>{const u=this.ts(t,a);return this.ns(t,u,o,l.readTime)?this.Yi(e,ow(t,null,"F")):this.rs(e,u,t,l)}))})))}Zi(e,t,r,i){return qj(t)||i.isEqual(We.min())?q.resolve(null):this.Ji.getDocuments(e,r).next(s=>{const o=this.ts(t,s);return this.ns(t,o,r,i)?q.resolve(null):(Gh()<=Ys.$b.DEBUG&&fe("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),tf(t)),this.rs(e,o,t,lj(i,-1)).next(a=>a))})}ts(e,t){let r=new dn(Xj(e));return t.forEach((i,s)=>{Lm(e,s)&&(r=r.add(s))}),r}ns(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Xi(e,t,r){return Gh()<=Ys.$b.DEBUG&&fe("QueryEngine","Using full collection scan to execute query:",tf(t)),this.Ji.getDocumentsMatchingQuery(e,t,Ss.min(),r)}rs(e,t,r,i){return this.Ji.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}class Qoe{constructor(e,t,r,i){this.persistence=e,this.ss=t,this.serializer=i,this.os=new Dn(st),this._s=new qa(s=>Cc(s),Om),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hH(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.os))}}function gH(n,e,t,r){return new Qoe(n,e,t,r)}function mH(n,e){return XD.apply(this,arguments)}function XD(){return(XD=(0,Z.A)(function*(n,e){const t=De(n);return yield t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],a=[];let l=pt();for(const u of i){o.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}for(const u of s){a.push(u.batchId);for(const d of u.mutations)l=l.add(d.key)}return t.localDocuments.getDocuments(r,l).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:a}))})})})).apply(this,arguments)}function _H(n){const e=De(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ur.getLastRemoteSnapshotVersion(t))}function yH(n,e,t){let r=pt(),i=pt();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=us();return t.forEach((a,l)=>{const u=s.get(a);l.isFoundDocument()!==u.isFoundDocument()&&(i=i.add(a)),l.isNoDocument()&&l.version.isEqual(We.min())?(e.removeEntry(a,l.readTime),o=o.insert(a,l)):!u.isValidDocument()||l.version.compareTo(u.version)>0||0===l.version.compareTo(u.version)&&u.hasPendingWrites?(e.addEntry(l),o=o.insert(a,l)):fe("LocalStore","Ignoring outdated watch update for ",a,". Current version:",u.version," Watch version:",l.version)}),{Ps:o,Is:i}})}function Xoe(n,e){const t=De(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(void 0===e&&(e=-1),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function pf(n,e){const t=De(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ur.getTargetData(r,e).next(s=>s?(i=s,q.resolve(i)):t.Ur.allocateTargetId(r).next(o=>(i=new Qa(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ur.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.os.get(r.targetId);return(null===i||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.os=t.os.insert(r.targetId,r),t._s.set(e,r.targetId)),r})}function gf(n,e,t){return ZD.apply(this,arguments)}function ZD(){return(ZD=(0,Z.A)(function*(n,e,t){const r=De(n),i=r.os.get(e),s=t?"readwrite":"readwrite-primary";try{t||(yield r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i)))}catch(o){if(!Vl(o))throw o;fe("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(i.target)})).apply(this,arguments)}function Cw(n,e,t){const r=De(n);let i=We.min(),s=pt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(l,u,d){const p=De(l),_=p._s.get(d);return void 0!==_?q.resolve(p.os.get(_)):p.Ur.getTargetData(u,d)}(r,o,wi(e)).next(a=>{if(a)return i=a.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,a.targetId).next(l=>{s=l})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,t?i:We.min(),t?s:pt())).next(a=>(IH(r,Jj(e),a),{documents:a,Ts:s})))}function vH(n,e){const t=De(n),r=De(t.Ur),i=t.os.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>r.ot(s,e).next(o=>o?o.target:null))}function EH(n,e){const t=De(n),r=t.us.get(e)||We.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.cs.getAllFromCollectionGroup(i,e,lj(r,-1),Number.MAX_SAFE_INTEGER)).then(i=>(IH(t,e,i),i))}function IH(n,e,t){let r=n.us.get(e)||We.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.us.set(e,r)}function eR(){return(eR=(0,Z.A)(function*(n,e,t,r){const i=De(n);let s=pt(),o=us();for(const u of t){const d=e.Es(u.metadata.name);u.document&&(s=s.add(d));const p=e.ds(u);p.setReadTime(e.As(u.metadata.readTime)),o=o.insert(d,p)}const a=i.cs.newChangeBuffer({trackRemovals:!0}),l=yield pf(i,(d=r,wi(Zh(Lt.fromString(`__bundle__/docs/${d}`)))));var d;return i.persistence.runTransaction("Apply bundle documents","readwrite",u=>yH(u,a,o).next(d=>(a.apply(u),d)).next(d=>i.Ur.removeMatchingKeysForTargetId(u,l.targetId).next(()=>i.Ur.addMatchingKeys(u,s,l.targetId)).next(()=>i.localDocuments.getLocalViewOfDocuments(u,d.Ps,d.Is)).next(()=>d.Ps)))})).apply(this,arguments)}function eae(n,e){return tR.apply(this,arguments)}function tR(){return(tR=(0,Z.A)(function*(n,e,t=pt()){const r=yield pf(n,wi(UD(e.bundledQuery))),i=De(n);return i.persistence.runTransaction("Save named query","readwrite",s=>{const o=Er(e.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Gr.saveNamedQuery(s,e);const a=r.withResumeToken(dr.EMPTY_BYTE_STRING,o);return i.os=i.os.insert(a.targetId,a),i.Ur.updateTargetData(s,a).next(()=>i.Ur.removeMatchingKeysForTargetId(s,r.targetId)).next(()=>i.Ur.addMatchingKeys(s,t,r.targetId)).next(()=>i.Gr.saveNamedQuery(s,e))})})).apply(this,arguments)}function wH(n,e){return`firestore_clients_${n}_${e}`}function CH(n,e,t){let r=`firestore_mutations_${n}_${t}`;return e.isAuthenticated()&&(r+=`_${e.uid}`),r}function nR(n,e){return`firestore_targets_${n}_${e}`}class Tw{constructor(e,t,r,i){this.user=e,this.batchId=t,this.state=r,this.error=i}static Rs(e,t,r){const i=JSON.parse(r);let s,o="object"==typeof i&&-1!==["pending","acknowledged","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code,o&&(s=new ce(i.error.code,i.error.message))),o?new Tw(e,t,i.state,s):(vr("SharedClientState",`Failed to parse mutation state for ID '${t}': ${r}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Zm{constructor(e,t,r){this.targetId=e,this.state=t,this.error=r}static Rs(e,t){const r=JSON.parse(t);let i,s="object"==typeof r&&-1!==["not-current","current","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new ce(r.error.code,r.error.message))),s?new Zm(e,r.state,i):(vr("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Aw{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const r=JSON.parse(t);let i="object"==typeof r&&r.activeTargetIds instanceof Array,s=SD();for(let o=0;i&&o<r.activeTargetIds.length;++o)i=pj(r.activeTargetIds[o]),s=s.add(r.activeTargetIds[o]);return i?new Aw(e,s):(vr("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class rR{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new rR(t.clientId,t.onlineState):(vr("SharedClientState",`Failed to parse online state: ${e}`),null)}}class iR{constructor(){this.activeTargetIds=SD()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class sR{constructor(e,t,r,i,s){this.window=e,this.ui=t,this.persistenceKey=r,this.ps=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Dn(st),this.started=!1,this.bs=[];const o=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=wH(this.persistenceKey,this.ps),this.vs=`firestore_sequence_number_${this.persistenceKey}`,this.Ss=this.Ss.insert(this.ps,new iR),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=`firestore_online_state_${this.persistenceKey}`,this.Os=function(l){return`firestore_bundle_loaded_v2_${l}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}start(){var e=this;return(0,Z.A)(function*(){const t=yield e.syncEngine.Qi();for(const i of t){if(i===e.ps)continue;const s=e.getItem(wH(e.persistenceKey,i));if(s){const o=Aw.Rs(i,s);o&&(e.Ss=e.Ss.insert(o.clientId,o))}}e.Ns();const r=e.storage.getItem(e.xs);if(r){const i=e.Ls(r);i&&e.Bs(i)}for(const i of e.bs)e.ws(i);e.bs=[],e.window.addEventListener("pagehide",()=>e.shutdown()),e.started=!0})()}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach((r,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,r){this.qs(e,t,r),this.Qs(e)}addLocalQueryTarget(e,t=!0){let r="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(nR(this.persistenceKey,e));if(i){const s=Zm.Rs(e,i);s&&(r=s.state)}}return t&&this.Ks.fs(e),this.Ns(),r}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(nR(this.persistenceKey,e))}updateQueryState(e,t,r){this.$s(e,t,r)}handleUserChange(e,t,r){t.forEach(i=>{this.Qs(i)}),this.currentUser=e,r.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return fe("SharedClientState","READ",e,t),t}setItem(e,t){fe("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){fe("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){var t=this;const r=e;if(r.storageArea===this.storage){if(fe("SharedClientState","EVENT",r.key,r.newValue),r.key===this.Ds)return void vr("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable((0,Z.A)(function*(){if(t.started){if(null!==r.key)if(t.Cs.test(r.key)){if(null==r.newValue){const i=t.Gs(r.key);return t.zs(i,null)}{const i=t.js(r.key,r.newValue);if(i)return t.zs(i.clientId,i)}}else if(t.Fs.test(r.key)){if(null!==r.newValue){const i=t.Hs(r.key,r.newValue);if(i)return t.Js(i)}}else if(t.Ms.test(r.key)){if(null!==r.newValue){const i=t.Ys(r.key,r.newValue);if(i)return t.Zs(i)}}else if(r.key===t.xs){if(null!==r.newValue){const i=t.Ls(r.newValue);if(i)return t.Bs(i)}}else if(r.key===t.vs){const i=function(o){let a=Ds.oe;if(null!=o)try{const l=JSON.parse(o);Ue("number"==typeof l),a=l}catch(l){vr("SharedClientState","Failed to read sequence number from WebStorage",l)}return a}(r.newValue);i!==Ds.oe&&t.sequenceNumberHandler(i)}else if(r.key===t.Os){const i=t.Xs(r.newValue);yield Promise.all(i.map(s=>t.syncEngine.eo(s)))}}else t.bs.push(r)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,r){const i=new Tw(this.currentUser,e,t,r),s=CH(this.persistenceKey,this.currentUser,e);this.setItem(s,i.Vs())}Qs(e){const t=CH(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){this.storage.setItem(this.xs,JSON.stringify({clientId:this.ps,onlineState:e}))}$s(e,t,r){const i=nR(this.persistenceKey,e),s=new Zm(e,t,r);this.setItem(i,s.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const r=this.Gs(e);return Aw.Rs(r,t)}Hs(e,t){const r=this.Fs.exec(e),i=Number(r[1]);return Tw.Rs(new Wr(void 0!==r[2]?r[2]:null),i,t)}Ys(e,t){const r=this.Ms.exec(e),i=Number(r[1]);return Zm.Rs(i,t)}Ls(e){return rR.Rs(e)}Xs(e){return JSON.parse(e)}Js(e){var t=this;return(0,Z.A)(function*(){if(e.user.uid===t.currentUser.uid)return t.syncEngine.no(e.batchId,e.state,e.error);fe("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)})()}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const r=t?this.Ss.insert(e,t):this.Ss.remove(e),i=this.ks(this.Ss),s=this.ks(r),o=[],a=[];return s.forEach(l=>{i.has(l)||o.push(l)}),i.forEach(l=>{s.has(l)||a.push(l)}),this.syncEngine.io(o,a).then(()=>{this.Ss=r})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=SD();return e.forEach((r,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class TH{constructor(){this.so=new iR,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,r){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new iR,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class tae{_o(e){}shutdown(){}}class AH{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){fe("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){fe("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let bw=null;function oR(){return null===bw?bw=268435456+Math.round(2147483648*Math.random()):bw++,"0x"+bw.toString(16)}const nae={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class rae{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Ti="WebChannelConnection";class iae extends class{constructor(t){this.databaseInfo=t,this.databaseId=t.databaseId;const r=t.ssl?"https":"http",i=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+t.host,this.vo=`projects/${i}/databases/${s}`,this.Co="(default)"===this.databaseId.database?`project_id=${i}`:`project_id=${i}&database_id=${s}`}get Fo(){return!1}Mo(t,r,i,s,o){const a=oR(),l=this.xo(t,r.toUriEncodedString());fe("RestConnection",`Sending RPC '${t}' ${a}:`,l,i);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,s,o),this.No(t,l,u,i).then(d=>(fe("RestConnection",`Received RPC '${t}' ${a}: `,d),d),d=>{throw bs("RestConnection",`RPC '${t}' ${a} failed with error: `,d,"url: ",l,"request:",i),d})}Lo(t,r,i,s,o,a){return this.Mo(t,r,i,s,o)}Oo(t,r,i){t["X-Goog-Api-Client"]="gl-js/ fire/"+Wh,t["Content-Type"]="text/plain",this.databaseInfo.appId&&(t["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((s,o)=>t[o]=s),i&&i.headers.forEach((s,o)=>t[o]=s)}xo(t,r){return`${this.Do}/v1/${r}:${nae[t]}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,r,i){const s=oR();return new Promise((o,a)=>{const l=new XB;l.setWithCredentials(!0),l.listenOnce(ZB.COMPLETE,()=>{try{switch(l.getLastErrorCode()){case KI.NO_ERROR:const d=l.getResponseJson();fe(Ti,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(d)),o(d);break;case KI.TIMEOUT:fe(Ti,`RPC '${e}' ${s} timed out`),a(new ce(te.DEADLINE_EXCEEDED,"Request time out"));break;case KI.HTTP_ERROR:const p=l.getStatus();if(fe(Ti,`RPC '${e}' ${s} failed with status:`,p,"response text:",l.getResponseText()),p>0){let _=l.getResponseJson();Array.isArray(_)&&(_=_[0]);const v=_?.error;if(v&&v.status&&v.message){const A=function(P){const H=P.toLowerCase().replace(/_/g,"-");return Object.values(te).indexOf(H)>=0?H:te.UNKNOWN}(v.status);a(new ce(A,v.message))}else a(new ce(te.UNKNOWN,"Server responded with status "+l.getStatus()))}else a(new ce(te.UNAVAILABLE,"Connection failed."));break;default:Oe()}}finally{fe(Ti,`RPC '${e}' ${s} completed.`)}});const u=JSON.stringify(i);fe(Ti,`RPC '${e}' ${s} sending request:`,i),l.send(t,"POST",u,r,15)})}Bo(e,t,r){const i=oR(),s=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=nj(),a=tj(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;void 0!==u&&(l.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(l.useFetchStreams=!0),this.Oo(l.initMessageHeaders,t,r),l.encodeInitMessageHeaders=!0;const d=s.join("");fe(Ti,`Creating RPC '${e}' stream ${i}: ${d}`,l);const p=o.createWebChannel(d,l);let _=!1,v=!1;const A=new rae({Io:P=>{v?fe(Ti,`Not sending because RPC '${e}' stream ${i} is closed:`,P):(_||(fe(Ti,`Opening RPC '${e}' stream ${i} transport.`),p.open(),_=!0),fe(Ti,`RPC '${e}' stream ${i} sending:`,P),p.send(P))},To:()=>p.close()}),D=(P,H,V)=>{P.listen(H,Y=>{try{V(Y)}catch(ae){setTimeout(()=>{throw ae},0)}})};return D(p,Am.EventType.OPEN,()=>{v||(fe(Ti,`RPC '${e}' stream ${i} transport opened.`),A.yo())}),D(p,Am.EventType.CLOSE,()=>{v||(v=!0,fe(Ti,`RPC '${e}' stream ${i} transport closed`),A.So())}),D(p,Am.EventType.ERROR,P=>{v||(v=!0,bs(Ti,`RPC '${e}' stream ${i} transport errored:`,P),A.So(new ce(te.UNAVAILABLE,"The operation could not be completed")))}),D(p,Am.EventType.MESSAGE,P=>{var H;if(!v){const V=P.data[0];Ue(!!V);const ae=V.error||(null===(H=V[0])||void 0===H?void 0:H.error);if(ae){fe(Ti,`RPC '${e}' stream ${i} received error:`,ae);const Te=ae.status;let $e=function(F){const j=br[F];if(void 0!==j)return m$(j)}(Te),U=ae.message;void 0===$e&&($e=te.INTERNAL,U="Unknown error status: "+Te+" with message "+ae.message),v=!0,A.So(new ce($e,U)),p.close()}else fe(Ti,`RPC '${e}' stream ${i} received:`,V),A.bo(V)}}),D(a,ej.STAT_EVENT,P=>{P.stat===dD.PROXY?fe(Ti,`RPC '${e}' stream ${i} detected buffering proxy`):P.stat===dD.NOPROXY&&fe(Ti,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{A.wo()},0),A}}function bH(){return typeof window<"u"?window:null}function Sw(){return typeof document<"u"?document:null}function e_(n){return new hoe(n,!0)}class aR{constructor(e,t,r=1e3,i=1.5,s=6e4){this.ui=e,this.timerId=t,this.ko=r,this.qo=i,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),i=Math.max(0,t-r);i>0&&fe("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,i,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class SH{constructor(e,t,r,i,s,o,a,l){this.ui=e,this.Ho=r,this.Jo=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=l,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new aR(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}stop(){var e=this;return(0,Z.A)(function*(){e.n_()&&(yield e.close(0))})()}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}__(){var e=this;return(0,Z.A)(function*(){if(e.r_())return e.close(0)})()}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(e,t){var r=this;return(0,Z.A)(function*(){r.u_(),r.c_(),r.t_.cancel(),r.Yo++,4!==e?r.t_.reset():t&&t.code===te.RESOURCE_EXHAUSTED?(vr(t.toString()),vr("Using maximum backoff delay to prevent overloading the backend."),r.t_.Wo()):t&&t.code===te.UNAUTHENTICATED&&3!==r.state&&(r.authCredentialsProvider.invalidateToken(),r.appCheckCredentialsProvider.invalidateToken()),null!==r.stream&&(r.l_(),r.stream.close(),r.stream=null),r.state=e,yield r.listener.mo(t)})()}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.Yo===t&&this.P_(r,i)},r=>{e(()=>{const i=new ce(te.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(i)})})}P_(e,t){const r=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(i=>{r(()=>this.I_(i))}),this.stream.onMessage(i=>{r(()=>1==++this.e_?this.E_(i):this.onNext(i))})}i_(){var e=this;this.state=5,this.t_.Go((0,Z.A)(function*(){e.state=0,e.start()}))}I_(e){return fe("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget(()=>this.Yo===e?t():(fe("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class sae extends SH{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function goe(n,e){let t;if("targetChange"in e){const r="NO_CHANGE"===(u=e.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===u?1:"REMOVE"===u?2:"CURRENT"===u?3:"RESET"===u?4:Oe(),i=e.targetChange.targetIds||[],s=function(u,d){return u.useProto3Json?(Ue(void 0===d||"string"==typeof d),dr.fromBase64String(d||"")):(Ue(void 0===d||d instanceof Buffer||d instanceof Uint8Array),dr.fromUint8Array(d||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,a=o&&function(u){const d=void 0===u.code?te.UNKNOWN:m$(u.code);return new ce(d,u.message||"")}(o);t=new I$(r,i,s,a||null)}else if("documentChange"in e){const r=e.documentChange,i=ra(n,r.document.name),s=Er(r.document.updateTime),o=r.document.createTime?Er(r.document.createTime):We.min(),a=new li({mapValue:{fields:r.document.fields}}),l=$n.newFoundDocument(i,s,o,a);t=new dw(r.targetIds||[],r.removedTargetIds||[],l.key,l)}else if("documentDelete"in e){const r=e.documentDelete,i=ra(n,r.document),s=r.readTime?Er(r.readTime):We.min(),o=$n.newNoDocument(i,s);t=new dw([],r.removedTargetIds||[],o.key,o)}else if("documentRemove"in e){const r=e.documentRemove,i=ra(n,r.document);t=new dw([],r.removedTargetIds||[],i,null)}else{if(!("filter"in e))return Oe();{const r=e.filter,{count:i=0,unchangedNames:s}=r,o=new ooe(i,s);t=new E$(r.targetId,o)}}var u;return t}(this.serializer,e),r=function(s){if(!("targetChange"in s))return We.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?We.min():o.readTime?Er(o.readTime):We.min()}(e);return this.listener.d_(t,r)}A_(e){const t={};t.database=LD(this.serializer),t.addTarget=function(s,o){let a;const l=o.target;if(a=iw(l)?{documents:N$(s,l)}:{query:hw(s,l)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=A$(s,o.resumeToken);const u=kD(s,o.expectedCount);null!==u&&(a.expectedCount=u)}else if(o.snapshotVersion.compareTo(We.min())>0){a.readTime=lf(s,o.snapshotVersion.toTimestamp());const u=kD(s,o.expectedCount);null!==u&&(a.expectedCount=u)}return a}(this.serializer,e);const r=function _oe(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Oe()}}(e.purpose);return null==t?null:{"goog-listen-tags":t}}(0,e);r&&(t.labels=r),this.a_(t)}R_(e){const t={};t.database=LD(this.serializer),t.removeTarget=e,this.a_(t)}}class oae extends SH{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return Ue(!!e.streamToken),this.lastStreamToken=e.streamToken,Ue(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){Ue(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function moe(n,e){return n&&n.length>0?(Ue(void 0!==e),n.map(t=>function(i,s){let o=Er(i.updateTime?i.updateTime:s);return o.isEqual(We.min())&&(o=Er(s)),new roe(o,i.transformResults||[])}(t,e))):[]}(e.writeResults,e.commitTime),r=Er(e.commitTime);return this.listener.g_(r,t)}p_(){const e={};e.database=LD(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Gm(this.serializer,r))};this.a_(t)}}class aae extends class{}{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.y_=!1}w_(){if(this.y_)throw new ce(te.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(e,FD(t,r),i,s,o)).catch(s=>{throw"FirebaseError"===s.name?(s.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new ce(te.UNKNOWN,s.toString())})}Lo(e,t,r,i,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(e,FD(t,r),i,o,a,s)).catch(o=>{throw"FirebaseError"===o.name?(o.code===te.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ce(te.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class lae{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(vr(t),this.D_=!1):fe("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class uae{constructor(e,t,r,i,s){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(a=>{r.enqueueAndForget((0,Z.A)(function*(){var l;Ql(o)&&(fe("RemoteStore","Restarting streams for network reachability change."),yield(l=(0,Z.A)(function*(d){const p=De(d);p.L_.add(4),yield mf(p),p.q_.set("Unknown"),p.L_.delete(4),yield t_(p)}),function u(d){return l.apply(this,arguments)})(o))}))}),this.q_=new lae(r,i)}}function t_(n){return lR.apply(this,arguments)}function lR(){return(lR=(0,Z.A)(function*(n){if(Ql(n))for(const e of n.B_)yield e(!0)})).apply(this,arguments)}function mf(n){return uR.apply(this,arguments)}function uR(){return(uR=(0,Z.A)(function*(n){for(const e of n.B_)yield e(!1)})).apply(this,arguments)}function Dw(n,e){const t=De(n);t.N_.has(e.targetId)||(t.N_.set(e.targetId,e),hR(t)?dR(t):vf(t).r_()&&cR(t,e))}function _f(n,e){const t=De(n),r=vf(t);t.N_.delete(e),r.r_()&&DH(t,e),0===t.N_.size&&(r.r_()?r.o_():Ql(t)&&t.q_.set("Unknown"))}function cR(n,e){if(n.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(We.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}vf(n).A_(e)}function DH(n,e){n.Q_.xe(e),vf(n).R_(e)}function dR(n){n.Q_=new loe({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>n.N_.get(e)||null,tt:()=>n.datastore.serializer.databaseId}),vf(n).start(),n.q_.v_()}function hR(n){return Ql(n)&&!vf(n).n_()&&n.N_.size>0}function Ql(n){return 0===De(n).L_.size}function RH(n){n.Q_=void 0}function cae(n){return fR.apply(this,arguments)}function fR(){return(fR=(0,Z.A)(function*(n){n.q_.set("Online")})).apply(this,arguments)}function dae(n){return pR.apply(this,arguments)}function pR(){return(pR=(0,Z.A)(function*(n){n.N_.forEach((e,t)=>{cR(n,e)})})).apply(this,arguments)}function hae(n,e){return gR.apply(this,arguments)}function gR(){return(gR=(0,Z.A)(function*(n,e){RH(n),hR(n)?(n.q_.M_(e),dR(n)):n.q_.set("Unknown")})).apply(this,arguments)}function fae(n,e,t){return mR.apply(this,arguments)}function mR(){return mR=(0,Z.A)(function*(n,e,t){if(n.q_.set("Online"),e instanceof I$&&2===e.state&&e.cause)try{yield(r=(0,Z.A)(function*(s,o){const a=o.cause;for(const l of o.targetIds)s.N_.has(l)&&(yield s.remoteSyncer.rejectListen(l,a),s.N_.delete(l),s.Q_.removeTarget(l))}),function i(s,o){return r.apply(this,arguments)})(n,e)}catch(r){fe("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),yield Rw(n,r)}else if(e instanceof dw?n.Q_.Ke(e):e instanceof E$?n.Q_.He(e):n.Q_.We(e),!t.isEqual(We.min()))try{const r=yield _H(n.localStore);t.compareTo(r)>=0&&(yield function(s,o){const a=s.Q_.rt(o);return a.targetChanges.forEach((l,u)=>{if(l.resumeToken.approximateByteSize()>0){const d=s.N_.get(u);d&&s.N_.set(u,d.withResumeToken(l.resumeToken,o))}}),a.targetMismatches.forEach((l,u)=>{const d=s.N_.get(l);if(!d)return;s.N_.set(l,d.withResumeToken(dr.EMPTY_BYTE_STRING,d.snapshotVersion)),DH(s,l);const p=new Qa(d.target,l,u,d.sequenceNumber);cR(s,p)}),s.remoteSyncer.applyRemoteEvent(a)}(n,t))}catch(r){fe("RemoteStore","Failed to raise snapshot:",r),yield Rw(n,r)}var r}),mR.apply(this,arguments)}function Rw(n,e,t){return _R.apply(this,arguments)}function _R(){return(_R=(0,Z.A)(function*(n,e,t){if(!Vl(e))throw e;n.L_.add(1),yield mf(n),n.q_.set("Offline"),t||(t=()=>_H(n.localStore)),n.asyncQueue.enqueueRetryable((0,Z.A)(function*(){fe("RemoteStore","Retrying IndexedDB access"),yield t(),n.L_.delete(1),yield t_(n)}))})).apply(this,arguments)}function xH(n,e){return e().catch(t=>Rw(n,t,e))}function yf(n){return yR.apply(this,arguments)}function yR(){return(yR=(0,Z.A)(function*(n){const e=De(n),t=Yl(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;pae(e);)try{const i=yield Xoe(e.localStore,r);if(null===i){0===e.O_.length&&t.o_();break}r=i.batchId,gae(e,i)}catch(i){yield Rw(e,i)}PH(e)&&NH(e)})).apply(this,arguments)}function pae(n){return Ql(n)&&n.O_.length<10}function gae(n,e){n.O_.push(e);const t=Yl(n);t.r_()&&t.V_&&t.m_(e.mutations)}function PH(n){return Ql(n)&&!Yl(n).n_()&&n.O_.length>0}function NH(n){Yl(n).start()}function mae(n){return vR.apply(this,arguments)}function vR(){return(vR=(0,Z.A)(function*(n){Yl(n).p_()})).apply(this,arguments)}function _ae(n){return ER.apply(this,arguments)}function ER(){return(ER=(0,Z.A)(function*(n){const e=Yl(n);for(const t of n.O_)e.m_(t.mutations)})).apply(this,arguments)}function yae(n,e,t){return IR.apply(this,arguments)}function IR(){return(IR=(0,Z.A)(function*(n,e,t){const r=n.O_.shift(),i=PD.from(r,e,t);yield xH(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),yield yf(n)})).apply(this,arguments)}function vae(n,e){return wR.apply(this,arguments)}function wR(){return wR=(0,Z.A)(function*(n,e){var t;e&&Yl(n).V_&&(yield(t=(0,Z.A)(function*(i,s){if(g$(a=s.code)&&a!==te.ABORTED){const o=i.O_.shift();Yl(i).s_(),yield xH(i,()=>i.remoteSyncer.rejectFailedWrite(o.batchId,s)),yield yf(i)}var a}),function r(i,s){return t.apply(this,arguments)})(n,e)),PH(n)&&NH(n)}),wR.apply(this,arguments)}function MH(n,e){return CR.apply(this,arguments)}function CR(){return(CR=(0,Z.A)(function*(n,e){const t=De(n);t.asyncQueue.verifyOperationInProgress(),fe("RemoteStore","RemoteStore received new credentials");const r=Ql(t);t.L_.add(3),yield mf(t),r&&t.q_.set("Unknown"),yield t.remoteSyncer.handleCredentialChange(e),t.L_.delete(3),yield t_(t)})).apply(this,arguments)}function TR(n,e){return AR.apply(this,arguments)}function AR(){return(AR=(0,Z.A)(function*(n,e){const t=De(n);e?(t.L_.delete(2),yield t_(t)):e||(t.L_.add(2),yield mf(t),t.q_.set("Unknown"))})).apply(this,arguments)}function vf(n){return n.K_||(n.K_=function(t,r,i){const s=De(t);return s.w_(),new sae(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:cae.bind(null,n),Ro:dae.bind(null,n),mo:hae.bind(null,n),d_:fae.bind(null,n)}),n.B_.push(function(){var e=(0,Z.A)(function*(t){t?(n.K_.s_(),hR(n)?dR(n):n.q_.set("Unknown")):(yield n.K_.stop(),RH(n))});return function(t){return e.apply(this,arguments)}}())),n.K_}function Yl(n){return n.U_||(n.U_=function(t,r,i){const s=De(t);return s.w_(),new oae(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:mae.bind(null,n),mo:vae.bind(null,n),f_:_ae.bind(null,n),g_:yae.bind(null,n)}),n.B_.push(function(){var e=(0,Z.A)(function*(t){t?(n.U_.s_(),yield yf(n)):(yield n.U_.stop(),n.O_.length>0&&(fe("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))});return function(t){return e.apply(this,arguments)}}())),n.U_}class bR{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new Gr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,a=new bR(e,t,o,i,s);return a.start(r),a}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ce(te.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ef(n,e){if(vr("AsyncQueue",`${e}: ${n}`),Vl(n))return new ce(te.UNAVAILABLE,`${e}: ${n}`);throw n}class If{constructor(e){this.comparator=e?(t,r)=>e(t,r)||Pe.comparator(t.key,r.key):(t,r)=>Pe.comparator(t.key,r.key),this.keyedMap=Vm(),this.sortedSet=new Dn(this.comparator)}static emptySet(e){return new If(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof If)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const r=new If;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}class kH{constructor(){this.W_=new Dn(Pe.comparator)}track(e){const t=e.doc.key,r=this.W_.get(t);r?0!==e.type&&3===r.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==r.type?this.W_=this.W_.insert(t,{type:r.type,doc:e.doc}):2===e.type&&2===r.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===r.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===r.type?this.W_=this.W_.remove(t):1===e.type&&2===r.type?this.W_=this.W_.insert(t,{type:1,doc:r.doc}):0===e.type&&1===r.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):Oe():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal((t,r)=>{e.push(r)}),e}}class wf{constructor(e,t,r,i,s,o,a,l,u){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=l,this.hasCachedResults=u}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(a=>{o.push({type:0,doc:a})}),new wf(e,t,If.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}class Eae{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class Iae{constructor(){this.queries=OH(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(t,r){const i=De(t),s=i.queries;i.queries=OH(),s.forEach((o,a)=>{for(const l of a.j_)l.onError(r)})}(this,new ce(te.ABORTED,"Firestore shutting down"))}}function OH(){return new qa(n=>Yj(n),Fm)}function SR(n,e){return DR.apply(this,arguments)}function DR(){return(DR=(0,Z.A)(function*(n,e){const t=De(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.H_()&&e.J_()&&(r=2):(s=new Eae,r=e.J_()?0:1);try{switch(r){case 0:s.z_=yield t.onListen(i,!0);break;case 1:s.z_=yield t.onListen(i,!1);break;case 2:yield t.onFirstRemoteStoreListen(i)}}catch(o){const a=Ef(o,`Initialization of query '${tf(e.query)}' failed`);return void e.onError(a)}t.queries.set(i,s),s.j_.push(e),e.Z_(t.onlineState),s.z_&&e.X_(s.z_)&&PR(t)})).apply(this,arguments)}function RR(n,e){return xR.apply(this,arguments)}function xR(){return(xR=(0,Z.A)(function*(n,e){const t=De(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.j_.indexOf(e);o>=0&&(s.j_.splice(o,1),0===s.j_.length?i=e.J_()?0:1:!s.H_()&&e.J_()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}})).apply(this,arguments)}function wae(n,e){const t=De(n);let r=!1;for(const i of e){const o=t.queries.get(i.query);if(o){for(const a of o.j_)a.X_(i)&&(r=!0);o.z_=i}}r&&PR(t)}function Cae(n,e,t){const r=De(n),i=r.queries.get(e);if(i)for(const s of i.j_)s.onError(t);r.queries.delete(e)}function PR(n){n.Y_.forEach(e=>{e.next()})}var NR,FH;(FH=NR||(NR={})).ea="default",FH.Cache="cache";class MR{constructor(e,t,r){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)3!==i.type&&r.push(i);e=new wf(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){return!e.fromCache||!this.J_()||(!this.options._a||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){return e.docChanges.length>0||!!(e.syncStateChanged||this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites)&&!0===this.options.includeMetadataChanges}oa(e){e=wf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==NR.Cache}}class Tae{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}class LH{constructor(e){this.serializer=e}Es(e){return ra(this.serializer,e)}ds(e){return e.metadata.exists?P$(this.serializer,e.document,!1):$n.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Er(e)}}class Aae{constructor(e,t,r){this.ca=e,this.localStore=t,this.serializer=r,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=VH(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const r=Lt.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(r.get(r.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,r=new LH(this.serializer);for(const i of e)if(i.metadata.queries){const s=r.Es(i.metadata.name);for(const o of i.metadata.queries){const a=(t.get(o)||pt()).add(s);t.set(o,a)}}return t}complete(){var e=this;return(0,Z.A)(function*(){const t=yield function Zoe(n,e,t,r){return eR.apply(this,arguments)}(e.localStore,new LH(e.serializer),e.documents,e.ca.id),r=e.ha(e.documents);for(const i of e.queries)yield eae(e.localStore,i,r.get(i.name));return e.progress.taskState="Success",{progress:e.progress,Pa:e.collectionGroups,Ia:t}})()}}function VH(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}class UH{constructor(e){this.key=e}}class BH{constructor(e){this.key=e}}class jH{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=pt(),this.mutatedKeys=pt(),this.Aa=Xj(e),this.Ra=new If(this.Aa)}get Va(){return this.Ta}ma(e,t){const r=t?t.fa:new kH,i=t?t.Ra:this.Ra;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,a=!1;const l="F"===this.query.limitType&&i.size===this.query.limit?i.last():null,u="L"===this.query.limitType&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((d,p)=>{const _=i.get(d),v=Lm(this.query,p)?p:null,A=!!_&&this.mutatedKeys.has(_.key),D=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let P=!1;_&&v?_.data.isEqual(v.data)?A!==D&&(r.track({type:3,doc:v}),P=!0):this.ga(_,v)||(r.track({type:2,doc:v}),P=!0,(l&&this.Aa(v,l)>0||u&&this.Aa(v,u)<0)&&(a=!0)):!_&&v?(r.track({type:0,doc:v}),P=!0):_&&!v&&(r.track({type:1,doc:_}),P=!0,(l||u)&&(a=!0)),P&&(v?(o=o.add(v),s=D?s.add(d):s.delete(d)):(o=o.delete(d),s=s.delete(d)))}),null!==this.query.limit)for(;o.size>this.query.limit;){const d="F"===this.query.limitType?o.last():o.first();o=o.delete(d.key),s=s.delete(d.key),r.track({type:1,doc:d})}return{Ra:o,fa:r,ns:a,mutatedKeys:s}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((d,p)=>function(v,A){const D=P=>{switch(P){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Oe()}};return D(v)-D(A)}(d.type,p.type)||this.Aa(d.doc,p.doc)),this.pa(r),i=null!=i&&i;const a=t&&!i?this.ya():[],l=0===this.da.size&&this.current&&!i?1:0,u=l!==this.Ea;return this.Ea=l,0!==o.length||u?{snapshot:new wf(this.query,e.Ra,s,o,e.mutatedKeys,0===l,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new kH,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(t=>this.Ta=this.Ta.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ta=this.Ta.delete(t)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=pt(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const t=[];return e.forEach(r=>{this.da.has(r)||t.push(new BH(r))}),this.da.forEach(r=>{e.has(r)||t.push(new UH(r))}),t}ba(e){this.Ta=e.Ts,this.da=pt();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return wf.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class bae{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class Sae{constructor(e){this.key=e,this.va=!1}}class Dae{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new qa(a=>Yj(a),Fm),this.Ma=new Map,this.xa=new Set,this.Oa=new Dn(Pe.comparator),this.Na=new Map,this.La=new GD,this.Ba={},this.ka=new Map,this.qa=Pc.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}function Rae(n,e){return kR.apply(this,arguments)}function kR(){return(kR=(0,Z.A)(function*(n,e,t=!0){const r=xw(n);let i;const s=r.Fa.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=yield $H(r,e,t,!0),i})).apply(this,arguments)}function xae(n,e){return OR.apply(this,arguments)}function OR(){return(OR=(0,Z.A)(function*(n,e){const t=xw(n);yield $H(t,e,!0,!1)})).apply(this,arguments)}function $H(n,e,t,r){return FR.apply(this,arguments)}function FR(){return(FR=(0,Z.A)(function*(n,e,t,r){const i=yield pf(n.localStore,wi(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let a;return r&&(a=yield LR(n,e,s,"current"===o,i.resumeToken)),n.isPrimaryClient&&t&&Dw(n.remoteStore,i),a})).apply(this,arguments)}function LR(n,e,t,r,i){return VR.apply(this,arguments)}function VR(){return VR=(0,Z.A)(function*(n,e,t,r,i){n.Ka=(p,_,v)=>{return(A=(0,Z.A)(function*(P,H,V,Y){let ae=H.view.ma(V);ae.ns&&(ae=yield Cw(P.localStore,H.query,!1).then(({documents:M})=>H.view.ma(M,ae)));const Te=Y&&Y.targetChanges.get(H.targetId),$e=Y&&null!=Y.targetMismatches.get(H.targetId),U=H.view.applyChanges(ae,P.isPrimaryClient,Te,$e);return QR(P,H.targetId,U.wa),U.snapshot}),function D(P,H,V,Y){return A.apply(this,arguments)})(n,p,_,v);var A};const s=yield Cw(n.localStore,e,!0),o=new jH(e,s.Ts),a=o.ma(s.documents),l=zm.createSynthesizedTargetChangeForCurrentChange(t,r&&"Offline"!==n.onlineState,i),u=o.applyChanges(a,n.isPrimaryClient,l);QR(n,t,u.wa);const d=new bae(e,t,o);return n.Fa.set(e,d),n.Ma.has(t)?n.Ma.get(t).push(e):n.Ma.set(t,[e]),u.snapshot}),VR.apply(this,arguments)}function Pae(n,e,t){return UR.apply(this,arguments)}function UR(){return(UR=(0,Z.A)(function*(n,e,t){const r=De(n),i=r.Fa.get(e),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter(o=>!Fm(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||(yield gf(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&_f(r.remoteStore,i.targetId),Cf(r,i.targetId)}).catch(Ll))):(Cf(r,i.targetId),yield gf(r.localStore,i.targetId,!0))})).apply(this,arguments)}function Nae(n,e){return BR.apply(this,arguments)}function BR(){return(BR=(0,Z.A)(function*(n,e){const t=De(n),r=t.Fa.get(e),i=t.Ma.get(r.targetId);t.isPrimaryClient&&1===i.length&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),_f(t.remoteStore,r.targetId))})).apply(this,arguments)}function jR(){return(jR=(0,Z.A)(function*(n,e,t){const r=ox(n);try{const i=yield function(o,a){const l=De(o),u=Qn.now(),d=a.reduce((v,A)=>v.add(A.key),pt());let p,_;return l.persistence.runTransaction("Locally write mutations","readwrite",v=>{let A=us(),D=pt();return l.cs.getEntries(v,d).next(P=>{A=P,A.forEach((H,V)=>{V.isValidDocument()||(D=D.add(H))})}).next(()=>l.localDocuments.getOverlayedDocuments(v,A)).next(P=>{p=P;const H=[];for(const V of a){const Y=soe(V,p.get(V.key).overlayedDocument);null!=Y&&H.push(new Ka(V.key,Y,kj(Y.value.mapValue),Jn.exists(!0)))}return l.mutationQueue.addMutationBatch(v,u,H,a)}).next(P=>{_=P;const H=P.applyToLocalDocumentSet(p,D);return l.documentOverlayCache.saveOverlays(v,P.batchId,H)})}).then(()=>({batchId:_.batchId,changes:e$(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,a,l){let u=o.Ba[o.currentUser.toKey()];u||(u=new Dn(st)),u=u.insert(a,l),o.Ba[o.currentUser.toKey()]=u}(r,i.batchId,t),yield Ya(r,i.changes),yield yf(r.remoteStore)}catch(i){const s=Ef(i,"Failed to persist write");t.reject(s)}})).apply(this,arguments)}function HH(n,e){return $R.apply(this,arguments)}function $R(){return($R=(0,Z.A)(function*(n,e){const t=De(n);try{const r=yield function Joe(n,e){const t=De(n),r=e.snapshotVersion;let i=t.os;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.cs.newChangeBuffer({trackRemovals:!0});i=t.os;const a=[];e.targetChanges.forEach((d,p)=>{const _=i.get(p);if(!_)return;a.push(t.Ur.removeMatchingKeys(s,d.removedDocuments,p).next(()=>t.Ur.addMatchingKeys(s,d.addedDocuments,p)));let v=_.withSequenceNumber(s.currentSequenceNumber);var D,P,H;null!==e.targetMismatches.get(p)?v=v.withResumeToken(dr.EMPTY_BYTE_STRING,We.min()).withLastLimboFreeSnapshotVersion(We.min()):d.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(d.resumeToken,r)),i=i.insert(p,v),P=v,H=d,(0===(D=_).resumeToken.approximateByteSize()||P.snapshotVersion.toMicroseconds()-D.snapshotVersion.toMicroseconds()>=3e8||H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0)&&a.push(t.Ur.updateTargetData(s,v))});let l=us(),u=pt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&a.push(t.persistence.referenceDelegate.updateLimboDocument(s,d))}),a.push(yH(s,o,e.documentUpdates).next(d=>{l=d.Ps,u=d.Is})),!r.isEqual(We.min())){const d=t.Ur.getLastRemoteSnapshotVersion(s).next(p=>t.Ur.setTargetsMetadata(s,s.currentSequenceNumber,r));a.push(d)}return q.waitFor(a).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,l,u)).next(()=>l)}).then(s=>(t.os=i,s))}(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Na.get(s);o&&(Ue(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1),i.addedDocuments.size>0?o.va=!0:i.modifiedDocuments.size>0?Ue(o.va):i.removedDocuments.size>0&&(Ue(o.va),o.va=!1))}),yield Ya(t,r,e)}catch(r){yield Ll(r)}})).apply(this,arguments)}function zH(n,e,t){const r=De(n);if(r.isPrimaryClient&&0===t||!r.isPrimaryClient&&1===t){const i=[];r.Fa.forEach((s,o)=>{const a=o.view.Z_(e);a.snapshot&&i.push(a.snapshot)}),function(o,a){const l=De(o);l.onlineState=a;let u=!1;l.queries.forEach((d,p)=>{for(const _ of p.j_)_.Z_(a)&&(u=!0)}),u&&PR(l)}(r.eventManager,e),i.length&&r.Ca.d_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function kae(n,e,t){return HR.apply(this,arguments)}function HR(){return(HR=(0,Z.A)(function*(n,e,t){const r=De(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Na.get(e),s=i&&i.key;if(s){let o=new Dn(Pe.comparator);o=o.insert(s,$n.newNoDocument(s,We.min()));const a=pt().add(s),l=new Hm(We.min(),new Map,new Dn(st),o,a);yield HH(r,l),r.Oa=r.Oa.remove(s),r.Na.delete(e),YR(r)}else yield gf(r.localStore,e,!1).then(()=>Cf(r,e,t)).catch(Ll)})).apply(this,arguments)}function Oae(n,e){return zR.apply(this,arguments)}function zR(){return(zR=(0,Z.A)(function*(n,e){const t=De(n),r=e.batch.batchId;try{const i=yield function Yoe(n,e){const t=De(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.cs.newChangeBuffer({trackRemovals:!0});return function(a,l,u,d){const p=u.batch,_=p.keys();let v=q.resolve();return _.forEach(A=>{v=v.next(()=>d.getEntry(l,A)).next(D=>{const P=u.docVersions.get(A);Ue(null!==P),D.version.compareTo(P)<0&&(p.applyToRemoteDocument(D,u),D.isValidDocument()&&(D.setReadTime(u.commitVersion),d.addEntry(D)))})}),v.next(()=>a.mutationQueue.removeMutationBatch(l,p))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(a){let l=pt();for(let u=0;u<a.mutationResults.length;++u)a.mutationResults[u].transformResults.length>0&&(l=l.add(a.batch.mutations[u].key));return l}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}(t.localStore,e);KR(t,r,null),qR(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),yield Ya(t,i)}catch(i){yield Ll(i)}})).apply(this,arguments)}function Fae(n,e,t){return WR.apply(this,arguments)}function WR(){return(WR=(0,Z.A)(function*(n,e,t){const r=De(n);try{const i=yield function(o,a){const l=De(o);return l.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return l.mutationQueue.lookupMutationBatch(u,a).next(p=>(Ue(null!==p),d=p.keys(),l.mutationQueue.removeMutationBatch(u,p))).next(()=>l.mutationQueue.performConsistencyCheck(u)).next(()=>l.documentOverlayCache.removeOverlaysForBatchId(u,d,a)).next(()=>l.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>l.localDocuments.getDocuments(u,d))})}(r.localStore,e);KR(r,e,t),qR(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),yield Ya(r,i)}catch(i){yield Ll(i)}})).apply(this,arguments)}function GR(){return(GR=(0,Z.A)(function*(n,e){const t=De(n);Ql(t.remoteStore)||fe("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const r=yield function(o){const a=De(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",l=>a.mutationQueue.getHighestUnacknowledgedBatchId(l))}(t.localStore);if(-1===r)return void e.resolve();const i=t.ka.get(r)||[];i.push(e),t.ka.set(r,i)}catch(r){const i=Ef(r,"Initialization of waitForPendingWrites() operation failed");e.reject(i)}})).apply(this,arguments)}function qR(n,e){(n.ka.get(e)||[]).forEach(t=>{t.resolve()}),n.ka.delete(e)}function KR(n,e,t){const r=De(n);let i=r.Ba[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Ba[r.currentUser.toKey()]=i}}function Cf(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Ma.get(e))n.Fa.delete(r),t&&n.Ca.$a(r,t);n.Ma.delete(e),n.isPrimaryClient&&n.La.gr(e).forEach(r=>{n.La.containsKey(r)||WH(n,r)})}function WH(n,e){n.xa.delete(e.path.canonicalString());const t=n.Oa.get(e);null!==t&&(_f(n.remoteStore,t),n.Oa=n.Oa.remove(e),n.Na.delete(t),YR(n))}function QR(n,e,t){for(const r of t)r instanceof UH?(n.La.addReference(r.key,e),Vae(n,r)):r instanceof BH?(fe("SyncEngine","Document no longer in limbo: "+r.key),n.La.removeReference(r.key,e),n.La.containsKey(r.key)||WH(n,r.key)):Oe()}function Vae(n,e){const t=e.key,r=t.path.canonicalString();n.Oa.get(t)||n.xa.has(r)||(fe("SyncEngine","New document in limbo: "+t),n.xa.add(r),YR(n))}function YR(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){const e=n.xa.values().next().value;n.xa.delete(e);const t=new Pe(Lt.fromString(e)),r=n.qa.next();n.Na.set(r,new Sae(t)),n.Oa=n.Oa.insert(t,r),Dw(n.remoteStore,new Qa(wi(Zh(t.path)),r,"TargetPurposeLimboResolution",Ds.oe))}}function Ya(n,e,t){return JR.apply(this,arguments)}function JR(){return JR=(0,Z.A)(function*(n,e,t){const r=De(n),i=[],s=[],o=[];var a;r.Fa.isEmpty()||(r.Fa.forEach((a,l)=>{o.push(r.Ka(l,e,t).then(u=>{var d;if((u||t)&&r.isPrimaryClient){const p=u?!u.fromCache:null===(d=t?.targetChanges.get(l.targetId))||void 0===d?void 0:d.current;r.sharedClientState.updateQueryState(l.targetId,p?"current":"not-current")}if(u){i.push(u);const p=JD.Wi(l.targetId,u);s.push(p)}}))}),yield Promise.all(o),r.Ca.d_(i),yield(a=(0,Z.A)(function*(u,d){const p=De(u);try{yield p.persistence.runTransaction("notifyLocalViewChanges","readwrite",_=>q.forEach(d,v=>q.forEach(v.$i,A=>p.persistence.referenceDelegate.addReference(_,v.targetId,A)).next(()=>q.forEach(v.Ui,A=>p.persistence.referenceDelegate.removeReference(_,v.targetId,A)))))}catch(_){if(!Vl(_))throw _;fe("LocalStore","Failed to update sequence numbers: "+_)}for(const _ of d){const v=_.targetId;if(!_.fromCache){const A=p.os.get(v),P=A.withLastLimboFreeSnapshotVersion(A.snapshotVersion);p.os=p.os.insert(v,P)}}}),function l(u,d){return a.apply(this,arguments)})(r.localStore,s))}),JR.apply(this,arguments)}function Uae(n,e){return XR.apply(this,arguments)}function XR(){return(XR=(0,Z.A)(function*(n,e){const t=De(n);if(!t.currentUser.isEqual(e)){fe("SyncEngine","User change. New user:",e.toKey());const r=yield mH(t.localStore,e);t.currentUser=e,(s=t).ka.forEach(a=>{a.forEach(l=>{l.reject(new ce(te.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ka.clear(),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),yield Ya(t,r.hs)}var s})).apply(this,arguments)}function Bae(n,e){const t=De(n),r=t.Na.get(e);if(r&&r.va)return pt().add(r.key);{let i=pt();const s=t.Ma.get(e);if(!s)return i;for(const o of s){const a=t.Fa.get(o);i=i.unionWith(a.view.Va)}return i}}function jae(n,e){return ZR.apply(this,arguments)}function ZR(){return(ZR=(0,Z.A)(function*(n,e){const t=De(n),r=yield Cw(t.localStore,e.query,!0),i=e.view.ba(r);return t.isPrimaryClient&&QR(t,e.targetId,i.wa),i})).apply(this,arguments)}function $ae(n,e){return ex.apply(this,arguments)}function ex(){return(ex=(0,Z.A)(function*(n,e){const t=De(n);return EH(t.localStore,e).then(r=>Ya(t,r))})).apply(this,arguments)}function Hae(n,e,t,r){return tx.apply(this,arguments)}function tx(){return(tx=(0,Z.A)(function*(n,e,t,r){const i=De(n),s=yield function(a,l){const u=De(a),d=De(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",p=>d.Mn(p,l).next(_=>_?u.localDocuments.getDocuments(p,_):q.resolve(null)))}(i.localStore,e);var l;null!==s?("pending"===t?yield yf(i.remoteStore):"acknowledged"===t||"rejected"===t?(KR(i,e,r||null),qR(i,e),l=e,De(De(i.localStore).mutationQueue).On(l)):Oe(),yield Ya(i,s)):fe("SyncEngine","Cannot apply mutation batch with id: "+e)})).apply(this,arguments)}function nx(){return(nx=(0,Z.A)(function*(n,e){const t=De(n);if(xw(t),ox(t),!0===e&&!0!==t.Qa){const r=t.sharedClientState.getAllActiveQueryTargets(),i=yield GH(t,r.toArray());t.Qa=!0,yield TR(t.remoteStore,!0);for(const s of i)Dw(t.remoteStore,s)}else if(!1===e&&!1!==t.Qa){const r=[];let i=Promise.resolve();t.Ma.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?r.push(o):i=i.then(()=>(Cf(t,o),gf(t.localStore,o,!0))),_f(t.remoteStore,o)}),yield i,yield GH(t,r),function(o){const a=De(o);a.Na.forEach((l,u)=>{_f(a.remoteStore,u)}),a.La.pr(),a.Na=new Map,a.Oa=new Dn(Pe.comparator)}(t),t.Qa=!1,yield TR(t.remoteStore,!1)}})).apply(this,arguments)}function GH(n,e,t){return rx.apply(this,arguments)}function rx(){return(rx=(0,Z.A)(function*(n,e,t){const r=De(n),i=[],s=[];for(const o of e){let a;const l=r.Ma.get(o);if(l&&0!==l.length){a=yield pf(r.localStore,wi(l[0]));for(const u of l){const d=r.Fa.get(u),p=yield jae(r,d);p.snapshot&&s.push(p.snapshot)}}else{const u=yield vH(r.localStore,o);a=yield pf(r.localStore,u),yield LR(r,qH(u),o,!1,a.resumeToken)}i.push(a)}return r.Ca.d_(s),i})).apply(this,arguments)}function qH(n){return Gj(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function Wae(n){return t=De(n).localStore,De(De(t).persistence).Qi();var t}function Gae(n,e,t,r){return ix.apply(this,arguments)}function ix(){return(ix=(0,Z.A)(function*(n,e,t,r){const i=De(n);if(i.Qa)return void fe("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=yield EH(i.localStore,Jj(s[0])),a=Hm.createSynthesizedRemoteEventForCurrentChange(e,"current"===t,dr.EMPTY_BYTE_STRING);yield Ya(i,o,a);break}case"rejected":yield gf(i.localStore,e,!0),Cf(i,e,r);break;default:Oe()}})).apply(this,arguments)}function qae(n,e,t){return sx.apply(this,arguments)}function sx(){return(sx=(0,Z.A)(function*(n,e,t){const r=xw(n);if(r.Qa){for(const i of e){if(r.Ma.has(i)&&r.sharedClientState.isActiveQueryTarget(i)){fe("SyncEngine","Adding an already active target "+i);continue}const s=yield vH(r.localStore,i),o=yield pf(r.localStore,s);yield LR(r,qH(s),o.targetId,!1,o.resumeToken),Dw(r.remoteStore,o)}for(const i of t)r.Ma.has(i)&&(yield gf(r.localStore,i,!1).then(()=>{_f(r.remoteStore,i),Cf(r,i)}).catch(Ll))}})).apply(this,arguments)}function xw(n){const e=De(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=HH.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Bae.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=kae.bind(null,e),e.Ca.d_=wae.bind(null,e.eventManager),e.Ca.$a=Cae.bind(null,e.eventManager),e}function ox(n){const e=De(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Oae.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Fae.bind(null,e),e}let Tf=(()=>{class n{constructor(){this.kind="memory",this.synchronizeTabs=!1}initialize(t){var r=this;return(0,Z.A)(function*(){r.serializer=e_(t.databaseInfo.databaseId),r.sharedClientState=r.Wa(t),r.persistence=r.Ga(t),yield r.persistence.start(),r.localStore=r.za(t),r.gcScheduler=r.ja(t,r.localStore),r.indexBackfillerScheduler=r.Ha(t,r.localStore)})()}ja(t,r){return null}Ha(t,r){return null}za(t){return gH(this.persistence,new pH,t.initialUser,this.serializer)}Ga(t){return new qD(Ew.Zr,this.serializer)}Wa(t){return new TH}terminate(){var t=this;return(0,Z.A)(function*(){var r,i;null===(r=t.gcScheduler)||void 0===r||r.stop(),null===(i=t.indexBackfillerScheduler)||void 0===i||i.stop(),t.sharedClientState.shutdown(),yield t.persistence.shutdown()})()}}return n.provider={build:()=>new n},n})();class ax extends Tf{constructor(e,t,r){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}initialize(e){var t=()=>super.initialize,r=this;return(0,Z.A)(function*(){yield t().call(r,e),yield r.Ja.initialize(r,e),yield ox(r.Ja.syncEngine),yield yf(r.Ja.remoteStore),yield r.persistence.yi(()=>(r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(),r.indexBackfillerScheduler&&!r.indexBackfillerScheduler.started&&r.indexBackfillerScheduler.start(),Promise.resolve()))})()}za(e){return gH(this.persistence,new pH,e.initialUser,this.serializer)}ja(e,t){return new sH(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}Ha(e,t){const r=new mse(t,this.persistence);return new gse(e.asyncQueue,r)}Ga(e){const t=YD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=void 0!==this.cacheSizeBytes?Ci.withCacheSize(this.cacheSizeBytes):Ci.DEFAULT;return new QD(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,bH(),Sw(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new TH}}class KH extends ax{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}initialize(e){var t=()=>super.initialize,r=this;return(0,Z.A)(function*(){yield t().call(r,e);const i=r.Ja.syncEngine;r.sharedClientState instanceof sR&&(r.sharedClientState.syncEngine={no:Hae.bind(null,i),ro:Gae.bind(null,i),io:qae.bind(null,i),Qi:Wae.bind(null,i),eo:$ae.bind(null,i)},yield r.sharedClientState.start()),yield r.persistence.yi(function(){var s=(0,Z.A)(function*(o){yield function zae(n,e){return nx.apply(this,arguments)}(r.Ja.syncEngine,o),r.gcScheduler&&(o&&!r.gcScheduler.started?r.gcScheduler.start():o||r.gcScheduler.stop()),r.indexBackfillerScheduler&&(o&&!r.indexBackfillerScheduler.started?r.indexBackfillerScheduler.start():o||r.indexBackfillerScheduler.stop())});return function(o){return s.apply(this,arguments)}}())})()}Wa(e){const t=bH();if(!sR.D(t))throw new ce(te.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const r=YD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new sR(t,e.asyncQueue,r,e.clientId,e.initialUser)}}let Af=(()=>{class n{initialize(t,r){var i=this;return(0,Z.A)(function*(){i.localStore||(i.localStore=t.localStore,i.sharedClientState=t.sharedClientState,i.datastore=i.createDatastore(r),i.remoteStore=i.createRemoteStore(r),i.eventManager=i.createEventManager(r),i.syncEngine=i.createSyncEngine(r,!t.synchronizeTabs),i.sharedClientState.onlineStateHandler=s=>zH(i.syncEngine,s,1),i.remoteStore.remoteSyncer.handleCredentialChange=Uae.bind(null,i.syncEngine),yield TR(i.remoteStore,i.syncEngine.isPrimaryClient))})()}createEventManager(t){return new Iae}createDatastore(t){const r=e_(t.databaseInfo.databaseId),i=new iae(t.databaseInfo);return new aae(t.authCredentials,t.appCheckCredentials,i,r)}createRemoteStore(t){return i=this.localStore,s=this.datastore,o=t.asyncQueue,a=r=>zH(this.syncEngine,r,0),l=AH.D()?new AH:new tae,new uae(i,s,o,a,l);var i,s,o,a,l}createSyncEngine(t,r){return function(s,o,a,l,u,d,p){const _=new Dae(s,o,a,l,u,d);return p&&(_.Qa=!0),_}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,r)}terminate(){var t=this;return(0,Z.A)(function*(){var r,i,s;yield(s=(0,Z.A)(function*(a){const l=De(a);fe("RemoteStore","RemoteStore shutting down."),l.L_.add(5),yield mf(l),l.k_.shutdown(),l.q_.set("Unknown")}),function o(a){return s.apply(this,arguments)})(t.remoteStore),null===(r=t.datastore)||void 0===r||r.terminate(),null===(i=t.eventManager)||void 0===i||i.terminate()})()}}return n.provider={build:()=>new n},n})();function QH(n,e=10240){let t=0;return{read:()=>(0,Z.A)(function*(){if(t<n.byteLength){const r={value:n.slice(t,t+e),done:!1};return t+=e,r}return{done:!0}})(),cancel:()=>(0,Z.A)(function*(){})(),releaseLock(){},closed:Promise.resolve()}}class Pw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):vr("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout(()=>{this.muted||e(t)},0)}}class Yae{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new Gr,this.buffer=new Uint8Array,this.eu=new TextDecoder("utf-8"),this.tu().then(r=>{r&&r.ua()?this.metadata.resolve(r.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(r?.aa)}`))},r=>this.metadata.reject(r))}close(){return this.Xa.cancel()}getMetadata(){var e=this;return(0,Z.A)(function*(){return e.metadata.promise})()}Ua(){var e=this;return(0,Z.A)(function*(){return yield e.getMetadata(),e.tu()})()}tu(){var e=this;return(0,Z.A)(function*(){const t=yield e.nu();if(null===t)return null;const r=e.eu.decode(t),i=Number(r);isNaN(i)&&e.ru(`length string (${r}) is not valid number`);const s=yield e.iu(i);return new Tae(JSON.parse(s),t.length+i)})()}su(){return this.buffer.findIndex(e=>e==="{".charCodeAt(0))}nu(){var e=this;return(0,Z.A)(function*(){for(;e.su()<0&&!(yield e.ou()););if(0===e.buffer.length)return null;const t=e.su();t<0&&e.ru("Reached the end of bundle when a length string is expected.");const r=e.buffer.slice(0,t);return e.buffer=e.buffer.slice(t),r})()}iu(e){var t=this;return(0,Z.A)(function*(){for(;t.buffer.length<e;)(yield t.ou())&&t.ru("Reached the end of bundle when more is expected.");const r=t.eu.decode(t.buffer.slice(0,e));return t.buffer=t.buffer.slice(e),r})()}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}ou(){var e=this;return(0,Z.A)(function*(){const t=yield e.Xa.read();if(!t.done){const r=new Uint8Array(e.buffer.length+t.value.length);r.set(e.buffer),r.set(t.value,e.buffer.length),e.buffer=r}return t.done})()}}class Jae{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(e){var t=this;return(0,Z.A)(function*(){if(t.ensureCommitNotCalled(),t.mutations.length>0)throw t.lastTransactionError=new ce(te.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),t.lastTransactionError;const r=yield(i=(0,Z.A)(function*(o,a){const l=De(o),u={documents:a.map(v=>Wm(l.serializer,v))},d=yield l.Lo("BatchGetDocuments",l.serializer.databaseId,Lt.emptyPath(),u,a.length),p=new Map;d.forEach(v=>{const A=function poe(n,e){return"found"in e?function(r,i){Ue(!!i.found);const s=ra(r,i.found.name),o=Er(i.found.updateTime),a=i.found.createTime?Er(i.found.createTime):We.min(),l=new li({mapValue:{fields:i.found.fields}});return $n.newFoundDocument(s,o,a,l)}(n,e):"missing"in e?function(r,i){Ue(!!i.missing),Ue(!!i.readTime);const s=ra(r,i.missing),o=Er(i.readTime);return $n.newNoDocument(s,o)}(n,e):Oe()}(l.serializer,v);p.set(A.key.toString(),A)});const _=[];return a.forEach(v=>{const A=p.get(v.toString());Ue(!!A),_.push(A)}),_}),function s(o,a){return i.apply(this,arguments)})(t.datastore,e);var i;return r.forEach(i=>t.recordVersion(i)),r})()}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastTransactionError=r}this.writtenDocs.add(e.toString())}delete(e){this.write(new af(e,this.precondition(e))),this.writtenDocs.add(e.toString())}commit(){var e=this;return(0,Z.A)(function*(){if(e.ensureCommitNotCalled(),e.lastTransactionError)throw e.lastTransactionError;const t=e.readVersions;var r;e.mutations.forEach(r=>{t.delete(r.key.toString())}),t.forEach((r,i)=>{const s=Pe.fromPath(i);e.mutations.push(new RD(s,e.precondition(s)))}),yield(r=(0,Z.A)(function*(s,o){const a=De(s),l={writes:o.map(u=>Gm(a.serializer,u))};yield a.Mo("Commit",a.serializer.databaseId,Lt.emptyPath(),l)}),function i(s,o){return r.apply(this,arguments)})(e.datastore,e.mutations),e.committed=!0})()}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Oe();t=We.min()}const r=this.readVersions.get(e.key.toString());if(r){if(!t.isEqual(r))throw new ce(te.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(We.min())?Jn.exists(!1):Jn.updateTime(t):Jn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(We.min()))throw new ce(te.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Jn.updateTime(t)}return Jn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class Xae{constructor(e,t,r,i,s){this.asyncQueue=e,this.datastore=t,this.options=r,this.updateFunction=i,this.deferred=s,this._u=r.maxAttempts,this.t_=new aR(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){var e=this;this.t_.Go((0,Z.A)(function*(){const t=new Jae(e.datastore),r=e.cu(t);r&&r.then(i=>{e.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{e.deferred.resolve(i)}).catch(s=>{e.lu(s)}))}).catch(i=>{e.lu(i)})}))}cu(e){try{const t=this.updateFunction(e);return!Dm(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget(()=>(this.uu(),Promise.resolve()))):this.deferred.reject(e)}hu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!g$(t)}return!1}}class Zae{constructor(e,t,r,i,s){var o=this;this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Wr.UNAUTHENTICATED,this.clientId=oj.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,function(){var a=(0,Z.A)(function*(l){fe("FirestoreClient","Received user=",l.uid),yield o.authCredentialListener(l),o.user=l});return function(l){return a.apply(this,arguments)}}()),this.appCheckCredentials.start(r,a=>(fe("FirestoreClient","Received new app check token=",a),this.appCheckCredentialListener(a,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){var e=this;this.asyncQueue.enterRestrictedMode();const t=new Gr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,Z.A)(function*(){try{e._onlineComponents&&(yield e._onlineComponents.terminate()),e._offlineComponents&&(yield e._offlineComponents.terminate()),e.authCredentials.shutdown(),e.appCheckCredentials.shutdown(),t.resolve()}catch(r){const i=Ef(r,"Failed to shutdown persistence");t.reject(i)}})),t.promise}}function lx(n,e){return ux.apply(this,arguments)}function ux(){return ux=(0,Z.A)(function*(n,e){n.asyncQueue.verifyOperationInProgress(),fe("FirestoreClient","Initializing OfflineComponentProvider");const t=n.configuration;yield e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(function(){var i=(0,Z.A)(function*(s){r.isEqual(s)||(yield mH(e.localStore,s),r=s)});return function(s){return i.apply(this,arguments)}}()),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}),ux.apply(this,arguments)}function YH(n,e){return cx.apply(this,arguments)}function cx(){return(cx=(0,Z.A)(function*(n,e){n.asyncQueue.verifyOperationInProgress();const t=yield dx(n);fe("FirestoreClient","Initializing OnlineComponentProvider"),yield e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>MH(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>MH(e.remoteStore,i)),n._onlineComponents=e})).apply(this,arguments)}function dx(n){return hx.apply(this,arguments)}function hx(){return(hx=(0,Z.A)(function*(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){fe("FirestoreClient","Using user provided OfflineComponentProvider");try{yield lx(n,n._uninitializedComponentsProvider._offline)}catch(e){if(!("FirebaseError"===(i=e).name?i.code===te.FAILED_PRECONDITION||i.code===te.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||22===i.code||20===i.code||11===i.code))throw e;bs("Error using user provided cache. Falling back to memory cache: "+e),yield lx(n,new Tf)}}else fe("FirestoreClient","Using default OfflineComponentProvider"),yield lx(n,new Tf);var i;return n._offlineComponents})).apply(this,arguments)}function Nw(n){return fx.apply(this,arguments)}function fx(){return(fx=(0,Z.A)(function*(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(fe("FirestoreClient","Using user provided OnlineComponentProvider"),yield YH(n,n._uninitializedComponentsProvider._online)):(fe("FirestoreClient","Using default OnlineComponentProvider"),yield YH(n,new Af))),n._onlineComponents})).apply(this,arguments)}function JH(n){return dx(n).then(e=>e.persistence)}function bf(n){return dx(n).then(e=>e.localStore)}function XH(n){return Nw(n).then(e=>e.remoteStore)}function px(n){return Nw(n).then(e=>e.syncEngine)}function Sf(n){return gx.apply(this,arguments)}function gx(){return(gx=(0,Z.A)(function*(n){const e=yield Nw(n),t=e.eventManager;return t.onListen=Rae.bind(null,e.syncEngine),t.onUnlisten=Pae.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=xae.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=Nae.bind(null,e.syncEngine),t})).apply(this,arguments)}function ez(n,e,t={}){const r=new Gr;return n.asyncQueue.enqueueAndForget((0,Z.A)(function*(){return function(s,o,a,l,u){const d=new Pw({next:_=>{d.Za(),o.enqueueAndForget(()=>RR(s,p));const v=_.docs.has(a);!v&&_.fromCache?u.reject(new ce(te.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&_.fromCache&&l&&"server"===l.source?u.reject(new ce(te.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(_)},error:_=>u.reject(_)}),p=new MR(Zh(a.path),d,{includeMetadataChanges:!0,_a:!0});return SR(s,p)}(yield Sf(n),n.asyncQueue,e,t,r)})),r.promise}function tz(n,e,t={}){const r=new Gr;return n.asyncQueue.enqueueAndForget((0,Z.A)(function*(){return function(s,o,a,l,u){const d=new Pw({next:_=>{d.Za(),o.enqueueAndForget(()=>RR(s,p)),_.fromCache&&"server"===l.source?u.reject(new ce(te.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(_)},error:_=>u.reject(_)}),p=new MR(a,d,{includeMetadataChanges:!0,_a:!0});return SR(s,p)}(yield Sf(n),n.asyncQueue,e,t,r)})),r.promise}function nz(n){const e={};return void 0!==n.timeoutSeconds&&(e.timeoutSeconds=n.timeoutSeconds),e}const rz=new Map;function mx(n,e,t){if(!t)throw new ce(te.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function iz(n,e,t,r){if(!0===e&&!0===r)throw new ce(te.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function sz(n){if(!Pe.isDocumentKey(n))throw new ce(te.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function oz(n){if(Pe.isDocumentKey(n))throw new ce(te.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Mw(n){if(void 0===n)return"undefined";if(null===n)return"null";if("string"==typeof n)return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if("number"==typeof n||"boolean"==typeof n)return""+n;if("object"==typeof n){if(n instanceof Array)return"an array";{const e=(r=n).constructor?r.constructor.name:null;return e?`a custom ${e} object`:"an object"}}var r;return"function"==typeof n?"a function":Oe()}function Rt(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new ce(te.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Mw(n);throw new ce(te.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function az(n,e){if(e<=0)throw new ce(te.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}class lz{constructor(e){var t,r;if(void 0===e.host){if(void 0!==e.ssl)throw new ce(te.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ce(te.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}iz("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!(this.experimentalForceLongPolling||void 0!==e.experimentalAutoDetectLongPolling&&!e.experimentalAutoDetectLongPolling),this.experimentalLongPollingOptions=nz(null!==(r=e.experimentalLongPollingOptions)&&void 0!==r?r:{}),function(s){if(void 0!==s.timeoutSeconds){if(isNaN(s.timeoutSeconds))throw new ce(te.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new ce(te.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new ce(te.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.experimentalLongPollingOptions.timeoutSeconds===e.experimentalLongPollingOptions.timeoutSeconds&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class n_{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new lz({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ce(te.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ce(te.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new lz(e),void 0!==e.credentials&&(this._authCredentials=function(r){if(!r)return new rse;switch(r.type){case"firstParty":return new ase(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ce(te.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}_restart(){var e=this;return(0,Z.A)(function*(){"notTerminated"===e._terminateTask?yield e._terminate():e._terminateTask="notTerminated"})()}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=rz.get(t);r&&(fe("ComponentProvider","Removing Datastore"),rz.delete(t),r.terminate())}(this),Promise.resolve()}}class ui{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new ui(this.firestore,e,this._query)}}class Hn{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ia(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Hn(this.firestore,e,this._key)}}class ia extends ui{constructor(e,t,r){super(e,t,Zh(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Hn(this.firestore,null,new Pe(e))}withConverter(e){return new ia(this.firestore,e,this._path)}}function cz(n,e,...t){if(n=(0,B.Ku)(n),mx("collection","path",e),n instanceof n_){const r=Lt.fromString(e,...t);return oz(r),new ia(n,null,r)}{if(!(n instanceof Hn||n instanceof ia))throw new ce(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Lt.fromString(e,...t));return oz(r),new ia(n.firestore,null,r)}}function kw(n,e,...t){if(n=(0,B.Ku)(n),1===arguments.length&&(e=oj.newId()),mx("doc","path",e),n instanceof n_){const r=Lt.fromString(e,...t);return sz(r),new Hn(n,null,new Pe(r))}{if(!(n instanceof Hn||n instanceof ia))throw new ce(te.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(Lt.fromString(e,...t));return sz(r),new Hn(n.firestore,n instanceof ia?n.converter:null,new Pe(r))}}function dz(n,e){return n=(0,B.Ku)(n),e=(0,B.Ku)(e),(n instanceof Hn||n instanceof ia)&&(e instanceof Hn||e instanceof ia)&&n.firestore===e.firestore&&n.path===e.path&&n.converter===e.converter}function _x(n,e){return n=(0,B.Ku)(n),e=(0,B.Ku)(e),n instanceof ui&&e instanceof ui&&n.firestore===e.firestore&&Fm(n._query,e._query)&&n.converter===e.converter}class hz{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new aR(this,"async_queue_retry"),this.Vu=()=>{const r=Sw();r&&fe("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const t=Sw();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Sw();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const t=new Gr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}pu(){var e=this;return(0,Z.A)(function*(){if(0!==e.Pu.length){try{yield e.Pu[0](),e.Pu.shift(),e.t_.reset()}catch(t){if(!Vl(t))throw t;fe("AsyncQueue","Operation failed with retryable error: "+t)}e.Pu.length>0&&e.t_.Go(()=>e.pu())}})()}gu(e){const t=this.mu.then(()=>(this.du=!0,e().catch(r=>{throw this.Eu=r,this.du=!1,vr("INTERNAL UNHANDLED ERROR: ",function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+"\n"+o.stack),a}(r)),r}).then(r=>(this.du=!1,r))));return this.mu=t,t}enqueueAfterDelay(e,t,r){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const i=bR.createAndSchedule(this,e,t,r,s=>this.yu(s));return this.Tu.push(i),i}fu(){this.Eu&&Oe()}verifyOperationInProgress(){}wu(){var e=this;return(0,Z.A)(function*(){let t;do{t=e.mu,yield t}while(t!==e.mu)})()}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function yx(n){return function(t,r){if("object"!=typeof t||null===t)return!1;const i=t;for(const s of["next","error","complete"])if(s in i&&"function"==typeof i[s])return!0;return!1}(n)}class hle{constructor(){this._progressObserver={},this._taskCompletionResolver=new Gr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,r){this._progressObserver={next:e,error:t,complete:r}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class vn extends n_{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new hz,this._persistenceKey=i?.name||"[DEFAULT]"}_terminate(){var e=this;return(0,Z.A)(function*(){if(e._firestoreClient){const t=e._firestoreClient.terminate();e._queue=new hz(t),e._firestoreClient=void 0,yield t}})()}}function Xn(n){if(n._terminated)throw new ce(te.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||fz(n),n._firestoreClient}function fz(n){var e,t,r;const i=n._freezeSettings(),s=(l=(null===(e=n._app)||void 0===e?void 0:e.options.appId)||"",new Vse(n._databaseId,l,n._persistenceKey,(d=i).host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,nz(d.experimentalLongPollingOptions),d.useFetchStreams));var l,d;n._componentsProvider||!(null===(t=i.localCache)||void 0===t)&&t._offlineComponentProvider&&!(null===(r=i.localCache)||void 0===r)&&r._onlineComponentProvider&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new Zae(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(a){const l=a?._online.build();return{_offline:a?._offline.build(l),_online:l}}(n._componentsProvider))}function vx(){return(vx=(0,Z.A)(function*(n){bs("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=n._freezeSettings();pz(n,Af.provider,{build:t=>new KH(t,e.cacheSizeBytes)})})).apply(this,arguments)}function pz(n,e,t){if((n=Rt(n,vn))._firestoreClient||n._terminated)throw new ce(te.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new ce(te.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},fz(n)}class sa{constructor(e){this._byteString=e}static fromBase64String(e){try{return new sa(dr.fromBase64String(e))}catch(t){throw new ce(te.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new sa(dr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Ja{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new ce(te.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new jn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Mc{constructor(e){this._methodName=e}}class Ow{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ce(te.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ce(te.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}}class Fw{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}const Cle=/^__.*__$/;class Tle{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new Ka(e,this.data,this.fieldMask,t,this.fieldTransforms):new sf(e,this.data,t,this.fieldTransforms)}}class gz{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Ka(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function mz(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Oe()}}class Lw{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===s&&this.vu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new Lw(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.Ou(e),i}Nu(e){var t;const r=null===(t=this.path)||void 0===t?void 0:t.child(e),i=this.Fu({path:r,xu:!1});return i.vu(),i}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Bw(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(mz(this.Cu)&&Cle.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Ale{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||e_(e)}Qu(e,t,r,i=!1){return new Lw({Cu:e,methodName:t,qu:r,path:jn.emptyPath(),xu:!1,ku:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function kc(n){const e=n._freezeSettings(),t=e_(n._databaseId);return new Ale(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Vw(n,e,t,r,i,s={}){const o=n.Qu(s.merge||s.mergeFields?2:0,e,t,i);bx("Data must be an object, but it was:",o,r);const a=vz(r,o);let l,u;if(s.merge)l=new ls(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const d=[];for(const p of s.mergeFields){const _=s_(e,p,t);if(!o.contains(_))throw new ce(te.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);Iz(d,_)||d.push(_)}l=new ls(d),u=o.fieldTransforms.filter(p=>l.covers(p.field))}else l=null,u=o.fieldTransforms;return new Tle(new li(a),l,u)}class i_ extends Mc{_toFieldTransform(e){if(2!==e.Cu)throw e.Bu(1===e.Cu?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof i_}}function _z(n,e,t){return new Lw({Cu:3,qu:e.settings.qu,methodName:n._methodName,xu:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Ex extends Mc{_toFieldTransform(e){return new Bm(e.path,new nf)}isEqual(e){return e instanceof Ex}}class Ix extends Mc{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=_z(this,e,!0),r=this.Ku.map(s=>Oc(s,t)),i=new Tc(r);return new Bm(e.path,i)}isEqual(e){return e instanceof Ix&&(0,B.bD)(this.Ku,e.Ku)}}class wx extends Mc{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=_z(this,e,!0),r=this.Ku.map(s=>Oc(s,t)),i=new Ac(r);return new Bm(e.path,i)}isEqual(e){return e instanceof wx&&(0,B.bD)(this.Ku,e.Ku)}}class Cx extends Mc{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new rf(e.serializer,r$(e.serializer,this.$u));return new Bm(e.path,t)}isEqual(e){return e instanceof Cx&&this.$u===e.$u}}function Tx(n,e,t,r){const i=n.Qu(1,e,t);bx("Data must be an object, but it was:",i,r);const s=[],o=li.empty();Ul(r,(l,u)=>{const d=Uw(e,l,t);u=(0,B.Ku)(u);const p=i.Nu(d);if(u instanceof i_)s.push(d);else{const _=Oc(u,p);null!=_&&(s.push(d),o.set(d,_))}});const a=new ls(s);return new gz(o,a,i.fieldTransforms)}function Ax(n,e,t,r,i,s){const o=n.Qu(1,e,t),a=[s_(e,r,t)],l=[i];if(s.length%2!=0)throw new ce(te.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let _=0;_<s.length;_+=2)a.push(s_(e,s[_])),l.push(s[_+1]);const u=[],d=li.empty();for(let _=a.length-1;_>=0;--_)if(!Iz(u,a[_])){const v=a[_];let A=l[_];A=(0,B.Ku)(A);const D=o.Nu(v);if(A instanceof i_)u.push(v);else{const P=Oc(A,D);null!=P&&(u.push(v),d.set(v,P))}}const p=new ls(u);return new gz(d,p,o.fieldTransforms)}function yz(n,e,t,r=!1){return Oc(t,n.Qu(r?4:3,e))}function Oc(n,e){if(Ez(n=(0,B.Ku)(n)))return bx("Unsupported field value:",e,n),vz(n,e);if(n instanceof Mc)return function(r,i){if(!mz(i.Cu))throw i.Bu(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.Bu(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(void 0===n&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.xu&&4!==e.Cu)throw e.Bu("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const a of r){let l=Oc(a,i.Lu(o));null==l&&(l={nullValue:"NULL_VALUE"}),s.push(l),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if(null===(r=(0,B.Ku)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return r$(i.serializer,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const s=Qn.fromDate(r);return{timestampValue:lf(i.serializer,s)}}if(r instanceof Qn){const s=new Qn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:lf(i.serializer,s)}}if(r instanceof Ow)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof sa)return{bytesValue:A$(i.serializer,r._byteString)};if(r instanceof Hn){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:OD(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Fw)return a=i,{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:r.toArray().map(l=>{if("number"!=typeof l)throw a.Bu("VectorValues must only contain numeric values.");return DD(a.serializer,l)})}}}}};var a;throw i.Bu(`Unsupported field value: ${Mw(r)}`)}(n,e)}function vz(n,e){const t={};return Cj(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ul(n,(r,i)=>{const s=Oc(i,e.Mu(r));null!=s&&(t[r]=s)}),{mapValue:{fields:t}}}function Ez(n){return!("object"!=typeof n||null===n||n instanceof Array||n instanceof Date||n instanceof Qn||n instanceof Ow||n instanceof sa||n instanceof Hn||n instanceof Mc||n instanceof Fw)}function bx(n,e,t){if(!Ez(t)||"object"!=typeof(i=t)||null===i||Object.getPrototypeOf(i)!==Object.prototype&&null!==Object.getPrototypeOf(i)){const r=Mw(t);throw e.Bu("an object"===r?n+" a custom object":n+" "+r)}var i}function s_(n,e,t){if((e=(0,B.Ku)(e))instanceof Ja)return e._internalPath;if("string"==typeof e)return Uw(n,e);throw Bw("Field path arguments must be of type string or ",n,!1,void 0,t)}const ble=new RegExp("[~\\*/\\[\\]]");function Uw(n,e,t){if(e.search(ble)>=0)throw Bw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Ja(...e.split("."))._internalPath}catch{throw Bw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Bw(n,e,t,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${e}() called with invalid data`;t&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ce(te.INVALID_ARGUMENT,a+n+l)}function Iz(n,e){return n.some(t=>t.isEqual(e))}class o_{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Hn(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Sle(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(jw("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Sle extends o_{data(){return super.data()}}function jw(n,e){return"string"==typeof e?Uw(n,e):e instanceof Ja?e._internalPath:e._delegate._internalPath}function wz(n){if("L"===n.limitType&&0===n.explicitOrderBy.length)throw new ce(te.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Sx{}class a_ extends Sx{}function Jl(n,e,...t){let r=[];e instanceof Sx&&r.push(e),r=r.concat(t),function(s){const o=s.filter(l=>l instanceof Df).length,a=s.filter(l=>l instanceof l_).length;if(o>1||o>0&&a>0)throw new ce(te.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class l_ extends a_{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new l_(e,t,r)}_apply(e){const t=this._parse(e);return bz(e._query,t),new ui(e.firestore,e.converter,bD(e._query,t))}_parse(e){const t=kc(e.firestore);return function(s,o,a,l,u,d,p){let _;if(u.isKeyField()){if("array-contains"===d||"array-contains-any"===d)throw new ce(te.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if("in"===d||"not-in"===d){Az(p,d);const v=[];for(const A of p)v.push(Tz(l,s,A));_={arrayValue:{values:v}}}else _=Tz(l,s,p)}else"in"!==d&&"not-in"!==d&&"array-contains-any"!==d||Az(p,d),_=yz(a,"where",p,"in"===d||"not-in"===d);return Vt.create(u,d,_)}(e._query,0,t,e.firestore._databaseId,this._field,this._op,this._value)}}class Df extends Sx{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Df(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return 1===t.length?t[0]:ln.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(i,s){let o=i;const a=s.getFlattenedFilters();for(const l of a)bz(o,l),o=bD(o,l)}(e._query,t),new ui(e.firestore,e.converter,bD(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Dx extends a_{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Dx(e,t)}_apply(e){const t=function(i,s,o){if(null!==i.startAt)throw new ce(te.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==i.endAt)throw new ce(te.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new km(s,o)}(e._query,this._field,this._direction);return new ui(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Ga(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}class $w extends a_{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new $w(e,t,r)}_apply(e){return new ui(e.firestore,e.converter,ow(e._query,this._limit,this._limitType))}}class Hw extends a_{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new Hw(e,t,r)}_apply(e){const t=Cz(e,this.type,this._docOrFields,this._inclusive);return new ui(e.firestore,e.converter,(s=t,new Ga((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)));var i,s}}class zw extends a_{constructor(e,t,r){super(),this.type=e,this._docOrFields=t,this._inclusive=r}static _create(e,t,r){return new zw(e,t,r)}_apply(e){const t=Cz(e,this.type,this._docOrFields,this._inclusive);return new ui(e.firestore,e.converter,(s=t,new Ga((i=e._query).path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,i.startAt,s)));var i,s}}function Cz(n,e,t,r){if(t[0]=(0,B.Ku)(t[0]),t[0]instanceof o_)return function(s,o,a,l,u){if(!l)throw new ce(te.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);const d=[];for(const p of ef(s))if(p.field.isKeyField())d.push(wc(o,l.key));else{const _=l.data.field(p.field);if(XI(_))throw new ce(te.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===_){const v=p.field.canonicalString();throw new ce(te.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}d.push(_)}return new zl(d,u)}(n._query,n.firestore._databaseId,e,t[0]._document,r);{const i=kc(n.firestore);return function(o,a,l,u,d,p){const _=o.explicitOrderBy;if(d.length>_.length)throw new ce(te.INVALID_ARGUMENT,`Too many arguments provided to ${u}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let A=0;A<d.length;A++){const D=d[A];if(_[A].field.isKeyField()){if("string"!=typeof D)throw new ce(te.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${u}(), but got a ${typeof D}`);if(!AD(o)&&-1!==D.indexOf("/"))throw new ce(te.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${u}() must be a plain document ID, but '${D}' contains a slash.`);const P=o.path.child(Lt.fromString(D));if(!Pe.isDocumentKey(P))throw new ce(te.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${u}() must result in a valid document path, but '${P}' is not because it contains an odd number of segments.`);const H=new Pe(P);v.push(wc(a,H))}else{const P=yz(l,u,D);v.push(P)}}return new zl(v,p)}(n._query,n.firestore._databaseId,i,e,t,r)}}function Tz(n,e,t){if("string"==typeof(t=(0,B.Ku)(t))){if(""===t)throw new ce(te.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!AD(e)&&-1!==t.indexOf("/"))throw new ce(te.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(Lt.fromString(t));if(!Pe.isDocumentKey(r))throw new ce(te.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return wc(n,new Pe(r))}if(t instanceof Hn)return wc(n,t._key);throw new ce(te.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Mw(t)}.`)}function Az(n,e){if(!Array.isArray(n)||0===n.length)throw new ce(te.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function bz(n,e){const t=function(i,s){for(const o of i)for(const a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(null!==t)throw new ce(te.INVALID_ARGUMENT,t===e.op?`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`:`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class Rx{convertValue(e,t="none"){switch($l(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Yn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Wa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Oe()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return Ul(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=null===(i=null===(r=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===r?void 0:r.values)||void 0===i?void 0:i.map(o=>Yn(o.doubleValue));return new Fw(s)}convertGeoPoint(e){return new Ow(Yn(e.latitude),Yn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=ZI(e);return null==r?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(xm(e));default:return null}}convertTimestamp(e){const t=za(e);return new Qn(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=Lt.fromString(e);Ue(L$(r));const i=new Bl(r.get(1),r.get(3)),s=new Pe(r.popFirst(5));return i.isEqual(t)||vr(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function Ww(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class Fle extends Rx{constructor(e){super(),this.firestore=e}convertBytes(e){return new sa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hn(this.firestore,null,t)}}class Fc{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Xa extends o_{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new u_(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(jw("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class u_ extends Xa{data(e={}){return super.data(e)}}class Xl{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Fc(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new u_(this._firestore,this._userDataWriter,r.key,r,new Fc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ce(te.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(a=>({type:"added",doc:new u_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter),oldIndex:-1,newIndex:o++}))}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(a=>s||3!==a.type).map(a=>{const l=new u_(i._firestore,i._userDataWriter,a.doc.key,a.doc,new Fc(i._snapshot.mutatedKeys.has(a.doc.key),i._snapshot.fromCache),i.query.converter);let u=-1,d=-1;return 0!==a.type&&(u=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),1!==a.type&&(o=o.add(a.doc),d=o.indexOf(a.doc.key)),{type:Vle(a.type),doc:l,oldIndex:u,newIndex:d}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function Vle(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Oe()}}function Dz(n,e){return n instanceof Xa&&e instanceof Xa?n._firestore===e._firestore&&n._key.isEqual(e._key)&&(null===n._document?null===e._document:n._document.isEqual(e._document))&&n._converter===e._converter:n instanceof Xl&&e instanceof Xl&&n._firestore===e._firestore&&_x(n.query,e.query)&&n.metadata.isEqual(e.metadata)&&n._snapshot.isEqual(e._snapshot)}class Zl extends Rx{constructor(e){super(),this.firestore=e}convertBytes(e){return new sa(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Hn(this.firestore,null,t)}}function Rz(n,e,t){n=Rt(n,Hn);const r=Rt(n.firestore,vn),i=Ww(n.converter,e,t);return Rf(r,[Vw(kc(r),"setDoc",n._key,i,null!==n.converter,t).toMutation(n._key,Jn.none())])}function xz(n,e,t,...r){n=Rt(n,Hn);const i=Rt(n.firestore,vn),s=kc(i);let o;return o="string"==typeof(e=(0,B.Ku)(e))||e instanceof Ja?Ax(s,"updateDoc",n._key,e,t,r):Tx(s,"updateDoc",n._key,e),Rf(i,[o.toMutation(n._key,Jn.exists(!0))])}function Pz(n,...e){var t,r,i;n=(0,B.Ku)(n);let s={includeMetadataChanges:!1,source:"default"},o=0;"object"!=typeof e[o]||yx(e[o])||(s=e[o],o++);const a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(yx(e[o])){const p=e[o];e[o]=null===(t=p.next)||void 0===t?void 0:t.bind(p),e[o+1]=null===(r=p.error)||void 0===r?void 0:r.bind(p),e[o+2]=null===(i=p.complete)||void 0===i?void 0:i.bind(p)}let l,u,d;if(n instanceof Hn)u=Rt(n.firestore,vn),d=Zh(n._key.path),l={next:p=>{e[o]&&e[o](xx(u,n,p))},error:e[o+1],complete:e[o+2]};else{const p=Rt(n,ui);u=Rt(p.firestore,vn),d=p._query;const _=new Zl(u);l={next:v=>{e[o]&&e[o](new Xl(u,_,p,v))},error:e[o+1],complete:e[o+2]},wz(n._query)}return function(_,v,A,D){const P=new Pw(D),H=new MR(v,P,A);return _.asyncQueue.enqueueAndForget((0,Z.A)(function*(){return SR(yield Sf(_),H)})),()=>{P.Za(),_.asyncQueue.enqueueAndForget((0,Z.A)(function*(){return RR(yield Sf(_),H)}))}}(Xn(u),d,a,l)}function Rf(n,e){return function(r,i){const s=new Gr;return r.asyncQueue.enqueueAndForget((0,Z.A)(function*(){return function Mae(n,e,t){return jR.apply(this,arguments)}(yield px(r),i,s)})),s.promise}(Xn(n),e)}function xx(n,e,t){const r=t.docs.get(e._key),i=new Zl(n);return new Xa(n,i,e._key,r,new Fc(t.hasPendingWrites,t.fromCache),e.converter)}const nue={maxAttempts:5};class Nz{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=kc(e)}set(e,t,r){this._verifyNotCommitted();const i=eu(e,this._firestore),s=Ww(i.converter,t,r),o=Vw(this._dataReader,"WriteBatch.set",i._key,s,null!==i.converter,r);return this._mutations.push(o.toMutation(i._key,Jn.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=eu(e,this._firestore);let o;return o="string"==typeof(t=(0,B.Ku)(t))||t instanceof Ja?Ax(this._dataReader,"WriteBatch.update",s._key,t,r,i):Tx(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Jn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=eu(e,this._firestore);return this._mutations=this._mutations.concat(new af(t._key,Jn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ce(te.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function eu(n,e){if((n=(0,B.Ku)(n)).firestore!==e)throw new ce(te.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}class rue extends class{constructor(t,r){this._firestore=t,this._transaction=r,this._dataReader=kc(t)}get(t){const r=eu(t,this._firestore),i=new Fle(this._firestore);return this._transaction.lookup([r._key]).then(s=>{if(!s||1!==s.length)return Oe();const o=s[0];if(o.isFoundDocument())return new o_(this._firestore,i,o.key,o,r.converter);if(o.isNoDocument())return new o_(this._firestore,i,r._key,null,r.converter);throw Oe()})}set(t,r,i){const s=eu(t,this._firestore),o=Ww(s.converter,r,i),a=Vw(this._dataReader,"Transaction.set",s._key,o,null!==s.converter,i);return this._transaction.set(s._key,a),this}update(t,r,i,...s){const o=eu(t,this._firestore);let a;return a="string"==typeof(r=(0,B.Ku)(r))||r instanceof Ja?Ax(this._dataReader,"Transaction.update",o._key,r,i,s):Tx(this._dataReader,"Transaction.update",o._key,r),this._transaction.update(o._key,a),this}delete(t){const r=eu(t,this._firestore);return this._transaction.delete(r._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=eu(e,this._firestore),r=new Zl(this._firestore);return super.get(e).then(i=>new Xa(this._firestore,r,t._key,i._document,new Fc(!1,!1),t.converter))}}function Nx(n,e){if(void 0===e)return{merge:!1};if(void 0!==e.mergeFields&&void 0!==e.merge)throw new ce("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return e}function Fz(){if(typeof Uint8Array>"u")throw new ce("unimplemented","Uint8Arrays are not available in this environment.")}function Lz(){if(!function Fse(){return typeof atob<"u"}())throw new ce("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,t=!0){Wh=zi.SDK_VERSION,(0,zi._registerComponent)(new cD.uA("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),a=new vn(new sse(r.getProvider("auth-internal")),new lse(r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ce(te.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Bl(u.options.projectId,d)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),(0,zi.registerVersion)(rj,"4.7.3",e),(0,zi.registerVersion)(rj,"4.7.3","esm2017")}();class c_{constructor(e){this._delegate=e}static fromBase64String(e){return Lz(),new c_(sa.fromBase64String(e))}static fromUint8Array(e){return Fz(),new c_(sa.fromUint8Array(e))}toBase64(){return Lz(),this._delegate.toBase64()}toUint8Array(){return Fz(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Mx(n){return function fue(n,e){if("object"!=typeof n||null===n)return!1;const t=n;for(const r of e)if(r in t&&"function"==typeof t[r])return!0;return!1}(n,["next","error","complete"])}class pue{enableIndexedDbPersistence(e,t){return function ple(n,e){bs("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return pz(n,Af.provider,{build:r=>new ax(r,t.cacheSizeBytes,e?.forceOwnership)}),Promise.resolve()}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function gle(n){return vx.apply(this,arguments)}(e._delegate)}clearIndexedDbPersistence(e){return function mle(n){if(n._initialized&&!n._terminated)throw new ce(te.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const e=new Gr;return n._queue.enqueueAndForgetEvenWhileRestricted((0,Z.A)(function*(){try{yield(t=(0,Z.A)(function*(i){if(!Zo.D())return Promise.resolve();const s=i+"main";yield Zo.delete(s)}),function r(i){return t.apply(this,arguments)})(YD(n._databaseId,n._persistenceKey)),e.resolve()}catch(t){e.reject(t)}var t})),e.promise}(e._delegate)}}class Vz{constructor(e,t,r){this._delegate=t,this._persistenceProvider=r,this.INTERNAL={delete:()=>this.terminate()},e instanceof Bl||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();!e.merge&&t.host!==e.host&&bs("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t,r={}){!function uz(n,e,t,r={}){var i;const s=(n=Rt(n,n_))._getSettings(),o=`${e}:${t}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&bs("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let a,l;if("string"==typeof r.mockUserToken)a=r.mockUserToken,l=Wr.MOCK_USER;else{a=(0,B.Fy)(r.mockUserToken,null===(i=n._app)||void 0===i?void 0:i.options.projectId);const u=r.mockUserToken.sub||r.mockUserToken.user_id;if(!u)throw new ce(te.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");l=new Wr(u)}n._authCredentials=new ise(new ij(a,l))}}(this._delegate,e,t,r)}enableNetwork(){return function yle(n){return function ele(n){return n.asyncQueue.enqueue((0,Z.A)(function*(){const e=yield JH(n),t=yield XH(n);return e.setNetworkEnabled(!0),function(i){const s=De(i);return s.L_.delete(0),t_(s)}(t)}))}(Xn(n=Rt(n,vn)))}(this._delegate)}disableNetwork(){return function vle(n){return function tle(n){return n.asyncQueue.enqueue((0,Z.A)(function*(){const e=yield JH(n),t=yield XH(n);return e.setNetworkEnabled(!1),(r=(0,Z.A)(function*(s){const o=De(s);o.L_.add(0),yield mf(o),o.q_.set("Offline")}),function i(s){return r.apply(this,arguments)})(t);var r}))}(Xn(n=Rt(n,vn)))}(this._delegate)}enablePersistence(e){let t=!1,r=!1;return e&&(t=!!e.synchronizeTabs,r=!!e.experimentalForceOwningTab,iz("synchronizeTabs",t,"experimentalForceOwningTab",r)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,r)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function _le(n){return function(t){const r=new Gr;return t.asyncQueue.enqueueAndForget((0,Z.A)(function*(){return function Lae(n,e){return GR.apply(this,arguments)}(yield px(t),r)})),r.promise}(Xn(n=Rt(n,vn)))}(this._delegate)}onSnapshotsInSync(e){return function qle(n,e){return function sle(n,e){const t=new Pw(e);return n.asyncQueue.enqueueAndForget((0,Z.A)(function*(){return i=yield Sf(n),s=t,De(i).Y_.add(s),void s.next();var i,s})),()=>{t.Za(),n.asyncQueue.enqueueAndForget((0,Z.A)(function*(){return i=yield Sf(n),s=t,void De(i).Y_.delete(s);var i,s}))}}(Xn(n=Rt(n,vn)),yx(e)?e:{next:e})}(this._delegate,e)}get app(){if(!this._appCompat)throw new ce("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new xf(this,cz(this._delegate,e))}catch(t){throw Wi(t,"collection()","Firestore.collection()")}}doc(e){try{return new Js(this,kw(this._delegate,e))}catch(t){throw Wi(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Gi(this,function dle(n,e){if(n=Rt(n,n_),mx("collectionGroup","collection id",e),e.indexOf("/")>=0)throw new ce(te.INVALID_ARGUMENT,`Invalid collection ID '${e}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ui(n,null,(r=e,new Ga(Lt.emptyPath(),r)));var r}(this._delegate,e))}catch(t){throw Wi(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function iue(n,e,t){n=Rt(n,vn);const r=Object.assign(Object.assign({},nue),t);return function(s){if(s.maxAttempts<1)throw new ce(te.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(s,o,a){const l=new Gr;return s.asyncQueue.enqueueAndForget((0,Z.A)(function*(){const u=yield function ZH(n){return Nw(n).then(e=>e.datastore)}(s);new Xae(s.asyncQueue,u,a,o,l).au()})),l.promise}(Xn(n),i=>e(new rue(n,i)),r)}(this._delegate,t=>e(new Uz(this,t)))}batch(){return Xn(this._delegate),new Bz(new Nz(this._delegate,e=>Rf(this._delegate,e)))}loadBundle(e){return function Ele(n,e){const t=Xn(n=Rt(n,vn)),r=new hle;return function ole(n,e,t,r){const i=function(o,a){let l;return l="string"==typeof o?_$().encode(o):o,d=function(d,p){if(d instanceof Uint8Array)return QH(d,p);if(d instanceof ArrayBuffer)return QH(new Uint8Array(d),p);if(d instanceof ReadableStream)return d.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(l),new Yae(d,a);var d}(t,e_(e));n.asyncQueue.enqueueAndForget((0,Z.A)(function*(){!function Kae(n,e,t){const r=De(n);var i;(i=(0,Z.A)(function*(o,a,l){try{const u=yield a.getMetadata();if(yield function(A,D){const P=De(A),H=Er(D.createTime);return P.persistence.runTransaction("hasNewerBundle","readonly",V=>P.Gr.getBundleMetadata(V,D.id)).then(V=>!!V&&V.createTime.compareTo(H)>=0)}(o.localStore,u))return yield a.close(),l._completeWith({taskState:"Success",documentsLoaded:(A=u).totalDocuments,bytesLoaded:A.totalBytes,totalDocuments:A.totalDocuments,totalBytes:A.totalBytes}),Promise.resolve(new Set);l._updateProgress(VH(u));const d=new Aae(u,o.localStore,a.serializer);let p=yield a.Ua();for(;p;){const v=yield d.la(p);v&&l._updateProgress(v),p=yield a.Ua()}const _=yield d.complete();return yield Ya(o,_.Ia,void 0),yield function(A,D){const P=De(A);return P.persistence.runTransaction("Save bundle","readwrite",H=>P.Gr.saveBundleMetadata(H,D))}(o.localStore,u),l._completeWith(_.progress),Promise.resolve(_.Pa)}catch(u){return bs("SyncEngine",`Loading bundle failed with ${u}`),l._failWith(u),Promise.resolve(new Set)}var A}),function s(o,a,l){return i.apply(this,arguments)})(r,e,t).then(i=>{r.sharedClientState.notifyBundleLoaded(i)})}(yield px(n),i,r)}))}(t,n._databaseId,e,r),r}(this._delegate,e)}namedQuery(e){return function Ile(n,e){return function ale(n,e){return n.asyncQueue.enqueue((0,Z.A)(function*(){return function(r,i){const s=De(r);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,i))}(yield bf(n),e)}))}(Xn(n=Rt(n,vn)),e).then(t=>t?new ui(n,null,t.query):null)}(this._delegate,e).then(t=>t?new Gi(this,t):null)}}class qw extends Rx{constructor(e){super(),this.firestore=e}convertBytes(e){return new c_(new sa(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return Js.forKey(t,this.firestore,null)}}class Uz{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new qw(e)}get(e){const t=Vc(e);return this._delegate.get(t).then(r=>new d_(this._firestore,new Xa(this._firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,t.converter)))}set(e,t,r){const i=Vc(e);return r?(Nx("Transaction.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Vc(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Vc(e);return this._delegate.delete(t),this}}class Bz{constructor(e){this._delegate=e}set(e,t,r){const i=Vc(e);return r?(Nx("WriteBatch.set",r),this._delegate.set(i,t,r)):this._delegate.set(i,t),this}update(e,t,r,...i){const s=Vc(e);return 2===arguments.length?this._delegate.update(s,t):this._delegate.update(s,t,r,...i),this}delete(e){const t=Vc(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Lc{constructor(e,t,r){this._firestore=e,this._userDataWriter=t,this._delegate=r}fromFirestore(e,t){const r=new u_(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new h_(this._firestore,r),t??{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const r=Lc.INSTANCES;let i=r.get(e);i||(i=new WeakMap,r.set(e,i));let s=i.get(t);return s||(s=new Lc(e,new qw(e),t),i.set(t,s)),s}}Lc.INSTANCES=new WeakMap;class Js{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new qw(e)}static forPath(e,t,r){if(e.length%2!=0)throw new ce("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new Js(t,new Hn(t._delegate,r,new Pe(e)))}static forKey(e,t,r){return new Js(t,new Hn(t._delegate,r,e))}get id(){return this._delegate.id}get parent(){return new xf(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new xf(this.firestore,cz(this._delegate,e))}catch(t){throw Wi(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,B.Ku)(e))instanceof Hn&&dz(this._delegate,e)}set(e,t){t=Nx("DocumentReference.set",t);try{return t?Rz(this._delegate,e,t):Rz(this._delegate,e)}catch(r){throw Wi(r,"setDoc()","DocumentReference.set()")}}update(e,t,...r){try{return 1===arguments.length?xz(this._delegate,e):xz(this._delegate,e,t,...r)}catch(i){throw Wi(i,"updateDoc()","DocumentReference.update()")}}delete(){return function Wle(n){return Rf(Rt(n.firestore,vn),[new af(n._key,Jn.none())])}(this._delegate)}onSnapshot(...e){const t=jz(e),r=$z(e,i=>new d_(this.firestore,new Xa(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)));return Pz(this._delegate,t,r)}get(e){let t;return t="cache"===e?.source?function Ble(n){n=Rt(n,Hn);const e=Rt(n.firestore,vn),t=Xn(e),r=new Zl(e);return function nle(n,e){const t=new Gr;return n.asyncQueue.enqueueAndForget((0,Z.A)(function*(){return(r=(0,Z.A)(function*(s,o,a){try{const l=yield function(d,p){const _=De(d);return _.persistence.runTransaction("read document","readonly",v=>_.localDocuments.getDocument(v,p))}(s,o);l.isFoundDocument()?a.resolve(l):l.isNoDocument()?a.resolve(null):a.reject(new ce(te.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(l){const u=Ef(l,`Failed to get document '${o} from cache`);a.reject(u)}}),function i(s,o,a){return r.apply(this,arguments)})(yield bf(n),e,t);var r})),t.promise}(t,n._key).then(i=>new Xa(e,r,n._key,i,new Fc(null!==i&&i.hasLocalMutations,!0),n.converter))}(this._delegate):"server"===e?.source?function jle(n){n=Rt(n,Hn);const e=Rt(n.firestore,vn);return ez(Xn(e),n._key,{source:"server"}).then(t=>xx(e,n,t))}(this._delegate):function Ule(n){n=Rt(n,Hn);const e=Rt(n.firestore,vn);return ez(Xn(e),n._key).then(t=>xx(e,n,t))}(this._delegate),t.then(r=>new d_(this.firestore,new Xa(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)))}withConverter(e){return new Js(this.firestore,this._delegate.withConverter(e?Lc.getInstance(this.firestore,e):null))}}function Wi(n,e,t){return n.message=n.message.replace(e,t),n}function jz(n){for(const e of n)if("object"==typeof e&&!Mx(e))return e;return{}}function $z(n,e){var t,r;let i;return i=Mx(n[0])?n[0]:Mx(n[1])?n[1]:"function"==typeof n[0]?{next:n[0],error:n[1],complete:n[2]}:{next:n[1],error:n[2],complete:n[3]},{next:s=>{i.next&&i.next(e(s))},error:null===(t=i.error)||void 0===t?void 0:t.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class d_{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new Js(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Dz(this._delegate,e._delegate)}}class h_ extends d_{data(e){const t=this._delegate.data(e);return this._delegate._converter||function nse(n,e){n||Oe()}(void 0!==t),t}}class Gi{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new qw(e)}where(e,t,r){try{return new Gi(this.firestore,Jl(this._delegate,function Dle(n,e,t){const r=e,i=jw("where",n);return l_._create(i,r,t)}(e,t,r)))}catch(i){throw Wi(i,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Gi(this.firestore,Jl(this._delegate,function Rle(n,e="asc"){const t=e,r=jw("orderBy",n);return Dx._create(r,t)}(e,t)))}catch(r){throw Wi(r,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Gi(this.firestore,Jl(this._delegate,function xle(n){return az("limit",n),$w._create("limit",n,"F")}(e)))}catch(t){throw Wi(t,"limit()","Query.limit()")}}limitToLast(e){try{return new Gi(this.firestore,Jl(this._delegate,function Ple(n){return az("limitToLast",n),$w._create("limitToLast",n,"L")}(e)))}catch(t){throw Wi(t,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new Gi(this.firestore,Jl(this._delegate,function Nle(...n){return Hw._create("startAt",n,!0)}(...e)))}catch(t){throw Wi(t,"startAt()","Query.startAt()")}}startAfter(...e){try{return new Gi(this.firestore,Jl(this._delegate,function Mle(...n){return Hw._create("startAfter",n,!1)}(...e)))}catch(t){throw Wi(t,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new Gi(this.firestore,Jl(this._delegate,function kle(...n){return zw._create("endBefore",n,!1)}(...e)))}catch(t){throw Wi(t,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new Gi(this.firestore,Jl(this._delegate,function Ole(...n){return zw._create("endAt",n,!0)}(...e)))}catch(t){throw Wi(t,"endAt()","Query.endAt()")}}isEqual(e){return _x(this._delegate,e._delegate)}get(e){let t;return t="cache"===e?.source?function Hle(n){n=Rt(n,ui);const e=Rt(n.firestore,vn),t=Xn(e),r=new Zl(e);return function rle(n,e){const t=new Gr;return n.asyncQueue.enqueueAndForget((0,Z.A)(function*(){return(r=(0,Z.A)(function*(s,o,a){try{const l=yield Cw(s,o,!0),u=new jH(o,l.Ts),d=u.ma(l.documents),p=u.applyChanges(d,!1);a.resolve(p.snapshot)}catch(l){const u=Ef(l,`Failed to execute query '${o} against cache`);a.reject(u)}}),function i(s,o,a){return r.apply(this,arguments)})(yield bf(n),e,t);var r})),t.promise}(t,n._query).then(i=>new Xl(e,r,n,i))}(this._delegate):"server"===e?.source?function zle(n){n=Rt(n,ui);const e=Rt(n.firestore,vn),t=Xn(e),r=new Zl(e);return tz(t,n._query,{source:"server"}).then(i=>new Xl(e,r,n,i))}(this._delegate):function $le(n){n=Rt(n,ui);const e=Rt(n.firestore,vn),t=Xn(e),r=new Zl(e);return wz(n._query),tz(t,n._query).then(i=>new Xl(e,r,n,i))}(this._delegate),t.then(r=>new kx(this.firestore,new Xl(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)))}onSnapshot(...e){const t=jz(e),r=$z(e,i=>new kx(this.firestore,new Xl(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)));return Pz(this._delegate,t,r)}withConverter(e){return new Gi(this.firestore,this._delegate.withConverter(e?Lc.getInstance(this.firestore,e):null))}}class mue{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new h_(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class kx{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Gi(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new h_(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(t=>new mue(this._firestore,t))}forEach(e,t){this._delegate.forEach(r=>{e.call(t,new h_(this._firestore,r))})}isEqual(e){return Dz(this._delegate,e._delegate)}}class xf extends Gi{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new Js(this.firestore,e):null}doc(e){try{return new Js(this.firestore,void 0===e?kw(this._delegate):kw(this._delegate,e))}catch(t){throw Wi(t,"doc()","CollectionReference.doc()")}}add(e){return function Gle(n,e){const t=Rt(n.firestore,vn),r=kw(n),i=Ww(n.converter,e);return Rf(t,[Vw(kc(n.firestore),"addDoc",r._key,i,null!==n.converter,{}).toMutation(r._key,Jn.exists(!1))]).then(()=>r)}(this._delegate,e).then(t=>new Js(this.firestore,t))}isEqual(e){return dz(this._delegate,e._delegate)}withConverter(e){return new xf(this.firestore,this._delegate.withConverter(e?Lc.getInstance(this.firestore,e):null))}}function Vc(n){return Rt(n,Hn)}class Ox{constructor(...e){this._delegate=new Ja(...e)}static documentId(){return new Ox(jn.keyField().canonicalString())}isEqual(e){return(e=(0,B.Ku)(e))instanceof Ja&&this._delegate._internalPath.isEqual(e._internalPath)}}class Uc{constructor(e){this._delegate=e}static serverTimestamp(){const e=function oue(){return new Ex("serverTimestamp")}();return e._methodName="FieldValue.serverTimestamp",new Uc(e)}static delete(){const e=function sue(){return new i_("deleteField")}();return e._methodName="FieldValue.delete",new Uc(e)}static arrayUnion(...e){const t=function aue(...n){return new Ix("arrayUnion",n)}(...e);return t._methodName="FieldValue.arrayUnion",new Uc(t)}static arrayRemove(...e){const t=function lue(...n){return new wx("arrayRemove",n)}(...e);return t._methodName="FieldValue.arrayRemove",new Uc(t)}static increment(e){const t=function uue(n){return new Cx("increment",n)}(e);return t._methodName="FieldValue.increment",new Uc(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const _ue={Firestore:Vz,GeoPoint:Ow,Timestamp:Qn,Blob:c_,Transaction:Uz,WriteBatch:Bz,DocumentReference:Js,DocumentSnapshot:d_,Query:Gi,QueryDocumentSnapshot:h_,QuerySnapshot:kx,CollectionReference:xf,FieldPath:Ox,FieldValue:Uc,setLogLevel:function gue(n){!function tse(n){Fl.setLogLevel(n)}(n)},CACHE_SIZE_UNLIMITED:-1};function Hz(n,e){return function Eue(n,e=MB){return new lt(t=>{let r;return null!=e?e.schedule(()=>{r=n.onSnapshot({includeMetadataChanges:!0},t)}):r=n.onSnapshot({includeMetadataChanges:!0},t),()=>{r?.()}})}(n,e)}function Fx(n,e){return Hz(n,e).pipe(de(t=>({payload:t,type:"query"})))}!function vue(n){(function yue(n,e){n.INTERNAL.registerComponent(new cD.uA("firestore-compat",t=>{const r=t.getProvider("app-compat").getImmediate(),i=t.getProvider("firestore").getImmediate();return e(r,i)},"PUBLIC").setServiceProps(Object.assign({},_ue)))})(n,(e,t)=>new Vz(e,t,new pue)),n.registerVersion("@firebase/firestore-compat","0.3.38")}(Ol.A);class zz{ref;afs;constructor(e,t){this.ref=e,this.afs=t}set(e,t){return this.ref.set(e,t)}update(e){return this.ref.update(e)}delete(){return this.ref.delete()}collection(e,t){const r=this.ref.collection(e),{ref:i,query:s}=Yz(r,t);return new qz(i,s,this.afs)}snapshotChanges(){return function Iue(n,e){return Hz(n,e).pipe(TI(void 0),uD(),de(t=>{const[r,i]=t;return i.exists?r?.exists?{payload:i,type:"modified"}:{payload:i,type:"added"}:{payload:i,type:"removed"}}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(As)}valueChanges(e={}){return this.snapshotChanges().pipe(de(({payload:t})=>e.idField?{...t.data(),[e.idField]:t.id}:t.data()))}get(e){return C(this.ref.get(e)).pipe(As)}}function Kw(n,e){return Fx(n,e).pipe(TI(void 0),uD(),de(t=>{const[r,i]=t,s=i.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(i.payload.metadata)&&i.payload.docs.forEach((a,l)=>{const u=s.find(p=>p.doc.ref.isEqual(a.ref)),d=r?.payload.docs.find(p=>p.ref.isEqual(a.ref));u&&JSON.stringify(u.doc.metadata)===JSON.stringify(a.metadata)||!u&&d&&JSON.stringify(d.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:l,newIndex:l,type:"modified",doc:a}})}),o}))}function Wz(n,e,t){return Kw(n,t).pipe(bI((r,i)=>function wue(n,e,t){return e.forEach(r=>{t.indexOf(r.type)>-1&&(n=function Cue(n,e){switch(e.type){case"added":if(!n[e.newIndex]||!n[e.newIndex].doc.ref.isEqual(e.doc.ref))return Lx(n,e.newIndex,0,e);break;case"modified":if(null==n[e.oldIndex]||n[e.oldIndex].doc.ref.isEqual(e.doc.ref)){if(e.oldIndex!==e.newIndex){const t=n.slice();return t.splice(e.oldIndex,1),t.splice(e.newIndex,0,e),t}return Lx(n,e.newIndex,1,e)}break;case"removed":if(n[e.oldIndex]&&n[e.oldIndex].doc.ref.isEqual(e.doc.ref))return Lx(n,e.oldIndex,1)}return n}(n,r))}),n}(r,i.map(s=>s.payload),e),[]),He(),de(r=>r.map(i=>({type:i.type,payload:i}))))}function Lx(n,e,t,...r){const i=n.slice();return i.splice(e,t,...r),i}function Gz(n){return(!n||0===n.length)&&(n=["added","removed","modified"]),n}class qz{ref;query;afs;constructor(e,t,r){this.ref=e,this.query=t,this.afs=r}stateChanges(e){let t=Kw(this.query,this.afs.schedulers.outsideAngular);return e&&e.length>0&&(t=t.pipe(de(r=>r.filter(i=>e.indexOf(i.type)>-1)))),t.pipe(TI(void 0),uD(),Ks(([r,i])=>i.length>0||!r),de(([,r])=>r),As)}auditTrail(e){return this.stateChanges(e).pipe(bI((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=Gz(e);return Wz(this.query,t,this.afs.schedulers.outsideAngular).pipe(As)}valueChanges(e={}){return Fx(this.query,this.afs.schedulers.outsideAngular).pipe(de(t=>t.payload.docs.map(r=>e.idField?{...r.data(),[e.idField]:r.id}:r.data())),As)}get(e){return C(this.query.get(e)).pipe(As)}add(e){return this.ref.add(e)}doc(e){return new zz(this.ref.doc(e),this.afs)}}class Tue{query;afs;constructor(e,t){this.query=e,this.afs=t}stateChanges(e){return e&&0!==e.length?Kw(this.query,this.afs.schedulers.outsideAngular).pipe(de(t=>t.filter(r=>e.indexOf(r.type)>-1)),Ks(t=>t.length>0),As):Kw(this.query,this.afs.schedulers.outsideAngular).pipe(As)}auditTrail(e){return this.stateChanges(e).pipe(bI((t,r)=>[...t,...r],[]))}snapshotChanges(e){const t=Gz(e);return Wz(this.query,t,this.afs.schedulers.outsideAngular).pipe(As)}valueChanges(e={}){return Fx(this.query,this.afs.schedulers.outsideAngular).pipe(de(r=>r.payload.docs.map(i=>e.idField?{[e.idField]:i.id,...i.data()}:i.data())),As)}get(e){return C(this.query.get(e)).pipe(As)}}const Kz=new we("angularfire2.enableFirestorePersistence"),Qz=new we("angularfire2.firestore.persistenceSettings"),Aue=new we("angularfire2.firestore.settings"),bue=new we("angularfire2.firestore.use-emulator");function Yz(n,e=(t=>t)){return{query:e(n),ref:n}}let Sue=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(t,r,i,s,o,a,l,u,d,p,_,v,A,D,P,H,V){this.schedulers=l;const Y=lD(t,a,r),ae=d;p&&qB(Y,a,_,A,D,P,v,H),[this.firestore,this.persistenceEnabled$]=LB(`${Y.name}.firestore`,"AngularFirestore",Y.name,()=>{const Te=a.runOutsideAngular(()=>Y.firestore());if(s&&Te.settings(s),ae&&Te.useEmulator(...ae),i&&!vI(o)){const $e=()=>{try{return C(Te.enablePersistence(u||void 0).then(()=>!0,()=>!1))}catch(U){return typeof console<"u"&&console.warn(U),R(!1)}};return[Te,a.runOutsideAngular($e)]}return[Te,R(!1)]},[s,ae,i])}collection(t,r){let i;i="string"==typeof t?this.firestore.collection(t):t;const{ref:s,query:o}=Yz(i,r),a=this.schedulers.ngZone.run(()=>s);return new qz(a,o,this)}collectionGroup(t,r){const i=r||(o=>o),s=this.firestore.collectionGroup(t);return new Tue(i(s),this)}doc(t){let r;r="string"==typeof t?this.firestore.doc(t):t;const i=this.schedulers.ngZone.run(()=>r);return new zz(i,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(r){return new(r||n)(Ee(WI),Ee(GI,8),Ee(Kz,8),Ee(Aue,8),Ee(zo),Ee(Xt),Ee(aD),Ee(Qz,8),Ee(bue,8),Ee(KB,8),Ee(jB,8),Ee($B,8),Ee(HB,8),Ee(zB,8),Ee(WB,8),Ee(GB,8),Ee(oD,8))};static \u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Due=(()=>{class n{constructor(){Ol.A.registerVersion("angularfire",zI.full,"fst-compat")}static enablePersistence(t){return{ngModule:n,providers:[{provide:Kz,useValue:!0},{provide:Qz,useValue:t}]}}static \u0275fac=function(r){return new(r||n)};static \u0275mod=ei({type:n});static \u0275inj=pi({providers:[Sue]})}return n})();const Jz_firebase={apiKey:"AIzaSyDWOb8hpZ7JQcpPzpcNw6SW53_pG0V5UE0",authDomain:"wedding-29b48.firebaseapp.com",databaseURL:"https://wedding-29b48-default-rtdb.europe-west1.firebasedatabase.app",projectId:"wedding-29b48",storageBucket:"wedding-29b48.firebasestorage.app",messagingSenderId:"807343676966",appId:"1:807343676966:web:1c21870a5ee2dfbae790e7",measurementId:"YOUR_MEASUREMENT_ID"};let Xz=(()=>{class n{constructor(t,r){this._renderer=t,this._elementRef=r,this.onChange=i=>{},this.onTouched=()=>{}}setProperty(t,r){this._renderer.setProperty(this._elementRef.nativeElement,t,r)}registerOnTouched(t){this.onTouched=t}registerOnChange(t){this.onChange=t}setDisabledState(t){this.setProperty("disabled",t)}static{this.\u0275fac=function(r){return new(r||n)(_e(Na),_e(Is))}}static{this.\u0275dir=Ye({type:n})}}return n})(),Bc=(()=>{class n extends Xz{static{this.\u0275fac=function(){let t;return function(i){return(t||(t=Cr(n)))(i||n)}}()}static{this.\u0275dir=Ye({type:n,features:[on]})}}return n})();const oa=new we("NgValueAccessor"),Pue={provide:oa,useExisting:Jt(()=>Qw),multi:!0},Mue=new we("CompositionEventMode");let Qw=(()=>{class n extends Xz{constructor(t,r,i){super(t,r),this._compositionMode=i,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function Nue(){const n=xl()?xl().getUserAgent():"";return/android (\d+)/.test(n.toLowerCase())}())}writeValue(t){this.setProperty("value",t??"")}_handleInput(t){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(t)}_compositionStart(){this._composing=!0}_compositionEnd(t){this._composing=!1,this._compositionMode&&this.onChange(t)}static{this.\u0275fac=function(r){return new(r||n)(_e(Na),_e(Is),_e(Mue,8))}}static{this.\u0275dir=Ye({type:n,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(r,i){1&r&&An("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[Kn([Pue]),on]})}}return n})();const Ai=new we("NgValidators"),nu=new we("NgAsyncValidators");function uW(n){return null!=n}function cW(n){return zg(n)?C(n):n}function dW(n){let e={};return n.forEach(t=>{e=null!=t?{...e,...t}:e}),0===Object.keys(e).length?null:e}function hW(n,e){return e.map(t=>t(n))}function fW(n){return n.map(e=>function Oue(n){return!n.validate}(e)?e:t=>e.validate(t))}function Vx(n){return null!=n?function pW(n){if(!n)return null;const e=n.filter(uW);return 0==e.length?null:function(t){return dW(hW(t,e))}}(fW(n)):null}function Ux(n){return null!=n?function gW(n){if(!n)return null;const e=n.filter(uW);return 0==e.length?null:function(t){return function Rue(...n){const e=fs(n),{args:t,keys:r}=CU(n),i=new lt(s=>{const{length:o}=t;if(!o)return void s.complete();const a=new Array(o);let l=o,u=o;for(let d=0;d<o;d++){let p=!1;Ut(t[d]).subscribe(re(s,_=>{p||(p=!0,u--),a[d]=_},()=>l--,void 0,()=>{(!l||!p)&&(u||s.next(r?AU(r,a):a),s.complete())}))}});return e?i.pipe(TU(e)):i}(hW(t,e).map(cW)).pipe(de(dW))}}(fW(n)):null}function mW(n,e){return null===n?[e]:Array.isArray(n)?[...n,e]:[n,e]}function Bx(n){return n?Array.isArray(n)?n:[n]:[]}function Jw(n,e){return Array.isArray(n)?n.includes(e):n===e}function vW(n,e){const t=Bx(e);return Bx(n).forEach(i=>{Jw(t,i)||t.push(i)}),t}function EW(n,e){return Bx(e).filter(t=>!Jw(n,t))}class IW{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(e){this._rawValidators=e||[],this._composedValidatorFn=Vx(this._rawValidators)}_setAsyncValidators(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=Ux(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(e){this._onDestroyCallbacks.push(e)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(e=>e()),this._onDestroyCallbacks=[]}reset(e=void 0){this.control&&this.control.reset(e)}hasError(e,t){return!!this.control&&this.control.hasError(e,t)}getError(e,t){return this.control?this.control.getError(e,t):null}}class qi extends IW{get formDirective(){return null}get path(){return null}}class ru extends IW{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class wW{constructor(e){this._cd=e}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let CW=(()=>{class n extends wW{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(_e(ru,2))}}static{this.\u0275dir=Ye({type:n,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(r,i){2&r&&Sl("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[on]})}}return n})(),TW=(()=>{class n extends wW{constructor(t){super(t)}static{this.\u0275fac=function(r){return new(r||n)(_e(qi,10))}}static{this.\u0275dir=Ye({type:n,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(r,i){2&r&&Sl("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[on]})}}return n})();const f_="VALID",Zw="INVALID",Pf="PENDING",p_="DISABLED";function Hx(n){return(eC(n)?n.validators:n)||null}function zx(n,e){return(eC(e)?e.asyncValidators:n)||null}function eC(n){return null!=n&&!Array.isArray(n)&&"object"==typeof n}class Wx{constructor(e,t){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(e),this._assignAsyncValidators(t)}get validator(){return this._composedValidatorFn}set validator(e){this._rawValidators=this._composedValidatorFn=e}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}get parent(){return this._parent}get valid(){return this.status===f_}get invalid(){return this.status===Zw}get pending(){return this.status==Pf}get disabled(){return this.status===p_}get enabled(){return this.status!==p_}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(e){this._assignValidators(e)}setAsyncValidators(e){this._assignAsyncValidators(e)}addValidators(e){this.setValidators(vW(e,this._rawValidators))}addAsyncValidators(e){this.setAsyncValidators(vW(e,this._rawAsyncValidators))}removeValidators(e){this.setValidators(EW(e,this._rawValidators))}removeAsyncValidators(e){this.setAsyncValidators(EW(e,this._rawAsyncValidators))}hasValidator(e){return Jw(this._rawValidators,e)}hasAsyncValidator(e){return Jw(this._rawAsyncValidators,e)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(e={}){this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(e=>e.markAllAsTouched())}markAsUntouched(e={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(t=>{t.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}markAsDirty(e={}){this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}markAsPristine(e={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(t=>{t.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}markAsPending(e={}){this.status=Pf,!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}disable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=p_,this.errors=null,this._forEachChild(r=>{r.disable({...e,onlySelf:!0})}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!0))}enable(e={}){const t=this._parentMarkedDirty(e.onlySelf);this.status=f_,this._forEachChild(r=>{r.enable({...e,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors({...e,skipPristineCheck:t}),this._onDisabledChange.forEach(r=>r(!1))}_updateAncestors(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(e){this._parent=e}getRawValue(){return this.value}updateValueAndValidity(e={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===f_||this.status===Pf)&&this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}_updateTreeValidity(e={emitEvent:!0}){this._forEachChild(t=>t._updateTreeValidity(e)),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?p_:f_}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(e){if(this.asyncValidator){this.status=Pf,this._hasOwnPendingAsyncValidator=!0;const t=cW(this.asyncValidator(this));this._asyncValidationSubscription=t.subscribe(r=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(r,{emitEvent:e})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(e,t={}){this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}get(e){let t=e;return null==t||(Array.isArray(t)||(t=t.split(".")),0===t.length)?null:t.reduce((r,i)=>r&&r._find(i),this)}getError(e,t){const r=t?this.get(t):this;return r&&r.errors?r.errors[e]:null}hasError(e,t){return!!this.getError(e,t)}get root(){let e=this;for(;e._parent;)e=e._parent;return e}_updateControlsErrors(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}_initObservables(){this.valueChanges=new ur,this.statusChanges=new ur}_calculateStatus(){return this._allControlsDisabled()?p_:this.errors?Zw:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Pf)?Pf:this._anyControlsHaveStatus(Zw)?Zw:f_}_anyControlsHaveStatus(e){return this._anyControls(t=>t.status===e)}_anyControlsDirty(){return this._anyControls(e=>e.dirty)}_anyControlsTouched(){return this._anyControls(e=>e.touched)}_updatePristine(e={}){this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}_updateTouched(e={}){this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}_registerOnCollectionChange(e){this._onCollectionChange=e}_setUpdateStrategy(e){eC(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}_parentMarkedDirty(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(e){return null}_assignValidators(e){this._rawValidators=Array.isArray(e)?e.slice():e,this._composedValidatorFn=function Uue(n){return Array.isArray(n)?Vx(n):n||null}(this._rawValidators)}_assignAsyncValidators(e){this._rawAsyncValidators=Array.isArray(e)?e.slice():e,this._composedAsyncValidatorFn=function Bue(n){return Array.isArray(n)?Ux(n):n||null}(this._rawAsyncValidators)}}class Gx extends Wx{constructor(e,t,r){super(Hx(t),zx(r,t)),this.controls=e,this._initObservables(),this._setUpdateStrategy(t),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}addControl(e,t,r={}){this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}removeControl(e,t={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],this.updateValueAndValidity({emitEvent:t.emitEvent}),this._onCollectionChange()}setControl(e,t,r={}){this.controls[e]&&this.controls[e]._registerOnCollectionChange(()=>{}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity({emitEvent:r.emitEvent}),this._onCollectionChange()}contains(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}setValue(e,t={}){(function SW(n,e,t){n._forEachChild((r,i)=>{if(void 0===t[i])throw new pe(1002,"")})})(this,0,e),Object.keys(e).forEach(r=>{(function bW(n,e,t){const r=n.controls;if(!(e?Object.keys(r):r).length)throw new pe(1e3,"");if(!r[t])throw new pe(1001,"")})(this,!0,r),this.controls[r].setValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t)}patchValue(e,t={}){null!=e&&(Object.keys(e).forEach(r=>{const i=this.controls[r];i&&i.patchValue(e[r],{onlySelf:!0,emitEvent:t.emitEvent})}),this.updateValueAndValidity(t))}reset(e={},t={}){this._forEachChild((r,i)=>{r.reset(e?e[i]:null,{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}getRawValue(){return this._reduceChildren({},(e,t,r)=>(e[r]=t.getRawValue(),e))}_syncPendingControls(){let e=this._reduceChildren(!1,(t,r)=>!!r._syncPendingControls()||t);return e&&this.updateValueAndValidity({onlySelf:!0}),e}_forEachChild(e){Object.keys(this.controls).forEach(t=>{const r=this.controls[t];r&&e(r,t)})}_setUpControls(){this._forEachChild(e=>{e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(e){for(const[t,r]of Object.entries(this.controls))if(this.contains(t)&&e(r))return!0;return!1}_reduceValue(){return this._reduceChildren({},(t,r,i)=>((r.enabled||this.disabled)&&(t[i]=r.value),t))}_reduceChildren(e,t){let r=e;return this._forEachChild((i,s)=>{r=t(r,i,s)}),r}_allControlsDisabled(){for(const e of Object.keys(this.controls))if(this.controls[e].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(e){return this.controls.hasOwnProperty(e)?this.controls[e]:null}}const Nf=new we("CallSetDisabledState",{providedIn:"root",factory:()=>tC}),tC="always";function g_(n,e,t=tC){qx(n,e),e.valueAccessor.writeValue(n.value),(n.disabled||"always"===t)&&e.valueAccessor.setDisabledState?.(n.disabled),function Hue(n,e){e.valueAccessor.registerOnChange(t=>{n._pendingValue=t,n._pendingChange=!0,n._pendingDirty=!0,"change"===n.updateOn&&DW(n,e)})}(n,e),function Wue(n,e){const t=(r,i)=>{e.valueAccessor.writeValue(r),i&&e.viewToModelUpdate(r)};n.registerOnChange(t),e._registerOnDestroy(()=>{n._unregisterOnChange(t)})}(n,e),function zue(n,e){e.valueAccessor.registerOnTouched(()=>{n._pendingTouched=!0,"blur"===n.updateOn&&n._pendingChange&&DW(n,e),"submit"!==n.updateOn&&n.markAsTouched()})}(n,e),function $ue(n,e){if(e.valueAccessor.setDisabledState){const t=r=>{e.valueAccessor.setDisabledState(r)};n.registerOnDisabledChange(t),e._registerOnDestroy(()=>{n._unregisterOnDisabledChange(t)})}}(n,e)}function iC(n,e){n.forEach(t=>{t.registerOnValidatorChange&&t.registerOnValidatorChange(e)})}function qx(n,e){const t=function _W(n){return n._rawValidators}(n);null!==e.validator?n.setValidators(mW(t,e.validator)):"function"==typeof t&&n.setValidators([t]);const r=function yW(n){return n._rawAsyncValidators}(n);null!==e.asyncValidator?n.setAsyncValidators(mW(r,e.asyncValidator)):"function"==typeof r&&n.setAsyncValidators([r]);const i=()=>n.updateValueAndValidity();iC(e._rawValidators,i),iC(e._rawAsyncValidators,i)}function DW(n,e){n._pendingDirty&&n.markAsDirty(),n.setValue(n._pendingValue,{emitModelToViewChange:!1}),e.viewToModelUpdate(n._pendingValue),n._pendingChange=!1}const Yue={provide:qi,useExisting:Jt(()=>oC)},m_=(()=>Promise.resolve())();let oC=(()=>{class n extends qi{constructor(t,r,i){super(),this.callSetDisabledState=i,this.submitted=!1,this._directives=new Set,this.ngSubmit=new ur,this.form=new Gx({},Vx(t),Ux(r))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(t){m_.then(()=>{const r=this._findContainer(t.path);t.control=r.registerControl(t.name,t.control),g_(t.control,t,this.callSetDisabledState),t.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(t)})}getControl(t){return this.form.get(t.path)}removeControl(t){m_.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name),this._directives.delete(t)})}addFormGroup(t){m_.then(()=>{const r=this._findContainer(t.path),i=new Gx({});(function RW(n,e){qx(n,e)})(i,t),r.registerControl(t.name,i),i.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(t){m_.then(()=>{const r=this._findContainer(t.path);r&&r.removeControl(t.name)})}getFormGroup(t){return this.form.get(t.path)}updateModel(t,r){m_.then(()=>{this.form.get(t.path).setValue(r)})}setValue(t){this.control.setValue(t)}onSubmit(t){return this.submitted=!0,function xW(n,e){n._syncPendingControls(),e.forEach(t=>{const r=t.control;"submit"===r.updateOn&&r._pendingChange&&(t.viewToModelUpdate(r._pendingValue),r._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(t),"dialog"===t?.target?.method}onReset(){this.resetForm()}resetForm(t=void 0){this.form.reset(t),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(t){return t.pop(),t.length?this.form.get(t):this.form}static{this.\u0275fac=function(r){return new(r||n)(_e(Ai,10),_e(nu,10),_e(Nf,8))}}static{this.\u0275dir=Ye({type:n,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(r,i){1&r&&An("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Kn([Yue]),on]})}}return n})();function PW(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}function NW(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}const MW=class extends Wx{constructor(e=null,t,r){super(Hx(t),zx(r,t)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(e),this._setUpdateStrategy(t),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),eC(t)&&(t.nonNullable||t.initialValueIsDefault)&&(this.defaultValue=NW(e)?e.value:e)}setValue(e,t={}){this.value=this._pendingValue=e,this._onChange.length&&!1!==t.emitModelToViewChange&&this._onChange.forEach(r=>r(this.value,!1!==t.emitViewToModelChange)),this.updateValueAndValidity(t)}patchValue(e,t={}){this.setValue(e,t)}reset(e=this.defaultValue,t={}){this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}_updateValue(){}_anyControls(e){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(e){this._onChange.push(e)}_unregisterOnChange(e){PW(this._onChange,e)}registerOnDisabledChange(e){this._onDisabledChange.push(e)}_unregisterOnDisabledChange(e){PW(this._onDisabledChange,e)}_forEachChild(e){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(e){NW(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}},Zue={provide:ru,useExisting:Jt(()=>Jx)},FW=(()=>Promise.resolve())();let Jx=(()=>{class n extends ru{constructor(t,r,i,s,o,a){super(),this._changeDetectorRef=o,this.callSetDisabledState=a,this.control=new MW,this._registered=!1,this.name="",this.update=new ur,this._parent=t,this._setValidators(r),this._setAsyncValidators(i),this.valueAccessor=function Yx(n,e){if(!e)return null;let t,r,i;return Array.isArray(e),e.forEach(s=>{s.constructor===Qw?t=s:function Kue(n){return Object.getPrototypeOf(n.constructor)===Bc}(s)?r=s:i=s}),i||r||t||null}(0,s)}ngOnChanges(t){if(this._checkForErrors(),!this._registered||"name"in t){if(this._registered&&(this._checkName(),this.formDirective)){const r=t.name.previousValue;this.formDirective.removeControl({name:r,path:this._getPath(r)})}this._setUpControl()}"isDisabled"in t&&this._updateDisabled(t),function Qx(n,e){if(!n.hasOwnProperty("model"))return!1;const t=n.model;return!!t.isFirstChange()||!Object.is(e,t.currentValue)}(t,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(t){this.viewModel=t,this.update.emit(t)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){g_(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(t){FW.then(()=>{this.control.setValue(t,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(t){const r=t.isDisabled.currentValue,i=0!==r&&xh(r);FW.then(()=>{i&&!this.control.disabled?this.control.disable():!i&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(t){return this._parent?function nC(n,e){return[...e.path,n]}(t,this._parent):[t]}static{this.\u0275fac=function(r){return new(r||n)(_e(qi,9),_e(Ai,10),_e(nu,10),_e(oa,10),_e(rI,8),_e(Nf,8))}}static{this.\u0275dir=Ye({type:n,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Kn([Zue]),on,Ui]})}}return n})(),LW=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275dir=Ye({type:n,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}}return n})(),UW=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ei({type:n})}static{this.\u0275inj=pi({})}}return n})(),Cce=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ei({type:n})}static{this.\u0275inj=pi({imports:[UW]})}}return n})(),Ace=(()=>{class n{static withConfig(t){return{ngModule:n,providers:[{provide:Nf,useValue:t.callSetDisabledState??tC}]}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ei({type:n})}static{this.\u0275inj=pi({imports:[Cce]})}}return n})();class aC{}class lC{}class Xs{constructor(e){this.normalizedNames=new Map,this.lazyUpdate=null,e?"string"==typeof e?this.lazyInit=()=>{this.headers=new Map,e.split("\n").forEach(t=>{const r=t.indexOf(":");if(r>0){const i=t.slice(0,r),s=i.toLowerCase(),o=t.slice(r+1).trim();this.maybeSetNormalizedName(i,s),this.headers.has(s)?this.headers.get(s).push(o):this.headers.set(s,[o])}})}:typeof Headers<"u"&&e instanceof Headers?(this.headers=new Map,e.forEach((t,r)=>{this.setHeaderEntries(r,t)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(e).forEach(([t,r])=>{this.setHeaderEntries(t,r)})}:this.headers=new Map}has(e){return this.init(),this.headers.has(e.toLowerCase())}get(e){this.init();const t=this.headers.get(e.toLowerCase());return t&&t.length>0?t[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(e){return this.init(),this.headers.get(e.toLowerCase())||null}append(e,t){return this.clone({name:e,value:t,op:"a"})}set(e,t){return this.clone({name:e,value:t,op:"s"})}delete(e,t){return this.clone({name:e,value:t,op:"d"})}maybeSetNormalizedName(e,t){this.normalizedNames.has(t)||this.normalizedNames.set(t,e)}init(){this.lazyInit&&(this.lazyInit instanceof Xs?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(e=>this.applyUpdate(e)),this.lazyUpdate=null))}copyFrom(e){e.init(),Array.from(e.headers.keys()).forEach(t=>{this.headers.set(t,e.headers.get(t)),this.normalizedNames.set(t,e.normalizedNames.get(t))})}clone(e){const t=new Xs;return t.lazyInit=this.lazyInit&&this.lazyInit instanceof Xs?this.lazyInit:this,t.lazyUpdate=(this.lazyUpdate||[]).concat([e]),t}applyUpdate(e){const t=e.name.toLowerCase();switch(e.op){case"a":case"s":let r=e.value;if("string"==typeof r&&(r=[r]),0===r.length)return;this.maybeSetNormalizedName(e.name,t);const i=("a"===e.op?this.headers.get(t):void 0)||[];i.push(...r),this.headers.set(t,i);break;case"d":const s=e.value;if(s){let o=this.headers.get(t);if(!o)return;o=o.filter(a=>-1===s.indexOf(a)),0===o.length?(this.headers.delete(t),this.normalizedNames.delete(t)):this.headers.set(t,o)}else this.headers.delete(t),this.normalizedNames.delete(t)}}setHeaderEntries(e,t){const r=(Array.isArray(t)?t:[t]).map(s=>s.toString()),i=e.toLowerCase();this.headers.set(i,r),this.maybeSetNormalizedName(e,i)}forEach(e){this.init(),Array.from(this.normalizedNames.keys()).forEach(t=>e(this.normalizedNames.get(t),this.headers.get(t)))}}class bce{encodeKey(e){return r4(e)}encodeValue(e){return r4(e)}decodeKey(e){return decodeURIComponent(e)}decodeValue(e){return decodeURIComponent(e)}}const Dce=/%(\d[a-f0-9])/gi,Rce={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function r4(n){return encodeURIComponent(n).replace(Dce,(e,t)=>Rce[t]??e)}function uC(n){return`${n}`}class iu{constructor(e={}){if(this.updates=null,this.cloneFrom=null,this.encoder=e.encoder||new bce,e.fromString){if(e.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Sce(n,e){const t=new Map;return n.length>0&&n.replace(/^\?/,"").split("&").forEach(i=>{const s=i.indexOf("="),[o,a]=-1==s?[e.decodeKey(i),""]:[e.decodeKey(i.slice(0,s)),e.decodeValue(i.slice(s+1))],l=t.get(o)||[];l.push(a),t.set(o,l)}),t}(e.fromString,this.encoder)}else e.fromObject?(this.map=new Map,Object.keys(e.fromObject).forEach(t=>{const r=e.fromObject[t],i=Array.isArray(r)?r.map(uC):[uC(r)];this.map.set(t,i)})):this.map=null}has(e){return this.init(),this.map.has(e)}get(e){this.init();const t=this.map.get(e);return t?t[0]:null}getAll(e){return this.init(),this.map.get(e)||null}keys(){return this.init(),Array.from(this.map.keys())}append(e,t){return this.clone({param:e,value:t,op:"a"})}appendAll(e){const t=[];return Object.keys(e).forEach(r=>{const i=e[r];Array.isArray(i)?i.forEach(s=>{t.push({param:r,value:s,op:"a"})}):t.push({param:r,value:i,op:"a"})}),this.clone(t)}set(e,t){return this.clone({param:e,value:t,op:"s"})}delete(e,t){return this.clone({param:e,value:t,op:"d"})}toString(){return this.init(),this.keys().map(e=>{const t=this.encoder.encodeKey(e);return this.map.get(e).map(r=>t+"="+this.encoder.encodeValue(r)).join("&")}).filter(e=>""!==e).join("&")}clone(e){const t=new iu({encoder:this.encoder});return t.cloneFrom=this.cloneFrom||this,t.updates=(this.updates||[]).concat(e),t}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(e=>this.map.set(e,this.cloneFrom.map.get(e))),this.updates.forEach(e=>{switch(e.op){case"a":case"s":const t=("a"===e.op?this.map.get(e.param):void 0)||[];t.push(uC(e.value)),this.map.set(e.param,t);break;case"d":if(void 0===e.value){this.map.delete(e.param);break}{let r=this.map.get(e.param)||[];const i=r.indexOf(uC(e.value));-1!==i&&r.splice(i,1),r.length>0?this.map.set(e.param,r):this.map.delete(e.param)}}}),this.cloneFrom=this.updates=null)}}class xce{constructor(){this.map=new Map}set(e,t){return this.map.set(e,t),this}get(e){return this.map.has(e)||this.map.set(e,e.defaultValue()),this.map.get(e)}delete(e){return this.map.delete(e),this}has(e){return this.map.has(e)}keys(){return this.map.keys()}}function i4(n){return typeof ArrayBuffer<"u"&&n instanceof ArrayBuffer}function s4(n){return typeof Blob<"u"&&n instanceof Blob}function o4(n){return typeof FormData<"u"&&n instanceof FormData}class __{constructor(e,t,r,i){let s;if(this.url=t,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=e.toUpperCase(),function Pce(n){switch(n){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||i?(this.body=void 0!==r?r:null,s=i):s=r,s&&(this.reportProgress=!!s.reportProgress,this.withCredentials=!!s.withCredentials,s.responseType&&(this.responseType=s.responseType),s.headers&&(this.headers=s.headers),s.context&&(this.context=s.context),s.params&&(this.params=s.params)),this.headers||(this.headers=new Xs),this.context||(this.context=new xce),this.params){const o=this.params.toString();if(0===o.length)this.urlWithParams=t;else{const a=t.indexOf("?");this.urlWithParams=t+(-1===a?"?":a<t.length-1?"&":"")+o}}else this.params=new iu,this.urlWithParams=t}serializeBody(){return null===this.body?null:i4(this.body)||s4(this.body)||o4(this.body)||function Nce(n){return typeof URLSearchParams<"u"&&n instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof iu?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||o4(this.body)?null:s4(this.body)?this.body.type||null:i4(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof iu?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(e={}){const t=e.method||this.method,r=e.url||this.url,i=e.responseType||this.responseType,s=void 0!==e.body?e.body:this.body,o=void 0!==e.withCredentials?e.withCredentials:this.withCredentials,a=void 0!==e.reportProgress?e.reportProgress:this.reportProgress;let l=e.headers||this.headers,u=e.params||this.params;const d=e.context??this.context;return void 0!==e.setHeaders&&(l=Object.keys(e.setHeaders).reduce((p,_)=>p.set(_,e.setHeaders[_]),l)),e.setParams&&(u=Object.keys(e.setParams).reduce((p,_)=>p.set(_,e.setParams[_]),u)),new __(t,r,s,{params:u,headers:l,context:d,reportProgress:a,responseType:i,withCredentials:o})}}var Mf=function(n){return n[n.Sent=0]="Sent",n[n.UploadProgress=1]="UploadProgress",n[n.ResponseHeader=2]="ResponseHeader",n[n.DownloadProgress=3]="DownloadProgress",n[n.Response=4]="Response",n[n.User=5]="User",n}(Mf||{});class iP{constructor(e,t=200,r="OK"){this.headers=e.headers||new Xs,this.status=void 0!==e.status?e.status:t,this.statusText=e.statusText||r,this.url=e.url||null,this.ok=this.status>=200&&this.status<300}}class sP extends iP{constructor(e={}){super(e),this.type=Mf.ResponseHeader}clone(e={}){return new sP({headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class kf extends iP{constructor(e={}){super(e),this.type=Mf.Response,this.body=void 0!==e.body?e.body:null}clone(e={}){return new kf({body:void 0!==e.body?e.body:this.body,headers:e.headers||this.headers,status:void 0!==e.status?e.status:this.status,statusText:e.statusText||this.statusText,url:e.url||this.url||void 0})}}class a4 extends iP{constructor(e){super(e,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${e.url||"(unknown url)"}`:`Http failure response for ${e.url||"(unknown url)"}: ${e.status} ${e.statusText}`,this.error=e.error||null}}function oP(n,e){return{body:e,headers:n.headers,context:n.context,observe:n.observe,params:n.params,reportProgress:n.reportProgress,responseType:n.responseType,withCredentials:n.withCredentials}}let aP=(()=>{class n{constructor(t){this.handler=t}request(t,r,i={}){let s;if(t instanceof __)s=t;else{let l,u;l=i.headers instanceof Xs?i.headers:new Xs(i.headers),i.params&&(u=i.params instanceof iu?i.params:new iu({fromObject:i.params})),s=new __(t,r,void 0!==i.body?i.body:null,{headers:l,context:i.context,params:u,reportProgress:i.reportProgress,responseType:i.responseType||"json",withCredentials:i.withCredentials})}const o=R(s).pipe(Mh(l=>this.handler.handle(l)));if(t instanceof __||"events"===i.observe)return o;const a=o.pipe(Ks(l=>l instanceof kf));switch(i.observe||"body"){case"body":switch(s.responseType){case"arraybuffer":return a.pipe(de(l=>{if(null!==l.body&&!(l.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return l.body}));case"blob":return a.pipe(de(l=>{if(null!==l.body&&!(l.body instanceof Blob))throw new Error("Response is not a Blob.");return l.body}));case"text":return a.pipe(de(l=>{if(null!==l.body&&"string"!=typeof l.body)throw new Error("Response is not a string.");return l.body}));default:return a.pipe(de(l=>l.body))}case"response":return a;default:throw new Error(`Unreachable: unhandled observe type ${i.observe}}`)}}delete(t,r={}){return this.request("DELETE",t,r)}get(t,r={}){return this.request("GET",t,r)}head(t,r={}){return this.request("HEAD",t,r)}jsonp(t,r){return this.request("JSONP",t,{params:(new iu).append(r,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(t,r={}){return this.request("OPTIONS",t,r)}patch(t,r,i={}){return this.request("PATCH",t,oP(i,r))}post(t,r,i={}){return this.request("POST",t,oP(i,r))}put(t,r,i={}){return this.request("PUT",t,oP(i,r))}static{this.\u0275fac=function(r){return new(r||n)(Ee(aC))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();function c4(n,e){return e(n)}function kce(n,e){return(t,r)=>e.intercept(t,{handle:i=>n(i,r)})}const Fce=new we(""),y_=new we(""),d4=new we("");function Lce(){let n=null;return(e,t)=>{null===n&&(n=(ke(Fce,{optional:!0})??[]).reduceRight(kce,c4));const r=ke(ZE),i=r.add();return n(e,t).pipe(am(()=>r.remove(i)))}}let h4=(()=>{class n extends aC{constructor(t,r){super(),this.backend=t,this.injector=r,this.chain=null,this.pendingTasks=ke(ZE)}handle(t){if(null===this.chain){const i=Array.from(new Set([...this.injector.get(y_),...this.injector.get(d4,[])]));this.chain=i.reduceRight((s,o)=>function Oce(n,e,t){return(r,i)=>t.runInContext(()=>e(r,s=>n(s,i)))}(s,o,this.injector),c4)}const r=this.pendingTasks.add();return this.chain(t,i=>this.backend.handle(i)).pipe(am(()=>this.pendingTasks.remove(r)))}static{this.\u0275fac=function(r){return new(r||n)(Ee(lC),Ee(Es))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();const jce=/^\)\]\}',?\n/;let p4=(()=>{class n{constructor(t){this.xhrFactory=t}handle(t){if("JSONP"===t.method)throw new pe(-2800,!1);const r=this.xhrFactory;return(r.\u0275loadImpl?C(r.\u0275loadImpl()):R(null)).pipe(ye(()=>new lt(s=>{const o=r.build();if(o.open(t.method,t.urlWithParams),t.withCredentials&&(o.withCredentials=!0),t.headers.forEach((D,P)=>o.setRequestHeader(D,P.join(","))),t.headers.has("Accept")||o.setRequestHeader("Accept","application/json, text/plain, */*"),!t.headers.has("Content-Type")){const D=t.detectContentTypeHeader();null!==D&&o.setRequestHeader("Content-Type",D)}if(t.responseType){const D=t.responseType.toLowerCase();o.responseType="json"!==D?D:"text"}const a=t.serializeBody();let l=null;const u=()=>{if(null!==l)return l;const D=o.statusText||"OK",P=new Xs(o.getAllResponseHeaders()),H=function $ce(n){return"responseURL"in n&&n.responseURL?n.responseURL:/^X-Request-URL:/m.test(n.getAllResponseHeaders())?n.getResponseHeader("X-Request-URL"):null}(o)||t.url;return l=new sP({headers:P,status:o.status,statusText:D,url:H}),l},d=()=>{let{headers:D,status:P,statusText:H,url:V}=u(),Y=null;204!==P&&(Y=typeof o.response>"u"?o.responseText:o.response),0===P&&(P=Y?200:0);let ae=P>=200&&P<300;if("json"===t.responseType&&"string"==typeof Y){const Te=Y;Y=Y.replace(jce,"");try{Y=""!==Y?JSON.parse(Y):null}catch($e){Y=Te,ae&&(ae=!1,Y={error:$e,text:Y})}}ae?(s.next(new kf({body:Y,headers:D,status:P,statusText:H,url:V||void 0})),s.complete()):s.error(new a4({error:Y,headers:D,status:P,statusText:H,url:V||void 0}))},p=D=>{const{url:P}=u(),H=new a4({error:D,status:o.status||0,statusText:o.statusText||"Unknown Error",url:P||void 0});s.error(H)};let _=!1;const v=D=>{_||(s.next(u()),_=!0);let P={type:Mf.DownloadProgress,loaded:D.loaded};D.lengthComputable&&(P.total=D.total),"text"===t.responseType&&o.responseText&&(P.partialText=o.responseText),s.next(P)},A=D=>{let P={type:Mf.UploadProgress,loaded:D.loaded};D.lengthComputable&&(P.total=D.total),s.next(P)};return o.addEventListener("load",d),o.addEventListener("error",p),o.addEventListener("timeout",p),o.addEventListener("abort",p),t.reportProgress&&(o.addEventListener("progress",v),null!==a&&o.upload&&o.upload.addEventListener("progress",A)),o.send(a),s.next({type:Mf.Sent}),()=>{o.removeEventListener("error",p),o.removeEventListener("abort",p),o.removeEventListener("load",d),o.removeEventListener("timeout",p),t.reportProgress&&(o.removeEventListener("progress",v),null!==a&&o.upload&&o.upload.removeEventListener("progress",A)),o.readyState!==o.DONE&&o.abort()}})))}static{this.\u0275fac=function(r){return new(r||n)(Ee(tU))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();const lP=new we("XSRF_ENABLED"),g4=new we("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),m4=new we("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class _4{}let Wce=(()=>{class n{constructor(t,r,i){this.doc=t,this.platform=r,this.cookieName=i,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const t=this.doc.cookie||"";return t!==this.lastCookieString&&(this.parseCount++,this.lastToken=W2(t,this.cookieName),this.lastCookieString=t),this.lastToken}static{this.\u0275fac=function(r){return new(r||n)(Ee(Cs),Ee(zo),Ee(g4))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac})}}return n})();function Gce(n,e){const t=n.url.toLowerCase();if(!ke(lP)||"GET"===n.method||"HEAD"===n.method||t.startsWith("http://")||t.startsWith("https://"))return e(n);const r=ke(_4).getToken(),i=ke(m4);return null!=r&&!n.headers.has(i)&&(n=n.clone({headers:n.headers.set(i,r)})),e(n)}var su=function(n){return n[n.Interceptors=0]="Interceptors",n[n.LegacyInterceptors=1]="LegacyInterceptors",n[n.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",n[n.NoXsrfProtection=3]="NoXsrfProtection",n[n.JsonpSupport=4]="JsonpSupport",n[n.RequestsMadeViaParent=5]="RequestsMadeViaParent",n[n.Fetch=6]="Fetch",n}(su||{});function $c(n,e){return{\u0275kind:n,\u0275providers:e}}function qce(...n){const e=[aP,p4,h4,{provide:aC,useExisting:h4},{provide:lC,useExisting:p4},{provide:y_,useValue:Gce,multi:!0},{provide:lP,useValue:!0},{provide:_4,useClass:Wce}];for(const t of n)e.push(...t.\u0275providers);return EE(e)}const y4=new we("LEGACY_INTERCEPTOR_FN");let Qce=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ei({type:n})}static{this.\u0275inj=pi({providers:[qce($c(su.LegacyInterceptors,[{provide:y4,useFactory:Lce},{provide:y_,useExisting:y4,multi:!0}]))]})}}return n})();const Ce=function(n,e){if(!n)throw Of(e)},Of=function(n){return new Error("Firebase Database (${JSCORE_VERSION}) INTERNAL ASSERT FAILED: "+n)},v4=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=63&i|128):55296==(64512&i)&&r+1<n.length&&56320==(64512&n.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&n.charCodeAt(++r)),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=63&i|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=63&i|128)}return e},dC={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,a=o?n[i+1]:0,l=i+2<n.length,u=l?n[i+2]:0;let _=(15&a)<<2|u>>6,v=63&u;l||(v=64,o||(_=64)),r.push(t[s>>2],t[(3&s)<<4|a>>4],t[_],t[v])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(v4(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const l=((7&i)<<18|(63&n[t++])<<12|(63&n[t++])<<6|63&n[t++])-65536;e[r++]=String.fromCharCode(55296+(l>>10)),e[r++]=String.fromCharCode(56320+(1023&l))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return e.join("")}(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],a=i<n.length?t[n.charAt(i)]:0;++i;const u=i<n.length?t[n.charAt(i)]:64;++i;const p=i<n.length?t[n.charAt(i)]:64;if(++i,null==s||null==a||null==u||null==p)throw new nde;r.push(s<<2|a>>4),64!==u&&(r.push(a<<4&240|u>>2),64!==p&&r.push(u<<6&192|p))}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class nde extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const E4=function(n){const e=v4(n);return dC.encodeByteArray(e,!0)},hC=function(n){return E4(n).replace(/\./g,"")},cP=function(n){try{return dC.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function rde(n){return I4(void 0,n)}function I4(n,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:return new Date(e.getTime());case Object:void 0===n&&(n={});break;case Array:n=[];break;default:return e}for(const t in e)!e.hasOwnProperty(t)||!ide(t)||(n[t]=I4(n[t],e[t]));return n}function ide(n){return"__proto__"!==n}function w4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const fC=()=>{try{return w4().__FIREBASE_DEFAULTS__||(()=>{if(typeof process>"u"||typeof process.env>"u")return;const n=process.env.__FIREBASE_DEFAULTS__;return n?JSON.parse(n):void 0})()||(()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&cP(n[1]);return e&&JSON.parse(e)})()}catch(n){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`)}},C4=()=>{var n;return null===(n=fC())||void 0===n?void 0:n.config};class ou{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function T4(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(function pC(){return typeof navigator<"u"&&"string"==typeof navigator.userAgent?navigator.userAgent:""}())}function dP(){try{return"object"==typeof indexedDB}catch{return!1}}class v_ extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name="FirebaseError",Object.setPrototypeOf(this,v_.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,hP.prototype.create)}}class hP{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?function mde(n,e){return n.replace(_de,(t,r)=>{const i=e[r];return null!=i?String(i):`<${r}?>`})}(s,r):"Error";return new v_(i,`${this.serviceName}: ${o} (${i}).`,r)}}const _de=/\{\$([^}]+)}/g;function E_(n){return JSON.parse(n)}function Fr(n){return JSON.stringify(n)}const gC=function(n){let e={},t={},r={},i="";try{const s=n.split(".");e=E_(cP(s[0])||""),t=E_(cP(s[1])||""),i=s[2],r=t.d||{},delete t.d}catch{}return{header:e,claims:t,data:r,signature:i}};function aa(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function Ff(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]}function A4(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function mC(n,e,t){const r={};for(const i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=e.call(t,n[i],i,n));return r}function fP(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(b4(s)&&b4(o)){if(!fP(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function b4(n){return null!==n&&"object"==typeof n}class Ide{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){t||(t=0);const r=this.W_;if("string"==typeof e)for(let p=0;p<16;p++)r[p]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let p=0;p<16;p++)r[p]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let p=16;p<80;p++){const _=r[p-3]^r[p-8]^r[p-14]^r[p-16];r[p]=4294967295&(_<<1|_>>>31)}let u,d,i=this.chain_[0],s=this.chain_[1],o=this.chain_[2],a=this.chain_[3],l=this.chain_[4];for(let p=0;p<80;p++){p<40?p<20?(u=a^s&(o^a),d=1518500249):(u=s^o^a,d=1859775393):p<60?(u=s&o|a&(s|o),d=2400959708):(u=s^o^a,d=3395469782);const _=(i<<5|i>>>27)+u+l+d+r[p]&4294967295;l=a,a=o,o=4294967295&(s<<30|s>>>2),s=i,i=_}this.chain_[0]=this.chain_[0]+i&4294967295,this.chain_[1]=this.chain_[1]+s&4294967295,this.chain_[2]=this.chain_[2]+o&4294967295,this.chain_[3]=this.chain_[3]+a&4294967295,this.chain_[4]=this.chain_[4]+l&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);const r=t-this.blockSize;let i=0;const s=this.buf_;let o=this.inbuf_;for(;i<t;){if(0===o)for(;i<=r;)this.compress_(e,i),i+=this.blockSize;if("string"==typeof e){for(;i<t;)if(s[o]=e.charCodeAt(i),++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}else for(;i<t;)if(s[o]=e[i],++o,++i,o===this.blockSize){this.compress_(s),o=0;break}}this.inbuf_=o,this.total_+=t}digest(){const e=[];let t=8*this.total_;this.update(this.pad_,this.inbuf_<56?56-this.inbuf_:this.blockSize-(this.inbuf_-56));for(let i=this.blockSize-1;i>=56;i--)this.buf_[i]=255&t,t/=256;this.compress_(this.buf_);let r=0;for(let i=0;i<5;i++)for(let s=24;s>=0;s-=8)e[r]=this.chain_[i]>>s&255,++r;return e}}function Lf(n,e){return`${n} failed: ${e} argument `}const _C=function(n){let e=0;for(let t=0;t<n.length;t++){const r=n.charCodeAt(t);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,t++):e+=3}return e},Ade=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{const e=16*Math.random()|0;return("x"===n?e:3&e|8).toString(16)})};function Vf(n){return n&&n._delegate?n._delegate:n}class Hc{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const zc="[DEFAULT]";class Nde{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new ou;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e?.identifier),i=null!==(t=e?.optional)&&void 0!==t&&t;if(!this.isInitialized(r)&&!this.shouldAutoInitialize()){if(i)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function kde(n){return"EAGER"===n.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:zc})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=zc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}delete(){var e=this;return(0,Z.A)(function*(){const t=Array.from(e.instances.values());yield Promise.all([...t.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...t.filter(r=>"_delete"in r).map(r=>r._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(e=zc){return this.instances.has(e)}getOptions(e=zc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(s)&&o.resolve(i);return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=null!==(r=this.onInitCallbacks.get(i))&&void 0!==r?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(n=e,n===zc?void 0:n),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}var n;return r||null}normalizeInstanceIdentifier(e=zc){return this.component?this.component.multipleInstances?e:zc:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Ode{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new Nde(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const gP=[];var Rn=function(n){return n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT",n}(Rn||{});const S4={debug:Rn.DEBUG,verbose:Rn.VERBOSE,info:Rn.INFO,warn:Rn.WARN,error:Rn.ERROR,silent:Rn.SILENT},Fde=Rn.INFO,Lde={[Rn.DEBUG]:"log",[Rn.VERBOSE]:"log",[Rn.INFO]:"info",[Rn.WARN]:"warn",[Rn.ERROR]:"error"},Vde=(n,e,...t)=>{if(e<n.logLevel)return;const r=(new Date).toISOString(),i=Lde[e];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`);console[i](`[${r}]  ${n.name}:`,...t)};class mP{constructor(e){this.name=e,this._logLevel=Fde,this._logHandler=Vde,this._userLogHandler=null,gP.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Rn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?S4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Rn.DEBUG,...e),this._logHandler(this,Rn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Rn.VERBOSE,...e),this._logHandler(this,Rn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Rn.INFO,...e),this._logHandler(this,Rn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Rn.WARN,...e),this._logHandler(this,Rn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Rn.ERROR,...e),this._logHandler(this,Rn.ERROR,...e)}}var Ude=Ge(749);class Bde{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(function jde(n){const e=n.getComponent();return"VERSION"===e?.type}(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}return null}).filter(t=>t).join(" ")}}const yC="@firebase/app",_P="0.10.17",el=new mP("@firebase/app"),vC="[DEFAULT]",ghe={[yC]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},Wc=new Map,I_=new Map,w_=new Map;function D4(n,e){try{n.container.addComponent(e)}catch(t){el.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Uf(n){const e=n.name;if(w_.has(e))return el.debug(`There were multiple attempts to register component ${e}.`),!1;w_.set(e,n);for(const t of Wc.values())D4(t,n);for(const t of I_.values())D4(t,n);return!0}function EC(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}const Zs=new hP("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class R4{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Hc("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zs.create("app-deleted",{appName:this._name})}}function x4(n,e={}){let t=n;"object"!=typeof e&&(e={name:e});const r=Object.assign({name:vC,automaticDataCollectionEnabled:!1},e),i=r.name;if("string"!=typeof i||!i)throw Zs.create("bad-app-name",{appName:String(i)});if(t||(t=C4()),!t)throw Zs.create("no-options");const s=Wc.get(i);if(s){if(fP(t,s.options)&&fP(r,s.config))return s;throw Zs.create("duplicate-app",{appName:i})}const o=new Ode(i);for(const l of w_.values())o.addComponent(l);const a=new R4(t,r,o);return Wc.set(i,a),a}function P4(n=vC){const e=Wc.get(n);if(!e&&n===vC&&C4())return x4();if(!e)throw Zs.create("no-app",{appName:n});return e}function au(n,e,t){var r;let i=null!==(r=ghe[n])&&void 0!==r?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const a=[`Unable to register library "${i}" with version "${e}":`];return s&&a.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&a.push("and"),o&&a.push(`version name "${e}" contains illegal characters (whitespace or "/")`),void el.warn(a.join(" "))}Uf(new Hc(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}const Ihe="firebase-heartbeat-database",whe=1,C_="firebase-heartbeat-store";let vP=null;function N4(){return vP||(vP=(0,Ude.P2)(Ihe,whe,{upgrade:(n,e)=>{if(0===e)try{n.createObjectStore(C_)}catch(t){console.warn(t)}}}).catch(n=>{throw Zs.create("idb-open",{originalErrorMessage:n.message})})),vP}function EP(){return(EP=(0,Z.A)(function*(n){try{const t=(yield N4()).transaction(C_),r=yield t.objectStore(C_).get(k4(n));return yield t.done,r}catch(e){if(e instanceof v_)el.warn(e.message);else{const t=Zs.create("idb-get",{originalErrorMessage:e?.message});el.warn(t.message)}}})).apply(this,arguments)}function M4(n,e){return IP.apply(this,arguments)}function IP(){return(IP=(0,Z.A)(function*(n,e){try{const r=(yield N4()).transaction(C_,"readwrite");yield r.objectStore(C_).put(e,k4(n)),yield r.done}catch(t){if(t instanceof v_)el.warn(t.message);else{const r=Zs.create("idb-set",{originalErrorMessage:t?.message});el.warn(r.message)}}})).apply(this,arguments)}function k4(n){return`${n.name}!${n.options.appId}`}class bhe{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Dhe(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}triggerHeartbeat(){var e=this;return(0,Z.A)(function*(){var t,r;try{const s=e.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=O4();return null==(null===(t=e._heartbeatsCache)||void 0===t?void 0:t.heartbeats)&&(e._heartbeatsCache=yield e._heartbeatsCachePromise,null==(null===(r=e._heartbeatsCache)||void 0===r?void 0:r.heartbeats))||e._heartbeatsCache.lastSentHeartbeatDate===o||e._heartbeatsCache.heartbeats.some(a=>a.date===o)?void 0:(e._heartbeatsCache.heartbeats.push({date:o,agent:s}),e._heartbeatsCache.heartbeats=e._heartbeatsCache.heartbeats.filter(a=>{const l=new Date(a.date).valueOf();return Date.now()-l<=2592e6}),e._storage.overwrite(e._heartbeatsCache))}catch(i){el.warn(i)}})()}getHeartbeatsHeader(){var e=this;return(0,Z.A)(function*(){var t;try{if(null===e._heartbeatsCache&&(yield e._heartbeatsCachePromise),null==(null===(t=e._heartbeatsCache)||void 0===t?void 0:t.heartbeats)||0===e._heartbeatsCache.heartbeats.length)return"";const r=O4(),{heartbeatsToSend:i,unsentEntries:s}=function She(n,e=1024){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),F4(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),F4(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}(e._heartbeatsCache.heartbeats),o=hC(JSON.stringify({version:2,heartbeats:i}));return e._heartbeatsCache.lastSentHeartbeatDate=r,s.length>0?(e._heartbeatsCache.heartbeats=s,yield e._storage.overwrite(e._heartbeatsCache)):(e._heartbeatsCache.heartbeats=[],e._storage.overwrite(e._heartbeatsCache)),o}catch(r){return el.warn(r),""}})()}}function O4(){return(new Date).toISOString().substring(0,10)}class Dhe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,Z.A)(function*(){return!!dP()&&function pde(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e((null===(s=i.error)||void 0===s?void 0:s.message)||"")}}catch(t){e(t)}})}().then(()=>!0).catch(()=>!1)})()}read(){var e=this;return(0,Z.A)(function*(){if(yield e._canUseIndexedDBPromise){const r=yield function Che(n){return EP.apply(this,arguments)}(e.app);return r?.heartbeats?r:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(e){var t=this;return(0,Z.A)(function*(){var r;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return M4(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}})()}add(e){var t=this;return(0,Z.A)(function*(){var r;if(yield t._canUseIndexedDBPromise){const s=yield t.read();return M4(t.app,{lastSentHeartbeatDate:null!==(r=e.lastSentHeartbeatDate)&&void 0!==r?r:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}})()}}function F4(n){return hC(JSON.stringify({version:2,heartbeats:n})).length}!function Rhe(n){Uf(new Hc("platform-logger",e=>new Bde(e),"PRIVATE")),Uf(new Hc("heartbeat",e=>new bhe(e),"PRIVATE")),au(yC,_P,n),au(yC,_P,"esm2017"),au("fire-js","")}(""),au("firebase","11.1.0","app");const wP=new Map,L4={activated:!1,tokenObservers:[]},Nhe={initialized:!1,enabled:!1};function hr(n){return wP.get(n)||Object.assign({},L4)}function IC(){return Nhe}const CP="https://content-firebaseappcheck.googleapis.com/v1",Fhe="exchangeDebugToken",V4={OFFSET_DURATION:3e5,RETRIAL_MIN_WAIT:3e4,RETRIAL_MAX_WAIT:96e4};class Vhe{constructor(e,t,r,i,s){if(this.operation=e,this.retryPolicy=t,this.getWaitDuration=r,this.lowerBound=i,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=i,i>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(e){var t=this;return(0,Z.A)(function*(){t.stop();try{t.pending=new ou,t.pending.promise.catch(r=>{}),yield function Uhe(n){return new Promise(e=>{setTimeout(e,n)})}(t.getNextRun(e)),t.pending.resolve(),yield t.pending.promise,t.pending=new ou,t.pending.promise.catch(r=>{}),yield t.operation(),t.pending.resolve(),yield t.pending.promise,t.process(!0).catch(()=>{})}catch(r){t.retryPolicy(r)?t.process(!1).catch(()=>{}):t.stop()}})()}getNextRun(e){if(e)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{const t=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),t}}}const ci=new hP("appCheck","AppCheck",{"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"});function wC(n=!1){var e;return n?null===(e=self.grecaptcha)||void 0===e?void 0:e.enterprise:self.grecaptcha}function TP(n){if(!hr(n).activated)throw ci.create("use-before-activation",{appName:n.name})}function AP(n){const e=Math.round(n/1e3),t=Math.floor(e/86400),r=Math.floor((e-3600*t*24)/3600),i=Math.floor((e-3600*t*24-3600*r)/60),s=e-3600*t*24-3600*r-60*i;let o="";return t&&(o+=CC(t)+"d:"),r&&(o+=CC(r)+"h:"),o+=CC(i)+"m:"+CC(s)+"s",o}function CC(n){return 0===n?"00":n>=10?n.toString():"0"+n}function TC(n,e){return bP.apply(this,arguments)}function bP(){return(bP=(0,Z.A)(function*({url:n,body:e},t){const r={"Content-Type":"application/json"},i=t.getImmediate({optional:!0});if(i){const p=yield i.getHeartbeatsHeader();p&&(r["X-Firebase-Client"]=p)}const s={method:"POST",body:JSON.stringify(e),headers:r};let o,a;try{o=yield fetch(n,s)}catch(p){throw ci.create("fetch-network-error",{originalErrorMessage:p?.message})}if(200!==o.status)throw ci.create("fetch-status-error",{httpStatus:o.status});try{a=yield o.json()}catch(p){throw ci.create("fetch-parse-error",{originalErrorMessage:p?.message})}const l=a.ttl.match(/^([\d.]+)(s)$/);if(!l||!l[2]||isNaN(Number(l[1])))throw ci.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${a.ttl}`});const u=1e3*Number(l[1]),d=Date.now();return{token:a.token,expireTimeMillis:d+u,issuedAtTimeMillis:d}})).apply(this,arguments)}function U4(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${CP}/projects/${t}/apps/${r}:${Fhe}?key=${i}`,body:{debug_token:e}}}const Hhe="firebase-app-check-database",zhe=1,T_="firebase-app-check-store",B4="debug-token";let AC=null;function j4(){return AC||(AC=new Promise((n,e)=>{try{const t=indexedDB.open(Hhe,zhe);t.onsuccess=r=>{n(r.target.result)},t.onerror=r=>{var i;e(ci.create("storage-open",{originalErrorMessage:null===(i=r.target.error)||void 0===i?void 0:i.message}))},t.onupgradeneeded=r=>{0===r.oldVersion&&r.target.result.createObjectStore(T_,{keyPath:"compositeKey"})}}catch(t){e(ci.create("storage-open",{originalErrorMessage:t?.message}))}}),AC)}function $4(n,e){return SP.apply(this,arguments)}function SP(){return(SP=(0,Z.A)(function*(n,e){const r=(yield j4()).transaction(T_,"readwrite"),s=r.objectStore(T_).put({compositeKey:n,value:e});return new Promise((o,a)=>{s.onsuccess=l=>{o()},r.onerror=l=>{var u;a(ci.create("storage-set",{originalErrorMessage:null===(u=l.target.error)||void 0===u?void 0:u.message}))}})})).apply(this,arguments)}function H4(n){return DP.apply(this,arguments)}function DP(){return(DP=(0,Z.A)(function*(n){const t=(yield j4()).transaction(T_,"readonly"),i=t.objectStore(T_).get(n);return new Promise((s,o)=>{i.onsuccess=a=>{const l=a.target.result;s(l?l.value:void 0)},t.onerror=a=>{var l;o(ci.create("storage-get",{originalErrorMessage:null===(l=a.target.error)||void 0===l?void 0:l.message}))}})})).apply(this,arguments)}function z4(n){return`${n.options.appId}-${n.name}`}const A_=new mP("@firebase/app-check");function RP(){return(RP=(0,Z.A)(function*(n){if(dP()){let e;try{e=yield function Whe(n){return H4(z4(n))}(n)}catch(t){A_.warn(`Failed to read token from IndexedDB. Error: ${t}`)}return e}})).apply(this,arguments)}function xP(n,e){return dP()?function Ghe(n,e){return $4(z4(n),e)}(n,e).catch(t=>{A_.warn(`Failed to write token to IndexedDB. Error: ${t}`)}):Promise.resolve()}function PP(){return(PP=(0,Z.A)(function*(){let n;try{n=yield function Khe(){return H4(B4)}()}catch{}if(n)return n;{const e=Ade();return function qhe(n){return $4(B4,n)}(e).catch(t=>A_.warn(`Failed to persist debug token to IndexedDB. Error: ${t}`)),e}})).apply(this,arguments)}function NP(){return IC().enabled}function MP(){return kP.apply(this,arguments)}function kP(){return(kP=(0,Z.A)(function*(){const n=IC();if(n.enabled&&n.token)return n.token.promise;throw Error("\n            Can't get debug token in production mode.\n        ")})).apply(this,arguments)}const Xhe={error:"UNKNOWN_ERROR"};function Zhe(n){return dC.encodeString(JSON.stringify(n),!1)}function bC(n){return OP.apply(this,arguments)}function OP(){return(OP=(0,Z.A)(function*(n,e=!1){const t=n.app;TP(t);const r=hr(t);let s,i=r.token;if(i&&!Bf(i)&&(r.token=void 0,i=void 0),!i){const l=yield r.cachedTokenPromise;l&&(Bf(l)?i=l:yield xP(t,void 0))}if(!e&&i&&Bf(i))return{token:i.token};let a,o=!1;if(NP()){r.exchangeTokenPromise||(r.exchangeTokenPromise=TC(U4(t,yield MP()),n.heartbeatServiceProvider).finally(()=>{r.exchangeTokenPromise=void 0}),o=!0);const l=yield r.exchangeTokenPromise;return yield xP(t,l),r.token=l,{token:l.token}}try{r.exchangeTokenPromise||(r.exchangeTokenPromise=r.provider.getToken().finally(()=>{r.exchangeTokenPromise=void 0}),o=!0),i=yield hr(t).exchangeTokenPromise}catch(l){"appCheck/throttled"===l.code?A_.warn(l.message):A_.error(l),s=l}return i?s?a=Bf(i)?{token:i.token,internalError:s}:K4(s):(a={token:i.token},r.token=i,yield xP(t,i)):a=K4(s),o&&q4(t,a),a})).apply(this,arguments)}function W4(n){return FP.apply(this,arguments)}function FP(){return(FP=(0,Z.A)(function*(n){const e=n.app;TP(e);const{provider:t}=hr(e);if(NP()){const r=yield MP(),{token:i}=yield TC(U4(e,r),n.heartbeatServiceProvider);return{token:i}}{const{token:r}=yield t.getToken();return{token:r}}})).apply(this,arguments)}function LP(n,e,t,r){const{app:i}=n,s=hr(i);if(s.tokenObservers=[...s.tokenObservers,{next:t,error:r,type:e}],s.token&&Bf(s.token)){const a=s.token;Promise.resolve().then(()=>{t({token:a.token}),G4(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>G4(n))}function VP(n,e){const t=hr(n),r=t.tokenObservers.filter(i=>i.next!==e);0===r.length&&t.tokenRefresher&&t.tokenRefresher.isRunning()&&t.tokenRefresher.stop(),t.tokenObservers=r}function G4(n){const{app:e}=n,t=hr(e);let r=t.tokenRefresher;r||(r=function efe(n){const{app:e}=n;return new Vhe((0,Z.A)(function*(){let r;if(r=hr(e).token?yield bC(n,!0):yield bC(n),r.error)throw r.error;if(r.internalError)throw r.internalError}),()=>!0,()=>{const t=hr(e);if(t.token){let r=t.token.issuedAtTimeMillis+.5*(t.token.expireTimeMillis-t.token.issuedAtTimeMillis)+3e5;return r=Math.min(r,t.token.expireTimeMillis-3e5),Math.max(0,r-Date.now())}return 0},V4.RETRIAL_MIN_WAIT,V4.RETRIAL_MAX_WAIT)}(n),t.tokenRefresher=r),!r.isRunning()&&t.isTokenAutoRefreshEnabled&&r.start()}function q4(n,e){const t=hr(n).tokenObservers;for(const r of t)try{"EXTERNAL"===r.type&&null!=e.error?r.error(e.error):r.next(e)}catch{}}function Bf(n){return n.expireTimeMillis-Date.now()>0}function K4(n){return{token:Zhe(Xhe),error:n}}class tfe{constructor(e,t){this.app=e,this.heartbeatServiceProvider=t}_delete(){const{tokenObservers:e}=hr(this.app);for(const t of e)VP(this.app,t.next);return Promise.resolve()}}function lfe(n,e){const t=new ou;hr(n).reCAPTCHAState={initialized:t};const i=function Q4(n){const e=`fire_app_check_${n.name}`,t=document.createElement("div");return t.id=e,t.style.display="none",document.body.appendChild(t),e}(n),s=wC(!1);return s?SC(n,e,s,i,t):function dfe(n){const e=document.createElement("script");e.src="https://www.google.com/recaptcha/api.js",e.onload=n,document.head.appendChild(e)}(()=>{const o=wC(!1);if(!o)throw new Error("no recaptcha");SC(n,e,o,i,t)}),t.promise}function SC(n,e,t,r,i){t.ready(()=>{(function cfe(n,e,t,r){const i=t.render(r,{sitekey:e,size:"invisible",callback:()=>{hr(n).reCAPTCHAState.succeeded=!0},"error-callback":()=>{hr(n).reCAPTCHAState.succeeded=!1}}),s=hr(n);s.reCAPTCHAState=Object.assign(Object.assign({},s.reCAPTCHAState),{widgetId:i})})(n,e,t,r),i.resolve(t)})}function Y4(n){return UP.apply(this,arguments)}function UP(){return(UP=(0,Z.A)(function*(n){TP(n);const t=yield hr(n).reCAPTCHAState.initialized.promise;return new Promise((r,i)=>{const s=hr(n).reCAPTCHAState;t.ready(()=>{r(t.execute(s.widgetId,{action:"fire_app_check"}))})})})).apply(this,arguments)}class BP{constructor(e){this._siteKey=e,this._throttleData=null}getToken(){var e=this;return(0,Z.A)(function*(){var t,r,i;!function eG(n){if(n&&Date.now()-n.allowRequestsAfter<=0)throw ci.create("throttled",{time:AP(n.allowRequestsAfter-Date.now()),httpStatus:n.httpStatus})}(e._throttleData);const s=yield Y4(e._app).catch(a=>{throw ci.create("recaptcha-error")});if(null===(t=hr(e._app).reCAPTCHAState)||void 0===t||!t.succeeded)throw ci.create("recaptcha-error");let o;try{o=yield TC(function jhe(n,e){const{projectId:t,appId:r,apiKey:i}=n.options;return{url:`${CP}/projects/${t}/apps/${r}:exchangeRecaptchaV3Token?key=${i}`,body:{recaptcha_v3_token:e}}}(e._app,s),e._heartbeatServiceProvider)}catch(a){throw null!==(r=a.code)&&void 0!==r&&r.includes("fetch-status-error")?(e._throttleData=function Z4(n,e){if(404===n||403===n)return{backoffCount:1,allowRequestsAfter:Date.now()+864e5,httpStatus:n};{const t=e?e.backoffCount:0,r=function xde(n,e=1e3,t=2){const r=e*Math.pow(t,n),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}(t,1e3,2);return{backoffCount:t+1,allowRequestsAfter:Date.now()+r,httpStatus:n}}}(Number(null===(i=a.customData)||void 0===i?void 0:i.httpStatus),e._throttleData),ci.create("throttled",{time:AP(e._throttleData.allowRequestsAfter-Date.now()),httpStatus:e._throttleData.httpStatus})):a}return e._throttleData=null,o})()}initialize(e){this._app=e,this._heartbeatServiceProvider=EC(e,"heartbeat"),lfe(e,this._siteKey).catch(()=>{})}isEqual(e){return e instanceof BP&&this._siteKey===e._siteKey}}function ffe(n=P4(),e){const t=EC(n=Vf(n),"app-check");if(IC().initialized||function Jhe(){const n=w4(),e=IC();if(e.initialized=!0,"string"!=typeof n.FIREBASE_APPCHECK_DEBUG_TOKEN&&!0!==n.FIREBASE_APPCHECK_DEBUG_TOKEN)return;e.enabled=!0;const t=new ou;e.token=t,t.resolve("string"==typeof n.FIREBASE_APPCHECK_DEBUG_TOKEN?n.FIREBASE_APPCHECK_DEBUG_TOKEN:function Yhe(){return PP.apply(this,arguments)}())}(),NP()&&MP().then(i=>console.log(`App Check debug token: ${i}. You will need to add it to your app's App Check settings in the Firebase console for it to work.`)),t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(s.isTokenAutoRefreshEnabled===e.isTokenAutoRefreshEnabled&&s.provider.isEqual(e.provider))return i;throw ci.create("already-initialized",{appName:n.name})}const r=t.initialize({options:e});return function pfe(n,e,t){const r=function Mhe(n,e){return wP.set(n,e),wP.get(n)}(n,Object.assign({},L4));r.activated=!0,r.provider=e,r.cachedTokenPromise=function Qhe(n){return RP.apply(this,arguments)}(n).then(i=>(i&&Bf(i)&&(r.token=i,q4(n,{token:i.token})),i)),r.isTokenAutoRefreshEnabled=void 0===t?n.automaticDataCollectionEnabled:t,r.provider.initialize(n)}(n,e.provider,e.isTokenAutoRefreshEnabled),hr(n).isTokenAutoRefreshEnabled&&LP(r,"INTERNAL",()=>{}),r}function jP(){return(jP=(0,Z.A)(function*(n,e){const t=yield bC(n,e);if(t.error)throw t.error;return{token:t.token}})).apply(this,arguments)}const tG="app-check-internal";!function _fe(){Uf(new Hc("app-check",n=>function nfe(n,e){return new tfe(n,e)}(n.getProvider("app").getImmediate(),n.getProvider("heartbeat")),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,e,t)=>{n.getProvider(tG).initialize()})),Uf(new Hc(tG,n=>function rfe(n){return{getToken:e=>bC(n,e),getLimitedUseToken:()=>W4(n),addTokenListener:e=>LP(n,"INTERNAL",e),removeTokenListener:e=>VP(n.app,e)}}(n.getProvider("app-check").getImmediate()),"PUBLIC").setInstantiationMode("EXPLICIT")),au("@firebase/app-check","0.8.10")}();class nG{constructor(){return(0,zi.getApps)()}}Ge(443);class iG{constructor(){return sD("auth")}}const sG="@firebase/database";let WP="";class bfe{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,B.As)(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,B.$L)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class Sfe{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,B.gR)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const lG=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new bfe(e)}}catch{}return new Sfe},Gc=lG("localStorage"),GP=lG("sessionStorage"),jf=new Ys.Vy("@firebase/database"),uG=function(){let n=1;return function(){return n++}}(),cG=function(n){const e=(0,B.kj)(n),t=new B.gz;t.update(e);const r=t.digest();return B.K3.encodeByteArray(r)},S_=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=S_.apply(null,r):e+="object"==typeof r?(0,B.As)(r):r,e+=" "}return e};let qc=null,dG=!0;const Kr=function(...n){if(!0===dG&&(dG=!1,null===qc&&!0===GP.get("logging_enabled")&&function(n,e){(0,B.vA)(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(jf.logLevel=Ys.$b.VERBOSE,qc=jf.log.bind(jf),e&&GP.set("logging_enabled",!0)):"function"==typeof n?qc=n:(qc=null,GP.remove("logging_enabled"))}(!0)),qc){const e=S_.apply(null,n);qc(e)}},D_=function(n){return function(...e){Kr(n,...e)}},qP=function(...n){const e="FIREBASE INTERNAL ERROR: "+S_(...n);jf.error(e)},la=function(...n){const e=`FIREBASE FATAL ERROR: ${S_(...n)}`;throw jf.error(e),new Error(e)},bi=function(...n){const e="FIREBASE WARNING: "+S_(...n);jf.warn(e)},DC=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},lu="[MIN_NAME]",tl="[MAX_NAME]",Kc=function(n,e){if(n===e)return 0;if(n===lu||e===tl)return-1;if(e===lu||n===tl)return 1;{const t=gG(n),r=gG(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},xfe=function(n,e){return n===e?0:n<e?-1:1},R_=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+(0,B.As)(e))},KP=function(n){if("object"!=typeof n||null===n)return(0,B.As)(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=(0,B.As)(e[r]),t+=":",t+=KP(n[e[r]]);return t+="}",t},fG=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Qr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const pG=function(n){(0,B.vA)(!DC(n),"Invalid JSON number");const r=1023;let i,s,o,a,l;0===n?(s=0,o=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,52-a)-Math.pow(2,52))):(s=0,o=Math.round(n/Math.pow(2,-1074))));const u=[];for(l=52;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=11;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();const d=u.join("");let p="";for(l=0;l<64;l+=8){let _=parseInt(d.substr(l,8),2).toString(16);1===_.length&&(_="0"+_),p+=_}return p.toLowerCase()},kfe=new RegExp("^-?(0*)\\d{1,10}$"),gG=function(n){if(kfe.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},$f=function(n){try{n()}catch(e){setTimeout(()=>{throw bi("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},x_=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class Vfe{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){bi(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class Ufe{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Kr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',bi(e)}}let P_=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const EG=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,CG="websocket",TG="long_polling";class YP{constructor(e,t,r,i,s=!1,o="",a=!1,l=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Gc.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Gc.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function AG(n,e,t){let r;if((0,B.vA)("string"==typeof e,"typeof type must == string"),(0,B.vA)("object"==typeof t,"typeof params must == object"),e===CG)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==TG)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function Bfe(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Qr(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}class jfe{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,B.gR)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,B.A4)(this.counters_)}}const JP={},XP={};function ZP(n){const e=n.toString();return JP[e]||(JP[e]=new jfe),JP[e]}class Hfe{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&$f(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class uu{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=D_(e),this.stats_=ZP(t),this.urlFn=l=>(this.appCheckToken&&(l.ac=this.appCheckToken),AG(t,TG,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Hfe(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if((0,B.$g)()||"complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new eN((...s)=>{const[o,a,l,u,d]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=l;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&EG.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){uu.forceAllow_=!0}static forceDisallow(){uu.forceDisallow_=!0}static isAvailable(){return!((0,B.$g)()||!uu.forceAllow_&&(uu.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=(0,B.As)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=(0,B.KA)(t),i=fG(r,1840);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,B.$g)())return;this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=(0,B.As)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class eN{constructor(e,t,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,B.$g)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=uG(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=eN.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Kr("frame writing exception"),a.stack&&Kr(a.stack),Kr(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Kr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const o=this.pendingSegs.shift();r=r+"&seg"+i+"="+o.seg+"&ts"+i+"="+o.ts+"&d"+i+"="+o.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){(0,B.$g)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Kr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let xC=null;typeof MozWebSocket<"u"?xC=MozWebSocket:typeof WebSocket<"u"&&(xC=WebSocket);let Hf=(()=>{class n{constructor(t,r,i,s,o,a,l){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=D_(this.connId),this.stats_=ZP(r),this.connURL=n.connectionURL_(r,a,l,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){const a={v:"5"};return!(0,B.$g)()&&typeof location<"u"&&location.hostname&&EG.test(location.hostname)&&(a.r="f"),r&&(a.s=r),i&&(a.ls=i),s&&(a.ac=s),o&&(a.p=o),AG(t,CG,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Gc.set("previous_websocket_failure",!0);try{let i;if((0,B.$g)()){i={headers:{"User-Agent":`Firebase/5/${WP}/${process.platform}/${this.nodeAdmin?"AdminNode":"Node"}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(i.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(i.headers["X-Firebase-AppCheck"]=this.appCheckToken);const o=process.env,a=0===this.connURL.indexOf("wss://")?o.HTTPS_PROXY||o.https_proxy:o.HTTP_PROXY||o.http_proxy;a&&(i.proxy={origin:a})}this.mySock=new xC(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==xC&&!n.forceDisallow_}static previouslyFailed(){return Gc.isInMemoryStorage||!0===Gc.get("previous_websocket_failure")}markConnectionHealthy(){Gc.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=(0,B.$L)(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if((0,B.vA)(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=(0,B.As)(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=fG(r,16384);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),NG=(()=>{class n{constructor(t){this.initTransports_(t)}static get ALL_TRANSPORTS(){return[uu,Hf]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(t){const r=Hf&&Hf.isAvailable();let i=r&&!Hf.previouslyFailed();if(t.webSocketOnly&&(r||bi("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[Hf];else{const s=this.transports_=[];for(const o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class UG{constructor(e,t,r,i,s,o,a,l,u,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=D_("c:"+this.id+":"),this.transportManager_=new NG(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=x_(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=R_("t",e),r=R_("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=R_("t",e),r=R_("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=R_("t",e);if("d"in e){const r=e.d;if("h"===t){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?qP("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):qP("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&bi("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),x_(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):x_(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Gc.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class BG{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class jG{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,B.vA)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context))return void i.splice(s,1)}validateEventType_(e){(0,B.vA)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class PC extends jG{constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!(0,B.jZ)()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new PC}getInitialEvent(e){return(0,B.vA)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class nn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function Gt(){return new nn("")}function Et(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function cu(n){return n.pieces_.length-n.pieceNum_}function En(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new nn(n.pieces_,e)}function nN(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function N_(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function zG(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new nn(e,0)}function Zn(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof nn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new nn(t,0)}function It(n){return n.pieceNum_>=n.pieces_.length}function Ki(n,e){const t=Et(n),r=Et(e);if(null===t)return e;if(t===r)return Ki(En(n),En(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function rN(n,e){if(cu(n)!==cu(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function eo(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(cu(n)>cu(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class hpe{constructor(e,t){this.errorPrefix_=t,this.parts_=N_(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=(0,B.OE)(this.parts_[r]);WG(this)}}function WG(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+Qc(n))}function Qc(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class iN extends jG{constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}static getInstance(){return new iN}getInitialEvent(e){return(0,B.vA)("visible"===e,"Unknown event type: "+e),[this.visible_]}}const M_=1e3;let MC,Yc=(()=>{class n extends BG{constructor(t,r,i,s,o,a,l,u){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=D_("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=M_,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u&&!(0,B.$g)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");iN.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&PC.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_((0,B.As)(o)),(0,B.vA)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();const r=new B.cY,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{const l=a.d;"ok"===a.s?r.resolve(l):r.reject(l)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,s){this.initConnection_();const o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),(0,B.vA)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,B.vA)(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i};t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest("q",o,l=>{const u=l.d,d=l.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",l),"ok"!==d&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,u))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&(0,B.gR)(t,"w")){const i=(0,B.yw)(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();bi(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||(0,B.qc)(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=(0,B.Cv)(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{const o=s.s,a=s.d||"error";this.authToken_===t&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),(0,B.vA)(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);const o={p:t};s&&(o.q=i,o.t=s),this.sendRequest("n",o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){const o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();const a={p:r,d:i};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+(0,B.As)(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):qP("Unrecognized action received from server: "+(0,B.As)(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){(0,B.vA)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=M_,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=M_,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=M_),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,Z.A)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),s=t.onRealtimeDisconnect_.bind(t),o=t.id+":"+n.nextConnectionId_++,a=t.lastSessionId;let l=!1,u=null;const d=function(){u?u.close():(l=!0,s())};t.realtime_={close:d,sendRequest:function(v){(0,B.vA)(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(v)}};const _=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[v,A]=yield Promise.all([t.authTokenProvider_.getToken(_),t.appCheckTokenProvider_.getToken(_)]);l?Kr("getToken() completed but was canceled"):(Kr("getToken() completed. Creating connection."),t.authToken_=v&&v.accessToken,t.appCheckToken_=A&&A.token,u=new UG(o,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,s,D=>{bi(D+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},a))}catch(v){t.log_("Failed to get token: "+v),l||(t.repoInfo_.nodeAdmin&&bi(v),d())}}})()}interrupt(t){Kr("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Kr("Resuming connection for reason: "+t),delete this.interruptReasons_[t],(0,B.Im)(this.interruptReasons_)&&(this.reconnectDelay_=M_,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(o=>KP(o)).join("$"):"default";const s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){const i=new nn(t).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(r),o.delete(r),0===o.size&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Kr("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Kr("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";(0,B.$g)()&&(r=this.repoInfo_.nodeAdmin?"admin_node":"node"),t["sdk."+r+"."+WP.replace(/\./g,"-")]=1,(0,B.jZ)()?t["framework.cordova"]=1:(0,B.lV)()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=PC.getInstance().currentlyOnline();return(0,B.Im)(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class xt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new xt(e,t)}}class NC{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new xt(lu,e),i=new xt(lu,t);return 0!==this.compare(r,i)}minPost(){return xt.MIN}}class KG extends NC{static get __EMPTY_NODE(){return MC}static set __EMPTY_NODE(e){MC=e}compare(e,t){return Kc(e.name,t.name)}isDefinedOn(e){throw(0,B.Hk)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return xt.MIN}maxPost(){return new xt(tl,MC)}makePost(e,t){return(0,B.vA)("string"==typeof e,"KeyIndex indexValue must always be a string."),new xt(e,MC)}toString(){return".key"}}const ua=new KG;class kC{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,i&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let oN,wo=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??cs.EMPTY_NODE,this.right=o??cs.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this;const o=i(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,r,i),null):0===o?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return cs.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return cs.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class cs{constructor(e,t=cs.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new cs(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,wo.BLACK,null,null))}remove(e){return new cs(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,wo.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new kC(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new kC(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new kC(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new kC(this.root_,null,this.comparator_,!0,e)}}function Epe(n,e){return Kc(n.name,e.name)}function sN(n,e){return Kc(n,e)}cs.EMPTY_NODE=new class vpe{copy(e,t,r,i,s){return this}insert(e,t,r){return new wo(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const QG=function(n){return"number"==typeof n?"number:"+pG(n):"string:"+n},YG=function(n){if(n.isLeafNode()){const e=n.val();(0,B.vA)("string"==typeof e||"number"==typeof e||"object"==typeof e&&(0,B.gR)(e,".sv"),"Priority must be a string or number.")}else(0,B.vA)(n===oN||n.isEmpty(),"priority of unexpected type.");(0,B.vA)(n===oN||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let JG,XG,ZG,zf=(()=>{class n{constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,(0,B.vA)(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),YG(this.priorityNode_)}static set __childrenNodeConstructor(t){JG=t}static get __childrenNodeConstructor(){return JG}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return It(t)?this:".priority"===Et(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=Et(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:((0,B.vA)(".priority"!==i||1===cu(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(En(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+QG(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?pG(this.value_):this.value_,this.lazyHash_=cG(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:((0,B.vA)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return(0,B.vA)(s>=0,"Unknown leaf type: "+r),(0,B.vA)(o>=0,"Unknown leaf type: "+i),s===o?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const xn=new class Tpe extends NC{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return 0===s?Kc(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return xt.MIN}maxPost(){return new xt(tl,new zf("[PRIORITY-POST]",ZG))}makePost(e,t){const r=XG(e);return new xt(t,new zf("[PRIORITY-POST]",r))}toString(){return".priority"}},Ape=Math.log(2);class bpe{constructor(e){this.count=parseInt(Math.log(e+1)/Ape,10),this.current_=this.count-1;const i=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const OC=function(n,e,t,r){n.sort(e);const i=function(l,u){const d=u-l;let p,_;if(0===d)return null;if(1===d)return p=n[l],_=t?t(p):p,new wo(_,p.node,wo.BLACK,null,null);{const v=parseInt(d/2,10)+l,A=i(l,v),D=i(v+1,u);return p=n[v],_=t?t(p):p,new wo(_,p.node,wo.BLACK,A,D)}},a=function(l){let u=null,d=null,p=n.length;const _=function(A,D){const P=p-A,H=p;p-=A;const V=i(P+1,H),Y=n[P],ae=t?t(Y):Y;v(new wo(ae,Y.node,D,null,V))},v=function(A){u?(u.left=A,u=A):(d=A,u=A)};for(let A=0;A<l.count;++A){const D=l.nextBitIsOne(),P=Math.pow(2,l.count-(A+1));D?_(P,wo.BLACK):(_(P,wo.BLACK),_(P,wo.RED))}return d}(new bpe(n.length));return new cs(r||e,a)};let aN;const Wf={};class nl{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,B.vA)(Wf&&xn,"ChildrenNode.ts has not been loaded"),aN=aN||new nl({".priority":Wf},{".priority":xn}),aN}get(e){const t=(0,B.yw)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof cs?t:null}hasIndex(e){return(0,B.gR)(this.indexSet_,e.toString())}addIndex(e,t){(0,B.vA)(e!==ua,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(xt.Wrap);let a,o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();a=i?OC(r,e.getCompare()):Wf;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const d=Object.assign({},this.indexes_);return d[l]=a,new nl(d,u)}addToIndexes(e,t){const r=(0,B.kH)(this.indexes_,(i,s)=>{const o=(0,B.yw)(this.indexSet_,s);if((0,B.vA)(o,"Missing index implementation for "+s),i===Wf){if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(xt.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),OC(a,o.getCompare())}return Wf}{const a=t.get(e.name);let l=i;return a&&(l=l.remove(new xt(e.name,a))),l.insert(e,e.node)}});return new nl(r,this.indexSet_)}removeFromIndexes(e,t){const r=(0,B.kH)(this.indexes_,i=>{if(i===Wf)return i;{const s=t.get(e.name);return s?i.remove(new xt(e.name,s)):i}});return new nl(r,this.indexSet_)}}let k_,ct=(()=>{class n{constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&YG(this.priorityNode_),this.children_.isEmpty()&&(0,B.vA)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return k_||(k_=new n(new cs(sN),null,nl.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||k_}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?k_:r}}getChild(t){const r=Et(t);return null===r?this:this.getImmediateChild(r).getChild(En(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if((0,B.vA)(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new xt(t,r);let s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));const a=s.isEmpty()?k_:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){const i=Et(t);if(null===i)return r;{(0,B.vA)(".priority"!==Et(t)||1===cu(t),".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(En(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,s=0,o=!0;if(this.forEachChild(xn,(a,l)=>{r[a]=l.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){const a=[];for(const l in r)a[l]=r[l];return a}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+QG(this.getPriority().val())+":"),this.forEachChild(xn,(r,i)=>{const s=i.hash();""!==s&&(t+=":"+r+":"+s)}),this.lazyHash_=""===t?"":cG(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new xt(t,r));return o?o.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new xt(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new xt(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,xt.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,xt.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===O_?-1:0}withIndex(t){if(t===ua||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===ua||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(xn),s=r.getIterator(xn);let o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(t){return t===ua?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const O_=new class Spe extends ct{constructor(){super(new cs(sN),ct.EMPTY_NODE,nl.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return ct.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(xt,{MIN:{value:new xt(lu,ct.EMPTY_NODE)},MAX:{value:new xt(tl,O_)}}),KG.__EMPTY_NODE=ct.EMPTY_NODE,zf.__childrenNodeConstructor=ct,function Ipe(n){oN=n}(O_),function Cpe(n){ZG=n}(O_);const Dpe=!0;function ir(n,e=null){if(null===n)return ct.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),(0,B.vA)(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new zf(n,ir(e));if(n instanceof Array||!Dpe){let t=ct.EMPTY_NODE;return Qr(n,(r,i)=>{if((0,B.gR)(n,r)&&"."!==r.substring(0,1)){const s=ir(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(ir(e))}{const t=[];let r=!1;if(Qr(n,(o,a)=>{if("."!==o.substring(0,1)){const l=ir(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),t.push(new xt(o,l)))}}),0===t.length)return ct.EMPTY_NODE;const s=OC(t,Epe,o=>o.name,sN);if(r){const o=OC(t,xn.getCompare());return new ct(s,ir(e),new nl({".priority":o},{".priority":xn}))}return new ct(s,ir(e),nl.Default)}}!function wpe(n){XG=n}(ir);class lN extends NC{constructor(e){super(),this.indexPath_=e,(0,B.vA)(!It(e)&&".priority"!==Et(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return 0===s?Kc(e.name,t.name):s}makePost(e,t){const r=ir(e),i=ct.EMPTY_NODE.updateChild(this.indexPath_,r);return new xt(t,i)}maxPost(){const e=ct.EMPTY_NODE.updateChild(this.indexPath_,O_);return new xt(tl,e)}toString(){return N_(this.indexPath_,0).join("/")}}const uN=new class Rpe extends NC{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?Kc(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return xt.MIN}maxPost(){return xt.MAX}makePost(e,t){const r=ir(e);return new xt(t,r)}toString(){return".value"}};function L_(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class dN{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=xn}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,B.vA)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return(0,B.vA)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:lu}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,B.vA)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return(0,B.vA)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:tl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,B.vA)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===xn}copy(){const e=new dN;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function tq(n){const e={};if(n.isDefault())return e;let t;if(n.index_===xn?t="$priority":n.index_===uN?t="$value":n.index_===ua?t="$key":((0,B.vA)(n.index_ instanceof lN,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=(0,B.As)(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=(0,B.As)(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+(0,B.As)(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=(0,B.As)(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+(0,B.As)(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function nq(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==xn&&(e.i=n.index_.toString()),e}class LC extends BG{constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=D_("p:rest:"),this.listens_={}}reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,B.vA)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=LC.getListenId_(e,r),a={};this.listens_[o]=a;const l=tq(e._queryParams);this.restRequest_(s+".json",l,(u,d)=>{let p=d;if(404===u&&(p=null,u=null),null===u&&this.onDataUpdate_(s,p,!1,r),(0,B.yw)(this.listens_,o)===a){let _;_=u?401===u?"permission_denied":"rest_error:"+u:"ok",i(_,null)}})}unlisten(e,t){const r=LC.getListenId_(e,t);delete this.listens_[r]}get(e){const t=tq(e._queryParams),r=e._path.toString(),i=new B.cY;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;404===s&&(a=null,s=null),null===s?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,B.Am)(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=(0,B.$L)(a.responseText)}catch{bi("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else 401!==a.status&&404!==a.status&&bi("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}class Lpe{constructor(){this.rootNode_=ct.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function VC(){return{value:null,children:new Map}}function qf(n,e,t){if(It(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=Et(e);n.children.has(r)||n.children.set(r,VC()),qf(n.children.get(r),e=En(e),t)}}function gN(n,e,t){null!==n.value?t(e,n.value):function Vpe(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{gN(i,new nn(e.toString()+"/"+r),t)})}class Upe{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Qr(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class $pe{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new Upe(e);const r=1e4+2e4*Math.random();x_(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Qr(e,(i,s)=>{s>0&&(0,B.gR)(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),x_(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var ca=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(ca||{});function yN(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class UC{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=ca.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(It(this.path)){if(null!=this.affectedTree.value)return(0,B.vA)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new nn(e));return new UC(Gt(),t,this.revert)}}return(0,B.vA)(Et(this.path)===e,"operationForChild called for unrelated child."),new UC(En(this.path),this.affectedTree,this.revert)}}class Jc{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=ca.OVERWRITE}operationForChild(e){return It(this.path)?new Jc(this.source,Gt(),this.snap.getImmediateChild(e)):new Jc(this.source,En(this.path),this.snap)}}class Kf{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=ca.MERGE}operationForChild(e){if(It(this.path)){const t=this.children.subtree(new nn(e));return t.isEmpty()?null:t.value?new Jc(this.source,Gt(),t.value):new Kf(this.source,Gt(),t)}return(0,B.vA)(Et(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new Kf(this.source,En(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class du{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(It(e))return this.isFullyInitialized()&&!this.filtered_;const t=Et(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}function B_(n,e,t,r,i,s){const o=r.filter(a=>a.type===t);o.sort((a,l)=>function Gpe(n,e,t){if(null==e.childName||null==t.childName)throw(0,B.Hk)("Should only compare child_ events.");const r=new xt(e.childName,e.snapshotNode),i=new xt(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,a,l)),o.forEach(a=>{const l=function Wpe(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,n.query_))})})}function BC(n,e){return{eventCache:n,serverCache:e}}function j_(n,e,t,r){return BC(new du(e,t,r),n.serverCache)}function iq(n,e,t,r){return BC(n.eventCache,new du(e,t,r))}function jC(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function Xc(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let vN;class Pn{constructor(e,t=(()=>(vN||(vN=new cs(xfe)),vN))()){this.value=e,this.children=t}static fromObject(e){let t=new Pn(null);return Qr(e,(r,i)=>{t=t.set(new nn(r),i)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:Gt(),value:this.value};if(It(e))return null;{const r=Et(e),i=this.children.get(r);if(null!==i){const s=i.findRootMostMatchingPathAndValue(En(e),t);return null!=s?{path:Zn(new nn(r),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(It(e))return this;{const t=Et(e),r=this.children.get(t);return null!==r?r.subtree(En(e)):new Pn(null)}}set(e,t){if(It(e))return new Pn(t,this.children);{const r=Et(e),s=(this.children.get(r)||new Pn(null)).set(En(e),t),o=this.children.insert(r,s);return new Pn(this.value,o)}}remove(e){if(It(e))return this.children.isEmpty()?new Pn(null):new Pn(null,this.children);{const t=Et(e),r=this.children.get(t);if(r){const i=r.remove(En(e));let s;return s=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&s.isEmpty()?new Pn(null):new Pn(this.value,s)}return this}}get(e){if(It(e))return this.value;{const t=Et(e),r=this.children.get(t);return r?r.get(En(e)):null}}setTree(e,t){if(It(e))return t;{const r=Et(e),s=(this.children.get(r)||new Pn(null)).setTree(En(e),t);let o;return o=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new Pn(this.value,o)}}fold(e){return this.fold_(Gt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(Zn(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,Gt(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(It(e))return null;{const s=Et(e),o=this.children.get(s);return o?o.findOnPath_(En(e),Zn(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,Gt(),t)}foreachOnPath_(e,t,r){if(It(e))return this;{this.value&&r(t,this.value);const i=Et(e),s=this.children.get(i);return s?s.foreachOnPath_(En(e),Zn(t,i),r):new Pn(null)}}foreach(e){this.foreach_(Gt(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(Zn(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class Co{constructor(e){this.writeTree_=e}static empty(){return new Co(new Pn(null))}}function $_(n,e,t){if(It(e))return new Co(new Pn(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let s=r.value;const o=Ki(i,e);return s=s.updateChild(o,t),new Co(n.writeTree_.set(i,s))}{const i=new Pn(t),s=n.writeTree_.setTree(e,i);return new Co(s)}}}function EN(n,e,t){let r=n;return Qr(t,(i,s)=>{r=$_(r,Zn(e,i),s)}),r}function sq(n,e){if(It(e))return Co.empty();{const t=n.writeTree_.setTree(e,new Pn(null));return new Co(t)}}function IN(n,e){return null!=Zc(n,e)}function Zc(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Ki(t.path,e)):null}function oq(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(xn,(r,i)=>{e.push(new xt(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new xt(r,i.value))}),e}function hu(n,e){if(It(e))return n;{const t=Zc(n,e);return new Co(null!=t?new Pn(t):n.writeTree_.subtree(e))}}function wN(n){return n.writeTree_.isEmpty()}function Qf(n,e){return aq(Gt(),n.writeTree_,e)}function aq(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{".priority"===i?((0,B.vA)(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):t=aq(Zn(n,i),s,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(Zn(n,".priority"),r)),t}}function $C(n,e){return hq(e,n)}function Xpe(n,e){if(n.snap)return eo(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&eo(Zn(n.path,t),e))return!0;return!1}function ege(n){return n.visible}function lq(n,e,t){let r=Co.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let a;if(s.snap)eo(t,o)?(a=Ki(t,o),r=$_(r,a,s.snap)):eo(o,t)&&(a=Ki(o,t),r=$_(r,Gt(),s.snap.getChild(a)));else{if(!s.children)throw(0,B.Hk)("WriteRecord should have .snap or .children");if(eo(t,o))a=Ki(t,o),r=EN(r,a,s.children);else if(eo(o,t))if(a=Ki(o,t),It(a))r=EN(r,Gt(),s.children);else{const l=(0,B.yw)(s.children,Et(a));if(l){const u=l.getChild(En(a));r=$_(r,Gt(),u)}}}}}return r}function uq(n,e,t,r,i){if(r||i){const s=hu(n.visibleWrites,e);return!i&&wN(s)?t:i||null!=t||IN(s,Gt())?Qf(lq(n.allWrites,function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(eo(u.path,e)||eo(e,u.path))},e),t||ct.EMPTY_NODE):null}{const s=Zc(n.visibleWrites,e);if(null!=s)return s;{const o=hu(n.visibleWrites,e);return wN(o)?t:null!=t||IN(o,Gt())?Qf(o,t||ct.EMPTY_NODE):null}}}function HC(n,e,t,r){return uq(n.writeTree,n.treePath,e,t,r)}function CN(n,e){return function tge(n,e,t){let r=ct.EMPTY_NODE;const i=Zc(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(xn,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=hu(n.visibleWrites,e);return t.forEachChild(xn,(o,a)=>{const l=Qf(hu(s,new nn(o)),a);r=r.updateImmediateChild(o,l)}),oq(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}return oq(hu(n.visibleWrites,e)).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}(n.writeTree,n.treePath,e)}function cq(n,e,t,r){return function nge(n,e,t,r,i){(0,B.vA)(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=Zn(e,t);if(IN(n.visibleWrites,s))return null;{const o=hu(n.visibleWrites,s);return wN(o)?i.getChild(t):Qf(o,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function zC(n,e){return function ige(n,e){return Zc(n.visibleWrites,e)}(n.writeTree,Zn(n.treePath,e))}function TN(n,e,t){return function rge(n,e,t,r){const i=Zn(e,t),s=Zc(n.visibleWrites,i);return null!=s?s:r.isCompleteForChild(t)?Qf(hu(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function dq(n,e){return hq(Zn(n.treePath,e),n.writeTree)}function hq(n,e){return{treePath:n,writeTree:e}}class lge{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;(0,B.vA)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,B.vA)(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(r,L_(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(r,function F_(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}(r,i.oldSnap));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(r,function Gf(n,e){return{type:"child_added",snapshotNode:e,childName:n}}(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw(0,B.Hk)("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,L_(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const fq=new class uge{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class AN{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new du(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return TN(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Xc(this.viewCache_),s=function age(n,e,t,r,i,s){return function sge(n,e,t,r,i,s,o){let a;const l=hu(n.visibleWrites,e),u=Zc(l,Gt());if(null!=u)a=u;else{if(null==t)return[];a=Qf(l,t)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const d=[],p=o.getCompare(),_=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let v=_.getNext();for(;v&&d.length<i;)0!==p(v,r)&&d.push(v),v=_.getNext();return d}}(n.writeTree,n.treePath,e,t,r,i,s)}(this.writes_,i,t,1,r,e);return 0===s.length?null:s[0]}}function pq(n,e,t,r,i,s){const o=e.eventCache;if(null!=zC(r,t))return e;{let a,l;if(It(t))if((0,B.vA)(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=Xc(e),p=CN(r,u instanceof ct?u:ct.EMPTY_NODE);a=n.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{const u=HC(r,Xc(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{const u=Et(t);if(".priority"===u){(0,B.vA)(1===cu(t),"Can't have a priority with additional path components");const d=o.getNode();l=e.serverCache.getNode();const p=cq(r,t,d,l);a=null!=p?n.filter.updatePriority(d,p):o.getNode()}else{const d=En(t);let p;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const _=cq(r,t,o.getNode(),l);p=null!=_?o.getNode().getImmediateChild(u).updateChild(d,_):o.getNode().getImmediateChild(u)}else p=TN(r,u,e.serverCache);a=null!=p?n.filter.updateChild(o.getNode(),u,p,d,i,s):o.getNode()}}return j_(e,a,o.isFullyInitialized()||It(t),n.filter.filtersNodes())}}function WC(n,e,t,r,i,s,o,a){const l=e.serverCache;let u;const d=o?n.filter:n.filter.getIndexedFilter();if(It(t))u=d.updateFullNode(l.getNode(),r,null);else if(d.filtersNodes()&&!l.isFiltered()){const v=l.getNode().updateChild(t,r);u=d.updateFullNode(l.getNode(),v,null)}else{const v=Et(t);if(!l.isCompleteForPath(t)&&cu(t)>1)return e;const A=En(t),P=l.getNode().getImmediateChild(v).updateChild(A,r);u=".priority"===v?d.updatePriority(l.getNode(),P):d.updateChild(l.getNode(),v,P,A,fq,null)}const p=iq(e,u,l.isFullyInitialized()||It(t),d.filtersNodes());return pq(n,p,t,i,new AN(i,p,s),a)}function bN(n,e,t,r,i,s,o){const a=e.eventCache;let l,u;const d=new AN(i,e,s);if(It(t))u=n.filter.updateFullNode(e.eventCache.getNode(),r,o),l=j_(e,u,!0,n.filter.filtersNodes());else{const p=Et(t);if(".priority"===p)u=n.filter.updatePriority(e.eventCache.getNode(),r),l=j_(e,u,a.isFullyInitialized(),a.isFiltered());else{const _=En(t),v=a.getNode().getImmediateChild(p);let A;if(It(_))A=r;else{const D=d.getCompleteChild(p);A=null!=D?".priority"===nN(_)&&D.getChild(zG(_)).isEmpty()?D:D.updateChild(_,r):ct.EMPTY_NODE}l=v.equals(A)?e:j_(e,n.filter.updateChild(a.getNode(),p,A,_,d,o),a.isFullyInitialized(),n.filter.filtersNodes())}}return l}function gq(n,e){return n.eventCache.isCompleteForChild(e)}function mq(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function SN(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u,l=e;u=It(t)?r:new Pn(null).setTree(t,r);const d=e.serverCache.getNode();return u.children.inorderTraversal((p,_)=>{if(d.hasChild(p)){const A=mq(0,e.serverCache.getNode().getImmediateChild(p),_);l=WC(n,l,new nn(p),A,i,s,o,a)}}),u.children.inorderTraversal((p,_)=>{const v=!e.serverCache.isCompleteForChild(p)&&null===_.value;if(!d.hasChild(p)&&!v){const D=mq(0,e.serverCache.getNode().getImmediateChild(p),_);l=WC(n,l,new nn(p),D,i,s,o,a)}}),l}function Ige(n,e){const t=Xc(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!It(e)&&!t.getImmediateChild(Et(e)).isEmpty())?t.getChild(e):null}function vq(n,e,t,r){e.type===ca.MERGE&&null!==e.source.queryId&&((0,B.vA)(Xc(n.viewCache_),"We should always have a full cache before handling merges"),(0,B.vA)(jC(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=function hge(n,e,t,r,i){const s=new lge;let o,a;if(t.type===ca.OVERWRITE){const u=t;u.source.fromUser?o=bN(n,e,u.path,u.snap,r,i,s):((0,B.vA)(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!It(u.path),o=WC(n,e,u.path,u.snap,r,i,a,s))}else if(t.type===ca.MERGE){const u=t;u.source.fromUser?o=function pge(n,e,t,r,i,s,o){let a=e;return r.foreach((l,u)=>{const d=Zn(t,l);gq(e,Et(d))&&(a=bN(n,a,d,u,i,s,o))}),r.foreach((l,u)=>{const d=Zn(t,l);gq(e,Et(d))||(a=bN(n,a,d,u,i,s,o))}),a}(n,e,u.path,u.children,r,i,s):((0,B.vA)(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=SN(n,e,u.path,u.children,r,i,a,s))}else if(t.type===ca.ACK_USER_WRITE){const u=t;o=u.revert?function _ge(n,e,t,r,i,s){let o;if(null!=zC(r,t))return e;{const a=new AN(r,e,i),l=e.eventCache.getNode();let u;if(It(t)||".priority"===Et(t)){let d;if(e.serverCache.isFullyInitialized())d=HC(r,Xc(e));else{const p=e.serverCache.getNode();(0,B.vA)(p instanceof ct,"serverChildren would be complete if leaf node"),d=CN(r,p)}u=n.filter.updateFullNode(l,d,s)}else{const d=Et(t);let p=TN(r,d,e.serverCache);null==p&&e.serverCache.isCompleteForChild(d)&&(p=l.getImmediateChild(d)),u=null!=p?n.filter.updateChild(l,d,p,En(t),a,s):e.eventCache.getNode().hasChild(d)?n.filter.updateChild(l,d,ct.EMPTY_NODE,En(t),a,s):l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=HC(r,Xc(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=zC(r,Gt()),j_(e,u,o,n.filter.filtersNodes())}}(n,e,u.path,r,i,s):function gge(n,e,t,r,i,s,o){if(null!=zC(i,t))return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(null!=r.value){if(It(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return WC(n,e,t,l.getNode().getChild(t),i,s,a,o);if(It(t)){let u=new Pn(null);return l.getNode().forEachChild(ua,(d,p)=>{u=u.set(new nn(d),p)}),SN(n,e,t,u,i,s,a,o)}return e}{let u=new Pn(null);return r.foreach((d,p)=>{const _=Zn(t,d);l.isCompleteForPath(_)&&(u=u.set(d,l.getNode().getChild(_)))}),SN(n,e,t,u,i,s,a,o)}}(n,e,u.path,u.affectedTree,r,i,s)}else{if(t.type!==ca.LISTEN_COMPLETE)throw(0,B.Hk)("Unknown operation type: "+t.type);o=function mge(n,e,t,r,i){const s=e.serverCache;return pq(n,iq(e,s.getNode(),s.isFullyInitialized()||It(t),s.isFiltered()),t,r,fq,i)}(n,e,t.path,r,s)}const l=s.getChanges();return function fge(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=jC(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(function eq(n){return{type:"value",snapshotNode:n}}(jC(e)))}}(e,o,l),{viewCache:o,changes:l}}(n.processor_,i,e,t,r);return function dge(n,e){(0,B.vA)(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),(0,B.vA)(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),(0,B.vA)(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,function Eq(n,e,t,r){return function zpe(n,e,t,r){const i=[],s=[];return e.forEach(o=>{"child_changed"===o.type&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function xpe(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(o.childName,o.snapshotNode))}),B_(n,i,"child_removed",e,r,t),B_(n,i,"child_added",e,r,t),B_(n,i,"child_moved",s,r,t),B_(n,i,"child_changed",e,r,t),B_(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}(n,s.changes,s.viewCache.eventCache.getNode(),null)}let GC,KC;function DN(n,e,t,r){const i=e.source.queryId;if(null!==i){const s=n.views.get(i);return(0,B.vA)(null!=s,"SyncTree gave us an op for an invalid query."),vq(s,e,t,r)}{let s=[];for(const o of n.views.values())s=s.concat(vq(o,e,t,r));return s}}function fu(n,e){let t=null;for(const r of n.views.values())t=t||Ige(r,e);return t}class bq{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Pn(null),this.pendingWriteTree_=function oge(){return{visibleWrites:Co.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function RN(n,e,t,r,i){return function Kpe(n,e,t,r,i){(0,B.vA)(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=$_(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?Yf(n,new Jc({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function gu(n,e,t=!1){const r=function Ype(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function Jpe(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);(0,B.vA)(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&Xpe(a,r.path)?i=!1:eo(r.path,a.path)&&(s=!0)),o--}return!!i&&(s?(function Zpe(n){n.visibleWrites=lq(n.allWrites,ege,Gt()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=sq(n.visibleWrites,r.path):Qr(r.children,l=>{n.visibleWrites=sq(n.visibleWrites,Zn(r.path,l))}),!0))}(n.pendingWriteTree_,e)){let s=new Pn(null);return null!=r.snap?s=s.set(Gt(),!0):Qr(r.children,o=>{s=s.set(new nn(o),!0)}),Yf(n,new UC(r.path,s,t))}return[]}function H_(n,e,t){return Yf(n,new Jc({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function YC(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{const u=fu(a,Ki(o,e));if(u)return u});return uq(i,e,s,t,!0)}function Yf(n,e){return Dq(e,n.syncPointTree_,null,$C(n.pendingWriteTree_,Gt()))}function Dq(n,e,t,r){if(It(n.path))return Rq(n,e,t,r);{const i=e.get(Gt());null==t&&null!=i&&(t=fu(i,Gt()));let s=[];const o=Et(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){const u=t?t.getImmediateChild(o):null,d=dq(r,o);s=s.concat(Dq(a,l,u,d))}return i&&(s=s.concat(DN(i,n,r,t))),s}}function Rq(n,e,t,r){const i=e.get(Gt());null==t&&null!=i&&(t=fu(i,Gt()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,u=dq(r,o),d=n.operationForChild(o);d&&(s=s.concat(Rq(d,a,l,u)))}),i&&(s=s.concat(DN(i,n,r,t))),s}function PN(n,e){return n.tagToQueryMap.get(e)}function NN(n){const e=n.indexOf("$");return(0,B.vA)(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new nn(n.substr(0,e))}}function MN(n,e,t){const r=n.syncPointTree_.get(e);return(0,B.vA)(r,"Missing sync point for query tag that we're tracking"),DN(r,t,$C(n.pendingWriteTree_,e),null)}class kN{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new kN(t)}node(){return this.node_}}class ON{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=Zn(this.path_,e);return new ON(this.syncTree_,t)}node(){return YC(this.syncTree_,this.path_)}}const $ge=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},Pq=function(n,e,t){return n&&"object"==typeof n?((0,B.vA)(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?Hge(n[".sv"],e,t):"object"==typeof n[".sv"]?zge(n[".sv"],e):void(0,B.vA)(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},Hge=function(n,e,t){if("timestamp"===n)return t.timestamp;(0,B.vA)(!1,"Unexpected server value: "+n)},zge=function(n,e,t){n.hasOwnProperty("increment")||(0,B.vA)(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&(0,B.vA)(!1,"Unexpected increment value: "+r);const i=e.node();if((0,B.vA)(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},Nq=function(n,e,t,r){return LN(e,new ON(t,n),r)},FN=function(n,e,t){return LN(n,new kN(e),t)};function LN(n,e,t){const r=n.getPriority().val(),i=Pq(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,a=Pq(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new zf(a,ir(i)):n}{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new zf(i))),o.forEachChild(xn,(a,l)=>{const u=LN(l,e.getImmediateChild(a),t);u!==l&&(s=s.updateImmediateChild(a,u))}),s}}class VN{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function XC(n,e){let t=e instanceof nn?e:new nn(e),r=n,i=Et(t);for(;null!==i;){const s=(0,B.yw)(r.node.children,i)||{children:{},childCount:0};r=new VN(i,r,s),t=En(t),i=Et(t)}return r}function ed(n){return n.node.value}function UN(n,e){n.node.value=e,BN(n)}function Mq(n){return n.node.childCount>0}function ZC(n,e){Qr(n.node.children,(t,r)=>{e(new VN(t,n,r))})}function kq(n,e,t,r){t&&!r&&e(n),ZC(n,i=>{kq(i,e,!0,r)}),t&&r&&e(n)}function G_(n){return new nn(null===n.parent?n.name:G_(n.parent)+"/"+n.name)}function BN(n){null!==n.parent&&function qge(n,e,t){const r=function Wge(n){return void 0===ed(n)&&!Mq(n)}(t),i=(0,B.gR)(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,BN(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,BN(n))}(n.parent,n.name,n)}const Kge=/[\[\].#$\/\u0000-\u001F\u007F]/,Qge=/[\[\].#$\u0000-\u001F\u007F]/,jN=10485760,e0=function(n){return"string"==typeof n&&0!==n.length&&!Kge.test(n)},K_=function(n,e,t){const r=t instanceof nn?new hpe(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+Qc(r));if("function"==typeof e)throw new Error(n+"contains a function "+Qc(r)+" with contents = "+e.toString());if(DC(e))throw new Error(n+"contains "+e.toString()+" "+Qc(r));if("string"==typeof e&&e.length>jN/3&&(0,B.OE)(e)>jN)throw new Error(n+"contains a string greater than "+jN+" utf8 bytes "+Qc(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,s=!1;if(Qr(e,(o,a)=>{if(".value"===o)i=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!e0(o)))throw new Error(n+" contains an invalid key ("+o+") "+Qc(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function fpe(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=(0,B.OE)(e),WG(n)})(r,o),K_(n,a,r),function ppe(n){const e=n.parts_.pop();n.byteLength_-=(0,B.OE)(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&s)throw new Error(n+' contains ".value" child '+Qc(r)+" in addition to actual children.")}},Lq=function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!e0(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),function(n){return"string"==typeof n&&0!==n.length&&!Qge.test(n)}(n)}(t))throw new Error((0,B.dI)(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};class Zge{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Rs(n,e,t){(function t0(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();null!==t&&!rN(s,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)})(n,t),function Uq(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(eme(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}(n,r=>eo(r,e)||eo(e,r))}function eme(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();qc&&Kr("event: "+t.toString()),$f(r)}}}const tme=25;class nme{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Zge,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=VC(),this.transactionQueueTree_=new VN,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function jq(n){const t=n.infoData_.getNode(new nn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function Y_(n){return $ge({timestamp:jq(n)})}function $q(n,e,t,r,i){n.dataUpdateCount++;const s=new nn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const l=(0,B.kH)(t,u=>ir(u));o=function Fge(n,e,t,r){const i=PN(n,r);if(i){const s=NN(i),o=s.path,a=s.queryId,l=Ki(o,e),u=Pn.fromObject(t);return MN(n,o,new Kf(yN(a),l,u))}return[]}(n.serverSyncTree_,s,l,i)}else{const l=ir(t);o=function Sq(n,e,t,r){const i=PN(n,r);if(null!=i){const s=NN(i),o=s.path,a=s.queryId,l=Ki(o,e);return MN(n,o,new Jc(yN(a),l,t))}return[]}(n.serverSyncTree_,s,l,i)}else if(r){const l=(0,B.kH)(t,u=>ir(u));o=function Mge(n,e,t){const r=Pn.fromObject(t);return Yf(n,new Kf({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,s,l)}else{const l=ir(t);o=H_(n.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=Xf(n,s)),Rs(n.eventQueue_,a,o)}function Hq(n,e){zN(n,"connected",e),!1===e&&function ame(n){Jf(n,"onDisconnectEvents");const e=Y_(n),t=VC();gN(n.onDisconnect_,Gt(),(i,s)=>{const o=Nq(i,s,n.serverSyncTree_,e);qf(t,i,o)});let r=[];gN(t,Gt(),(i,s)=>{r=r.concat(H_(n.serverSyncTree_,i,s));const o=function KN(n,e){const t=G_(Gq(n,e)),r=XC(n.transactionQueueTree_,e);return function Gge(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{QN(n,i)}),QN(n,r),kq(r,i=>{QN(n,i)}),t}(n,i);Xf(n,o)}),n.onDisconnect_=VC(),Rs(n.eventQueue_,Gt(),r)}(n)}function zN(n,e,t){const r=new nn("/.info/"+e),i=ir(t);n.infoData_.updateSnapshot(r,i);const s=H_(n.infoSyncTree_,r,i);Rs(n.eventQueue_,r,s)}function n0(n){return n.nextWriteId_++}function Jf(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Kr(t,...e)}function qN(n,e,t){return YC(n.serverSyncTree_,e,t)||ct.EMPTY_NODE}function r0(n,e=n.transactionQueueTree_){if(e||s0(n,e),ed(e)){const t=qq(n,e);(0,B.vA)(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function pme(n,e,t){const r=t.map(u=>u.currentWriteId),i=qN(n,e,r);let s=i;const o=i.hash();for(let u=0;u<t.length;u++){const d=t[u];(0,B.vA)(0===d.status,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const p=Ki(e,d.path);s=s.updateChild(p,d.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;n.server_.put(l.toString(),a,u=>{Jf(n,"transaction put response",{path:l.toString(),status:u});let d=[];if("ok"===u){const p=[];for(let _=0;_<t.length;_++)t[_].status=2,d=d.concat(gu(n.serverSyncTree_,t[_].currentWriteId)),t[_].onComplete&&p.push(()=>t[_].onComplete(null,!0,t[_].currentOutputSnapshotResolved)),t[_].unwatcher();s0(n,XC(n.transactionQueueTree_,e)),r0(n,n.transactionQueueTree_),Rs(n.eventQueue_,e,d);for(let _=0;_<p.length;_++)$f(p[_])}else{if("datastale"===u)for(let p=0;p<t.length;p++)t[p].status=3===t[p].status?4:0;else{bi("transaction at "+l.toString()+" failed: "+u);for(let p=0;p<t.length;p++)t[p].status=4,t[p].abortReason=u}Xf(n,e)}},o)}(n,G_(e),t)}else Mq(e)&&ZC(e,t=>{r0(n,t)})}function Xf(n,e){const t=Gq(n,e),r=G_(t);return function gme(n,e,t){if(0===e.length)return;const r=[];let i=[];const o=e.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=Ki(t,l.path);let p,d=!1;if((0,B.vA)(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)d=!0,p=l.abortReason,i=i.concat(gu(n.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=tme)d=!0,p="maxretry",i=i.concat(gu(n.serverSyncTree_,l.currentWriteId,!0));else{const _=qN(n,l.path,o);l.currentInputSnapshot=_;const v=e[a].update(_.val());if(void 0!==v){K_("transaction failed: Data returned ",v,l.path);let A=ir(v);"object"==typeof v&&null!=v&&(0,B.gR)(v,".priority")||(A=A.updatePriority(_.getPriority()));const P=l.currentWriteId,H=Y_(n),V=FN(A,_,H);l.currentOutputSnapshotRaw=A,l.currentOutputSnapshotResolved=V,l.currentWriteId=n0(n),o.splice(o.indexOf(P),1),i=i.concat(RN(n.serverSyncTree_,l.path,V,l.currentWriteId,l.applyLocally)),i=i.concat(gu(n.serverSyncTree_,P,!0))}else d=!0,p="nodata",i=i.concat(gu(n.serverSyncTree_,l.currentWriteId,!0))}Rs(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&r.push("nodata"===p?()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot):()=>e[a].onComplete(new Error(p),!1,null)))}s0(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)$f(r[a]);r0(n,n.transactionQueueTree_)}(n,qq(n,t),r),r}function Gq(n,e){let t,r=n.transactionQueueTree_;for(t=Et(e);null!==t&&void 0===ed(r);)r=XC(r,t),t=Et(e=En(e));return r}function qq(n,e){const t=[];return Kq(n,e,t),t.sort((r,i)=>r.order-i.order),t}function Kq(n,e,t){const r=ed(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);ZC(e,i=>{Kq(n,i,t)})}function s0(n,e){const t=ed(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,UN(e,t.length>0?t:void 0)}ZC(e,r=>{s0(n,r)})}function QN(n,e){const t=ed(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)3===t[o].status||(1===t[o].status?((0,B.vA)(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):((0,B.vA)(0===t[o].status,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(gu(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?UN(e,void 0):t.length=s+1,Rs(n.eventQueue_,G_(e),i);for(let o=0;o<r.length;o++)$f(r[o])}}const YN=function(n,e){const t=yme(n),r=t.namespace;return"firebase.com"===t.domain&&la(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&la("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&bi("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new YP(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new nn(t.pathString)}},yme=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",l=443;if("string"==typeof n){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let d=n.indexOf("/");-1===d&&(d=n.length);let p=n.indexOf("?");-1===p&&(p=n.length),e=n.substring(0,Math.min(d,p)),d<p&&(i=function mme(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(d,p)));const _=function _me(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):bi(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,p)));u=e.indexOf(":"),u>=0?(o="https"===a||"wss"===a,l=parseInt(e.substring(u+1),10)):u=e.length;const v=e.slice(0,u);if("localhost"===v.toLowerCase())t="localhost";else if(v.split(".").length<=2)t=v;else{const A=e.indexOf(".");r=e.substring(0,A).toLowerCase(),t=e.substring(A+1),s=r}"ns"in _&&(s=_.ns)}return{host:e,port:l,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};class xs{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return It(this._path)?null:nN(this._path)}get ref(){return new To(this._repo,this._path)}get _queryIdentifier(){const e=nq(this._queryParams),t=KP(e);return"{}"===t?"default":t}get _queryObject(){return nq(this._queryParams)}isEqual(e){if(!((e=(0,B.Ku)(e))instanceof xs))return!1;const t=this._repo===e._repo,r=rN(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function cpe(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}class To extends xs{constructor(e,t){super(e,t,new dN,!1)}get parent(){const e=zG(this._path);return null===e?null:new To(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}(function Tge(n){(0,B.vA)(!GC,"__referenceConstructor has already been defined"),GC=n})(To),function Rge(n){(0,B.vA)(!KC,"__referenceConstructor has already been defined"),KC=n}(To);const XN={};class Lme{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function rme(n,e,t){if(n.stats_=ZP(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new LC(n.repoInfo_,(r,i,s,o)=>{$q(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>Hq(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,B.As)(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new Yc(n.repoInfo_,e,(r,i,s,o)=>{$q(n,r,i,s,o)},r=>{Hq(n,r)},r=>{!function ime(n,e){Qr(e,(t,r)=>{zN(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function $fe(n,e){const t=n.toString();return XP[t]||(XP[t]=e()),XP[t]}(n.repoInfo_,()=>new $pe(n.stats_,n.server_)),n.infoData_=new Lpe,n.infoSyncTree_=new bq({startListening:(r,i,s,o)=>{let a=[];const l=n.infoData_.getNode(r._path);return l.isEmpty()||(a=H_(n.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),zN(n,"connected",!1),n.serverSyncTree_=new bq({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,l)=>{const u=o(a,l);Rs(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new To(this._repo,Gt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function kme(n,e){const t=XN[e];(!t||t[n.key]!==n)&&la(`Database ${e}(${n.repoInfo_}) has already been deleted.`),function Wq(n){n.persistentConnection_&&n.persistentConnection_.interrupt("repo_interrupt")}(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&la("Cannot call "+e+" on a deleted database.")}}function Vme(n=(0,zi.getApp)(),e){const t=(0,zi._getProvider)(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=(0,B.yU)("database");r&&function Ume(n,e,t,r={}){(n=(0,B.Ku)(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&la("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&la('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new P_(P_.OWNER);else if(r.mockUserToken){const o="string"==typeof r.mockUserToken?r.mockUserToken:(0,B.Fy)(r.mockUserToken,n.app.options.projectId);s=new P_(o)}!function Mme(n,e,t,r){n.repoInfo_=new YP(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}(i,e,t,s)}(t,...r)}return t}Yc.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},Yc.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function Bme(n){(function aG(n){WP=n})(zi.SDK_VERSION),(0,zi._registerComponent)(new cD.uA("database",(e,{instanceIdentifier:t})=>function n3(n,e,t,r,i){let s=r||n.options.databaseURL;void 0===s&&(n.options.projectId||la("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Kr("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let l,u,o=YN(s,i),a=o.repoInfo;typeof process<"u"&&process.env&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(l=!0,s=`http://${u}?ns=${a.namespace}`,o=YN(s,i),a=o.repoInfo):l=!o.repoInfo.secure;const d=i&&l?new P_(P_.OWNER):new Ufe(n.name,n.options,e);Lq("Invalid Firebase Database URL",o),It(o.path)||la("Database URL must point to the root of a Firebase Database (not including a child path).");const p=function Ome(n,e,t,r){let i=XN[e.name];i||(i={},XN[e.name]=i);let s=i[n.toURLString()];return s&&la("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new nme(n,!1,t,r),i[n.toURLString()]=s,s}(a,n,d,new Vfe(n.name,t));return new Lme(p,n)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),(0,zi.registerVersion)(sG,"1.0.8",n),(0,zi.registerVersion)(sG,"1.0.8","esm2017")}();class ZN{constructor(e){return e}}const i3="database",eM=new we("angularfire2.database-instances");function Wme(n){return(e,t)=>{const r=e.runOutsideAngular(()=>n(t));return new ZN(r)}}const Gme={provide:class Hme{constructor(){return sD(i3)}},deps:[[new vs,eM]]},qme={provide:ZN,useFactory:function zme(n,e){const t=function kB(n,e,t){if(e){if(1===e.length)return e[0];const s=e.filter(o=>o.app===t);if(1===s.length)return s[0]}return t.container.getProvider(n).getImmediate({optional:!0})}(i3,n,e);return t&&new ZN(t)},deps:[[new vs,eM],class b_{constructor(e){return e}}]};function Kme(n,...e){return(0,zi.registerVersion)("angularfire",zI.full,"rtdb"),EE([qme,Gme,{provide:eM,useFactory:Wme(n),multi:!0,deps:[Xt,ss,aD,nG,[new vs,iG],[new vs,oD],...e]}])}const Qme=jie(Vme,!0);let Yme=(()=>{class n{constructor(){this.target=new Date(2025,6,19,12,30),this.updateTimeDifference(),this.intervalId=setInterval(()=>{this.updateTimeDifference()},1e3)}updateTimeDifference(){const t=new Date(Date.now()),r=this.target.getTime()-t.getTime();r<=0?(clearInterval(this.intervalId),this.remDays=this.remHours=this.remMinutes=this.remSeconds=0):this.calculateDifference(r)}calculateDifference(t){try{this.remDays=Math.floor(t/864e5),t%=864e5,this.remHours=Math.floor(t/36e5),t%=36e5,this.remMinutes=Math.floor(t/6e4),t%=6e4,this.remSeconds=Math.floor(t/1e3)}catch(r){console.log("Error in calculateDifference",r)}}ngOnDestroy(){clearInterval(this.intervalId)}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-timer"]],decls:3,vars:4,consts:[[1,"container"],[1,"clock"]],template:function(r,i){1&r&&(me(0,"div",0)(1,"div",1),Se(2),Ie()()),2&r&&(Bt(2),Eb("",i.remDays," days, ",i.remHours," hrs ",i.remMinutes," min ",i.remSeconds," sec."))},styles:[".container[_ngcontent-%COMP%]{display:flex;align-items:center;height:70px;width:50vw;background-color:#96a498;color:#fff;font-size:26px;padding-left:2em}@media (max-width: 1000px){.container[_ngcontent-%COMP%]{height:60px;font-size:20px}}@media (max-width: 800px){.container[_ngcontent-%COMP%]{height:50px;font-size:18px}}@media (max-width: 600px){.container[_ngcontent-%COMP%]{height:40px;width:45vw;font-size:12px;padding-left:1.5em}}@media (max-width: 450px){.container[_ngcontent-%COMP%]{height:30px;font-size:10px;padding-left:1em}}@media (max-width: 400px){.container[_ngcontent-%COMP%]{height:25px;padding-left:1em}}"]})}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function Jme(n,e){if(1&n){const t=Al();me(0,"div",35),An("click",function(){return ni(t),ri(Mr().hideImage())}),Tr(1,"img",36),Ie()}if(2&n){const t=Mr();Bt(1),Tn("src",t.enlargedImageSrc,Tl)}}let Xme=(()=>{class n{constructor(){this.timer=new Yme,this.isImageVisible=!1,this.enlargedImageSrc=""}showImage(t){this.enlargedImageSrc=t.src,this.isImageVisible=!0}hideImage(){this.isImageVisible=!1}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-home"]],decls:62,vars:2,consts:[[1,"container"],[1,"welcome-text"],[1,"time-and-place"],[1,"dot"],[1,"our-story"],[1,"our-story-headline"],[1,"our-story-text"],[1,"collage-container"],[1,"collage-item-1",3,"click"],["src","assets/images/ratio1-1/picture5-1_1.jpg"],["collageItem1",""],[1,"overlay-text-1_1"],[1,"collage-item-2",3,"click"],["src","assets/images/ratio1-1/picture12-1_1.jpg"],["collageItem2",""],[1,"collage-item-3",3,"click"],["src","assets/images/ratio9-16/picture10-9_16.jpg"],["collageItem3",""],[1,"overlay-text-9_16"],[1,"collage-item-4",3,"click"],["src","assets/images/ratio9-16/picture6-9_16.jpg"],["collageItem4",""],[1,"collage-item-5",3,"click"],["src","assets/images/ratio9-16/picture18-9_16.jpg"],["collageItem5",""],[1,"collage-item-6",3,"click"],["src","assets/images/ratio9-16/picture17-9_16.jpg"],["collageItem6",""],[1,"collage-item-7",3,"click"],["src","assets/images/ratio1-1/picture8-1_1.jpg"],["collageItem7",""],[1,"collage-item-8",3,"click"],["src","assets/images/ratio1-1/picture14-1_1.jpg"],["collageItem8",""],["class","image-overlay",3,"click",4,"ngIf"],[1,"image-overlay",3,"click"],[3,"src"]],template:function(r,i){if(1&r){const s=Al();me(0,"div",0)(1,"div",1)(2,"div"),Se(3,"We are delighted to welcome you to"),Ie(),me(4,"div"),Se(5,"Patrik & Claudia's"),Ie(),me(6,"div"),Se(7,"wedding!"),Ie()(),me(8,"div",2),Se(9," July 19 2025 "),Tr(10,"span",3),Se(11," G\xf6teborg "),Tr(12,"span",3),me(13,"span"),Se(14),Ie()(),me(15,"div",4)(16,"div",5),Se(17,"OUR STORY"),Ie(),me(18,"p",6),Se(19," A simple message on a dating app would travel across Kattegat and become the beginning of our beautiful love story. \u201cHello there on the other side of the water\u201d Patrik wrote, and with those simple words, a Swedish Pilot and a Danish accountant would begin their very own fairytale. Our story proves that love knows no borders. Between Patrik\u2019s flights touching down all over Europe and my world of endless numbers and spreadsheets we have created a beautiful relationship based on mutual respect, curiosity and many interests that with time have become mutual. Patrik has introduced me to the beauty of the Gothenburg Archipelago, and I have shared with him my love for all things Italian. In our relationship we delight in teaching each other. Patrik patiently sits evening after evening explaining to me the intricate systems of jet aircraft \u2013 just ask me what might happen if you get on the back side of the drag curve... While I introduce him to the profound simplicity of Hemingway\u2019s prose, as well as the differences between the different philosophical schools. When I was younger, and wanted as young people tend to do \u2013 everything all at once, I would get annoyed when people told me to be patient, and that whoever waits for something good never waits in vain. Today I understand that they were right. Patrik and I might have found each other later in life, but in each other we have found a true soul mate, and a love that is both patient and enduring of any outside circumstances. On that magical Christmas Eve in 2023 when Patrik dropped to one knee and asked me to be his wife in Rome\u2019s beautiful Borghese Gardens I have never been more sure of an answer in my whole life. Patrik and I are so excited to embark on this next chapter of our lives as husband and wife together with our beloved children, and one far too spoiled miniature dachshund. Welcome to our wedding website. We can\u2019t wait to celebrate with all of you and hope you will find the information on this site useful. "),Ie()(),me(20,"div",7)(21,"div",8),An("click",function(){ni(s);const a=Ko(23);return ri(i.showImage(a))}),Tr(22,"img",9,10),me(24,"div",11),Se(25,"Dec 2023"),Ie()(),me(26,"div",12),An("click",function(){ni(s);const a=Ko(28);return ri(i.showImage(a))}),Tr(27,"img",13,14),me(29,"div",11),Se(30,"May 2023"),Ie()(),me(31,"div",15),An("click",function(){ni(s);const a=Ko(33);return ri(i.showImage(a))}),Tr(32,"img",16,17),me(34,"div",18),Se(35,"Aug 2023"),Ie()(),me(36,"div",19),An("click",function(){ni(s);const a=Ko(38);return ri(i.showImage(a))}),Tr(37,"img",20,21),me(39,"div",18),Se(40,"Dec 2023"),Ie()(),me(41,"div",22),An("click",function(){ni(s);const a=Ko(43);return ri(i.showImage(a))}),Tr(42,"img",23,24),me(44,"div",18),Se(45,"Feb 2023"),Ie()(),me(46,"div",25),An("click",function(){ni(s);const a=Ko(48);return ri(i.showImage(a))}),Tr(47,"img",26,27),me(49,"div",18),Se(50,"Sept 2024"),Ie()(),me(51,"div",28),An("click",function(){ni(s);const a=Ko(53);return ri(i.showImage(a))}),Tr(52,"img",29,30),me(54,"div",11),Se(55,"July 2024"),Ie()(),me(56,"div",31),An("click",function(){ni(s);const a=Ko(58);return ri(i.showImage(a))}),Tr(57,"img",32,33),me(59,"div",11),Se(60,"Dec 2022"),Ie()()(),go(61,Jme,2,1,"div",34),Ie()}2&r&&(Bt(14),Dl("",i.timer.remDays," days to go"),Bt(47),Tn("ngIf",i.isImageVisible))},dependencies:[yI],styles:[".welcome-text[_ngcontent-%COMP%]{margin-top:10px;margin-bottom:30px;font-family:Waterfall,cursive;font-size:80px;align-items:center;text-align:center}.time-and-place[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:100%;height:auto;background-color:#96a498;color:#fff;padding:.5em;font-size:22px}.dot[_ngcontent-%COMP%]{height:5px;width:5px;background-color:#fff;border-radius:50%;display:inline-block;margin-left:1.5em;margin-right:1.5em}.our-story-headline[_ngcontent-%COMP%]{margin-top:30px;display:flex;justify-content:center;font-size:26px}.our-story-text[_ngcontent-%COMP%]{margin:15px 2em 2em;font-size:14px;column-count:2;column-gap:20px;column-fill:balance;overflow-y:auto}.our-story-text[_ngcontent-%COMP%]:first-letter{font-size:36px;float:left;margin-right:.15em;line-height:1}.collage-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);grid-template-rows:auto auto auto auto;grid-column-gap:3%;grid-row-gap:3%;margin:3% 5% 5%}.collage-item-1[_ngcontent-%COMP%]{grid-column:1/1;grid-row:1/2;position:relative}.collage-item-2[_ngcontent-%COMP%]{grid-column:2/2;grid-row:1/2;position:relative}.collage-item-3[_ngcontent-%COMP%]{grid-column:3/4;grid-row:1/3;position:relative}.collage-item-4[_ngcontent-%COMP%]{grid-column:4/5;grid-row:1/3;position:relative}.collage-item-5[_ngcontent-%COMP%]{grid-column:1/2;grid-row:2/4;position:relative}.collage-item-6[_ngcontent-%COMP%]{grid-column:2/3;grid-row:2/4;position:relative}.collage-item-7[_ngcontent-%COMP%]{grid-column:3/4;grid-row:3/4;position:relative}.collage-item-8[_ngcontent-%COMP%]{grid-column:4/5;grid-row:3/4;position:relative}.collage-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{display:block;width:100%;height:auto;object-fit:cover;border-radius:5px;filter:grayscale(100%);transition:filter .3s ease}.collage-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]:hover{filter:grayscale(0%)}.overlay-text-1_1[_ngcontent-%COMP%]{position:absolute;top:85%;left:10%;color:#fff;text-shadow:2px 2px 5px rgb(0,0,0);font-size:16px;font-weight:700}.overlay-text-9_16[_ngcontent-%COMP%]{position:absolute;top:90%;left:10%;color:#fff;text-shadow:2px 2px 5px rgb(0,0,0);font-size:16px;font-weight:700}.image-overlay[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;max-height:100%;max-width:auto;transform:translate(-35%,-50%);background-color:#000c;padding:40px;display:flex;justify-content:center;align-items:center;z-index:2}.image-overlay[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:90vh;box-shadow:0 0 20px #00000080;border:2px solid white}@media (max-width: 1200px){.welcome-text[_ngcontent-%COMP%]{margin-top:50px;font-size:70px}.time-and-place[_ngcontent-%COMP%]{font-size:20px}.overlay-text-1_1[_ngcontent-%COMP%], .overlay-text-9_16[_ngcontent-%COMP%]{font-size:15px}}@media (max-width: 1000px){.welcome-text[_ngcontent-%COMP%]{margin-top:60px;font-size:65px}.time-and-place[_ngcontent-%COMP%]{font-size:18px}.dot[_ngcontent-%COMP%]{height:4px;width:4px}.our-story-text[_ngcontent-%COMP%]{font-size:12px;column-gap:18px}.our-story-text[_ngcontent-%COMP%]:first-letter{font-size:30px}.overlay-text-1_1[_ngcontent-%COMP%], .overlay-text-9_16[_ngcontent-%COMP%]{font-size:12px}}@media (max-width: 800px){.welcome-text[_ngcontent-%COMP%]{margin-top:60px;font-size:52px}.time-and-place[_ngcontent-%COMP%]{font-size:16px}.our-story-headline[_ngcontent-%COMP%]{margin-top:20px;font-size:22px}.our-story-text[_ngcontent-%COMP%]{font-size:10px;column-gap:12px;margin-top:10px}.our-story-text[_ngcontent-%COMP%]:first-letter{font-size:25px}.overlay-text-1_1[_ngcontent-%COMP%], .overlay-text-9_16[_ngcontent-%COMP%]{font-size:10px}.image-overlay[_ngcontent-%COMP%]{padding:30px;transform:translate(-30%,-50%)}}@media (max-width: 600px){.welcome-text[_ngcontent-%COMP%]{margin-top:50px;margin-bottom:30px;font-size:38px}.time-and-place[_ngcontent-%COMP%]{font-size:12px}.dot[_ngcontent-%COMP%]{height:3px;width:3px}.our-story-headline[_ngcontent-%COMP%]{margin-top:15px;font-size:18px}.our-story-text[_ngcontent-%COMP%]{font-size:8px;column-gap:8px}.our-story-text[_ngcontent-%COMP%]:first-letter{font-size:20px}.overlay-text-1_1[_ngcontent-%COMP%], .overlay-text-9_16[_ngcontent-%COMP%]{font-size:8px}}@media (max-width: 450px){.welcome-text[_ngcontent-%COMP%]{margin-top:50px;font-size:35px}.time-and-place[_ngcontent-%COMP%]{font-size:10px}.our-story-headline[_ngcontent-%COMP%]{font-size:14px}.our-story-text[_ngcontent-%COMP%]{font-size:7px}.our-story-text[_ngcontent-%COMP%]:first-letter{font-size:18px;column-gap:6px}.overlay-text-1_1[_ngcontent-%COMP%], .overlay-text-9_16[_ngcontent-%COMP%]{font-size:6px}.image-overlay[_ngcontent-%COMP%]{padding:20px}}@media (max-width: 400px){.welcome-text[_ngcontent-%COMP%]{margin-top:50px;font-size:28px}.timer[_ngcontent-%COMP%]{margin-top:20px}}"]})}}return n})(),Zme=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-about"]],decls:4,vars:0,consts:[[1,"page-headline"]],template:function(r,i){1&r&&(me(0,"div",0),Se(1,"ABOUT"),Ie(),me(2,"p"),Se(3,"TEST TEST TEST"),Ie())},styles:[".page-headline[_ngcontent-%COMP%]{background-color:#96a498;color:#fff;display:flex;justify-content:center;font-size:32px;width:100%;padding:5px;margin:0}.container[_ngcontent-%COMP%]{margin:2em;height:100vh}"]})}}return n})(),e_e=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-schedule"]],decls:45,vars:1,consts:[[1,"page-headline"],[2,"margin","2em"],[1,"headline"],[1,"grid-system"],[1,"grid-item-1","left-column"],[1,"grid-item-2","right-column"],[1,"grid-item-3","left-column"],[1,"grid-item-4","right-column"],[1,"grid-item-5","left-column"],[1,"grid-item-6","right-column"],[1,"left-column"],[1,"right-column"],[3,"routerLink"]],template:function(r,i){1&r&&(me(0,"div",0),Se(1,"SCHEDULE"),Ie(),me(2,"div",1),Se(3,"This schedule gives a general outline of the wedding day. Apart from when the ceremony starts, and when the venue of the wedding party closes, times are only approximate. Our wish is for everyone to enjoy a day free of stress, in good company with the wedding couple, family and friends."),Ie(),me(4,"div",2),Se(5,"CHURCH"),Ie(),me(6,"div",3)(7,"div",4),Se(8,"14:30"),Ie(),me(9,"div",5),Se(10,"Wedding cermony starts in Domkyrkan."),Ie(),me(11,"div",6),Se(12,"15:30"),Ie(),me(13,"div",7),Se(14,"Walk from Domkyrkan to Residensbron to embark on S/S F\xe4rjan 4. The walk is approximately 700 m."),Ie(),me(15,"div",8),Se(16,"15:45"),Ie(),me(17,"div",9),Se(18,"S/S F\xe4rjan 4 leaves Residensbron for a 1.5 - 2 hour tour of G\xf6teborg harbour. Drinks and snacks will be provided onboard. "),me(19,"p")(20,"b"),Se(21,"Note:"),Ie(),Se(22," There is no toilet available onboard."),Ie()()(),me(23,"div",2),Se(24,"WEDDING PARTY"),Ie(),me(25,"div",3)(26,"div",10),Se(27,"17:30"),Ie(),me(28,"div",11),Se(29,"Arrival at Restaurant River On The Pier. Welcome drinks and hang out on the docks."),Ie(),me(30,"div",10),Se(31,"19:00"),Ie(),me(32,"div",11),Se(33,"Three course dinner and wedding cake. Anyone keen on holding a speech? This is your moment. Reach out to the toastmaster, details in the "),me(34,"a",12),Se(35,"FAQ"),Ie(),Se(36,"."),Ie(),me(37,"div",10),Se(38,"21:00"),Ie(),me(39,"div",11),Se(40,"Music and live artists."),Ie(),me(41,"div",10),Se(42,"02:00"),Ie(),me(43,"div",11),Se(44,"The restaurant closes and we have to leave."),Ie()()),2&r&&(Bt(34),Tn("routerLink","/FAQ"))},dependencies:[Cm],styles:[".page-headline[_ngcontent-%COMP%]{background-color:#96a498;color:#fff;display:flex;justify-content:center;font-size:32px;width:100%;padding:5px;margin:0}.headline[_ngcontent-%COMP%]{display:flex;justify-content:center;background-color:#96a498;color:#fff;font-size:22px}.grid-system[_ngcontent-%COMP%]{display:grid;grid-template-columns:10% auto;grid-template-rows:auto;margin:2em}.left-column[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;margin-bottom:2em}.right-column[_ngcontent-%COMP%]{padding-left:2em;margin-bottom:2em;margin-right:15%}.right-column[_ngcontent-%COMP%]:last-child{margin-bottom:0}a[_ngcontent-%COMP%]{text-decoration:none;color:#00f}@media (max-width: 1000px){.page-headline[_ngcontent-%COMP%]{font-size:26px}}@media (max-width: 800px){.page-headline[_ngcontent-%COMP%]{font-size:22px}}@media (max-width: 600px){.page-headline[_ngcontent-%COMP%]{font-size:18px}}@media (max-width: 450px){.page-headline[_ngcontent-%COMP%]{font-size:16px}}"]})}}return n})(),t_e=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-contact"]],decls:2,vars:0,consts:[[1,"page-headline"]],template:function(r,i){1&r&&(me(0,"div",0),Se(1,"CONTACT"),Ie())},styles:[".page-headline[_ngcontent-%COMP%]{background-color:#96a498;color:#fff;display:flex;justify-content:center;font-size:32px;width:100%;padding:5px;margin:0}.container[_ngcontent-%COMP%]{height:100vh;margin:2em}@media (max-width: 1000px){.page-headline[_ngcontent-%COMP%]{font-size:26px}}@media (max-width: 800px){.page-headline[_ngcontent-%COMP%]{font-size:22px}}@media (max-width: 600px){.page-headline[_ngcontent-%COMP%]{font-size:18px}}@media (max-width: 450px){.page-headline[_ngcontent-%COMP%]{font-size:16px}}"]})}}return n})(),n_e=(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-error"]],decls:5,vars:0,consts:[[1,"container"]],template:function(r,i){1&r&&(me(0,"div",0)(1,"h1"),Se(2,"404: Page Not Found"),Ie(),me(3,"p"),Se(4,"The page you are looking for cannot be found or you do not have access to this page."),Ie()())},styles:[".container[_ngcontent-%COMP%]{text-align:center;margin:30px 0}"]})}}return n})(),s3=(()=>{class n{constructor(t){this.http=t,this.appCheckToken=null,console.log("FirebaseService initialized"),this.appCheckToken=localStorage.getItem("firebaseAppCheckToken")}fetchGifts(){const r=new Xs({"X-Firebase-AppCheck":this.appCheckToken||""});return this.http.get("https://wedding-29b48-default-rtdb.europe-west1.firebasedatabase.app/gifts.json",{headers:r}).pipe(de(i=>{const s=[];for(const o in i)s.push({...i[o]});return s}))}updateClaim(t,r){return this.http.patch("https://wedding-29b48-default-rtdb.europe-west1.firebasedatabase.app//"+t+".json",r)}addGuest(t){return this.http.post("https://wedding-29b48-default-rtdb.europe-west1.firebasedatabase.app/guests.json",t)}static{this.\u0275fac=function(r){return new(r||n)(Ee(aP))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function r_e(n,e){1&n&&(me(0,"div",11),Se(1,"Name missing"),Ie())}let i_e=(()=>{class n{constructor(t){this.firebaseService=t,this.validName=!0}addGuest(t,r){try{this.validateName(t.name),this.firebaseService.addGuest(t).subscribe(),this.validName=!0,r.reset()}catch(i){this.validName=!1,console.error("Adding a Guest failed: "+i)}}validateName(t){if(t.length<1)throw Error}static{this.\u0275fac=function(r){return new(r||n)(_e(s3))}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-rsvp"]],decls:20,vars:1,consts:[[1,"page-headline"],[1,"container"],[1,"text-container"],[1,"form-container"],[1,"form",3,"ngSubmit"],["guestForm","ngForm"],["type","text","name","name","ngModel","",1,"input-field"],["class","error-message",4,"ngIf"],["type","text","name","plusOne","ngModel","",1,"input-field"],["name","additional","rows","5","ngModel","",1,"input-field"],["type","submit","value","Send",1,"submit-button"],[1,"error-message"]],template:function(r,i){if(1&r){const s=Al();me(0,"div",0),Se(1,"RSVP"),Ie(),me(2,"div",1)(3,"div",2)(4,"p"),Se(5,"Lorem ipsum dolor sit, amet consectetur adipisicing elit. Ipsam natus deleniti ex delectus at libero consequatur est sequi numquam eveniet! "),Ie()(),me(6,"div",3)(7,"form",4,5),An("ngSubmit",function(){ni(s);const a=Ko(8);return ri(i.addGuest(a.value,a))}),me(9,"label"),Se(10,"Name"),Ie(),Tr(11,"input",6),go(12,r_e,2,0,"div",7),me(13,"label"),Se(14,"Plus one (if any)"),Ie(),Tr(15,"input",8),me(16,"label"),Se(17,"Additional info"),Ie(),Tr(18,"textarea",9)(19,"input",10),Ie()()()}2&r&&(Bt(12),Tn("ngIf",!i.validName))},dependencies:[yI,LW,Qw,CW,TW,Jx,oC],styles:[".page-headline[_ngcontent-%COMP%]{background-color:#96a498;color:#fff;display:flex;justify-content:center;font-size:32px;width:100%;padding:5px;margin:0}.container[_ngcontent-%COMP%]{height:100vh;margin:2em}.text-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:14px}.form-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-start}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:400px;height:auto;background-color:#96a498;color:#fff;border-radius:10px;padding:1em}label[_ngcontent-%COMP%]{font-size:18px;margin-top:1em}.input-field[_ngcontent-%COMP%]{margin-top:.5em;margin-bottom:.5em;width:300px}.submit-button[_ngcontent-%COMP%]{margin-top:.5em;margin-bottom:2em;width:50px}.error-message[_ngcontent-%COMP%]{color:#fff}@media (max-width: 1000px){.page-headline[_ngcontent-%COMP%]{font-size:26px}label[_ngcontent-%COMP%]{font-size:16px}.form[_ngcontent-%COMP%]{width:300px;height:auto}.input-field[_ngcontent-%COMP%]{width:200px}}@media (max-width: 800px){.page-headline[_ngcontent-%COMP%]{font-size:22px}label[_ngcontent-%COMP%]{font-size:14px}}@media (max-width: 600px){.page-headline[_ngcontent-%COMP%]{font-size:18px}.form[_ngcontent-%COMP%]{width:200px;height:auto}.input-field[_ngcontent-%COMP%]{width:150px}label[_ngcontent-%COMP%]{font-size:12px}}@media (max-width: 450px){.page-headline[_ngcontent-%COMP%]{font-size:16px}.form[_ngcontent-%COMP%]{width:150px;height:auto}.input-field[_ngcontent-%COMP%]{width:120px}label[_ngcontent-%COMP%]{font-size:12px}}"]})}}return n})();const o3="@firebase/database";let tM="";class s_e{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Fr(t))}get(e){const t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:E_(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}class o_e{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return aa(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}const u3=function(n){try{if(typeof window<"u"&&typeof window[n]<"u"){const e=window[n];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new s_e(e)}}catch{}return new o_e},nd=u3("localStorage"),nM=u3("sessionStorage"),ep=new mP("@firebase/database"),c3=function(){let n=1;return function(){return n++}}(),d3=function(n){const e=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);if(i>=55296&&i<=56319){const s=i-55296;r++,Ce(r<n.length,"Surrogate pair missing trail surrogate."),i=65536+(s<<10)+(n.charCodeAt(r)-56320)}i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=63&i|128):i<65536?(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=63&i|128):(e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=63&i|128)}return e}(n),t=new Ide;t.update(e);const r=t.digest();return dC.encodeByteArray(r)},Z_=function(...n){let e="";for(let t=0;t<n.length;t++){const r=n[t];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?e+=Z_.apply(null,r):e+="object"==typeof r?Fr(r):r,e+=" "}return e};let rd=null,h3=!0;const Yr=function(...n){if(!0===h3&&(h3=!1,null===rd&&!0===nM.get("logging_enabled")&&function(n,e){Ce(!e||!0===n||!1===n,"Can't turn on custom loggers persistently."),!0===n?(ep.logLevel=Rn.VERBOSE,rd=ep.log.bind(ep),e&&nM.set("logging_enabled",!0)):"function"==typeof n?rd=n:(rd=null,nM.remove("logging_enabled"))}(!0)),rd){const e=Z_.apply(null,n);rd(e)}},ey=function(n){return function(...e){Yr(n,...e)}},rM=function(...n){const e="FIREBASE INTERNAL ERROR: "+Z_(...n);ep.error(e)},fa=function(...n){const e=`FIREBASE FATAL ERROR: ${Z_(...n)}`;throw ep.error(e),new Error(e)},Si=function(...n){const e="FIREBASE WARNING: "+Z_(...n);ep.warn(e)},u0=function(n){return"number"==typeof n&&(n!=n||n===Number.POSITIVE_INFINITY||n===Number.NEGATIVE_INFINITY)},yu="[MIN_NAME]",rl="[MAX_NAME]",id=function(n,e){if(n===e)return 0;if(n===yu||e===rl)return-1;if(e===yu||n===rl)return 1;{const t=m3(n),r=m3(e);return null!==t?null!==r?t-r==0?n.length-e.length:t-r:-1:null!==r?1:n<e?-1:1}},u_e=function(n,e){return n===e?0:n<e?-1:1},ty=function(n,e){if(e&&n in e)return e[n];throw new Error("Missing required key ("+n+") in object: "+Fr(e))},iM=function(n){if("object"!=typeof n||null===n)return Fr(n);const e=[];for(const r in n)e.push(r);e.sort();let t="{";for(let r=0;r<e.length;r++)0!==r&&(t+=","),t+=Fr(e[r]),t+=":",t+=iM(n[e[r]]);return t+="}",t},p3=function(n,e){const t=n.length;if(t<=e)return[n];const r=[];for(let i=0;i<t;i+=e)r.push(n.substring(i,i+e>t?t:i+e));return r};function Jr(n,e){for(const t in n)n.hasOwnProperty(t)&&e(t,n[t])}const g3=function(n){Ce(!u0(n),"Invalid JSON number");const r=1023;let i,s,o,a,l;0===n?(s=0,o=0,i=1/n==-1/0?1:0):(i=n<0,(n=Math.abs(n))>=Math.pow(2,1-r)?(a=Math.min(Math.floor(Math.log(n)/Math.LN2),r),s=a+r,o=Math.round(n*Math.pow(2,52-a)-Math.pow(2,52))):(s=0,o=Math.round(n/Math.pow(2,-1074))));const u=[];for(l=52;l;l-=1)u.push(o%2?1:0),o=Math.floor(o/2);for(l=11;l;l-=1)u.push(s%2?1:0),s=Math.floor(s/2);u.push(i?1:0),u.reverse();const d=u.join("");let p="";for(l=0;l<64;l+=8){let _=parseInt(d.substr(l,8),2).toString(16);1===_.length&&(_="0"+_),p+=_}return p.toLowerCase()},f_e=new RegExp("^-?(0*)\\d{1,10}$"),m3=function(n){if(f_e.test(n)){const e=Number(n);if(e>=-2147483648&&e<=2147483647)return e}return null},tp=function(n){try{n()}catch(e){setTimeout(()=>{throw Si("Exception was thrown by user callback.",e.stack||""),e},Math.floor(0))}},ny=function(n,e){const t=setTimeout(n,e);return"number"==typeof t&&typeof Deno<"u"&&Deno.unrefTimer?Deno.unrefTimer(t):"object"==typeof t&&t.unref&&t.unref(),t};class __e{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=t?.getImmediate({optional:!0}),this.appCheck||t?.get().then(r=>this.appCheck=r)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,r)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(r=>r.addTokenListener(e))}notifyForInvalidToken(){Si(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}class y_e{constructor(e,t,r){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(i=>this.auth_=i)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(t=>t&&"auth/token-not-initialized"===t.code?(Yr("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)):new Promise((t,r)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,r):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';e+="credential"in this.firebaseOptions_?'Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?'Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':'Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',Si(e)}}let ry=(()=>{class n{constructor(t){this.accessToken=t}getToken(t){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(t){t(this.accessToken)}removeTokenChangeListener(t){}notifyForInvalidToken(){}}return n.OWNER="owner",n})();const I3=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,T3="websocket",A3="long_polling";class oM{constructor(e,t,r,i,s=!1,o="",a=!1,l=!1){this.secure=t,this.namespace=r,this.webSocketOnly=i,this.nodeAdmin=s,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this.isUsingEmulator=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=nd.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&nd.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){return`${this.secure?"https://":"http://"}${this.host}/${this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:""}`}}function b3(n,e,t){let r;if(Ce("string"==typeof e,"typeof type must == string"),Ce("object"==typeof t,"typeof params must == object"),e===T3)r=(n.secure?"wss://":"ws://")+n.internalHost+"/.ws?";else{if(e!==A3)throw new Error("Unknown connection type: "+e);r=(n.secure?"https://":"http://")+n.internalHost+"/.lp?"}(function v_e(n){return n.host!==n.internalHost||n.isCustomHost()||n.includeNamespaceInQueryParams})(n)&&(t.ns=n.namespace);const i=[];return Jr(t,(s,o)=>{i.push(s+"="+o)}),r+i.join("&")}class E_e{constructor(){this.counters_={}}incrementCounter(e,t=1){aa(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return rde(this.counters_)}}const aM={},lM={};function uM(n){const e=n.toString();return aM[e]||(aM[e]=new E_e),aM[e]}class w_e{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){const r=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let i=0;i<r.length;++i)r[i]&&tp(()=>{this.onMessage_(r[i])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}class vu{constructor(e,t,r,i,s,o,a){this.connId=e,this.repoInfo=t,this.applicationId=r,this.appCheckToken=i,this.authToken=s,this.transportSessionId=o,this.lastSessionId=a,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=ey(e),this.stats_=uM(t),this.urlFn=l=>(this.appCheckToken&&(l.ac=this.appCheckToken),b3(t,A3,l))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new w_e(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),function(n){if("complete"===document.readyState)n();else{let e=!1;const t=function(){document.body?e||(e=!0,n()):setTimeout(t,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",t,!1),window.addEventListener("load",t,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&t()}),window.attachEvent("onload",t))}}(()=>{if(this.isClosed_)return;this.scriptTagHolder=new cM((...s)=>{const[o,a,l,u,d]=s;if(this.incrementIncomingBytes_(s),this.scriptTagHolder)if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,"start"===o)this.id=a,this.password=l;else{if("close"!==o)throw new Error("Unrecognized command received: "+o);a?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(a,()=>{this.onClosed_()})):this.onClosed_()}},(...s)=>{const[o,a]=s;this.incrementIncomingBytes_(s),this.myPacketOrderer.handleResponse(o,a)},()=>{this.onClosed_()},this.urlFn);const r={start:"t"};r.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(r.cb=this.scriptTagHolder.uniqueCallbackIdentifier),r.v="5",this.transportSessionId&&(r.s=this.transportSessionId),this.lastSessionId&&(r.ls=this.lastSessionId),this.applicationId&&(r.p=this.applicationId),this.appCheckToken&&(r.ac=this.appCheckToken),typeof location<"u"&&location.hostname&&I3.test(location.hostname)&&(r.r="f");const i=this.urlFn(r);this.log_("Connecting via long-poll to "+i),this.scriptTagHolder.addTag(i,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){vu.forceAllow_=!0}static forceDisallow(){vu.forceDisallow_=!0}static isAvailable(){return!(!vu.forceAllow_&&(vu.forceDisallow_||!(typeof document<"u")||null==document.createElement||"object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href)||"object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){const t=Fr(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);const r=E4(t),i=p3(r,1840);for(let s=0;s<i.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,i.length,i[s]),this.curSegmentNum++}addDisconnectPingFrame(e,t){this.myDisconnFrame=document.createElement("iframe");const r={dframe:"t"};r.id=e,r.pw=t,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){const t=Fr(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class cM{constructor(e,t,r,i){this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=c3(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=cM.createIFrame_();let s="";this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)&&(s='<script>document.domain="'+document.domain+'";<\/script>');const o="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(o),this.myIFrame.doc.close()}catch(a){Yr("frame writing exception"),a.stack&&Yr(a.stack),Yr(a)}}}static createIFrame_(){const e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||Yr("No IE domain setting required")}catch{const r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));const e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;const e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),r="",i=0;for(;this.pendingSegs.length>0&&this.pendingSegs[0].d.length+30+r.length<=1870;){const o=this.pendingSegs.shift();r=r+"&seg"+i+"="+o.seg+"&ts"+i+"="+o.ts+"&d"+i+"="+o.d,i++}return t+=r,this.addLongPollTag_(t,this.currentSerial),!0}return!1}enqueueSegment(e,t,r){this.pendingSegs.push({seg:e,ts:t,d:r}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);const r=()=>{this.outstandingRequests.delete(t),this.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,()=>{clearTimeout(i),r()})}addTag(e,t){setTimeout(()=>{try{if(!this.sendNewPolls)return;const r=this.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){const i=r.readyState;(!i||"loaded"===i||"complete"===i)&&(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=()=>{Yr("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(r)}catch{}},Math.floor(1))}}let d0=null;typeof MozWebSocket<"u"?d0=MozWebSocket:typeof WebSocket<"u"&&(d0=WebSocket);let np=(()=>{class n{constructor(t,r,i,s,o,a,l){this.connId=t,this.applicationId=i,this.appCheckToken=s,this.authToken=o,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=ey(this.connId),this.stats_=uM(r),this.connURL=n.connectionURL_(r,a,l,s,i),this.nodeAdmin=r.nodeAdmin}static connectionURL_(t,r,i,s,o){const a={v:"5"};return typeof location<"u"&&location.hostname&&I3.test(location.hostname)&&(a.r="f"),r&&(a.s=r),i&&(a.ls=i),s&&(a.ac=s),o&&(a.p=o),b3(t,T3,a)}open(t,r){this.onDisconnect=r,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,nd.set("previous_websocket_failure",!0);try{let i;0,this.mySock=new d0(this.connURL,[],i)}catch(i){this.log_("Error instantiating WebSocket.");const s=i.message||i.data;return s&&this.log_(s),void this.onClosed_()}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=i=>{this.handleIncomingFrame(i)},this.mySock.onerror=i=>{this.log_("WebSocket error.  Closing connection.");const s=i.message||i.data;s&&this.log_(s),this.onClosed_()}}start(){}static forceDisallow(){n.forceDisallow_=!0}static isAvailable(){let t=!1;if(typeof navigator<"u"&&navigator.userAgent){const i=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);i&&i.length>1&&parseFloat(i[1])<4.4&&(t=!0)}return!t&&null!==d0&&!n.forceDisallow_}static previouslyFailed(){return nd.isInMemoryStorage||!0===nd.get("previous_websocket_failure")}markConnectionHealthy(){nd.remove("previous_websocket_failure")}appendFrame_(t){if(this.frames.push(t),this.frames.length===this.totalFrames){const r=this.frames.join("");this.frames=null;const i=E_(r);this.onMessage(i)}}handleNewFrameCount_(t){this.totalFrames=t,this.frames=[]}extractFrameCount_(t){if(Ce(null===this.frames,"We already have a frame buffer"),t.length<=6){const r=Number(t);if(!isNaN(r))return this.handleNewFrameCount_(r),null}return this.handleNewFrameCount_(1),t}handleIncomingFrame(t){if(null===this.mySock)return;const r=t.data;if(this.bytesReceived+=r.length,this.stats_.incrementCounter("bytes_received",r.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(r);else{const i=this.extractFrameCount_(r);null!==i&&this.appendFrame_(i)}}send(t){this.resetKeepAlive();const r=Fr(t);this.bytesSent+=r.length,this.stats_.incrementCounter("bytes_sent",r.length);const i=p3(r,16384);i.length>1&&this.sendString_(String(i.length));for(let s=0;s<i.length;s++)this.sendString_(i[s])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(t){try{this.mySock.send(t)}catch(r){this.log_("Exception thrown from WebSocket.send():",r.message||r.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}return n.responsesRequiredToBeHealthy=2,n.healthyTimeout=3e4,n})(),M3=(()=>{class n{static get ALL_TRANSPORTS(){return[vu,np]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}constructor(t){this.initTransports_(t)}initTransports_(t){const r=np&&np.isAvailable();let i=r&&!np.previouslyFailed();if(t.webSocketOnly&&(r||Si("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),i=!0),i)this.transports_=[np];else{const s=this.transports_=[];for(const o of n.ALL_TRANSPORTS)o&&o.isAvailable()&&s.push(o);n.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}return n.globalTransportInitialized_=!1,n})();class B3{constructor(e,t,r,i,s,o,a,l,u,d){this.id=e,this.repoInfo_=t,this.applicationId_=r,this.appCheckToken_=i,this.authToken_=s,this.onMessage_=o,this.onReady_=a,this.onDisconnect_=l,this.onKill_=u,this.lastSessionId=d,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=ey("c:"+this.id+":"),this.transportManager_=new M3(t),this.log_("Connection created"),this.start_()}start_(){const e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,r)},Math.floor(0));const i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=ny(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(i)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){const t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){const t=ty("t",e),r=ty("d",e);if("c"===t)this.onSecondaryControl_(r);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(r)}}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){const t=ty("t",e),r=ty("d",e);"c"===t?this.onControl_(r):"d"===t&&this.onDataMessage_(r)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){const t=ty("t",e);if("d"in e){const r=e.d;if("h"===t){const i=Object.assign({},r);this.repoInfo_.isUsingEmulator&&(i.h=this.repoInfo_.host),this.onHandshake_(i)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let i=0;i<this.pendingDataMessages.length;++i)this.onDataMessage_(this.pendingDataMessages[i]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(r):"r"===t?this.onReset_(r):"e"===t?rM("Server Error: "+r):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):rM("Unknown control packet command: "+t)}}onHandshake_(e){const t=e.ts,r=e.v,i=e.h;this.sessionId=e.s,this.repoInfo_.host=i,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==r&&Si("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){const e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;const t=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,r),ny(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):ny(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){!this.isHealthy_&&1===this.state_&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){const e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(nd.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}class j3{put(e,t,r,i){}merge(e,t,r,i){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,r){}onDisconnectMerge(e,t,r){}onDisconnectCancel(e,t){}reportStats(e){}}class $3{constructor(e){this.allowedEvents_=e,this.listeners_={},Ce(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){const r=[...this.listeners_[e]];for(let i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)}}on(e,t,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:r});const i=this.getInitialEvent(e);i&&t.apply(r,i)}off(e,t,r){this.validateEventType_(e);const i=this.listeners_[e]||[];for(let s=0;s<i.length;s++)if(i[s].callback===t&&(!r||r===i[s].context))return void i.splice(s,1)}validateEventType_(e){Ce(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}class h0 extends $3{static getInstance(){return new h0}constructor(){super(["online"]),this.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!T4()&&(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}getInitialEvent(e){return Ce("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class rn{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let r=0;for(let i=0;i<this.pieces_.length;i++)this.pieces_[i].length>0&&(this.pieces_[r]=this.pieces_[i],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function qt(){return new rn("")}function wt(n){return n.pieceNum_>=n.pieces_.length?null:n.pieces_[n.pieceNum_]}function Eu(n){return n.pieces_.length-n.pieceNum_}function In(n){let e=n.pieceNum_;return e<n.pieces_.length&&e++,new rn(n.pieces_,e)}function hM(n){return n.pieceNum_<n.pieces_.length?n.pieces_[n.pieces_.length-1]:null}function iy(n,e=0){return n.pieces_.slice(n.pieceNum_+e)}function W3(n){if(n.pieceNum_>=n.pieces_.length)return null;const e=[];for(let t=n.pieceNum_;t<n.pieces_.length-1;t++)e.push(n.pieces_[t]);return new rn(e,0)}function er(n,e){const t=[];for(let r=n.pieceNum_;r<n.pieces_.length;r++)t.push(n.pieces_[r]);if(e instanceof rn)for(let r=e.pieceNum_;r<e.pieces_.length;r++)t.push(e.pieces_[r]);else{const r=e.split("/");for(let i=0;i<r.length;i++)r[i].length>0&&t.push(r[i])}return new rn(t,0)}function Ct(n){return n.pieceNum_>=n.pieces_.length}function Qi(n,e){const t=wt(n),r=wt(e);if(null===t)return e;if(t===r)return Qi(In(n),In(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+n+")")}function fM(n,e){if(Eu(n)!==Eu(e))return!1;for(let t=n.pieceNum_,r=e.pieceNum_;t<=n.pieces_.length;t++,r++)if(n.pieces_[t]!==e.pieces_[r])return!1;return!0}function to(n,e){let t=n.pieceNum_,r=e.pieceNum_;if(Eu(n)>Eu(e))return!1;for(;t<n.pieces_.length;){if(n.pieces_[t]!==e.pieces_[r])return!1;++t,++r}return!0}class W_e{constructor(e,t){this.errorPrefix_=t,this.parts_=iy(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let r=0;r<this.parts_.length;r++)this.byteLength_+=_C(this.parts_[r]);G3(this)}}function G3(n){if(n.byteLength_>768)throw new Error(n.errorPrefix_+"has a key path longer than 768 bytes ("+n.byteLength_+").");if(n.parts_.length>32)throw new Error(n.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+sd(n))}function sd(n){return 0===n.parts_.length?"":"in property '"+n.parts_.join(".")+"'"}class pM extends $3{static getInstance(){return new pM}constructor(){let e,t;super(["visible"]),typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(t="visibilitychange",e="hidden"):typeof document.mozHidden<"u"?(t="mozvisibilitychange",e="mozHidden"):typeof document.msHidden<"u"?(t="msvisibilitychange",e="msHidden"):typeof document.webkitHidden<"u"&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{const r=!document[e];r!==this.visible_&&(this.visible_=r,this.trigger("visible",r))},!1)}getInitialEvent(e){return Ce("visible"===e,"Unknown event type: "+e),[this.visible_]}}const sy=1e3;let p0,od=(()=>{class n extends j3{constructor(t,r,i,s,o,a,l,u){if(super(),this.repoInfo_=t,this.applicationId_=r,this.onDataUpdate_=i,this.onConnectStatus_=s,this.onServerInfoUpdate_=o,this.authTokenProvider_=a,this.appCheckTokenProvider_=l,this.authOverride_=u,this.id=n.nextPersistentConnectionId_++,this.log_=ey("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=sy,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,u)throw new Error("Auth override specified in options, but not supported on non Node.js platforms");pM.getInstance().on("visible",this.onVisible_,this),-1===t.host.indexOf("fblocal")&&h0.getInstance().on("online",this.onOnline_,this)}sendRequest(t,r,i){const s=++this.requestNumber_,o={r:s,a:t,b:r};this.log_(Fr(o)),Ce(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(o),i&&(this.requestCBHash_[s]=i)}get(t){this.initConnection_();const r=new ou,s={action:"g",request:{p:t._path.toString(),q:t._queryObject},onComplete:a=>{const l=a.d;"ok"===a.s?r.resolve(l):r.reject(l)}};return this.outstandingGets_.push(s),this.outstandingGetCount_++,this.connected_&&this.sendGet_(this.outstandingGets_.length-1),r.promise}listen(t,r,i,s){this.initConnection_();const o=t._queryIdentifier,a=t._path.toString();this.log_("Listen called for "+a+" "+o),this.listens.has(a)||this.listens.set(a,new Map),Ce(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Ce(!this.listens.get(a).has(o),"listen() called twice for same path/queryId.");const l={onComplete:s,hashFn:r,query:t,tag:i};this.listens.get(a).set(o,l),this.connected_&&this.sendListen_(l)}sendGet_(t){const r=this.outstandingGets_[t];this.sendRequest("g",r.request,i=>{delete this.outstandingGets_[t],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),r.onComplete&&r.onComplete(i)})}sendListen_(t){const r=t.query,i=r._path.toString(),s=r._queryIdentifier;this.log_("Listen on "+i+" for "+s);const o={p:i};t.tag&&(o.q=r._queryObject,o.t=t.tag),o.h=t.hashFn(),this.sendRequest("q",o,l=>{const u=l.d,d=l.s;n.warnOnListenWarnings_(u,r),(this.listens.get(i)&&this.listens.get(i).get(s))===t&&(this.log_("listen response",l),"ok"!==d&&this.removeListen_(i,s),t.onComplete&&t.onComplete(d,u))})}static warnOnListenWarnings_(t,r){if(t&&"object"==typeof t&&aa(t,"w")){const i=Ff(t,"w");if(Array.isArray(i)&&~i.indexOf("no_index")){const s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',o=r._path.toString();Si(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${s} at ${o} to your security rules for better performance.`)}}}refreshAuthToken(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(t)}reduceReconnectDelayIfAdminCredential_(t){(t&&40===t.length||function(n){const e=gC(n).claims;return"object"==typeof e&&!0===e.admin}(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(t){this.appCheckToken_=t,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){const t=this.authToken_,r=function(n){const t=gC(n).claims;return!!t&&"object"==typeof t&&t.hasOwnProperty("iat")}(t)?"auth":"gauth",i={cred:t};null===this.authOverride_?i.noauth=!0:"object"==typeof this.authOverride_&&(i.authvar=this.authOverride_),this.sendRequest(r,i,s=>{const o=s.s,a=s.d||"error";this.authToken_===t&&("ok"===o?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(o,a))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},t=>{const r=t.s,i=t.d||"error";"ok"===r?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(r,i)})}unlisten(t,r){const i=t._path.toString(),s=t._queryIdentifier;this.log_("Unlisten called for "+i+" "+s),Ce(t._queryParams.isDefault()||!t._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(i,s)&&this.connected_&&this.sendUnlisten_(i,s,t._queryObject,r)}sendUnlisten_(t,r,i,s){this.log_("Unlisten on "+t+" for "+r);const o={p:t};s&&(o.q=i,o.t=s),this.sendRequest("n",o)}onDisconnectPut(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:r,onComplete:i})}onDisconnectMerge(t,r,i){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",t,r,i):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:r,onComplete:i})}onDisconnectCancel(t,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",t,null,r):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:r})}sendOnDisconnect_(t,r,i,s){const o={p:r,d:i};this.log_("onDisconnect "+t,o),this.sendRequest(t,o,a=>{s&&setTimeout(()=>{s(a.s,a.d)},Math.floor(0))})}put(t,r,i,s){this.putInternal("p",t,r,i,s)}merge(t,r,i,s){this.putInternal("m",t,r,i,s)}putInternal(t,r,i,s,o){this.initConnection_();const a={p:r,d:i};void 0!==o&&(a.h=o),this.outstandingPuts_.push({action:t,request:a,onComplete:s}),this.outstandingPutCount_++,this.connected_?this.sendPut_(this.outstandingPuts_.length-1):this.log_("Buffering put: "+r)}sendPut_(t){const r=this.outstandingPuts_[t].action,i=this.outstandingPuts_[t].request,s=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(r,i,o=>{this.log_(r+" response",o),delete this.outstandingPuts_[t],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),s&&s(o.s,o.d)})}reportStats(t){if(this.connected_){const r={c:t};this.log_("reportStats",r),this.sendRequest("s",r,i=>{"ok"!==i.s&&this.log_("reportStats","Error sending stats: "+i.d)})}}onDataMessage_(t){if("r"in t){this.log_("from server: "+Fr(t));const r=t.r,i=this.requestCBHash_[r];i&&(delete this.requestCBHash_[r],i(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}}onDataPush_(t,r){this.log_("handleServerMessage",t,r),"d"===t?this.onDataUpdate_(r.p,r.d,!1,r.t):"m"===t?this.onDataUpdate_(r.p,r.d,!0,r.t):"c"===t?this.onListenRevoked_(r.p,r.q):"ac"===t?this.onAuthRevoked_(r.s,r.d):"apc"===t?this.onAppCheckRevoked_(r.s,r.d):"sd"===t?this.onSecurityDebugPacket_(r):rM("Unrecognized action received from server: "+Fr(t)+"\nAre you using the latest client?")}onReady_(t,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(t){Ce(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(t))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=sy,this.realtime_||this.scheduleConnect_(0)),this.visible_=t}onOnline_(t){t?(this.log_("Browser went online."),this.reconnectDelay_=sy,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){this.visible_?this.lastConnectionEstablishedTime_&&((new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=sy),this.lastConnectionEstablishedTime_=null):(this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime());const t=(new Date).getTime()-this.lastConnectionAttemptTime_;let r=Math.max(0,this.reconnectDelay_-t);r=Math.random()*r,this.log_("Trying to reconnect in "+r+"ms"),this.scheduleConnect_(r),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}establishConnection_(){var t=this;return(0,Z.A)(function*(){if(t.shouldReconnect_()){t.log_("Making a connection attempt"),t.lastConnectionAttemptTime_=(new Date).getTime(),t.lastConnectionEstablishedTime_=null;const r=t.onDataMessage_.bind(t),i=t.onReady_.bind(t),s=t.onRealtimeDisconnect_.bind(t),o=t.id+":"+n.nextConnectionId_++,a=t.lastSessionId;let l=!1,u=null;const d=function(){u?u.close():(l=!0,s())};t.realtime_={close:d,sendRequest:function(v){Ce(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(v)}};const _=t.forceTokenRefresh_;t.forceTokenRefresh_=!1;try{const[v,A]=yield Promise.all([t.authTokenProvider_.getToken(_),t.appCheckTokenProvider_.getToken(_)]);l?Yr("getToken() completed but was canceled"):(Yr("getToken() completed. Creating connection."),t.authToken_=v&&v.accessToken,t.appCheckToken_=A&&A.token,u=new B3(o,t.repoInfo_,t.applicationId_,t.appCheckToken_,t.authToken_,r,i,s,D=>{Si(D+" ("+t.repoInfo_.toString()+")"),t.interrupt("server_kill")},a))}catch(v){t.log_("Failed to get token: "+v),l||(t.repoInfo_.nodeAdmin&&Si(v),d())}}})()}interrupt(t){Yr("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(t){Yr("Resuming connection for reason: "+t),delete this.interruptReasons_[t],A4(this.interruptReasons_)&&(this.reconnectDelay_=sy,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(t){const r=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:r})}cancelSentTransactions_(){for(let t=0;t<this.outstandingPuts_.length;t++){const r=this.outstandingPuts_[t];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(t,r){let i;i=r?r.map(o=>iM(o)).join("$"):"default";const s=this.removeListen_(t,i);s&&s.onComplete&&s.onComplete("permission_denied")}removeListen_(t,r){const i=new rn(t).toString();let s;if(this.listens.has(i)){const o=this.listens.get(i);s=o.get(r),o.delete(r),0===o.size&&this.listens.delete(i)}else s=void 0;return s}onAuthRevoked_(t,r){Yr("Auth token revoked: "+t+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===t||"permission_denied"===t)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(t,r){Yr("App check token revoked: "+t+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===t||"permission_denied"===t)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))}restoreState_(){this.tryAuth(),this.tryAppCheck();for(const t of this.listens.values())for(const r of t.values())this.sendListen_(r);for(let t=0;t<this.outstandingPuts_.length;t++)this.outstandingPuts_[t]&&this.sendPut_(t);for(;this.onDisconnectRequestQueue_.length;){const t=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(t.action,t.pathString,t.data,t.onComplete)}for(let t=0;t<this.outstandingGets_.length;t++)this.outstandingGets_[t]&&this.sendGet_(t)}sendConnectStats_(){const t={};let r="js";t["sdk."+r+"."+tM.replace(/\./g,"-")]=1,T4()?t["framework.cordova"]=1:function fde(){return"object"==typeof navigator&&"ReactNative"===navigator.product}()&&(t["framework.reactnative"]=1),this.reportStats(t)}shouldReconnect_(){const t=h0.getInstance().currentlyOnline();return A4(this.interruptReasons_)&&t}}return n.nextPersistentConnectionId_=0,n.nextConnectionId_=0,n})();class Pt{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new Pt(e,t)}}class f0{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){const r=new Pt(yu,e),i=new Pt(yu,t);return 0!==this.compare(r,i)}minPost(){return Pt.MIN}}class Q3 extends f0{static get __EMPTY_NODE(){return p0}static set __EMPTY_NODE(e){p0=e}compare(e,t){return id(e.name,t.name)}isDefinedOn(e){throw Of("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return Pt.MIN}maxPost(){return new Pt(rl,p0)}makePost(e,t){return Ce("string"==typeof e,"KeyIndex indexValue must always be a string."),new Pt(e,p0)}toString(){return".key"}}const pa=new Q3;class g0{constructor(e,t,r,i,s=null){this.isReverse_=i,this.resultGenerator_=s,this.nodeStack_=[];let o=1;for(;!e.isEmpty();)if(o=t?r(e.key,t):1,i&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}getNext(){if(0===this.nodeStack_.length)return null;let t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;const e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}let mM,bo=(()=>{class n{constructor(t,r,i,s,o){this.key=t,this.value=r,this.color=i??n.RED,this.left=s??ds.EMPTY_NODE,this.right=o??ds.EMPTY_NODE}copy(t,r,i,s,o){return new n(t??this.key,r??this.value,i??this.color,s??this.left,o??this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||!!t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,r,i){let s=this;const o=i(t,s.key);return s=o<0?s.copy(null,null,null,s.left.insert(t,r,i),null):0===o?s.copy(null,r,null,null,null):s.copy(null,null,null,null,s.right.insert(t,r,i)),s.fixUp_()}removeMin_(){if(this.left.isEmpty())return ds.EMPTY_NODE;let t=this;return!t.left.isRed_()&&!t.left.left.isRed_()&&(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()}remove(t,r){let i,s;if(i=this,r(t,i.key)<0)!i.left.isEmpty()&&!i.left.isRed_()&&!i.left.left.isRed_()&&(i=i.moveRedLeft_()),i=i.copy(null,null,null,i.left.remove(t,r),null);else{if(i.left.isRed_()&&(i=i.rotateRight_()),!i.right.isEmpty()&&!i.right.isRed_()&&!i.right.left.isRed_()&&(i=i.moveRedRight_()),0===r(t,i.key)){if(i.right.isEmpty())return ds.EMPTY_NODE;s=i.right.min_(),i=i.copy(s.key,s.value,null,null,i.right.removeMin_())}i=i.copy(null,null,null,null,i.right.remove(t,r))}return i.fixUp_()}isRed_(){return this.color}fixUp_(){let t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t}moveRedLeft_(){let t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t}moveRedRight_(){let t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t}rotateLeft_(){const t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight_(){const t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip_(){const t=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,r)}checkMaxDepth_(){const t=this.check_();return Math.pow(2,t)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");const t=this.left.check_();if(t!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)}}return n.RED=!0,n.BLACK=!1,n})();class ds{constructor(e,t=ds.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new ds(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,bo.BLACK,null,null))}remove(e){return new ds(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,bo.BLACK,null,null))}get(e){let t,r=this.root_;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t)return r.value;t<0?r=r.left:t>0&&(r=r.right)}return null}getPredecessorKey(e){let t,r=this.root_,i=null;for(;!r.isEmpty();){if(t=this.comparator_(e,r.key),0===t){if(r.left.isEmpty())return i?i.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}t<0?r=r.left:t>0&&(i=r,r=r.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new g0(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new g0(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new g0(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new g0(this.root_,null,this.comparator_,!0,e)}}function Z_e(n,e){return id(n.name,e.name)}function gM(n,e){return id(n,e)}ds.EMPTY_NODE=new class X_e{copy(e,t,r,i,s){return this}insert(e,t,r){return new bo(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};const Y3=function(n){return"number"==typeof n?"number:"+g3(n):"string:"+n},J3=function(n){if(n.isLeafNode()){const e=n.val();Ce("string"==typeof e||"number"==typeof e||"object"==typeof e&&aa(e,".sv"),"Priority must be a string or number.")}else Ce(n===mM||n.isEmpty(),"priority of unexpected type.");Ce(n===mM||n.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};let X3,Z3,e7,rp=(()=>{class n{static set __childrenNodeConstructor(t){X3=t}static get __childrenNodeConstructor(){return X3}constructor(t,r=n.__childrenNodeConstructor.EMPTY_NODE){this.value_=t,this.priorityNode_=r,this.lazyHash_=null,Ce(null!=this.value_,"LeafNode shouldn't be created with null/undefined value."),J3(this.priorityNode_)}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(t){return new n(this.value_,t)}getImmediateChild(t){return".priority"===t?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}getChild(t){return Ct(t)?this:".priority"===wt(t)?this.priorityNode_:n.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(t,r){return null}updateImmediateChild(t,r){return".priority"===t?this.updatePriority(r):r.isEmpty()&&".priority"!==t?this:n.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,r).updatePriority(this.priorityNode_)}updateChild(t,r){const i=wt(t);return null===i?r:r.isEmpty()&&".priority"!==i?this:(Ce(".priority"!==i||1===Eu(t),".priority must be the last token in a path"),this.updateImmediateChild(i,n.__childrenNodeConstructor.EMPTY_NODE.updateChild(In(t),r)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(t,r){return!1}val(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let t="";this.priorityNode_.isEmpty()||(t+="priority:"+Y3(this.priorityNode_.val())+":");const r=typeof this.value_;t+=r+":",t+="number"===r?g3(this.value_):this.value_,this.lazyHash_=d3(t)}return this.lazyHash_}getValue(){return this.value_}compareTo(t){return t===n.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof n.__childrenNodeConstructor?-1:(Ce(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))}compareToLeafNode_(t){const r=typeof t.value_,i=typeof this.value_,s=n.VALUE_TYPE_ORDER.indexOf(r),o=n.VALUE_TYPE_ORDER.indexOf(i);return Ce(s>=0,"Unknown leaf type: "+r),Ce(o>=0,"Unknown leaf type: "+i),s===o?"object"===i?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:o-s}withIndex(){return this}isIndexed(){return!0}equals(t){return t===this||!!t.isLeafNode()&&(this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_))}}return n.VALUE_TYPE_ORDER=["object","boolean","number","string"],n})();const Nn=new class rye extends f0{compare(e,t){const r=e.node.getPriority(),i=t.node.getPriority(),s=r.compareTo(i);return 0===s?id(e.name,t.name):s}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return Pt.MIN}maxPost(){return new Pt(rl,new rp("[PRIORITY-POST]",e7))}makePost(e,t){const r=Z3(e);return new Pt(t,new rp("[PRIORITY-POST]",r))}toString(){return".priority"}},iye=Math.log(2);class sye{constructor(e){this.count=parseInt(Math.log(e+1)/iye,10),this.current_=this.count-1;const i=(s=>parseInt(Array(this.count+1).join("1"),2))();this.bits_=e+1&i}nextBitIsOne(){const e=!(this.bits_&1<<this.current_);return this.current_--,e}}const m0=function(n,e,t,r){n.sort(e);const i=function(l,u){const d=u-l;let p,_;if(0===d)return null;if(1===d)return p=n[l],_=t?t(p):p,new bo(_,p.node,bo.BLACK,null,null);{const v=parseInt(d/2,10)+l,A=i(l,v),D=i(v+1,u);return p=n[v],_=t?t(p):p,new bo(_,p.node,bo.BLACK,A,D)}},a=function(l){let u=null,d=null,p=n.length;const _=function(A,D){const P=p-A,H=p;p-=A;const V=i(P+1,H),Y=n[P],ae=t?t(Y):Y;v(new bo(ae,Y.node,D,null,V))},v=function(A){u?(u.left=A,u=A):(d=A,u=A)};for(let A=0;A<l.count;++A){const D=l.nextBitIsOne(),P=Math.pow(2,l.count-(A+1));D?_(P,bo.BLACK):(_(P,bo.BLACK),_(P,bo.RED))}return d}(new sye(n.length));return new ds(r||e,a)};let _M;const ip={};class il{static get Default(){return Ce(ip&&Nn,"ChildrenNode.ts has not been loaded"),_M=_M||new il({".priority":ip},{".priority":Nn}),_M}constructor(e,t){this.indexes_=e,this.indexSet_=t}get(e){const t=Ff(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof ds?t:null}hasIndex(e){return aa(this.indexSet_,e.toString())}addIndex(e,t){Ce(e!==pa,"KeyIndex always exists and isn't meant to be added to the IndexMap.");const r=[];let i=!1;const s=t.getIterator(Pt.Wrap);let a,o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();a=i?m0(r,e.getCompare()):ip;const l=e.toString(),u=Object.assign({},this.indexSet_);u[l]=e;const d=Object.assign({},this.indexes_);return d[l]=a,new il(d,u)}addToIndexes(e,t){const r=mC(this.indexes_,(i,s)=>{const o=Ff(this.indexSet_,s);if(Ce(o,"Missing index implementation for "+s),i===ip){if(o.isDefinedOn(e.node)){const a=[],l=t.getIterator(Pt.Wrap);let u=l.getNext();for(;u;)u.name!==e.name&&a.push(u),u=l.getNext();return a.push(e),m0(a,o.getCompare())}return ip}{const a=t.get(e.name);let l=i;return a&&(l=l.remove(new Pt(e.name,a))),l.insert(e,e.node)}});return new il(r,this.indexSet_)}removeFromIndexes(e,t){const r=mC(this.indexes_,i=>{if(i===ip)return i;{const s=t.get(e.name);return s?i.remove(new Pt(e.name,s)):i}});return new il(r,this.indexSet_)}}let oy,dt=(()=>{class n{static get EMPTY_NODE(){return oy||(oy=new n(new ds(gM),null,il.Default))}constructor(t,r,i){this.children_=t,this.priorityNode_=r,this.indexMap_=i,this.lazyHash_=null,this.priorityNode_&&J3(this.priorityNode_),this.children_.isEmpty()&&Ce(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}isLeafNode(){return!1}getPriority(){return this.priorityNode_||oy}updatePriority(t){return this.children_.isEmpty()?this:new n(this.children_,t,this.indexMap_)}getImmediateChild(t){if(".priority"===t)return this.getPriority();{const r=this.children_.get(t);return null===r?oy:r}}getChild(t){const r=wt(t);return null===r?this:this.getImmediateChild(r).getChild(In(t))}hasChild(t){return null!==this.children_.get(t)}updateImmediateChild(t,r){if(Ce(r,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(r);{const i=new Pt(t,r);let s,o;r.isEmpty()?(s=this.children_.remove(t),o=this.indexMap_.removeFromIndexes(i,this.children_)):(s=this.children_.insert(t,r),o=this.indexMap_.addToIndexes(i,this.children_));const a=s.isEmpty()?oy:this.priorityNode_;return new n(s,a,o)}}updateChild(t,r){const i=wt(t);if(null===i)return r;{Ce(".priority"!==wt(t)||1===Eu(t),".priority must be the last token in a path");const s=this.getImmediateChild(i).updateChild(In(t),r);return this.updateImmediateChild(i,s)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(t){if(this.isEmpty())return null;const r={};let i=0,s=0,o=!0;if(this.forEachChild(Nn,(a,l)=>{r[a]=l.val(t),i++,o&&n.INTEGER_REGEXP_.test(a)?s=Math.max(s,Number(a)):o=!1}),!t&&o&&s<2*i){const a=[];for(const l in r)a[l]=r[l];return a}return t&&!this.getPriority().isEmpty()&&(r[".priority"]=this.getPriority().val()),r}hash(){if(null===this.lazyHash_){let t="";this.getPriority().isEmpty()||(t+="priority:"+Y3(this.getPriority().val())+":"),this.forEachChild(Nn,(r,i)=>{const s=i.hash();""!==s&&(t+=":"+r+":"+s)}),this.lazyHash_=""===t?"":d3(t)}return this.lazyHash_}getPredecessorChildName(t,r,i){const s=this.resolveIndex_(i);if(s){const o=s.getPredecessorKey(new Pt(t,r));return o?o.name:null}return this.children_.getPredecessorKey(t)}getFirstChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.minKey();return i&&i.name}return this.children_.minKey()}getFirstChild(t){const r=this.getFirstChildName(t);return r?new Pt(r,this.children_.get(r)):null}getLastChildName(t){const r=this.resolveIndex_(t);if(r){const i=r.maxKey();return i&&i.name}return this.children_.maxKey()}getLastChild(t){const r=this.getLastChildName(t);return r?new Pt(r,this.children_.get(r)):null}forEachChild(t,r){const i=this.resolveIndex_(t);return i?i.inorderTraversal(s=>r(s.name,s.node)):this.children_.inorderTraversal(r)}getIterator(t){return this.getIteratorFrom(t.minPost(),t)}getIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getIteratorFrom(t,s=>s);{const s=this.children_.getIteratorFrom(t.name,Pt.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,t)<0;)s.getNext(),o=s.peek();return s}}getReverseIterator(t){return this.getReverseIteratorFrom(t.maxPost(),t)}getReverseIteratorFrom(t,r){const i=this.resolveIndex_(r);if(i)return i.getReverseIteratorFrom(t,s=>s);{const s=this.children_.getReverseIteratorFrom(t.name,Pt.Wrap);let o=s.peek();for(;null!=o&&r.compare(o,t)>0;)s.getNext(),o=s.peek();return s}}compareTo(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===ay?-1:0}withIndex(t){if(t===pa||this.indexMap_.hasIndex(t))return this;{const r=this.indexMap_.addIndex(t,this.children_);return new n(this.children_,this.priorityNode_,r)}}isIndexed(t){return t===pa||this.indexMap_.hasIndex(t)}equals(t){if(t===this)return!0;if(t.isLeafNode())return!1;{const r=t;if(this.getPriority().equals(r.getPriority())){if(this.children_.count()===r.children_.count()){const i=this.getIterator(Nn),s=r.getIterator(Nn);let o=i.getNext(),a=s.getNext();for(;o&&a;){if(o.name!==a.name||!o.node.equals(a.node))return!1;o=i.getNext(),a=s.getNext()}return null===o&&null===a}return!1}return!1}}resolveIndex_(t){return t===pa?null:this.indexMap_.get(t.toString())}}return n.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,n})();const ay=new class oye extends dt{constructor(){super(new ds(gM),dt.EMPTY_NODE,il.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return dt.EMPTY_NODE}isEmpty(){return!1}};Object.defineProperties(Pt,{MIN:{value:new Pt(yu,dt.EMPTY_NODE)},MAX:{value:new Pt(rl,ay)}}),Q3.__EMPTY_NODE=dt.EMPTY_NODE,rp.__childrenNodeConstructor=dt,function eye(n){mM=n}(ay),function nye(n){e7=n}(ay);const aye=!0;function sr(n,e=null){if(null===n)return dt.EMPTY_NODE;if("object"==typeof n&&".priority"in n&&(e=n[".priority"]),Ce(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof n&&".value"in n&&null!==n[".value"]&&(n=n[".value"]),"object"!=typeof n||".sv"in n)return new rp(n,sr(e));if(n instanceof Array||!aye){let t=dt.EMPTY_NODE;return Jr(n,(r,i)=>{if(aa(n,r)&&"."!==r.substring(0,1)){const s=sr(i);(s.isLeafNode()||!s.isEmpty())&&(t=t.updateImmediateChild(r,s))}}),t.updatePriority(sr(e))}{const t=[];let r=!1;if(Jr(n,(o,a)=>{if("."!==o.substring(0,1)){const l=sr(a);l.isEmpty()||(r=r||!l.getPriority().isEmpty(),t.push(new Pt(o,l)))}}),0===t.length)return dt.EMPTY_NODE;const s=m0(t,Z_e,o=>o.name,gM);if(r){const o=m0(t,Nn.getCompare());return new dt(s,sr(e),new il({".priority":o},{".priority":Nn}))}return new dt(s,sr(e),il.Default)}}!function tye(n){Z3=n}(sr);class yM extends f0{constructor(e){super(),this.indexPath_=e,Ce(!Ct(e)&&".priority"!==wt(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){const r=this.extractChild(e.node),i=this.extractChild(t.node),s=r.compareTo(i);return 0===s?id(e.name,t.name):s}makePost(e,t){const r=sr(e),i=dt.EMPTY_NODE.updateChild(this.indexPath_,r);return new Pt(t,i)}maxPost(){const e=dt.EMPTY_NODE.updateChild(this.indexPath_,ay);return new Pt(rl,e)}toString(){return iy(this.indexPath_,0).join("/")}}const vM=new class lye extends f0{compare(e,t){const r=e.node.compareTo(t.node);return 0===r?id(e.name,t.name):r}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return Pt.MIN}maxPost(){return Pt.MAX}makePost(e,t){const r=sr(e);return new Pt(t,r)}toString(){return".value"}};function t7(n){return{type:"value",snapshotNode:n}}function sp(n,e){return{type:"child_added",snapshotNode:e,childName:n}}function ly(n,e){return{type:"child_removed",snapshotNode:e,childName:n}}function uy(n,e,t){return{type:"child_changed",snapshotNode:e,childName:n,oldSnap:t}}class EM{constructor(e){this.index_=e}updateChild(e,t,r,i,s,o){Ce(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");const a=e.getImmediateChild(t);return a.getChild(i).equals(r.getChild(i))&&a.isEmpty()===r.isEmpty()||(null!=o&&(r.isEmpty()?e.hasChild(t)?o.trackChildChange(ly(t,a)):Ce(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(sp(t,r)):o.trackChildChange(uy(t,r,a))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(t,r).withIndex(this.index_)}updateFullNode(e,t,r){return null!=r&&(e.isLeafNode()||e.forEachChild(Nn,(i,s)=>{t.hasChild(i)||r.trackChildChange(ly(i,s))}),t.isLeafNode()||t.forEachChild(Nn,(i,s)=>{if(e.hasChild(i)){const o=e.getImmediateChild(i);o.equals(s)||r.trackChildChange(uy(i,s,o))}else r.trackChildChange(sp(i,s))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?dt.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}class cy{constructor(e){this.indexedFilter_=new EM(e.getIndex()),this.index_=e.getIndex(),this.startPost_=cy.getStartPost_(e),this.endPost_=cy.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){const t=this.startIsInclusive_?this.index_.compare(this.getStartPost(),e)<=0:this.index_.compare(this.getStartPost(),e)<0,r=this.endIsInclusive_?this.index_.compare(e,this.getEndPost())<=0:this.index_.compare(e,this.getEndPost())<0;return t&&r}updateChild(e,t,r,i,s,o){return this.matches(new Pt(t,r))||(r=dt.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,r,i,s,o)}updateFullNode(e,t,r){t.isLeafNode()&&(t=dt.EMPTY_NODE);let i=t.withIndex(this.index_);i=i.updatePriority(dt.EMPTY_NODE);const s=this;return t.forEachChild(Nn,(o,a)=>{s.matches(new Pt(o,a))||(i=i.updateImmediateChild(o,dt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(e.hasStart()){const t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()}static getEndPost_(e){if(e.hasEnd()){const t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()}}class cye{constructor(e){this.withinDirectionalStart=t=>this.reverse_?this.withinEndPost(t):this.withinStartPost(t),this.withinDirectionalEnd=t=>this.reverse_?this.withinStartPost(t):this.withinEndPost(t),this.withinStartPost=t=>{const r=this.index_.compare(this.rangedFilter_.getStartPost(),t);return this.startIsInclusive_?r<=0:r<0},this.withinEndPost=t=>{const r=this.index_.compare(t,this.rangedFilter_.getEndPost());return this.endIsInclusive_?r<=0:r<0},this.rangedFilter_=new cy(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,r,i,s,o){return this.rangedFilter_.matches(new Pt(t,r))||(r=dt.EMPTY_NODE),e.getImmediateChild(t).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,r,i,s,o):this.fullLimitUpdateChild_(e,t,r,s,o)}updateFullNode(e,t,r){let i;if(t.isLeafNode()||t.isEmpty())i=dt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let s;i=dt.EMPTY_NODE.withIndex(this.index_),s=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let o=0;for(;s.hasNext()&&o<this.limit_;){const a=s.getNext();if(this.withinDirectionalStart(a)){if(!this.withinDirectionalEnd(a))break;i=i.updateImmediateChild(a.name,a.node),o++}}}else{let s;i=t.withIndex(this.index_),i=i.updatePriority(dt.EMPTY_NODE),s=this.reverse_?i.getReverseIterator(this.index_):i.getIterator(this.index_);let o=0;for(;s.hasNext();){const a=s.getNext();o<this.limit_&&this.withinDirectionalStart(a)&&this.withinDirectionalEnd(a)?o++:i=i.updateImmediateChild(a.name,dt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,i,r)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,r,i,s){let o;if(this.reverse_){const p=this.index_.getCompare();o=(_,v)=>p(v,_)}else o=this.index_.getCompare();const a=e;Ce(a.numChildren()===this.limit_,"");const l=new Pt(t,r),u=this.reverse_?a.getFirstChild(this.index_):a.getLastChild(this.index_),d=this.rangedFilter_.matches(l);if(a.hasChild(t)){const p=a.getImmediateChild(t);let _=i.getChildAfterChild(this.index_,u,this.reverse_);for(;null!=_&&(_.name===t||a.hasChild(_.name));)_=i.getChildAfterChild(this.index_,_,this.reverse_);const v=null==_?1:o(_,l);if(d&&!r.isEmpty()&&v>=0)return s?.trackChildChange(uy(t,r,p)),a.updateImmediateChild(t,r);{s?.trackChildChange(ly(t,p));const D=a.updateImmediateChild(t,dt.EMPTY_NODE);return null!=_&&this.rangedFilter_.matches(_)?(s?.trackChildChange(sp(_.name,_.node)),D.updateImmediateChild(_.name,_.node)):D}}return r.isEmpty()?e:d&&o(u,l)>=0?(null!=s&&(s.trackChildChange(ly(u.name,u.node)),s.trackChildChange(sp(t,r))),a.updateImmediateChild(t,r).updateImmediateChild(u.name,dt.EMPTY_NODE)):e}}class IM{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Nn}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return Ce(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return Ce(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:yu}hasEnd(){return this.endSet_}getIndexEndValue(){return Ce(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return Ce(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:rl}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return Ce(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===Nn}copy(){const e=new IM;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function n7(n){const e={};if(n.isDefault())return e;let t;if(n.index_===Nn?t="$priority":n.index_===vM?t="$value":n.index_===pa?t="$key":(Ce(n.index_ instanceof yM,"Unrecognized index type!"),t=n.index_.toString()),e.orderBy=Fr(t),n.startSet_){const r=n.startAfterSet_?"startAfter":"startAt";e[r]=Fr(n.indexStartValue_),n.startNameSet_&&(e[r]+=","+Fr(n.indexStartName_))}if(n.endSet_){const r=n.endBeforeSet_?"endBefore":"endAt";e[r]=Fr(n.indexEndValue_),n.endNameSet_&&(e[r]+=","+Fr(n.indexEndName_))}return n.limitSet_&&(n.isViewFromLeft()?e.limitToFirst=n.limit_:e.limitToLast=n.limit_),e}function r7(n){const e={};if(n.startSet_&&(e.sp=n.indexStartValue_,n.startNameSet_&&(e.sn=n.indexStartName_),e.sin=!n.startAfterSet_),n.endSet_&&(e.ep=n.indexEndValue_,n.endNameSet_&&(e.en=n.indexEndName_),e.ein=!n.endBeforeSet_),n.limitSet_){e.l=n.limit_;let t=n.viewFrom_;""===t&&(t=n.isViewFromLeft()?"l":"r"),e.vf=t}return n.index_!==Nn&&(e.i=n.index_.toString()),e}class y0 extends j3{reportStats(e){throw new Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:(Ce(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}constructor(e,t,r,i){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=r,this.appCheckTokenProvider_=i,this.log_=ey("p:rest:"),this.listens_={}}listen(e,t,r,i){const s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);const o=y0.getListenId_(e,r),a={};this.listens_[o]=a;const l=n7(e._queryParams);this.restRequest_(s+".json",l,(u,d)=>{let p=d;if(404===u&&(p=null,u=null),null===u&&this.onDataUpdate_(s,p,!1,r),Ff(this.listens_,o)===a){let _;_=u?401===u?"permission_denied":"rest_error:"+u:"ok",i(_,null)}})}unlisten(e,t){const r=y0.getListenId_(e,t);delete this.listens_[r]}get(e){const t=n7(e._queryParams),r=e._path.toString(),i=new ou;return this.restRequest_(r+".json",t,(s,o)=>{let a=o;404===s&&(a=null,s=null),null===s?(this.onDataUpdate_(r,a,!1,null),i.resolve(a)):i.reject(new Error(a))}),i.promise}refreshAuthToken(e){}restRequest_(e,t={},r){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([i,s])=>{i&&i.accessToken&&(t.auth=i.accessToken),s&&s.token&&(t.ac=s.token);const o=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+function Ede(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}(t);this.log_("Sending REST request for "+o);const a=new XMLHttpRequest;a.onreadystatechange=()=>{if(r&&4===a.readyState){this.log_("REST Response for "+o+" received. status:",a.status,"response:",a.responseText);let l=null;if(a.status>=200&&a.status<300){try{l=E_(a.responseText)}catch{Si("Failed to parse JSON response for "+o+": "+a.responseText)}r(null,l)}else 401!==a.status&&404!==a.status&&Si("Got unsuccessful REST response for "+o+" Status: "+a.status),r(a.status);r=null}},a.open("GET",o,!0),a.send()})}}class mye{constructor(){this.rootNode_=dt.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}function v0(){return{value:null,children:new Map}}function op(n,e,t){if(Ct(e))n.value=t,n.children.clear();else if(null!==n.value)n.value=n.value.updateChild(e,t);else{const r=wt(e);n.children.has(r)||n.children.set(r,v0()),op(n.children.get(r),e=In(e),t)}}function AM(n,e,t){null!==n.value?t(e,n.value):function _ye(n,e){n.children.forEach((t,r)=>{e(r,t)})}(n,(r,i)=>{AM(i,new rn(e.toString()+"/"+r),t)})}class yye{constructor(e){this.collection_=e,this.last_=null}get(){const e=this.collection_.get(),t=Object.assign({},e);return this.last_&&Jr(this.last_,(r,i)=>{t[r]=t[r]-i}),this.last_=e,t}}class Iye{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new yye(e);const r=1e4+2e4*Math.random();ny(this.reportStats_.bind(this),Math.floor(r))}reportStats_(){const e=this.statsListener_.get(),t={};let r=!1;Jr(e,(i,s)=>{s>0&&aa(this.statsToReport_,i)&&(t[i]=s,r=!0)}),r&&this.server_.reportStats(t),ny(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}var ga=function(n){return n[n.OVERWRITE=0]="OVERWRITE",n[n.MERGE=1]="MERGE",n[n.ACK_USER_WRITE=2]="ACK_USER_WRITE",n[n.LISTEN_COMPLETE=3]="LISTEN_COMPLETE",n}(ga||{});function DM(n){return{fromUser:!1,fromServer:!0,queryId:n,tagged:!0}}class E0{constructor(e,t,r){this.path=e,this.affectedTree=t,this.revert=r,this.type=ga.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}operationForChild(e){if(Ct(this.path)){if(null!=this.affectedTree.value)return Ce(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{const t=this.affectedTree.subtree(new rn(e));return new E0(qt(),t,this.revert)}}return Ce(wt(this.path)===e,"operationForChild called for unrelated child."),new E0(In(this.path),this.affectedTree,this.revert)}}class dy{constructor(e,t){this.source=e,this.path=t,this.type=ga.LISTEN_COMPLETE}operationForChild(e){return Ct(this.path)?new dy(this.source,qt()):new dy(this.source,In(this.path))}}class ad{constructor(e,t,r){this.source=e,this.path=t,this.snap=r,this.type=ga.OVERWRITE}operationForChild(e){return Ct(this.path)?new ad(this.source,qt(),this.snap.getImmediateChild(e)):new ad(this.source,In(this.path),this.snap)}}class ap{constructor(e,t,r){this.source=e,this.path=t,this.children=r,this.type=ga.MERGE}operationForChild(e){if(Ct(this.path)){const t=this.children.subtree(new rn(e));return t.isEmpty()?null:t.value?new ad(this.source,qt(),t.value):new ap(this.source,qt(),t)}return Ce(wt(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new ap(this.source,In(this.path),this.children)}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}class Iu{constructor(e,t,r){this.node_=e,this.fullyInitialized_=t,this.filtered_=r}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(Ct(e))return this.isFullyInitialized()&&!this.filtered_;const t=wt(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}class wye{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function hy(n,e,t,r,i,s){const o=r.filter(a=>a.type===t);o.sort((a,l)=>function Aye(n,e,t){if(null==e.childName||null==t.childName)throw Of("Should only compare child_ events.");const r=new Pt(e.childName,e.snapshotNode),i=new Pt(t.childName,t.snapshotNode);return n.index_.compare(r,i)}(n,a,l)),o.forEach(a=>{const l=function Tye(n,e,t){return"value"===e.type||"child_removed"===e.type||(e.prevName=t.getPredecessorChildName(e.childName,e.snapshotNode,n.index_)),e}(n,a,s);i.forEach(u=>{u.respondsTo(a.type)&&e.push(u.createEvent(l,n.query_))})})}function I0(n,e){return{eventCache:n,serverCache:e}}function fy(n,e,t,r){return I0(new Iu(e,t,r),n.serverCache)}function s7(n,e,t,r){return I0(n.eventCache,new Iu(e,t,r))}function w0(n){return n.eventCache.isFullyInitialized()?n.eventCache.getNode():null}function ld(n){return n.serverCache.isFullyInitialized()?n.serverCache.getNode():null}let RM;class Mn{static fromObject(e){let t=new Mn(null);return Jr(e,(r,i)=>{t=t.set(new rn(r),i)}),t}constructor(e,t=(()=>(RM||(RM=new ds(u_e)),RM))()){this.value=e,this.children=t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:qt(),value:this.value};if(Ct(e))return null;{const r=wt(e),i=this.children.get(r);if(null!==i){const s=i.findRootMostMatchingPathAndValue(In(e),t);return null!=s?{path:er(new rn(r),s.path),value:s.value}:null}return null}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(Ct(e))return this;{const t=wt(e),r=this.children.get(t);return null!==r?r.subtree(In(e)):new Mn(null)}}set(e,t){if(Ct(e))return new Mn(t,this.children);{const r=wt(e),s=(this.children.get(r)||new Mn(null)).set(In(e),t),o=this.children.insert(r,s);return new Mn(this.value,o)}}remove(e){if(Ct(e))return this.children.isEmpty()?new Mn(null):new Mn(null,this.children);{const t=wt(e),r=this.children.get(t);if(r){const i=r.remove(In(e));let s;return s=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&s.isEmpty()?new Mn(null):new Mn(this.value,s)}return this}}get(e){if(Ct(e))return this.value;{const t=wt(e),r=this.children.get(t);return r?r.get(In(e)):null}}setTree(e,t){if(Ct(e))return t;{const r=wt(e),s=(this.children.get(r)||new Mn(null)).setTree(In(e),t);let o;return o=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new Mn(this.value,o)}}fold(e){return this.fold_(qt(),e)}fold_(e,t){const r={};return this.children.inorderTraversal((i,s)=>{r[i]=s.fold_(er(e,i),t)}),t(e,this.value,r)}findOnPath(e,t){return this.findOnPath_(e,qt(),t)}findOnPath_(e,t,r){const i=!!this.value&&r(t,this.value);if(i)return i;if(Ct(e))return null;{const s=wt(e),o=this.children.get(s);return o?o.findOnPath_(In(e),er(t,s),r):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,qt(),t)}foreachOnPath_(e,t,r){if(Ct(e))return this;{this.value&&r(t,this.value);const i=wt(e),s=this.children.get(i);return s?s.foreachOnPath_(In(e),er(t,i),r):new Mn(null)}}foreach(e){this.foreach_(qt(),e)}foreach_(e,t){this.children.inorderTraversal((r,i)=>{i.foreach_(er(e,r),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,r)=>{r.value&&e(t,r.value)})}}class So{constructor(e){this.writeTree_=e}static empty(){return new So(new Mn(null))}}function py(n,e,t){if(Ct(e))return new So(new Mn(t));{const r=n.writeTree_.findRootMostValueAndPath(e);if(null!=r){const i=r.path;let s=r.value;const o=Qi(i,e);return s=s.updateChild(o,t),new So(n.writeTree_.set(i,s))}{const i=new Mn(t),s=n.writeTree_.setTree(e,i);return new So(s)}}}function xM(n,e,t){let r=n;return Jr(t,(i,s)=>{r=py(r,er(e,i),s)}),r}function o7(n,e){if(Ct(e))return So.empty();{const t=n.writeTree_.setTree(e,new Mn(null));return new So(t)}}function PM(n,e){return null!=ud(n,e)}function ud(n,e){const t=n.writeTree_.findRootMostValueAndPath(e);return null!=t?n.writeTree_.get(t.path).getChild(Qi(t.path,e)):null}function a7(n){const e=[],t=n.writeTree_.value;return null!=t?t.isLeafNode()||t.forEachChild(Nn,(r,i)=>{e.push(new Pt(r,i))}):n.writeTree_.children.inorderTraversal((r,i)=>{null!=i.value&&e.push(new Pt(r,i.value))}),e}function wu(n,e){if(Ct(e))return n;{const t=ud(n,e);return new So(null!=t?new Mn(t):n.writeTree_.subtree(e))}}function NM(n){return n.writeTree_.isEmpty()}function lp(n,e){return l7(qt(),n.writeTree_,e)}function l7(n,e,t){if(null!=e.value)return t.updateChild(n,e.value);{let r=null;return e.children.inorderTraversal((i,s)=>{".priority"===i?(Ce(null!==s.value,"Priority writes must always be leaf nodes"),r=s.value):t=l7(er(n,i),s,t)}),!t.getChild(n).isEmpty()&&null!==r&&(t=t.updateChild(er(n,".priority"),r)),t}}function C0(n,e){return f7(e,n)}function Pye(n,e){if(n.snap)return to(n.path,e);for(const t in n.children)if(n.children.hasOwnProperty(t)&&to(er(n.path,t),e))return!0;return!1}function Mye(n){return n.visible}function u7(n,e,t){let r=So.empty();for(let i=0;i<n.length;++i){const s=n[i];if(e(s)){const o=s.path;let a;if(s.snap)to(t,o)?(a=Qi(t,o),r=py(r,a,s.snap)):to(o,t)&&(a=Qi(o,t),r=py(r,qt(),s.snap.getChild(a)));else{if(!s.children)throw Of("WriteRecord should have .snap or .children");if(to(t,o))a=Qi(t,o),r=xM(r,a,s.children);else if(to(o,t))if(a=Qi(o,t),Ct(a))r=xM(r,qt(),s.children);else{const l=Ff(s.children,wt(a));if(l){const u=l.getChild(In(a));r=py(r,qt(),u)}}}}}return r}function c7(n,e,t,r,i){if(r||i){const s=wu(n.visibleWrites,e);return!i&&NM(s)?t:i||null!=t||PM(s,qt())?lp(u7(n.allWrites,function(u){return(u.visible||i)&&(!r||!~r.indexOf(u.writeId))&&(to(u.path,e)||to(e,u.path))},e),t||dt.EMPTY_NODE):null}{const s=ud(n.visibleWrites,e);if(null!=s)return s;{const o=wu(n.visibleWrites,e);return NM(o)?t:null!=t||PM(o,qt())?lp(o,t||dt.EMPTY_NODE):null}}}function T0(n,e,t,r){return c7(n.writeTree,n.treePath,e,t,r)}function MM(n,e){return function kye(n,e,t){let r=dt.EMPTY_NODE;const i=ud(n.visibleWrites,e);if(i)return i.isLeafNode()||i.forEachChild(Nn,(s,o)=>{r=r.updateImmediateChild(s,o)}),r;if(t){const s=wu(n.visibleWrites,e);return t.forEachChild(Nn,(o,a)=>{const l=lp(wu(s,new rn(o)),a);r=r.updateImmediateChild(o,l)}),a7(s).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}return a7(wu(n.visibleWrites,e)).forEach(o=>{r=r.updateImmediateChild(o.name,o.node)}),r}(n.writeTree,n.treePath,e)}function d7(n,e,t,r){return function Oye(n,e,t,r,i){Ce(r||i,"Either existingEventSnap or existingServerSnap must exist");const s=er(e,t);if(PM(n.visibleWrites,s))return null;{const o=wu(n.visibleWrites,s);return NM(o)?i.getChild(t):lp(o,i.getChild(t))}}(n.writeTree,n.treePath,e,t,r)}function A0(n,e){return function Lye(n,e){return ud(n.visibleWrites,e)}(n.writeTree,er(n.treePath,e))}function kM(n,e,t){return function Fye(n,e,t,r){const i=er(e,t),s=ud(n.visibleWrites,i);return null!=s?s:r.isCompleteForChild(t)?lp(wu(n.visibleWrites,i),r.getNode().getImmediateChild(t)):null}(n.writeTree,n.treePath,e,t)}function h7(n,e){return f7(er(n.treePath,e),n.writeTree)}function f7(n,e){return{treePath:n,writeTree:e}}class jye{constructor(){this.changeMap=new Map}trackChildChange(e){const t=e.type,r=e.childName;Ce("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Ce(".priority"!==r,"Only non-priority child changes can be tracked.");const i=this.changeMap.get(r);if(i){const s=i.type;if("child_added"===t&&"child_removed"===s)this.changeMap.set(r,uy(r,e.snapshotNode,i.snapshotNode));else if("child_removed"===t&&"child_added"===s)this.changeMap.delete(r);else if("child_removed"===t&&"child_changed"===s)this.changeMap.set(r,ly(r,i.oldSnap));else if("child_changed"===t&&"child_added"===s)this.changeMap.set(r,sp(r,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==s)throw Of("Illegal combination of changes: "+e+" occurred after "+i);this.changeMap.set(r,uy(r,e.snapshotNode,i.oldSnap))}}else this.changeMap.set(r,e)}getChanges(){return Array.from(this.changeMap.values())}}const p7=new class $ye{getCompleteChild(e){return null}getChildAfterChild(e,t,r){return null}};class OM{constructor(e,t,r=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=r}getCompleteChild(e){const t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{const r=null!=this.optCompleteServerCache_?new Iu(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return kM(this.writes_,e,r)}}getChildAfterChild(e,t,r){const i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:ld(this.viewCache_),s=function Bye(n,e,t,r,i,s){return function Vye(n,e,t,r,i,s,o){let a;const l=wu(n.visibleWrites,e),u=ud(l,qt());if(null!=u)a=u;else{if(null==t)return[];a=lp(l,t)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];{const d=[],p=o.getCompare(),_=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o);let v=_.getNext();for(;v&&d.length<i;)0!==p(v,r)&&d.push(v),v=_.getNext();return d}}(n.writeTree,n.treePath,e,t,r,i,s)}(this.writes_,i,t,1,r,e);return 0===s.length?null:s[0]}}function g7(n,e,t,r,i,s){const o=e.eventCache;if(null!=A0(r,t))return e;{let a,l;if(Ct(t))if(Ce(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){const u=ld(e),p=MM(r,u instanceof dt?u:dt.EMPTY_NODE);a=n.filter.updateFullNode(e.eventCache.getNode(),p,s)}else{const u=T0(r,ld(e));a=n.filter.updateFullNode(e.eventCache.getNode(),u,s)}else{const u=wt(t);if(".priority"===u){Ce(1===Eu(t),"Can't have a priority with additional path components");const d=o.getNode();l=e.serverCache.getNode();const p=d7(r,t,d,l);a=null!=p?n.filter.updatePriority(d,p):o.getNode()}else{const d=In(t);let p;if(o.isCompleteForChild(u)){l=e.serverCache.getNode();const _=d7(r,t,o.getNode(),l);p=null!=_?o.getNode().getImmediateChild(u).updateChild(d,_):o.getNode().getImmediateChild(u)}else p=kM(r,u,e.serverCache);a=null!=p?n.filter.updateChild(o.getNode(),u,p,d,i,s):o.getNode()}}return fy(e,a,o.isFullyInitialized()||Ct(t),n.filter.filtersNodes())}}function b0(n,e,t,r,i,s,o,a){const l=e.serverCache;let u;const d=o?n.filter:n.filter.getIndexedFilter();if(Ct(t))u=d.updateFullNode(l.getNode(),r,null);else if(d.filtersNodes()&&!l.isFiltered()){const v=l.getNode().updateChild(t,r);u=d.updateFullNode(l.getNode(),v,null)}else{const v=wt(t);if(!l.isCompleteForPath(t)&&Eu(t)>1)return e;const A=In(t),P=l.getNode().getImmediateChild(v).updateChild(A,r);u=".priority"===v?d.updatePriority(l.getNode(),P):d.updateChild(l.getNode(),v,P,A,p7,null)}const p=s7(e,u,l.isFullyInitialized()||Ct(t),d.filtersNodes());return g7(n,p,t,i,new OM(i,p,s),a)}function FM(n,e,t,r,i,s,o){const a=e.eventCache;let l,u;const d=new OM(i,e,s);if(Ct(t))u=n.filter.updateFullNode(e.eventCache.getNode(),r,o),l=fy(e,u,!0,n.filter.filtersNodes());else{const p=wt(t);if(".priority"===p)u=n.filter.updatePriority(e.eventCache.getNode(),r),l=fy(e,u,a.isFullyInitialized(),a.isFiltered());else{const _=In(t),v=a.getNode().getImmediateChild(p);let A;if(Ct(_))A=r;else{const D=d.getCompleteChild(p);A=null!=D?".priority"===hM(_)&&D.getChild(W3(_)).isEmpty()?D:D.updateChild(_,r):dt.EMPTY_NODE}l=v.equals(A)?e:fy(e,n.filter.updateChild(a.getNode(),p,A,_,d,o),a.isFullyInitialized(),n.filter.filtersNodes())}}return l}function m7(n,e){return n.eventCache.isCompleteForChild(e)}function _7(n,e,t){return t.foreach((r,i)=>{e=e.updateChild(r,i)}),e}function LM(n,e,t,r,i,s,o,a){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;let u,l=e;u=Ct(t)?r:new Mn(null).setTree(t,r);const d=e.serverCache.getNode();return u.children.inorderTraversal((p,_)=>{if(d.hasChild(p)){const A=_7(0,e.serverCache.getNode().getImmediateChild(p),_);l=b0(n,l,new rn(p),A,i,s,o,a)}}),u.children.inorderTraversal((p,_)=>{const v=!e.serverCache.isCompleteForChild(p)&&null===_.value;if(!d.hasChild(p)&&!v){const D=_7(0,e.serverCache.getNode().getImmediateChild(p),_);l=b0(n,l,new rn(p),D,i,s,o,a)}}),l}class Jye{constructor(e,t){this.query_=e,this.eventRegistrations_=[];const r=this.query_._queryParams,i=new EM(r.getIndex()),s=function dye(n){return n.loadsAllData()?new EM(n.getIndex()):n.hasLimit()?new cye(n):new cy(n)}(r);this.processor_=function Hye(n){return{filter:n}}(s);const o=t.serverCache,a=t.eventCache,l=i.updateFullNode(dt.EMPTY_NODE,o.getNode(),null),u=s.updateFullNode(dt.EMPTY_NODE,a.getNode(),null),d=new Iu(l,o.isFullyInitialized(),i.filtersNodes()),p=new Iu(u,a.isFullyInitialized(),s.filtersNodes());this.viewCache_=I0(p,d),this.eventGenerator_=new wye(this.query_)}get query(){return this.query_}}function eve(n,e){const t=ld(n.viewCache_);return t&&(n.query._queryParams.loadsAllData()||!Ct(e)&&!t.getImmediateChild(wt(e)).isEmpty())?t.getChild(e):null}function y7(n){return 0===n.eventRegistrations_.length}function v7(n,e,t){const r=[];if(t){Ce(null==e,"A cancel should cancel all event registrations.");const i=n.query._path;n.eventRegistrations_.forEach(s=>{const o=s.createCancelEvent(t,i);o&&r.push(o)})}if(e){let i=[];for(let s=0;s<n.eventRegistrations_.length;++s){const o=n.eventRegistrations_[s];if(o.matches(e)){if(e.hasAnyCallback()){i=i.concat(n.eventRegistrations_.slice(s+1));break}}else i.push(o)}n.eventRegistrations_=i}else n.eventRegistrations_=[];return r}function E7(n,e,t,r){e.type===ga.MERGE&&null!==e.source.queryId&&(Ce(ld(n.viewCache_),"We should always have a full cache before handling merges"),Ce(w0(n.viewCache_),"Missing event cache, even though we have a server cache"));const i=n.viewCache_,s=function Wye(n,e,t,r,i){const s=new jye;let o,a;if(t.type===ga.OVERWRITE){const u=t;u.source.fromUser?o=FM(n,e,u.path,u.snap,r,i,s):(Ce(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered()&&!Ct(u.path),o=b0(n,e,u.path,u.snap,r,i,a,s))}else if(t.type===ga.MERGE){const u=t;u.source.fromUser?o=function qye(n,e,t,r,i,s,o){let a=e;return r.foreach((l,u)=>{const d=er(t,l);m7(e,wt(d))&&(a=FM(n,a,d,u,i,s,o))}),r.foreach((l,u)=>{const d=er(t,l);m7(e,wt(d))||(a=FM(n,a,d,u,i,s,o))}),a}(n,e,u.path,u.children,r,i,s):(Ce(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.serverCache.isFiltered(),o=LM(n,e,u.path,u.children,r,i,a,s))}else if(t.type===ga.ACK_USER_WRITE){const u=t;o=u.revert?function Yye(n,e,t,r,i,s){let o;if(null!=A0(r,t))return e;{const a=new OM(r,e,i),l=e.eventCache.getNode();let u;if(Ct(t)||".priority"===wt(t)){let d;if(e.serverCache.isFullyInitialized())d=T0(r,ld(e));else{const p=e.serverCache.getNode();Ce(p instanceof dt,"serverChildren would be complete if leaf node"),d=MM(r,p)}u=n.filter.updateFullNode(l,d,s)}else{const d=wt(t);let p=kM(r,d,e.serverCache);null==p&&e.serverCache.isCompleteForChild(d)&&(p=l.getImmediateChild(d)),u=null!=p?n.filter.updateChild(l,d,p,In(t),a,s):e.eventCache.getNode().hasChild(d)?n.filter.updateChild(l,d,dt.EMPTY_NODE,In(t),a,s):l,u.isEmpty()&&e.serverCache.isFullyInitialized()&&(o=T0(r,ld(e)),o.isLeafNode()&&(u=n.filter.updateFullNode(u,o,s)))}return o=e.serverCache.isFullyInitialized()||null!=A0(r,qt()),fy(e,u,o,n.filter.filtersNodes())}}(n,e,u.path,r,i,s):function Kye(n,e,t,r,i,s,o){if(null!=A0(i,t))return e;const a=e.serverCache.isFiltered(),l=e.serverCache;if(null!=r.value){if(Ct(t)&&l.isFullyInitialized()||l.isCompleteForPath(t))return b0(n,e,t,l.getNode().getChild(t),i,s,a,o);if(Ct(t)){let u=new Mn(null);return l.getNode().forEachChild(pa,(d,p)=>{u=u.set(new rn(d),p)}),LM(n,e,t,u,i,s,a,o)}return e}{let u=new Mn(null);return r.foreach((d,p)=>{const _=er(t,d);l.isCompleteForPath(_)&&(u=u.set(d,l.getNode().getChild(_)))}),LM(n,e,t,u,i,s,a,o)}}(n,e,u.path,u.affectedTree,r,i,s)}else{if(t.type!==ga.LISTEN_COMPLETE)throw Of("Unknown operation type: "+t.type);o=function Qye(n,e,t,r,i){const s=e.serverCache;return g7(n,s7(e,s.getNode(),s.isFullyInitialized()||Ct(t),s.isFiltered()),t,r,p7,i)}(n,e,t.path,r,s)}const l=s.getChanges();return function Gye(n,e,t){const r=e.eventCache;if(r.isFullyInitialized()){const i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=w0(n);(t.length>0||!n.eventCache.isFullyInitialized()||i&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&t.push(t7(w0(e)))}}(e,o,l),{viewCache:o,changes:l}}(n.processor_,i,e,t,r);return function zye(n,e){Ce(e.eventCache.getNode().isIndexed(n.filter.getIndex()),"Event snap not indexed"),Ce(e.serverCache.getNode().isIndexed(n.filter.getIndex()),"Server snap not indexed")}(n.processor_,s.viewCache),Ce(s.viewCache.serverCache.isFullyInitialized()||!i.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),n.viewCache_=s.viewCache,I7(n,s.changes,s.viewCache.eventCache.getNode(),null)}function I7(n,e,t,r){return function Cye(n,e,t,r){const i=[],s=[];return e.forEach(o=>{"child_changed"===o.type&&n.index_.indexedValueChanged(o.oldSnap,o.snapshotNode)&&s.push(function uye(n,e){return{type:"child_moved",snapshotNode:e,childName:n}}(o.childName,o.snapshotNode))}),hy(n,i,"child_removed",e,r,t),hy(n,i,"child_added",e,r,t),hy(n,i,"child_moved",s,r,t),hy(n,i,"child_changed",e,r,t),hy(n,i,"value",e,r,t),i}(n.eventGenerator_,e,t,r?[r]:n.eventRegistrations_)}let S0,R0;class w7{constructor(){this.views=new Map}}function VM(n,e,t,r){const i=e.source.queryId;if(null!==i){const s=n.views.get(i);return Ce(null!=s,"SyncTree gave us an op for an invalid query."),E7(s,e,t,r)}{let s=[];for(const o of n.views.values())s=s.concat(E7(o,e,t,r));return s}}function C7(n,e,t,r,i){const o=n.views.get(e._queryIdentifier);if(!o){let a=T0(t,i?r:null),l=!1;a?l=!0:r instanceof dt?(a=MM(t,r),l=!1):(a=dt.EMPTY_NODE,l=!1);const u=I0(new Iu(a,l,!1),new Iu(r,i,!1));return new Jye(e,u)}return o}function T7(n){const e=[];for(const t of n.views.values())t.query._queryParams.loadsAllData()||e.push(t);return e}function Cu(n,e){let t=null;for(const r of n.views.values())t=t||eve(r,e);return t}function A7(n,e){return e._queryParams.loadsAllData()?D0(n):n.views.get(e._queryIdentifier)}function b7(n,e){return null!=A7(n,e)}function Tu(n){return null!=D0(n)}function D0(n){for(const e of n.views.values())if(e.query._queryParams.loadsAllData())return e;return null}let cve=1;class S7{constructor(e){this.listenProvider_=e,this.syncPointTree_=new Mn(null),this.pendingWriteTree_=function Uye(){return{visibleWrites:So.empty(),allWrites:[],lastWriteId:-1}}(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function UM(n,e,t,r,i){return function Sye(n,e,t,r,i){Ce(r>n.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),n.allWrites.push({path:e,snap:t,writeId:r,visible:i}),i&&(n.visibleWrites=py(n.visibleWrites,e,t)),n.lastWriteId=r}(n.pendingWriteTree_,e,t,r,i),i?up(n,new ad({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},e,t)):[]}function Au(n,e,t=!1){const r=function Rye(n,e){for(let t=0;t<n.allWrites.length;t++){const r=n.allWrites[t];if(r.writeId===e)return r}return null}(n.pendingWriteTree_,e);if(function xye(n,e){const t=n.allWrites.findIndex(a=>a.writeId===e);Ce(t>=0,"removeWrite called with nonexistent writeId.");const r=n.allWrites[t];n.allWrites.splice(t,1);let i=r.visible,s=!1,o=n.allWrites.length-1;for(;i&&o>=0;){const a=n.allWrites[o];a.visible&&(o>=t&&Pye(a,r.path)?i=!1:to(r.path,a.path)&&(s=!0)),o--}return!!i&&(s?(function Nye(n){n.visibleWrites=u7(n.allWrites,Mye,qt()),n.lastWriteId=n.allWrites.length>0?n.allWrites[n.allWrites.length-1].writeId:-1}(n),!0):(r.snap?n.visibleWrites=o7(n.visibleWrites,r.path):Jr(r.children,l=>{n.visibleWrites=o7(n.visibleWrites,er(r.path,l))}),!0))}(n.pendingWriteTree_,e)){let s=new Mn(null);return null!=r.snap?s=s.set(qt(),!0):Jr(r.children,o=>{s=s.set(new rn(o),!0)}),up(n,new E0(r.path,s,t))}return[]}function gy(n,e,t){return up(n,new ad({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,t))}function x0(n,e,t,r,i=!1){const s=e._path,o=n.syncPointTree_.get(s);let a=[];if(o&&("default"===e._queryIdentifier||b7(o,e))){const l=function ave(n,e,t,r){const i=e._queryIdentifier,s=[];let o=[];const a=Tu(n);if("default"===i)for(const[l,u]of n.views.entries())o=o.concat(v7(u,t,r)),y7(u)&&(n.views.delete(l),u.query._queryParams.loadsAllData()||s.push(u.query));else{const l=n.views.get(i);l&&(o=o.concat(v7(l,t,r)),y7(l)&&(n.views.delete(i),l.query._queryParams.loadsAllData()||s.push(l.query)))}return a&&!Tu(n)&&s.push(new(function ive(){return Ce(S0,"Reference.ts has not been loaded"),S0}())(e._repo,e._path)),{removed:s,events:o}}(o,e,t,r);(function sve(n){return 0===n.views.size})(o)&&(n.syncPointTree_=n.syncPointTree_.remove(s));const u=l.removed;if(a=l.events,!i){const d=-1!==u.findIndex(_=>_._queryParams.loadsAllData()),p=n.syncPointTree_.findOnPath(s,(_,v)=>Tu(v));if(d&&!p){const _=n.syncPointTree_.subtree(s);if(!_.isEmpty()){const v=function _ve(n){return n.fold((e,t,r)=>{if(t&&Tu(t))return[D0(t)];{let i=[];return t&&(i=T7(t)),Jr(r,(s,o)=>{i=i.concat(o)}),i}})}(_);for(let A=0;A<v.length;++A){const D=v[A],P=D.query,H=P7(n,D);n.listenProvider_.startListening(_y(P),my(n,P),H.hashFn,H.onComplete)}}}!p&&u.length>0&&!r&&(d?n.listenProvider_.stopListening(_y(e),null):u.forEach(_=>{const v=n.queryToTagMap.get(N0(_));n.listenProvider_.stopListening(_y(_),v)}))}!function yve(n,e){for(let t=0;t<e.length;++t){const r=e[t];if(!r._queryParams.loadsAllData()){const i=N0(r),s=n.queryToTagMap.get(i);n.queryToTagMap.delete(i),n.tagToQueryMap.delete(s)}}}(n,u)}return a}function D7(n,e,t,r){const i=jM(n,r);if(null!=i){const s=$M(i),o=s.path,a=s.queryId,l=Qi(o,e);return HM(n,o,new ad(DM(a),l,t))}return[]}function BM(n,e,t,r=!1){const i=e._path;let s=null,o=!1;n.syncPointTree_.foreachOnPath(i,(_,v)=>{const A=Qi(_,i);s=s||Cu(v,A),o=o||Tu(v)});let l,a=n.syncPointTree_.get(i);a?(o=o||Tu(a),s=s||Cu(a,qt())):(a=new w7,n.syncPointTree_=n.syncPointTree_.set(i,a)),null!=s?l=!0:(l=!1,s=dt.EMPTY_NODE,n.syncPointTree_.subtree(i).foreachChild((v,A)=>{const D=Cu(A,qt());D&&(s=s.updateImmediateChild(v,D))}));const u=b7(a,e);if(!u&&!e._queryParams.loadsAllData()){const _=N0(e);Ce(!n.queryToTagMap.has(_),"View does not exist, but we have a tag");const v=function vve(){return cve++}();n.queryToTagMap.set(_,v),n.tagToQueryMap.set(v,_)}let p=function ove(n,e,t,r,i,s){const o=C7(n,e,r,i,s);return n.views.has(e._queryIdentifier)||n.views.set(e._queryIdentifier,o),function tve(n,e){n.eventRegistrations_.push(e)}(o,t),function nve(n,e){const t=n.viewCache_.eventCache,r=[];return t.getNode().isLeafNode()||t.getNode().forEachChild(Nn,(s,o)=>{r.push(sp(s,o))}),t.isFullyInitialized()&&r.push(t7(t.getNode())),I7(n,r,t.getNode(),e)}(o,t)}(a,e,t,C0(n.pendingWriteTree_,i),s,l);if(!u&&!o&&!r){const _=A7(a,e);p=p.concat(function Eve(n,e,t){const r=e._path,i=my(n,e),s=P7(n,t),o=n.listenProvider_.startListening(_y(e),i,s.hashFn,s.onComplete),a=n.syncPointTree_.subtree(r);if(i)Ce(!Tu(a.value),"If we're adding a query, it shouldn't be shadowed");else{const l=a.fold((u,d,p)=>{if(!Ct(u)&&d&&Tu(d))return[D0(d).query];{let _=[];return d&&(_=_.concat(T7(d).map(v=>v.query))),Jr(p,(v,A)=>{_=_.concat(A)}),_}});for(let u=0;u<l.length;++u){const d=l[u];n.listenProvider_.stopListening(_y(d),my(n,d))}}return o}(n,e,_))}return p}function P0(n,e,t){const i=n.pendingWriteTree_,s=n.syncPointTree_.findOnPath(e,(o,a)=>{const u=Cu(a,Qi(o,e));if(u)return u});return c7(i,e,s,t,!0)}function up(n,e){return R7(e,n.syncPointTree_,null,C0(n.pendingWriteTree_,qt()))}function R7(n,e,t,r){if(Ct(n.path))return x7(n,e,t,r);{const i=e.get(qt());null==t&&null!=i&&(t=Cu(i,qt()));let s=[];const o=wt(n.path),a=n.operationForChild(o),l=e.children.get(o);if(l&&a){const u=t?t.getImmediateChild(o):null,d=h7(r,o);s=s.concat(R7(a,l,u,d))}return i&&(s=s.concat(VM(i,n,r,t))),s}}function x7(n,e,t,r){const i=e.get(qt());null==t&&null!=i&&(t=Cu(i,qt()));let s=[];return e.children.inorderTraversal((o,a)=>{const l=t?t.getImmediateChild(o):null,u=h7(r,o),d=n.operationForChild(o);d&&(s=s.concat(x7(d,a,l,u)))}),i&&(s=s.concat(VM(i,n,r,t))),s}function P7(n,e){const t=e.query,r=my(n,t);return{hashFn:()=>(function Xye(n){return n.viewCache_.serverCache.getNode()}(e)||dt.EMPTY_NODE).hash(),onComplete:i=>{if("ok"===i)return r?function pve(n,e,t){const r=jM(n,t);if(r){const i=$M(r),s=i.path,o=i.queryId,a=Qi(s,e);return HM(n,s,new dy(DM(o),a))}return[]}(n,t._path,r):function fve(n,e){return up(n,new dy({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e))}(n,t._path);{const s=function h_e(n,e){let t="Unknown Error";"too_big"===n?t="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===n?t="Client doesn't have permission to access the desired data.":"unavailable"===n&&(t="The service is unavailable");const r=new Error(n+" at "+e._path.toString()+": "+t);return r.code=n.toUpperCase(),r}(i,t);return x0(n,t,null,s)}}}}function my(n,e){const t=N0(e);return n.queryToTagMap.get(t)}function N0(n){return n._path.toString()+"$"+n._queryIdentifier}function jM(n,e){return n.tagToQueryMap.get(e)}function $M(n){const e=n.indexOf("$");return Ce(-1!==e&&e<n.length-1,"Bad queryKey."),{queryId:n.substr(e+1),path:new rn(n.substr(0,e))}}function HM(n,e,t){const r=n.syncPointTree_.get(e);return Ce(r,"Missing sync point for query tag that we're tracking"),VM(r,t,C0(n.pendingWriteTree_,e),null)}function _y(n){return n._queryParams.loadsAllData()&&!n._queryParams.isDefault()?new(function uve(){return Ce(R0,"Reference.ts has not been loaded"),R0}())(n._repo,n._path):n}class zM{constructor(e){this.node_=e}getImmediateChild(e){const t=this.node_.getImmediateChild(e);return new zM(t)}node(){return this.node_}}class WM{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){const t=er(this.path_,e);return new WM(this.syncTree_,t)}node(){return P0(this.syncTree_,this.path_)}}const Ive=function(n){return(n=n||{}).timestamp=n.timestamp||(new Date).getTime(),n},N7=function(n,e,t){return n&&"object"==typeof n?(Ce(".sv"in n,"Unexpected leaf node or priority contents"),"string"==typeof n[".sv"]?wve(n[".sv"],e,t):"object"==typeof n[".sv"]?Cve(n[".sv"],e):void Ce(!1,"Unexpected server value: "+JSON.stringify(n,null,2))):n},wve=function(n,e,t){if("timestamp"===n)return t.timestamp;Ce(!1,"Unexpected server value: "+n)},Cve=function(n,e,t){n.hasOwnProperty("increment")||Ce(!1,"Unexpected server value: "+JSON.stringify(n,null,2));const r=n.increment;"number"!=typeof r&&Ce(!1,"Unexpected increment value: "+r);const i=e.node();if(Ce(null!==i&&typeof i<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;const o=i.getValue();return"number"!=typeof o?r:o+r},M7=function(n,e,t,r){return qM(e,new WM(t,n),r)},GM=function(n,e,t){return qM(n,new zM(e),t)};function qM(n,e,t){const r=n.getPriority().val(),i=N7(r,e.getImmediateChild(".priority"),t);let s;if(n.isLeafNode()){const o=n,a=N7(o.getValue(),e,t);return a!==o.getValue()||i!==o.getPriority().val()?new rp(a,sr(i)):n}{const o=n;return s=o,i!==o.getPriority().val()&&(s=s.updatePriority(new rp(i))),o.forEachChild(Nn,(a,l)=>{const u=qM(l,e.getImmediateChild(a),t);u!==l&&(s=s.updateImmediateChild(a,u))}),s}}class KM{constructor(e="",t=null,r={children:{},childCount:0}){this.name=e,this.parent=t,this.node=r}}function M0(n,e){let t=e instanceof rn?e:new rn(e),r=n,i=wt(t);for(;null!==i;){const s=Ff(r.node.children,i)||{children:{},childCount:0};r=new KM(i,r,s),t=In(t),i=wt(t)}return r}function cd(n){return n.node.value}function QM(n,e){n.node.value=e,YM(n)}function k7(n){return n.node.childCount>0}function k0(n,e){Jr(n.node.children,(t,r)=>{e(new KM(t,n,r))})}function O7(n,e,t,r){t&&!r&&e(n),k0(n,i=>{O7(i,e,!0,r)}),t&&r&&e(n)}function yy(n){return new rn(null===n.parent?n.name:yy(n.parent)+"/"+n.name)}function YM(n){null!==n.parent&&function bve(n,e,t){const r=function Tve(n){return void 0===cd(n)&&!k7(n)}(t),i=aa(n.node.children,e);r&&i?(delete n.node.children[e],n.node.childCount--,YM(n)):!r&&!i&&(n.node.children[e]=t.node,n.node.childCount++,YM(n))}(n.parent,n.name,n)}const Sve=/[\[\].#$\/\u0000-\u001F\u007F]/,Dve=/[\[\].#$\u0000-\u001F\u007F]/,JM=10485760,O0=function(n){return"string"==typeof n&&0!==n.length&&!Sve.test(n)},F7=function(n){return"string"==typeof n&&0!==n.length&&!Dve.test(n)},Ey=function(n,e,t){const r=t instanceof rn?new W_e(t,n):t;if(void 0===e)throw new Error(n+"contains undefined "+sd(r));if("function"==typeof e)throw new Error(n+"contains a function "+sd(r)+" with contents = "+e.toString());if(u0(e))throw new Error(n+"contains "+e.toString()+" "+sd(r));if("string"==typeof e&&e.length>JM/3&&_C(e)>JM)throw new Error(n+"contains a string greater than "+JM+" utf8 bytes "+sd(r)+" ('"+e.substring(0,50)+"...')");if(e&&"object"==typeof e){let i=!1,s=!1;if(Jr(e,(o,a)=>{if(".value"===o)i=!0;else if(".priority"!==o&&".sv"!==o&&(s=!0,!O0(o)))throw new Error(n+" contains an invalid key ("+o+") "+sd(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(function G_e(n,e){n.parts_.length>0&&(n.byteLength_+=1),n.parts_.push(e),n.byteLength_+=_C(e),G3(n)})(r,o),Ey(n,a,r),function q_e(n){const e=n.parts_.pop();n.byteLength_-=_C(e),n.parts_.length>0&&(n.byteLength_-=1)}(r)}),i&&s)throw new Error(n+' contains ".value" child '+sd(r)+" in addition to actual children.")}},ZM=function(n,e,t,r){if(!(r&&void 0===t||F7(t)))throw new Error(Lf(n,e)+'was an invalid path = "'+t+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Pve=function(n,e,t,r){t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),ZM(n,e,t,r)};class Nve{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function Ps(n,e,t){(function F0(n,e){let t=null;for(let r=0;r<e.length;r++){const i=e[r],s=i.getPath();null!==t&&!fM(s,t.path)&&(n.eventLists_.push(t),t=null),null===t&&(t={events:[],path:s}),t.events.push(i)}t&&n.eventLists_.push(t)})(n,t),function B7(n,e){n.recursionDepth_++;let t=!0;for(let r=0;r<n.eventLists_.length;r++){const i=n.eventLists_[r];i&&(e(i.path)?(Mve(n.eventLists_[r]),n.eventLists_[r]=null):t=!1)}t&&(n.eventLists_=[]),n.recursionDepth_--}(n,r=>to(r,e)||to(e,r))}function Mve(n){for(let e=0;e<n.events.length;e++){const t=n.events[e];if(null!==t){n.events[e]=null;const r=t.getEventRunner();rd&&Yr("event: "+t.toString()),tp(r)}}}const kve=25;class Ove{constructor(e,t,r,i){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=r,this.appCheckProvider_=i,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Nve,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=v0(),this.transactionQueueTree_=new KM,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function $7(n){const t=n.infoData_.getNode(new rn(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function wy(n){return Ive({timestamp:$7(n)})}function H7(n,e,t,r,i){n.dataUpdateCount++;const s=new rn(e);t=n.interceptServerDataCallback_?n.interceptServerDataCallback_(e,t):t;let o=[];if(i)if(r){const l=mC(t,u=>sr(u));o=function gve(n,e,t,r){const i=jM(n,r);if(i){const s=$M(i),o=s.path,a=s.queryId,l=Qi(o,e),u=Mn.fromObject(t);return HM(n,o,new ap(DM(a),l,u))}return[]}(n.serverSyncTree_,s,l,i)}else{const l=sr(t);o=D7(n.serverSyncTree_,s,l,i)}else if(r){const l=mC(t,u=>sr(u));o=function hve(n,e,t){const r=Mn.fromObject(t);return up(n,new ap({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},e,r))}(n.serverSyncTree_,s,l)}else{const l=sr(t);o=gy(n.serverSyncTree_,s,l)}let a=s;o.length>0&&(a=dp(n,s)),Ps(n.eventQueue_,a,o)}function z7(n,e){e1(n,"connected",e),!1===e&&function Bve(n){cp(n,"onDisconnectEvents");const e=wy(n),t=v0();AM(n.onDisconnect_,qt(),(i,s)=>{const o=M7(i,s,n.serverSyncTree_,e);op(t,i,o)});let r=[];AM(t,qt(),(i,s)=>{r=r.concat(gy(n.serverSyncTree_,i,s));const o=function i1(n,e){const t=yy(q7(n,e)),r=M0(n.transactionQueueTree_,e);return function Ave(n,e,t){let r=t?n:n.parent;for(;null!==r;){if(e(r))return!0;r=r.parent}}(r,i=>{s1(n,i)}),s1(n,r),O7(r,i=>{s1(n,i)}),t}(n,i);dp(n,o)}),n.onDisconnect_=v0(),Ps(n.eventQueue_,qt(),r)}(n)}function e1(n,e,t){const r=new rn("/.info/"+e),i=sr(t);n.infoData_.updateSnapshot(r,i);const s=gy(n.infoSyncTree_,r,i);Ps(n.eventQueue_,r,s)}function L0(n){return n.nextWriteId_++}function cp(n,...e){let t="";n.persistentConnection_&&(t=n.persistentConnection_.id+":"),Yr(t,...e)}function r1(n,e,t){return P0(n.serverSyncTree_,e,t)||dt.EMPTY_NODE}function V0(n,e=n.transactionQueueTree_){if(e||U0(n,e),cd(e)){const t=K7(n,e);Ce(t.length>0,"Sending zero length transaction queue"),t.every(i=>0===i.status)&&function qve(n,e,t){const r=t.map(u=>u.currentWriteId),i=r1(n,e,r);let s=i;const o=i.hash();for(let u=0;u<t.length;u++){const d=t[u];Ce(0===d.status,"tryToSendTransactionQueue_: items in queue should all be run."),d.status=1,d.retryCount++;const p=Qi(e,d.path);s=s.updateChild(p,d.currentOutputSnapshotRaw)}const a=s.val(!0),l=e;n.server_.put(l.toString(),a,u=>{cp(n,"transaction put response",{path:l.toString(),status:u});let d=[];if("ok"===u){const p=[];for(let _=0;_<t.length;_++)t[_].status=2,d=d.concat(Au(n.serverSyncTree_,t[_].currentWriteId)),t[_].onComplete&&p.push(()=>t[_].onComplete(null,!0,t[_].currentOutputSnapshotResolved)),t[_].unwatcher();U0(n,M0(n.transactionQueueTree_,e)),V0(n,n.transactionQueueTree_),Ps(n.eventQueue_,e,d);for(let _=0;_<p.length;_++)tp(p[_])}else{if("datastale"===u)for(let p=0;p<t.length;p++)t[p].status=3===t[p].status?4:0;else{Si("transaction at "+l.toString()+" failed: "+u);for(let p=0;p<t.length;p++)t[p].status=4,t[p].abortReason=u}dp(n,e)}},o)}(n,yy(e),t)}else k7(e)&&k0(e,t=>{V0(n,t)})}function dp(n,e){const t=q7(n,e),r=yy(t);return function Kve(n,e,t){if(0===e.length)return;const r=[];let i=[];const o=e.filter(a=>0===a.status).map(a=>a.currentWriteId);for(let a=0;a<e.length;a++){const l=e[a],u=Qi(t,l.path);let p,d=!1;if(Ce(null!==u,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)d=!0,p=l.abortReason,i=i.concat(Au(n.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=kve)d=!0,p="maxretry",i=i.concat(Au(n.serverSyncTree_,l.currentWriteId,!0));else{const _=r1(n,l.path,o);l.currentInputSnapshot=_;const v=e[a].update(_.val());if(void 0!==v){Ey("transaction failed: Data returned ",v,l.path);let A=sr(v);"object"==typeof v&&null!=v&&aa(v,".priority")||(A=A.updatePriority(_.getPriority()));const P=l.currentWriteId,H=wy(n),V=GM(A,_,H);l.currentOutputSnapshotRaw=A,l.currentOutputSnapshotResolved=V,l.currentWriteId=L0(n),o.splice(o.indexOf(P),1),i=i.concat(UM(n.serverSyncTree_,l.path,V,l.currentWriteId,l.applyLocally)),i=i.concat(Au(n.serverSyncTree_,P,!0))}else d=!0,p="nodata",i=i.concat(Au(n.serverSyncTree_,l.currentWriteId,!0))}Ps(n.eventQueue_,t,i),i=[],d&&(e[a].status=2,setTimeout(e[a].unwatcher,Math.floor(0)),e[a].onComplete&&r.push("nodata"===p?()=>e[a].onComplete(null,!1,e[a].currentInputSnapshot):()=>e[a].onComplete(new Error(p),!1,null)))}U0(n,n.transactionQueueTree_);for(let a=0;a<r.length;a++)tp(r[a]);V0(n,n.transactionQueueTree_)}(n,K7(n,t),r),r}function q7(n,e){let t,r=n.transactionQueueTree_;for(t=wt(e);null!==t&&void 0===cd(r);)r=M0(r,t),t=wt(e=In(e));return r}function K7(n,e){const t=[];return Q7(n,e,t),t.sort((r,i)=>r.order-i.order),t}function Q7(n,e,t){const r=cd(e);if(r)for(let i=0;i<r.length;i++)t.push(r[i]);k0(e,i=>{Q7(n,i,t)})}function U0(n,e){const t=cd(e);if(t){let r=0;for(let i=0;i<t.length;i++)2!==t[i].status&&(t[r]=t[i],r++);t.length=r,QM(e,t.length>0?t:void 0)}k0(e,r=>{U0(n,r)})}function s1(n,e){const t=cd(e);if(t){const r=[];let i=[],s=-1;for(let o=0;o<t.length;o++)3===t[o].status||(1===t[o].status?(Ce(s===o-1,"All SENT items should be at beginning of queue."),s=o,t[o].status=3,t[o].abortReason="set"):(Ce(0===t[o].status,"Unexpected transaction status in abort"),t[o].unwatcher(),i=i.concat(Au(n.serverSyncTree_,t[o].currentWriteId,!0)),t[o].onComplete&&r.push(t[o].onComplete.bind(null,new Error("set"),!1,null))));-1===s?QM(e,void 0):t.length=s+1,Ps(n.eventQueue_,yy(e),i);for(let o=0;o<r.length;o++)tp(r[o])}}const o1=function(n,e){const t=Jve(n),r=t.namespace;return"firebase.com"===t.domain&&fa(t.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||"undefined"===r)&&"localhost"!==t.domain&&fa("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),t.secure||typeof window<"u"&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&Si("Insecure Firebase access from a secure page. Please use https in calls to new Firebase()."),{repoInfo:new oM(t.host,t.secure,r,"ws"===t.scheme||"wss"===t.scheme,e,"",r!==t.subdomain),path:new rn(t.pathString)}},Jve=function(n){let e="",t="",r="",i="",s="",o=!0,a="https",l=443;if("string"==typeof n){let u=n.indexOf("//");u>=0&&(a=n.substring(0,u-1),n=n.substring(u+2));let d=n.indexOf("/");-1===d&&(d=n.length);let p=n.indexOf("?");-1===p&&(p=n.length),e=n.substring(0,Math.min(d,p)),d<p&&(i=function Qve(n){let e="";const t=n.split("/");for(let r=0;r<t.length;r++)if(t[r].length>0){let i=t[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch{}e+="/"+i}return e}(n.substring(d,p)));const _=function Yve(n){const e={};"?"===n.charAt(0)&&(n=n.substring(1));for(const t of n.split("&")){if(0===t.length)continue;const r=t.split("=");2===r.length?e[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):Si(`Invalid query segment '${t}' in query '${n}'`)}return e}(n.substring(Math.min(n.length,p)));u=e.indexOf(":"),u>=0?(o="https"===a||"wss"===a,l=parseInt(e.substring(u+1),10)):u=e.length;const v=e.slice(0,u);if("localhost"===v.toLowerCase())t="localhost";else if(v.split(".").length<=2)t=v;else{const A=e.indexOf(".");r=e.substring(0,A).toLowerCase(),t=e.substring(A+1),s=r}"ns"in _&&(s=_.ns)}return{host:e,port:l,domain:t,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}};class J7{constructor(e,t,r,i){this.eventType=e,this.eventRegistration=t,this.snapshot=r,this.prevName=i}getPath(){const e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+Fr(this.snapshot.exportVal())}}class X7{constructor(e,t,r){this.eventRegistration=e,this.error=t,this.path=r}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}class a1{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return Ce(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}class Ns{constructor(e,t,r,i){this._repo=e,this._path=t,this._queryParams=r,this._orderByCalled=i}get key(){return Ct(this._path)?null:hM(this._path)}get ref(){return new Do(this._repo,this._path)}get _queryIdentifier(){const e=r7(this._queryParams),t=iM(e);return"{}"===t?"default":t}get _queryObject(){return r7(this._queryParams)}isEqual(e){if(!((e=Vf(e))instanceof Ns))return!1;const t=this._repo===e._repo,r=fM(this._path,e._path);return t&&r&&this._queryIdentifier===e._queryIdentifier}toJSON(){return this.toString()}toString(){return this._repo.toString()+function H_e(n){let e="";for(let t=n.pieceNum_;t<n.pieces_.length;t++)""!==n.pieces_[t]&&(e+="/"+encodeURIComponent(String(n.pieces_[t])));return e||"/"}(this._path)}}class Do extends Ns{constructor(e,t){super(e,t,new IM,!1)}get parent(){const e=W3(this._path);return null===e?null:new Do(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class dd{constructor(e,t,r){this._node=e,this.ref=t,this._index=r}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){const t=new rn(e),r=hp(this.ref,e);return new dd(this._node.getChild(t),r,Nn)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(r,i)=>e(new dd(i,hp(this.ref,r),Nn)))}hasChild(e){const t=new rn(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function hp(n,e){return null===wt((n=Vf(n))._path)?Pve("child","path",e,!1):ZM("child","path",e,!1),new Do(n._repo,er(n._path,e))}function eEe(n){n=Vf(n);const e=new a1(()=>{}),t=new Cy(e);return function Vve(n,e,t){const r=function mve(n,e){const t=e._path;let r=null;n.syncPointTree_.foreachOnPath(t,(u,d)=>{const p=Qi(u,t);r=r||Cu(d,p)});let i=n.syncPointTree_.get(t);i?r=r||Cu(i,qt()):(i=new w7,n.syncPointTree_=n.syncPointTree_.set(t,i));const s=null!=r,o=s?new Iu(r,!0,!1):null;return function Zye(n){return w0(n.viewCache_)}(C7(i,e,C0(n.pendingWriteTree_,e._path),s?o.getNode():dt.EMPTY_NODE,s))}(n.serverSyncTree_,e);return null!=r?Promise.resolve(r):n.server_.get(e).then(i=>{const s=sr(i).withIndex(e._queryParams.getIndex());let o;if(BM(n.serverSyncTree_,e,t,!0),e._queryParams.loadsAllData())o=gy(n.serverSyncTree_,e._path,s);else{const a=my(n.serverSyncTree_,e);o=D7(n.serverSyncTree_,e._path,s,a)}return Ps(n.eventQueue_,e._path,o),x0(n.serverSyncTree_,e,t,null,!0),s},i=>(cp(n,"get for query "+Fr(e)+" failed: "+i),Promise.reject(new Error(i))))}(n._repo,n,t).then(r=>new dd(r,new Do(n._repo,n._path),n._queryParams.getIndex()))}class Cy{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){const r=t._queryParams.getIndex();return new J7("value",this,new dd(e.snapshotNode,new Do(t._repo,t._path),r))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new X7(this,e,t):null}matches(e){return e instanceof Cy&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}(function rve(n){Ce(!S0,"__referenceConstructor has already been defined"),S0=n})(Do),function lve(n){Ce(!R0,"__referenceConstructor has already been defined"),R0=n}(Do);const l1={};function i6(n,e,t,r,i){let s=r||n.options.databaseURL;void 0===s&&(n.options.projectId||fa("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),Yr("Using default host for project ",n.options.projectId),s=`${n.options.projectId}-default-rtdb.firebaseio.com`);let l,u,o=o1(s,i),a=o.repoInfo;typeof process<"u"&&process.env&&(u=process.env.FIREBASE_DATABASE_EMULATOR_HOST),u?(l=!0,s=`http://${u}?ns=${a.namespace}`,o=o1(s,i),a=o.repoInfo):l=!o.repoInfo.secure;const d=i&&l?new ry(ry.OWNER):new y_e(n.name,n.options,e);(function(n,e){const t=e.path.toString();if("string"!=typeof e.repoInfo.host||0===e.repoInfo.host.length||!O0(e.repoInfo.namespace)&&"localhost"!==e.repoInfo.host.split(":")[0]||0!==t.length&&!function(n){return n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),F7(n)}(t))throw new Error(Lf(n,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')})("Invalid Firebase Database URL",o),Ct(o.path)||fa("Database URL must point to the root of a Firebase Database (not including a child path).");const p=function pEe(n,e,t,r){let i=l1[e.name];i||(i={},l1[e.name]=i);let s=i[n.toURLString()];return s&&fa("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new Ove(n,false,t,r),i[n.toURLString()]=s,s}(a,n,d,new __e(n.name,t));return new mEe(p,n)}class mEe{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function Fve(n,e,t){if(n.stats_=uM(n.repoInfo_),n.forceRestClient_||("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)n.server_=new y0(n.repoInfo_,(r,i,s,o)=>{H7(n,r,i,s,o)},n.authTokenProvider_,n.appCheckProvider_),setTimeout(()=>z7(n,!0),0);else{if(typeof t<"u"&&null!==t){if("object"!=typeof t)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Fr(t)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}n.persistentConnection_=new od(n.repoInfo_,e,(r,i,s,o)=>{H7(n,r,i,s,o)},r=>{z7(n,r)},r=>{!function Lve(n,e){Jr(e,(t,r)=>{e1(n,t,r)})}(n,r)},n.authTokenProvider_,n.appCheckProvider_,t),n.server_=n.persistentConnection_}n.authTokenProvider_.addTokenChangeListener(r=>{n.server_.refreshAuthToken(r)}),n.appCheckProvider_.addTokenChangeListener(r=>{n.server_.refreshAppCheckToken(r.token)}),n.statsReporter_=function I_e(n,e){const t=n.toString();return lM[t]||(lM[t]=e()),lM[t]}(n.repoInfo_,()=>new Iye(n.stats_,n.server_)),n.infoData_=new mye,n.infoSyncTree_=new S7({startListening:(r,i,s,o)=>{let a=[];const l=n.infoData_.getNode(r._path);return l.isEmpty()||(a=gy(n.infoSyncTree_,r._path,l),setTimeout(()=>{o("ok")},0)),a},stopListening:()=>{}}),e1(n,"connected",!1),n.serverSyncTree_=new S7({startListening:(r,i,s,o)=>(n.server_.listen(r,s,i,(a,l)=>{const u=o(a,l);Ps(n.eventQueue_,r._path,u)}),[]),stopListening:(r,i)=>{n.server_.unlisten(r,i)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new Do(this._repo,qt())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function fEe(n,e){const t=l1[e];(!t||t[n.key]!==n)&&fa(`Database ${e}(${n.repoInfo_}) has already been deleted.`),function G7(n){n.persistentConnection_&&n.persistentConnection_.interrupt("repo_interrupt")}(n),delete t[n.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&fa("Cannot call "+e+" on a deleted database.")}}function _Ee(n=P4(),e){const t=EC(n,"database").getImmediate({identifier:e});if(!t._instanceStarted){const r=(n=>{const e=(n=>{var e,t;return null===(t=null===(e=fC())||void 0===e?void 0:e.emulatorHosts)||void 0===t?void 0:t[n]})(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return"["===e[0]?[e.substring(1,t-1),r]:[e.substring(0,t),r]})("database");r&&function yEe(n,e,t,r={}){(n=Vf(n))._checkNotDeleted("useEmulator"),n._instanceStarted&&fa("Cannot call useEmulator() after instance has already been initialized.");const i=n._repoInternal;let s;if(i.repoInfo_.nodeAdmin)r.mockUserToken&&fa('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new ry(ry.OWNER);else if(r.mockUserToken){const o="string"==typeof r.mockUserToken?r.mockUserToken:function cde(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[hC(JSON.stringify({alg:"none",type:"JWT"})),hC(JSON.stringify(o)),""].join(".")}(r.mockUserToken,n.app.options.projectId);s=new ry(o)}!function hEe(n,e,t,r){n.repoInfo_=new oM(`${e}:${t}`,!1,n.repoInfo_.namespace,n.repoInfo_.webSocketOnly,n.repoInfo_.nodeAdmin,n.repoInfo_.persistenceKey,n.repoInfo_.includeNamespaceInQueryParams,!0),r&&(n.authTokenProvider_=r)}(i,e,t,s)}(t,...r)}return t}od.prototype.simpleListen=function(n,e){this.sendRequest("q",{p:n},e)},od.prototype.echo=function(n,e){this.sendRequest("echo",{d:n},e)},function vEe(n){(function l3(n){tM=n})("11.1.0"),Uf(new Hc("database",(e,{instanceIdentifier:t})=>i6(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"),e.getProvider("app-check-internal"),t),"PUBLIC").setMultipleInstances(!0)),au(o3,"1.0.10",n),au(o3,"1.0.10","esm2017")}();let wEe=(()=>{class n{constructor(t){this.http=t,this.appCheckToken=null,this.appCheckToken=localStorage.getItem("firebaseAppCheckToken"),console.log("Token received in GiftService: "+this.appCheckToken)}fetchGiftsHttp(){console.log("Running HTTP...");const t=(new Xs).set("X-Firebase-AppCheck",this.appCheckToken||"");this.http.get("https://wedding-29b48-default-rtdb.europe-west1.firebasedatabase.app/gifts.json",{headers:t}).subscribe(r=>console.log("Gifts:",r),r=>console.error("Error fetching data:",r))}fetchGifts(){return(0,Z.A)(function*(){const r=function Z7(n,e){return(n=Vf(n))._checkNotDeleted("ref"),void 0!==e?hp(n._root,e):n._root}(_Ee(),"/gifts");try{const i=yield eEe(r),s=[];if(i.exists()){const o=i.val();for(const a in o)s.push({key:a,...o[a]})}else console.log("No data available");return s}catch(i){console.log("Shit goes wrong here?"),console.error("Error fetching data:",i)}})()}static{this.\u0275fac=function(r){return new(r||n)(Ee(aP))}}static{this.\u0275prov=Be({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();function CEe(n,e){if(1&n){const t=Al();me(0,"button",9),An("click",function(){ni(t);const i=Mr().$implicit;return ri(Mr().updateGiftStatus(i))}),Ie()}2&n&&Sl("ticked",Mr().$implicit.claimed)}function TEe(n,e){if(1&n&&(me(0,"tr")(1,"td",5),go(2,CEe,1,2,"button",6),Ie(),me(3,"td",7)(4,"a",8),Se(5),Ie()()()),2&n){const t=e.$implicit,r=Mr();Bt(2),Tn("ngIf","single"===t.quantity),Bt(1),Tn("ngStyle",r.getGiftStyle(t)),Bt(1),Ch("href",t.link,Tl),Bt(1),Dl(" ",t.name,"")}}function AEe(n,e){if(1&n){const t=Al();me(0,"button",9),An("click",function(){ni(t);const i=Mr().$implicit;return ri(Mr().updateGiftStatus(i))}),Ie()}2&n&&Sl("ticked",Mr().$implicit.claimed)}function bEe(n,e){if(1&n&&(me(0,"tr")(1,"td",5),go(2,AEe,1,2,"button",6),Ie(),me(3,"td",7)(4,"a",8),Se(5),Ie()()()),2&n){const t=e.$implicit,r=Mr();Bt(2),Tn("ngIf","single"===t.quantity),Bt(1),Tn("ngStyle",r.getGiftStyle(t)),Bt(1),Ch("href",t.link,Tl),Bt(1),Dl(" ",t.name,"")}}function SEe(n,e){if(1&n){const t=Al();me(0,"button",9),An("click",function(){ni(t);const i=Mr().$implicit;return ri(Mr().updateGiftStatus(i))}),Ie()}2&n&&Sl("ticked",Mr().$implicit.claimed)}function DEe(n,e){if(1&n&&(me(0,"tr")(1,"td",5),go(2,SEe,1,2,"button",6),Ie(),me(3,"td",7)(4,"a",8),Se(5),Ie()()()),2&n){const t=e.$implicit,r=Mr();Bt(2),Tn("ngIf","single"===t.quantity),Bt(1),Tn("ngStyle",r.getGiftStyle(t)),Bt(1),Ch("href",t.link,Tl),Bt(1),Dl(" ",t.name,"")}}function REe(n,e){if(1&n){const t=Al();me(0,"button",9),An("click",function(){ni(t);const i=Mr().$implicit;return ri(Mr().updateGiftStatus(i))}),Ie()}2&n&&Sl("ticked",Mr().$implicit.claimed)}function xEe(n,e){if(1&n&&(me(0,"tr")(1,"td",5),go(2,REe,1,2,"button",6),Ie(),me(3,"td",7)(4,"a",8),Se(5),Ie()()()),2&n){const t=e.$implicit,r=Mr();Bt(2),Tn("ngIf","single"===t.quantity),Bt(1),Tn("ngStyle",r.getGiftStyle(t)),Bt(1),Ch("href",t.link,Tl),Bt(1),Dl(" ",t.name,"")}}let PEe=(()=>{class n{constructor(t,r){this.firebaseService=t,this.giftService=r,this.giftList=[]}ngOnInit(){var t=this;return(0,Z.A)(function*(){yield t.fetchGifts()})()}fetchGifts(){var t=this;return(0,Z.A)(function*(){try{t.giftList=yield t.giftService.fetchGifts()}catch(r){throw console.log("Error in fetching gift data",r),r}})()}sortGifts(t){let r=[];return this.giftList.forEach(i=>{i.category===t&&r.push(i)}),r}updateGiftStatus(t){const r=`gifts/gift_${t.id}`;this.firebaseService.updateClaim(r,{claimed:!t.claimed}).subscribe(()=>{try{console.log("Update: "+r+" successful"),this.ngOnInit()}catch(s){console.error("Update failed",s)}})}getGiftStyle(t){return{"text-decoration":t.claimed?"line-through":"none",color:t.claimed?"gray":"black"}}static{this.\u0275fac=function(r){return new(r||n)(_e(s3),_e(wEe))}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-registry"]],decls:24,vars:4,consts:[[1,"page-headline"],[1,"container"],[1,"columns"],[1,"headline"],[4,"ngFor","ngForOf"],[1,"td-button"],["class","button",3,"ticked","click",4,"ngIf"],[3,"ngStyle"],["target","_blank",3,"href"],[1,"button",3,"click"]],template:function(r,i){1&r&&(me(0,"div",0),Se(1,"REGISTRY"),Ie(),me(2,"div",1)(3,"div",2)(4,"div",3),Se(5,"Kitchen"),Ie(),me(6,"table")(7,"tbody"),go(8,TEe,6,4,"tr",4),Ie()(),me(9,"div",3),Se(10,"Living Room"),Ie(),me(11,"table")(12,"tbody"),go(13,bEe,6,4,"tr",4),Ie()(),me(14,"div",3),Se(15,"Bathroom"),Ie(),me(16,"table")(17,"tbody"),go(18,DEe,6,4,"tr",4),Ie()(),me(19,"div",3),Se(20,"Experience"),Ie(),me(21,"table")(22,"tbody"),go(23,xEe,6,4,"tr",4),Ie()()()()),2&r&&(Bt(8),Tn("ngForOf",i.sortGifts("kitchen")),Bt(5),Tn("ngForOf",i.sortGifts("living-room")),Bt(5),Tn("ngForOf",i.sortGifts("bathroom")),Bt(5),Tn("ngForOf",i.sortGifts("experience")))},dependencies:[K2,yI,X2],styles:['.page-headline[_ngcontent-%COMP%]{background-color:#96a498;color:#fff;display:flex;justify-content:center;font-size:32px;width:100%;padding:5px;margin:0}.container[_ngcontent-%COMP%]{height:100vh;margin:2em}.columns[_ngcontent-%COMP%]{column-count:2;column-gap:20px;height:80vh;overflow-y:auto;column-fill:auto}table[_ngcontent-%COMP%]{width:100%;border-spacing:0 10px}.headline[_ngcontent-%COMP%]{display:flex;justify-content:center;background-color:#96a498;color:#fff;margin-top:10px;margin-bottom:10px;border-radius:5px;padding:3px;font-size:18px}tr[_ngcontent-%COMP%]:nth-child(odd){background-color:#f2f2f2}.td-button[_ngcontent-%COMP%]{width:20px}td[_ngcontent-%COMP%]{padding-left:30px;font-size:16px}.button[_ngcontent-%COMP%]{width:16px;height:16px;border-radius:0%;border:1px solid;box-shadow:2px 2px 5px #0009;padding:0;margin:0;display:flex;justify-content:center;cursor:pointer}.button[_ngcontent-%COMP%]:after{content:"";margin-left:20px;margin-top:4px;position:absolute;width:18px;height:6px;border-left:2px solid black;border-bottom:2px solid black;transform:rotate(-45deg) scale(0);transform-origin:bottom left;opacity:0}.button.ticked[_ngcontent-%COMP%]:after{transform:rotate(-45deg) scale(1);opacity:1}.button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}a[_ngcontent-%COMP%]:link, a[_ngcontent-%COMP%]:visited{color:inherit;text-decoration:none}@media (max-width: 1200px){.headline[_ngcontent-%COMP%]{font-size:17px}td[_ngcontent-%COMP%]{padding-left:25px}}@media (max-width: 1000px){.page-headline[_ngcontent-%COMP%]{font-size:26px}td[_ngcontent-%COMP%]{padding-left:20px}}@media (max-width: 800px){.page-headline[_ngcontent-%COMP%]{font-size:22px}.columns[_ngcontent-%COMP%]{column-gap:15px}.headline[_ngcontent-%COMP%]{font-size:16px}.button[_ngcontent-%COMP%]{width:15px;height:15px}td[_ngcontent-%COMP%]{padding-left:15px;font-size:15px}}@media (max-width: 600px){.page-headline[_ngcontent-%COMP%]{font-size:18px}.columns[_ngcontent-%COMP%]{column-count:1}.headline[_ngcontent-%COMP%]{font-size:14px}.button[_ngcontent-%COMP%]{width:13px;height:13px}td[_ngcontent-%COMP%]{padding-left:10px;font-size:13px}}@media (max-width: 450px){.page-headline[_ngcontent-%COMP%]{font-size:16px}td[_ngcontent-%COMP%]{padding-left:10px}}']})}}return n})(),NEe=(()=>{class n{constructor(){this.emailUser="pc",this.emailDomain="reithe.se"}getEmail(){return`${this.emailUser}@${this.emailDomain}`}getEmailLink(){return`mailto:${this.getEmail()}`}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-email-display"]],decls:2,vars:2,consts:[[3,"href"]],template:function(r,i){1&r&&(me(0,"a",0),Se(1),Ie()),2&r&&(Tn("href",i.getEmailLink(),Tl),Bt(1),vb(i.getEmail()))}})}}return n})();const MEe=[{path:"",redirectTo:"Home",pathMatch:"full"},{path:"Home",component:Xme},{path:"About",component:Zme},{path:"Schedule",component:e_e},{path:"Registry",component:PEe},{path:"FAQ",component:(()=>{class n{static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275cmp=Zr({type:n,selectors:[["app-faq"]],decls:28,vars:0,consts:[[1,"page-headline"],[1,"container"],[1,"question"],[1,"answer"],["href","https://www.google.com/maps/search/Hotels+near+Restaurant+River+on+The+Pier+Gothenburg","target","_blank"],[2,"margin-top","1em"]],template:function(r,i){1&r&&(me(0,"div",0),Se(1,"FAQ"),Ie(),me(2,"div",1)(3,"p"),Se(4,"We know that many of you have gone to great lengths to make it to our wedding, travelling in from various parts around the world. For this we are truly grateful. In order to ease the stress we've put together this FAQ that will hopefully shine light on some practical aspects of your journey."),Ie(),me(5,"div",2),Se(6,"What suitable accomodation is available?"),Ie(),me(7,"div",3),Se(8,'We recommend "Quality Hotel 11" located right next to the venue of the wedding party. The price is ca: 2000 SEK / 1300 DKK / 175 EUR per night for a double room including breakfast. Booking is made by contacting the hotel directly on +46 31 7791111. Use discount code '),me(9,"i"),Se(10,"RIVER"),Ie(),Se(11,' to obtain 15 % discount on previously mentioned prices. Another option is "Hotel Villan", also very near the venue of the party. For other hotel options near Eriksberg click '),me(12,"a",4),Se(13,"here."),Ie(),me(14,"div",5)(15,"b"),Se(16,"Note:"),Ie(),Se(17," Due to the fact the finals of Gothia Cup, the largest youth football tournament in the world, are being played on our wedding weekend Quality Hotell 11 is not available until the 19th."),Ie()(),me(18,"div",2),Se(19,"How do I transport myself to, from and around the wedding?"),Ie(),me(20,"div",3),Se(21,'Public transportation is pretty good in Gothenburg, once you get the hang of it. Download the app "V\xe4sttrafik ToGo" and buy tickets directly using your bank card. There is no need to sign up for an account. The same ticket is valid on all V\xe4sttrafik buses, trams and ferries. The app language should pop up as English as long as your phone\'s language is not set to Swedish. The ceremony, held at Domkyrkan in the city center of Gothenburg, is right next to a bus stop with the same name, "Domkyrkan". Between the church and the wedding party transportation is arranged as we have chartered a boat that will take us on a scenic tour along the harbour of Gothenburg before dropping us off at Restaurant River on The Pier in Eriksberg. The restaurant closes at 02:00, if you are in need of transportation home or to your hotel, buses run every 10-15 min through the night from bus stop "Eriksbergtorget", some 200 meters from the restaurant, to the city center. If you prefer taxi, Taxi G\xf6teborg is a trustworthy and well established taxi operator that can be booked on +46 31 650000. '),Ie(),me(22,"div",2),Se(23,"I would like to hold a speech, who do I contact?"),Ie(),me(24,"div",3),Se(25,"Please be in touch with toastmaster, Per-Christian Reithe, on XXX or XXX "),Tr(26,"app-email-display"),Se(27,". "),Ie()())},dependencies:[NEe],styles:[".page-headline[_ngcontent-%COMP%]{background-color:#96a498;color:#fff;display:flex;justify-content:center;font-size:32px;width:100%;padding:5px;margin:0}.container[_ngcontent-%COMP%]{margin:2em}.question[_ngcontent-%COMP%]{font-size:16px;font-weight:700}.answer[_ngcontent-%COMP%]{font-size:14px;margin-bottom:2em}a[_ngcontent-%COMP%]{text-decoration:none;color:#00f}"]})}}return n})()},{path:"Contact",component:t_e},{path:"Rsvp",component:i_e},{path:"**",component:n_e}];let kEe=(()=>{class n{constructor(){const t=x4(Jz_firebase);try{const r=ffe(t,{provider:new BP("6LeVw6YqAAAAAMSHu5q94FNCOdQgnV48JjOidVRE"),isTokenAutoRefreshEnabled:!0});console.log("AppCheck init OK"),function gfe(n,e){return jP.apply(this,arguments)}(r,!0).then(i=>{localStorage.setItem("firebaseAppCheckToken",i.token),console.log("AppCheck Token:",i)}).catch(i=>{console.error("AppCheck Error:",i)})}catch(r){console.log("AppCheck init failed,"+r)}}static{this.\u0275fac=function(r){return new(r||n)}}static{this.\u0275mod=ei({type:n,bootstrap:[Rie]})}static{this.\u0275inj=pi({providers:[Kme(()=>Qme())],imports:[zte,Ace,Die,rD.forRoot(MEe),Qie.initializeApp(Jz_firebase),Due,Qce]})}}return n})();$te().bootstrapModule(kEe).catch(n=>console.error(n))},574:(hs,or,Ge)=>{Ge.d(or,{A:()=>tr});var x=Ge(401),Ae=Ge(779),N=Ge(631),Fe=Ge(398);class Nt{constructor(Xe,qe){this._delegate=Xe,this.firebase=qe,(0,N._addComponent)(Xe,new Ae.uA("app-compat",()=>this,"PUBLIC")),this.container=Xe.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(Xe){this._delegate.automaticDataCollectionEnabled=Xe}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(Xe=>{this._delegate.checkDestroyed(),Xe()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,N.deleteApp)(this._delegate)))}_getService(Xe,qe=N._DEFAULT_ENTRY_NAME){var Wn;this._delegate.checkDestroyed();const fn=this._delegate.container.getProvider(Xe);return!fn.isInitialized()&&"EXPLICIT"===(null===(Wn=fn.getComponent())||void 0===Wn?void 0:Wn.instantiationMode)&&fn.initialize(),fn.getImmediate({identifier:qe})}_removeServiceInstance(Xe,qe=N._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(Xe).clearInstance(qe)}_addComponent(Xe){(0,N._addComponent)(this._delegate,Xe)}_addOrOverwriteComponent(Xe){(0,N._addOrOverwriteComponent)(this._delegate,Xe)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const Cn=new x.FA("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),se=function ht(){const gt=function Mt(gt){const Xe={},qe={__esModule:!0,initializeApp:function Ht(nt,ve={}){const K=N.initializeApp(nt,ve);if((0,x.gR)(Xe,K.name))return Xe[K.name];const je=new gt(K,qe);return Xe[K.name]=je,je},app:fn,registerVersion:N.registerVersion,setLogLevel:N.setLogLevel,onLog:N.onLog,apps:null,SDK_VERSION:N.SDK_VERSION,INTERNAL:{registerComponent:function Lr(nt){const ve=nt.name,K=ve.replace("-compat","");if(N._registerComponent(nt)&&"PUBLIC"===nt.type){const je=(rt=fn())=>{if("function"!=typeof rt[K])throw Cn.create("invalid-app-argument",{appName:ve});return rt[K]()};void 0!==nt.serviceProps&&(0,x.zw)(je,nt.serviceProps),qe[K]=je,gt.prototype[K]=function(...rt){return this._getService.bind(this,ve).apply(this,nt.multipleInstances?rt:[])}}return"PUBLIC"===nt.type?qe[K]:null},removeApp:function Wn(nt){delete Xe[nt]},useAsService:function _t(nt,ve){return"serverAuth"===ve?null:ve},modularAPIs:N}};function fn(nt){if(!(0,x.gR)(Xe,nt=nt||N._DEFAULT_ENTRY_NAME))throw Cn.create("no-app",{appName:nt});return Xe[nt]}return qe.default=qe,Object.defineProperty(qe,"apps",{get:function zt(){return Object.keys(Xe).map(nt=>Xe[nt])}}),fn.App=gt,qe}(Nt);return gt.INTERNAL=Object.assign(Object.assign({},gt.INTERNAL),{createFirebaseNamespace:ht,extendNamespace:function Xe(qe){(0,x.zw)(gt,qe)},createSubscribe:x.tD,ErrorFactory:x.FA,deepExtend:x.zw}),gt}(),he=new Fe.Vy("@firebase/app-compat");try{const gt=(0,x.mS)();if(void 0!==gt.firebase){he.warn("\n      Warning: Firebase is already defined in the global scope. Please make sure\n      Firebase library is only loaded once.\n    ");const Xe=gt.firebase.SDK_VERSION;Xe&&Xe.indexOf("LITE")>=0&&he.warn("\n        Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n        ")}}catch{}const tr=se;!function Tt(gt){(0,N.registerVersion)("@firebase/app-compat","0.2.43",gt)}()},631:(hs,or,Ge)=>{Ge.r(or),Ge.d(or,{FirebaseError:()=>Fe.g,SDK_VERSION:()=>Ir,_DEFAULT_ENTRY_NAME:()=>W,_addComponent:()=>ge,_addOrOverwriteComponent:()=>de,_apps:()=>Q,_clearComponents:()=>gr,_components:()=>re,_getProvider:()=>Qt,_isFirebaseApp:()=>Ft,_isFirebaseServerApp:()=>gn,_registerComponent:()=>Qe,_removeServiceInstance:()=>Ke,_serverApps:()=>$,deleteApp:()=>Os,getApp:()=>no,getApps:()=>Po,initializeApp:()=>Ut,initializeServerApp:()=>hi,onLog:()=>Fs,registerVersion:()=>Xi,setLogLevel:()=>mr});var x=Ge(467),Ae=Ge(779),N=Ge(398),Fe=Ge(401),Nt=Ge(749);class hn{constructor(oe){this.container=oe}getPlatformInfoString(){return this.container.getProviders().map(C=>{if(function Cn(Re){const oe=Re.getComponent();return"VERSION"===oe?.type}(C)){const E=C.getImmediate();return`${E.library}/${E.version}`}return null}).filter(C=>C).join(" ")}}const Mt="@firebase/app",ht="0.10.13",se=new N.Vy("@firebase/app"),W="[DEFAULT]",ee={[Mt]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/vertexai-preview":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},Q=new Map,$=new Map,re=new Map;function ge(Re,oe){try{Re.container.addComponent(oe)}catch(C){se.debug(`Component ${oe.name} failed to register with FirebaseApp ${Re.name}`,C)}}function de(Re,oe){Re.container.addOrOverwriteComponent(oe)}function Qe(Re){const oe=Re.name;if(re.has(oe))return se.debug(`There were multiple attempts to register component ${oe}.`),!1;re.set(oe,Re);for(const C of Q.values())ge(C,Re);for(const C of $.values())ge(C,Re);return!0}function Qt(Re,oe){const C=Re.container.getProvider("heartbeat").getImmediate({optional:!0});return C&&C.triggerHeartbeat(),Re.container.getProvider(oe)}function Ke(Re,oe,C=W){Qt(Re,oe).clearInstance(C)}function Ft(Re){return void 0!==Re.options}function gn(Re){return void 0!==Re.settings}function gr(){re.clear()}const Ot=new Fe.FA("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class Gn{constructor(oe,C,E){this._isDeleted=!1,this._options=Object.assign({},oe),this._config=Object.assign({},C),this._name=C.name,this._automaticDataCollectionEnabled=C.automaticDataCollectionEnabled,this._container=E,this.container.addComponent(new Ae.uA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(oe){this.checkDestroyed(),this._automaticDataCollectionEnabled=oe}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(oe){this._isDeleted=oe}checkDestroyed(){if(this.isDeleted)throw Ot.create("app-deleted",{appName:this._name})}}class ar extends Gn{constructor(oe,C,E,T){const R=void 0!==C.automaticDataCollectionEnabled&&C.automaticDataCollectionEnabled,k={name:E,automaticDataCollectionEnabled:R};super(void 0!==oe.apiKey?oe:oe.options,k,T),this._serverConfig=Object.assign({automaticDataCollectionEnabled:R},C),this._finalizationRegistry=null,typeof FinalizationRegistry<"u"&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,C.releaseOnDeref=void 0,Xi(Mt,ht,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(oe){this.isDeleted||(this._refCount++,void 0!==oe&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(oe,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){Os(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw Ot.create("server-app-deleted")}}const Ir="10.14.1";function Ut(Re,oe={}){let C=Re;"object"!=typeof oe&&(oe={name:oe});const E=Object.assign({name:W,automaticDataCollectionEnabled:!1},oe),T=E.name;if("string"!=typeof T||!T)throw Ot.create("bad-app-name",{appName:String(T)});if(C||(C=(0,Fe.T9)()),!C)throw Ot.create("no-options");const R=Q.get(T);if(R){if((0,Fe.bD)(C,R.options)&&(0,Fe.bD)(E,R.config))return R;throw Ot.create("duplicate-app",{appName:T})}const k=new Ae.h1(T);for(const ye of re.values())k.addComponent(ye);const ie=new Gn(C,E,k);return Q.set(T,ie),ie}function hi(Re,oe){if((0,Fe.Bd)()&&!(0,Fe.p7)())throw Ot.create("invalid-server-app-environment");let C;void 0===oe.automaticDataCollectionEnabled&&(oe.automaticDataCollectionEnabled=!1),C=Ft(Re)?Re.options:Re;const E=Object.assign(Object.assign({},oe),C);if(void 0!==E.releaseOnDeref&&delete E.releaseOnDeref,void 0!==oe.releaseOnDeref&&typeof FinalizationRegistry>"u")throw Ot.create("finalization-registry-not-supported",{});const R=""+(He=JSON.stringify(E),[...He].reduce((bt,Ve)=>Math.imul(31,bt)+Ve.charCodeAt(0)|0,0)),k=$.get(R);var He;if(k)return k.incRefCount(oe.releaseOnDeref),k;const ie=new Ae.h1(R);for(const He of re.values())ie.addComponent(He);const ye=new ar(C,oe,R,ie);return $.set(R,ye),ye}function no(Re=W){const oe=Q.get(Re);if(!oe&&Re===W&&(0,Fe.T9)())return Ut();if(!oe)throw Ot.create("no-app",{appName:Re});return oe}function Po(){return Array.from(Q.values())}function Os(Re){return fi.apply(this,arguments)}function fi(){return(fi=(0,x.A)(function*(Re){let oe=!1;const C=Re.name;Q.has(C)?(oe=!0,Q.delete(C)):$.has(C)&&Re.decRefCount()<=0&&($.delete(C),oe=!0),oe&&(yield Promise.all(Re.container.getProviders().map(E=>E.delete())),Re.isDeleted=!0)})).apply(this,arguments)}function Xi(Re,oe,C){var E;let T=null!==(E=ee[Re])&&void 0!==E?E:Re;C&&(T+=`-${C}`);const R=T.match(/\s|\//),k=oe.match(/\s|\//);if(R||k){const ie=[`Unable to register library "${T}" with version "${oe}":`];return R&&ie.push(`library name "${T}" contains illegal characters (whitespace or "/")`),R&&k&&ie.push("and"),k&&ie.push(`version name "${oe}" contains illegal characters (whitespace or "/")`),void se.warn(ie.join(" "))}Qe(new Ae.uA(`${T}-version`,()=>({library:T,version:oe}),"VERSION"))}function Fs(Re,oe){if(null!==Re&&"function"!=typeof Re)throw Ot.create("invalid-log-argument");(0,N.Ey)(Re,oe)}function mr(Re){(0,N.He)(Re)}const Ni="firebase-heartbeat-database",On=1,wr="firebase-heartbeat-store";let qn=null;function ro(){return qn||(qn=(0,Nt.P2)(Ni,On,{upgrade:(Re,oe)=>{if(0===oe)try{Re.createObjectStore(wr)}catch(C){console.warn(C)}}}).catch(Re=>{throw Ot.create("idb-open",{originalErrorMessage:Re.message})})),qn}function Yt(){return(Yt=(0,x.A)(function*(Re){try{const C=(yield ro()).transaction(wr),E=yield C.objectStore(wr).get(es(Re));return yield C.done,E}catch(oe){if(oe instanceof Fe.g)se.warn(oe.message);else{const C=Ot.create("idb-get",{originalErrorMessage:oe?.message});se.warn(C.message)}}})).apply(this,arguments)}function Mi(Re,oe){return fs.apply(this,arguments)}function fs(){return(fs=(0,x.A)(function*(Re,oe){try{const E=(yield ro()).transaction(wr,"readwrite");yield E.objectStore(wr).put(oe,es(Re)),yield E.done}catch(C){if(C instanceof Fe.g)se.warn(C.message);else{const E=Ot.create("idb-set",{originalErrorMessage:C?.message});se.warn(E.message)}}})).apply(this,arguments)}function es(Re){return`${Re.name}!${Re.options.appId}`}class Vr{constructor(oe){this.container=oe,this._heartbeatsCache=null;const C=this.container.getProvider("app").getImmediate();this._storage=new oo(C),this._heartbeatsCachePromise=this._storage.read().then(E=>(this._heartbeatsCache=E,E))}triggerHeartbeat(){var oe=this;return(0,x.A)(function*(){var C,E;try{const R=oe.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),k=io();return null==(null===(C=oe._heartbeatsCache)||void 0===C?void 0:C.heartbeats)&&(oe._heartbeatsCache=yield oe._heartbeatsCachePromise,null==(null===(E=oe._heartbeatsCache)||void 0===E?void 0:E.heartbeats))||oe._heartbeatsCache.lastSentHeartbeatDate===k||oe._heartbeatsCache.heartbeats.some(ie=>ie.date===k)?void 0:(oe._heartbeatsCache.heartbeats.push({date:k,agent:R}),oe._heartbeatsCache.heartbeats=oe._heartbeatsCache.heartbeats.filter(ie=>{const ye=new Date(ie.date).valueOf();return Date.now()-ye<=2592e6}),oe._storage.overwrite(oe._heartbeatsCache))}catch(T){se.warn(T)}})()}getHeartbeatsHeader(){var oe=this;return(0,x.A)(function*(){var C;try{if(null===oe._heartbeatsCache&&(yield oe._heartbeatsCachePromise),null==(null===(C=oe._heartbeatsCache)||void 0===C?void 0:C.heartbeats)||0===oe._heartbeatsCache.heartbeats.length)return"";const E=io(),{heartbeatsToSend:T,unsentEntries:R}=function so(Re,oe=1024){const C=[];let E=Re.slice();for(const T of Re){const R=C.find(k=>k.agent===T.agent);if(R){if(R.dates.push(T.date),No(C)>oe){R.dates.pop();break}}else if(C.push({agent:T.agent,dates:[T.date]}),No(C)>oe){C.pop();break}E=E.slice(1)}return{heartbeatsToSend:C,unsentEntries:E}}(oe._heartbeatsCache.heartbeats),k=(0,Fe.Uj)(JSON.stringify({version:2,heartbeats:T}));return oe._heartbeatsCache.lastSentHeartbeatDate=E,R.length>0?(oe._heartbeatsCache.heartbeats=R,yield oe._storage.overwrite(oe._heartbeatsCache)):(oe._heartbeatsCache.heartbeats=[],oe._storage.overwrite(oe._heartbeatsCache)),k}catch(E){return se.warn(E),""}})()}}function io(){return(new Date).toISOString().substring(0,10)}class oo{constructor(oe){this.app=oe,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}runIndexedDBEnvironmentCheck(){return(0,x.A)(function*(){return!!(0,Fe.zW)()&&(0,Fe.eX)().then(()=>!0).catch(()=>!1)})()}read(){var oe=this;return(0,x.A)(function*(){if(yield oe._canUseIndexedDBPromise){const E=yield function Zi(Re){return Yt.apply(this,arguments)}(oe.app);return E?.heartbeats?E:{heartbeats:[]}}return{heartbeats:[]}})()}overwrite(oe){var C=this;return(0,x.A)(function*(){var E;if(yield C._canUseIndexedDBPromise){const R=yield C.read();return Mi(C.app,{lastSentHeartbeatDate:null!==(E=oe.lastSentHeartbeatDate)&&void 0!==E?E:R.lastSentHeartbeatDate,heartbeats:oe.heartbeats})}})()}add(oe){var C=this;return(0,x.A)(function*(){var E;if(yield C._canUseIndexedDBPromise){const R=yield C.read();return Mi(C.app,{lastSentHeartbeatDate:null!==(E=oe.lastSentHeartbeatDate)&&void 0!==E?E:R.lastSentHeartbeatDate,heartbeats:[...R.heartbeats,...oe.heartbeats]})}})()}}function No(Re){return(0,Fe.Uj)(JSON.stringify({version:2,heartbeats:Re})).length}!function ya(Re){Qe(new Ae.uA("platform-logger",oe=>new hn(oe),"PRIVATE")),Qe(new Ae.uA("heartbeat",oe=>new Vr(oe),"PRIVATE")),Xi(Mt,ht,Re),Xi(Mt,ht,"esm2017"),Xi("fire-js","")}("")},779:(hs,or,Ge)=>{Ge.d(or,{h1:()=>Mt,uA:()=>N});var x=Ge(467),Ae=Ge(401);class N{constructor(se,he,Le){this.name=se,this.instanceFactory=he,this.type=Le,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(se){return this.instantiationMode=se,this}setMultipleInstances(se){return this.multipleInstances=se,this}setServiceProps(se){return this.serviceProps=se,this}setInstanceCreatedCallback(se){return this.onInstanceCreated=se,this}}const Fe="[DEFAULT]";class Nt{constructor(se,he){this.name=se,this.container=he,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(se){const he=this.normalizeInstanceIdentifier(se);if(!this.instancesDeferred.has(he)){const Le=new Ae.cY;if(this.instancesDeferred.set(he,Le),this.isInitialized(he)||this.shouldAutoInitialize())try{const ot=this.getOrInitializeService({instanceIdentifier:he});ot&&Le.resolve(ot)}catch{}}return this.instancesDeferred.get(he).promise}getImmediate(se){var he;const Le=this.normalizeInstanceIdentifier(se?.identifier),ot=null!==(he=se?.optional)&&void 0!==he&&he;if(!this.isInitialized(Le)&&!this.shouldAutoInitialize()){if(ot)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:Le})}catch(Tt){if(ot)return null;throw Tt}}getComponent(){return this.component}setComponent(se){if(se.name!==this.name)throw Error(`Mismatching Component ${se.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=se,this.shouldAutoInitialize()){if(function Cn(ht){return"EAGER"===ht.instantiationMode}(se))try{this.getOrInitializeService({instanceIdentifier:Fe})}catch{}for(const[he,Le]of this.instancesDeferred.entries()){const ot=this.normalizeInstanceIdentifier(he);try{const Tt=this.getOrInitializeService({instanceIdentifier:ot});Le.resolve(Tt)}catch{}}}}clearInstance(se=Fe){this.instancesDeferred.delete(se),this.instancesOptions.delete(se),this.instances.delete(se)}delete(){var se=this;return(0,x.A)(function*(){const he=Array.from(se.instances.values());yield Promise.all([...he.filter(Le=>"INTERNAL"in Le).map(Le=>Le.INTERNAL.delete()),...he.filter(Le=>"_delete"in Le).map(Le=>Le._delete())])})()}isComponentSet(){return null!=this.component}isInitialized(se=Fe){return this.instances.has(se)}getOptions(se=Fe){return this.instancesOptions.get(se)||{}}initialize(se={}){const{options:he={}}=se,Le=this.normalizeInstanceIdentifier(se.instanceIdentifier);if(this.isInitialized(Le))throw Error(`${this.name}(${Le}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const ot=this.getOrInitializeService({instanceIdentifier:Le,options:he});for(const[Tt,tr]of this.instancesDeferred.entries())Le===this.normalizeInstanceIdentifier(Tt)&&tr.resolve(ot);return ot}onInit(se,he){var Le;const ot=this.normalizeInstanceIdentifier(he),Tt=null!==(Le=this.onInitCallbacks.get(ot))&&void 0!==Le?Le:new Set;Tt.add(se),this.onInitCallbacks.set(ot,Tt);const tr=this.instances.get(ot);return tr&&se(tr,ot),()=>{Tt.delete(se)}}invokeOnInitCallbacks(se,he){const Le=this.onInitCallbacks.get(he);if(Le)for(const ot of Le)try{ot(se,he)}catch{}}getOrInitializeService({instanceIdentifier:se,options:he={}}){let Le=this.instances.get(se);if(!Le&&this.component&&(Le=this.component.instanceFactory(this.container,{instanceIdentifier:(ht=se,ht===Fe?void 0:ht),options:he}),this.instances.set(se,Le),this.instancesOptions.set(se,he),this.invokeOnInitCallbacks(Le,se),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,se,Le)}catch{}var ht;return Le||null}normalizeInstanceIdentifier(se=Fe){return this.component?this.component.multipleInstances?se:Fe:se}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Mt{constructor(se){this.name=se,this.providers=new Map}addComponent(se){const he=this.getProvider(se.name);if(he.isComponentSet())throw new Error(`Component ${se.name} has already been registered with ${this.name}`);he.setComponent(se)}addOrOverwriteComponent(se){this.getProvider(se.name).isComponentSet()&&this.providers.delete(se.name),this.addComponent(se)}getProvider(se){if(this.providers.has(se))return this.providers.get(se);const he=new Nt(se,this);return this.providers.set(se,he),he}getProviders(){return Array.from(this.providers.values())}}},398:(hs,or,Ge)=>{Ge.d(or,{$b:()=>Ae,Ey:()=>ht,He:()=>Mt,Vy:()=>Cn});const x=[];var Ae=function(se){return se[se.DEBUG=0]="DEBUG",se[se.VERBOSE=1]="VERBOSE",se[se.INFO=2]="INFO",se[se.WARN=3]="WARN",se[se.ERROR=4]="ERROR",se[se.SILENT=5]="SILENT",se}(Ae||{});const N={debug:Ae.DEBUG,verbose:Ae.VERBOSE,info:Ae.INFO,warn:Ae.WARN,error:Ae.ERROR,silent:Ae.SILENT},Fe=Ae.INFO,Nt={[Ae.DEBUG]:"log",[Ae.VERBOSE]:"log",[Ae.INFO]:"info",[Ae.WARN]:"warn",[Ae.ERROR]:"error"},hn=(se,he,...Le)=>{if(he<se.logLevel)return;const ot=(new Date).toISOString(),Tt=Nt[he];if(!Tt)throw new Error(`Attempted to log a message with an invalid logType (value: ${he})`);console[Tt](`[${ot}]  ${se.name}:`,...Le)};class Cn{constructor(he){this.name=he,this._logLevel=Fe,this._logHandler=hn,this._userLogHandler=null,x.push(this)}get logLevel(){return this._logLevel}set logLevel(he){if(!(he in Ae))throw new TypeError(`Invalid value "${he}" assigned to \`logLevel\``);this._logLevel=he}setLogLevel(he){this._logLevel="string"==typeof he?N[he]:he}get logHandler(){return this._logHandler}set logHandler(he){if("function"!=typeof he)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=he}get userLogHandler(){return this._userLogHandler}set userLogHandler(he){this._userLogHandler=he}debug(...he){this._userLogHandler&&this._userLogHandler(this,Ae.DEBUG,...he),this._logHandler(this,Ae.DEBUG,...he)}log(...he){this._userLogHandler&&this._userLogHandler(this,Ae.VERBOSE,...he),this._logHandler(this,Ae.VERBOSE,...he)}info(...he){this._userLogHandler&&this._userLogHandler(this,Ae.INFO,...he),this._logHandler(this,Ae.INFO,...he)}warn(...he){this._userLogHandler&&this._userLogHandler(this,Ae.WARN,...he),this._logHandler(this,Ae.WARN,...he)}error(...he){this._userLogHandler&&this._userLogHandler(this,Ae.ERROR,...he),this._logHandler(this,Ae.ERROR,...he)}}function Mt(se){x.forEach(he=>{he.setLogLevel(se)})}function ht(se,he){for(const Le of x){let ot=null;he&&he.level&&(ot=N[he.level]),Le.userLogHandler=null===se?null:(Tt,tr,...gt)=>{const Xe=gt.map(qe=>{if(null==qe)return null;if("string"==typeof qe)return qe;if("number"==typeof qe||"boolean"==typeof qe)return qe.toString();if(qe instanceof Error)return qe.message;try{return JSON.stringify(qe)}catch{return null}}).filter(qe=>qe).join(" ");tr>=(ot??Tt.logLevel)&&se({level:Ae[tr].toLowerCase(),message:Xe,args:gt,type:Tt.name})}}}},46:(hs,or,Ge)=>{var x=Ge(467),Ae=Ge(574),N=Ge(443),Fe=Ge(401),Cn=(Ge(631),Ge(398),Ge(779));function Mt(){return window}function he(){return he=(0,x.A)(function*(C,E,T){var R;const{BuildInfo:k}=Mt();(0,N.au)(E.sessionId,"AuthEvent did not contain a session ID");const ie=yield function qe(C){return Wn.apply(this,arguments)}(E.sessionId),ye={};return(0,N.av)()?ye.ibi=k.packageName:(0,N.aw)()?ye.apn=k.packageName:(0,N.ax)(C,"operation-not-supported-in-this-environment"),k.displayName&&(ye.appDisplayName=k.displayName),ye.sessionId=ie,(0,N.ay)(C,T,E.type,void 0,null!==(R=E.eventId)&&void 0!==R?R:void 0,ye)}),he.apply(this,arguments)}function ot(){return(ot=(0,x.A)(function*(C){const{BuildInfo:E}=Mt(),T={};(0,N.av)()?T.iosBundleId=E.packageName:(0,N.aw)()?T.androidPackageName=E.packageName:(0,N.ax)(C,"operation-not-supported-in-this-environment"),yield(0,N.az)(C,T)})).apply(this,arguments)}function gt(){return(gt=(0,x.A)(function*(C,E,T){const{cordova:R}=Mt();let k=()=>{};try{yield new Promise((ie,ye)=>{let He=null;function bt(){var be;ie();const Fn=null===(be=R.plugins.browsertab)||void 0===be?void 0:be.close;"function"==typeof Fn&&Fn(),"function"==typeof T?.close&&T.close()}function Ve(){He||(He=window.setTimeout(()=>{ye((0,N.aB)(C,"redirect-cancelled-by-user"))},2e3))}function mn(){"visible"===document?.visibilityState&&Ve()}E.addPassiveListener(bt),document.addEventListener("resume",Ve,!1),(0,N.aw)()&&document.addEventListener("visibilitychange",mn,!1),k=()=>{E.removePassiveListener(bt),document.removeEventListener("resume",Ve,!1),document.removeEventListener("visibilitychange",mn,!1),He&&window.clearTimeout(He)}})}finally{k()}})).apply(this,arguments)}function Wn(){return(Wn=(0,x.A)(function*(C){const E=function fn(C){if((0,N.au)(/[0-9a-zA-Z]+/.test(C),"Can only convert alpha-numeric strings"),typeof TextEncoder<"u")return(new TextEncoder).encode(C);const E=new ArrayBuffer(C.length),T=new Uint8Array(E);for(let R=0;R<C.length;R++)T[R]=C.charCodeAt(R);return T}(C),T=yield crypto.subtle.digest("SHA-256",E);return Array.from(new Uint8Array(T)).map(k=>k.toString(16).padStart(2,"0")).join("")})).apply(this,arguments)}class zt extends N.aD{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(E=>{this.resolveInitialized=E})}addPassiveListener(E){this.passiveListeners.add(E)}removePassiveListener(E){this.passiveListeners.delete(E)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(E){return this.resolveInitialized(),this.passiveListeners.forEach(T=>T(E)),super.onEvent(E)}initialized(){var E=this;return(0,x.A)(function*(){yield E.initPromise})()}}function nt(C){return ve.apply(this,arguments)}function ve(){return(ve=(0,x.A)(function*(C){const E=yield rt()._get(At(C));return E&&(yield rt()._remove(At(C))),E})).apply(this,arguments)}function je(){const C=[];for(let T=0;T<20;T++){const R=Math.floor(62*Math.random());C.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(R))}return C.join("")}function rt(){return(0,N.aE)(N.b)}function At(C){return(0,N.aF)("authEvent",C.config.apiKey,C.name)}function lt(C){if(!C?.includes("?"))return{};const[E,...T]=C.split("?");return(0,Fe.I9)(T.join("?"))}const Xr=class pr{constructor(){this._redirectPersistence=N.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=N.aG,this._overrideRedirectResult=N.aH}_initialize(E){var T=this;return(0,x.A)(function*(){const R=E._key();let k=T.eventManagers.get(R);return k||(k=new zt(E),T.eventManagers.set(R,k),T.attachCallbackListeners(E,k)),k})()}_openPopup(E){(0,N.ax)(E,"operation-not-supported-in-this-environment")}_openRedirect(E,T,R,k){var ie=this;return(0,x.A)(function*(){!function Xe(C){var E,T,R,k,ie,ye,He,bt,Ve,mn;const be=Mt();(0,N.aC)("function"==typeof(null===(E=be?.universalLinks)||void 0===E?void 0:E.subscribe),C,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,N.aC)(typeof(null===(T=be?.BuildInfo)||void 0===T?void 0:T.packageName)<"u",C,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,N.aC)("function"==typeof(null===(ie=null===(k=null===(R=be?.cordova)||void 0===R?void 0:R.plugins)||void 0===k?void 0:k.browsertab)||void 0===ie?void 0:ie.openUrl),C,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,N.aC)("function"==typeof(null===(bt=null===(He=null===(ye=be?.cordova)||void 0===ye?void 0:ye.plugins)||void 0===He?void 0:He.browsertab)||void 0===bt?void 0:bt.isAvailable),C,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,N.aC)("function"==typeof(null===(mn=null===(Ve=be?.cordova)||void 0===Ve?void 0:Ve.InAppBrowser)||void 0===mn?void 0:mn.open),C,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(E);const ye=yield ie._initialize(E);yield ye.initialized(),ye.resetRedirect(),(0,N.aI)(),yield ie._originValidation(E);const He=function Lr(C,E,T=null){return{type:E,eventId:T,urlResponse:null,sessionId:je(),postBody:null,tenantId:C.tenantId,error:(0,N.aB)(C,"no-auth-event")}}(E,R,k);yield function _t(C,E){return rt()._set(At(C),E)}(E,He);const bt=yield function se(C,E,T){return he.apply(this,arguments)}(E,He,T),Ve=yield function Tt(C){const{cordova:E}=Mt();return new Promise(T=>{E.plugins.browsertab.isAvailable(R=>{let k=null;R?E.plugins.browsertab.openUrl(C):k=E.InAppBrowser.open(C,(0,N.aA)()?"_blank":"_system","location=yes"),T(k)})})}(bt);return function tr(C,E,T){return gt.apply(this,arguments)}(E,ye,Ve)})()}_isIframeWebStorageSupported(E,T){throw new Error("Method not implemented.")}_originValidation(E){const T=E._key();return this.originValidationPromises[T]||(this.originValidationPromises[T]=function Le(C){return ot.apply(this,arguments)}(E)),this.originValidationPromises[T]}attachCallbackListeners(E,T){const{universalLinks:R,handleOpenURL:k,BuildInfo:ie}=Mt(),ye=setTimeout((0,x.A)(function*(){yield nt(E),T.onEvent(ks())}),500),He=function(){var mn=(0,x.A)(function*(be){clearTimeout(ye);const Fn=yield nt(E);let Ls=null;Fn&&be?.url&&(Ls=function K(C,E){var T,R;const k=function sn(C){const E=lt(C),T=E.link?decodeURIComponent(E.link):void 0,R=lt(T).link,k=E.deep_link_id?decodeURIComponent(E.deep_link_id):void 0;return lt(k).link||k||R||T||C}(E);if(k.includes("/__/auth/callback")){const ie=lt(k),ye=ie.firebaseError?function kn(C){try{return JSON.parse(C)}catch{return null}}(decodeURIComponent(ie.firebaseError)):null,He=null===(R=null===(T=ye?.code)||void 0===T?void 0:T.split("auth/"))||void 0===R?void 0:R[1],bt=He?(0,N.aB)(He):null;return bt?{type:C.type,eventId:C.eventId,tenantId:C.tenantId,error:bt,urlResponse:null,sessionId:null,postBody:null}:{type:C.type,eventId:C.eventId,tenantId:C.tenantId,sessionId:C.sessionId,urlResponse:k,postBody:null}}return null}(Fn,be.url)),T.onEvent(Ls||ks())});return function(Fn){return mn.apply(this,arguments)}}();typeof R<"u"&&"function"==typeof R.subscribe&&R.subscribe(null,He);const bt=k,Ve=`${ie.packageName.toLowerCase()}://`;Mt().handleOpenURL=function(){var mn=(0,x.A)(function*(be){if(be.toLowerCase().startsWith(Ve)&&He({url:be}),"function"==typeof bt)try{bt(be)}catch(Fn){console.error(Fn)}});return function(be){return mn.apply(this,arguments)}}()}};function ks(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,N.aB)("no-auth-event")}}function re(){var C;return(null===(C=self?.location)||void 0===C?void 0:C.protocol)||null}function de(C=(0,Fe.ZQ)()){return!("file:"!==re()&&"ionic:"!==re()&&"capacitor:"!==re()||!C.toLowerCase().match(/iphone|ipad|ipod|android/))}function gn(){try{const C=self.localStorage,E=N.aN();if(C)return C.setItem(E,"1"),C.removeItem(E),!function Ft(C=(0,Fe.ZQ)()){return function Qt(){return(0,Fe.lT)()&&11===document?.documentMode}()||function Ke(C=(0,Fe.ZQ)()){return/Edge\/\d+/.test(C)}(C)}()||(0,Fe.zW)()}catch{return gr()&&(0,Fe.zW)()}return!1}function gr(){return typeof global<"u"&&"WorkerGlobalScope"in global&&"importScripts"in global}function kt(){return(function ge(){return"http:"===re()||"https:"===re()}()||(0,Fe.sr)()||de())&&!function Qe(){return(0,Fe.lV)()||(0,Fe.Ll)()}()&&gn()&&!gr()}function Ot(){return de()&&typeof document<"u"}function ar(){return(ar=(0,x.A)(function*(){return!!Ot()&&new Promise(C=>{const E=setTimeout(()=>{C(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(E),C(!0)})})})).apply(this,arguments)}const Ut={LOCAL:"local",NONE:"none",SESSION:"session"},hi=N.aC,no="persistence";function Os(C){return fi.apply(this,arguments)}function fi(){return(fi=(0,x.A)(function*(C){yield C._initializationPromise;const E=Fs(),T=N.aF(no,C.config.apiKey,C.name);E&&E.setItem(T,C._getPersistence())})).apply(this,arguments)}function Fs(){var C;try{return(null===(C=function Ir(){return typeof window<"u"?window:null}())||void 0===C?void 0:C.sessionStorage)||null}catch{return null}}const mr=N.aC;class Ni{constructor(){this.browserResolver=N.aE(N.k),this.cordovaResolver=N.aE(Xr),this.underlyingResolver=null,this._redirectPersistence=N.a,this._completeRedirectFn=N.aG,this._overrideRedirectResult=N.aH}_initialize(E){var T=this;return(0,x.A)(function*(){return yield T.selectUnderlyingResolver(),T.assertedUnderlyingResolver._initialize(E)})()}_openPopup(E,T,R,k){var ie=this;return(0,x.A)(function*(){return yield ie.selectUnderlyingResolver(),ie.assertedUnderlyingResolver._openPopup(E,T,R,k)})()}_openRedirect(E,T,R,k){var ie=this;return(0,x.A)(function*(){return yield ie.selectUnderlyingResolver(),ie.assertedUnderlyingResolver._openRedirect(E,T,R,k)})()}_isIframeWebStorageSupported(E,T){this.assertedUnderlyingResolver._isIframeWebStorageSupported(E,T)}_originValidation(E){return this.assertedUnderlyingResolver._originValidation(E)}get _shouldInitProactively(){return Ot()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return mr(this.underlyingResolver,"internal-error"),this.underlyingResolver}selectUnderlyingResolver(){var E=this;return(0,x.A)(function*(){if(E.underlyingResolver)return;const T=yield function Gn(){return ar.apply(this,arguments)}();E.underlyingResolver=T?E.cordovaResolver:E.browserResolver})()}}function On(C){return C.unwrap()}function qn(C){return Zi(C)}function Zi(C){const{_tokenResponse:E}=C instanceof Fe.g?C.customData:C;if(!E)return null;if(!(C instanceof Fe.g)&&"temporaryProof"in E&&"phoneNumber"in E)return N.P.credentialFromResult(C);const T=E.providerId;if(!T||T===N.p.PASSWORD)return null;let R;switch(T){case N.p.GOOGLE:R=N.X;break;case N.p.FACEBOOK:R=N.W;break;case N.p.GITHUB:R=N.Y;break;case N.p.TWITTER:R=N.$;break;default:const{oauthIdToken:k,oauthAccessToken:ie,oauthTokenSecret:ye,pendingToken:He,nonce:bt}=E;return ie||ye||k||He?He?T.startsWith("saml.")?N.aQ._create(T,He):N.N._fromParams({providerId:T,signInMethod:T,pendingToken:He,idToken:k,accessToken:ie}):new N.Z(T).credential({idToken:k,accessToken:ie,rawNonce:bt}):null}return C instanceof Fe.g?R.credentialFromError(C):R.credentialFromResult(C)}function Yt(C,E){return E.catch(T=>{throw T instanceof Fe.g&&function ro(C,E){var T;const R=null===(T=E.customData)||void 0===T?void 0:T._tokenResponse;if("auth/multi-factor-auth-required"===E?.code)E.resolver=new es(C,N.as(C,E));else if(R){const k=Zi(E),ie=E;k&&(ie.credential=k,ie.tenantId=R.tenantId||void 0,ie.email=R.email||void 0,ie.phoneNumber=R.phoneNumber||void 0)}}(C,T),T}).then(T=>{const k=T.user;return{operationType:T.operationType,credential:qn(T),additionalUserInfo:N.aq(T),user:Sr.getOrCreate(k)}})}function Mi(C,E){return fs.apply(this,arguments)}function fs(){return(fs=(0,x.A)(function*(C,E){const T=yield E;return{verificationId:T.verificationId,confirm:R=>Yt(C,T.confirm(R))}})).apply(this,arguments)}class es{constructor(E,T){this.resolver=T,this.auth=function wr(C){return C.wrapped()}(E)}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(E){return Yt(On(this.auth),this.resolver.resolveSignIn(E))}}class Sr{constructor(E){this._delegate=E,this.multiFactor=N.at(E)}static getOrCreate(E){return Sr.USER_MAP.has(E)||Sr.USER_MAP.set(E,new Sr(E)),Sr.USER_MAP.get(E)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(E){return this._delegate.getIdTokenResult(E)}getIdToken(E){return this._delegate.getIdToken(E)}linkAndRetrieveDataWithCredential(E){return this.linkWithCredential(E)}linkWithCredential(E){var T=this;return(0,x.A)(function*(){return Yt(T.auth,N.a2(T._delegate,E))})()}linkWithPhoneNumber(E,T){var R=this;return(0,x.A)(function*(){return Mi(R.auth,N.l(R._delegate,E,T))})()}linkWithPopup(E){var T=this;return(0,x.A)(function*(){return Yt(T.auth,N.d(T._delegate,E,Ni))})()}linkWithRedirect(E){var T=this;return(0,x.A)(function*(){return yield Os(N.aJ(T.auth)),N.g(T._delegate,E,Ni)})()}reauthenticateAndRetrieveDataWithCredential(E){return this.reauthenticateWithCredential(E)}reauthenticateWithCredential(E){var T=this;return(0,x.A)(function*(){return Yt(T.auth,N.a3(T._delegate,E))})()}reauthenticateWithPhoneNumber(E,T){return Mi(this.auth,N.r(this._delegate,E,T))}reauthenticateWithPopup(E){return Yt(this.auth,N.e(this._delegate,E,Ni))}reauthenticateWithRedirect(E){var T=this;return(0,x.A)(function*(){return yield Os(N.aJ(T.auth)),N.h(T._delegate,E,Ni)})()}sendEmailVerification(E){return N.ag(this._delegate,E)}unlink(E){var T=this;return(0,x.A)(function*(){return yield N.ap(T._delegate,E),T})()}updateEmail(E){return N.al(this._delegate,E)}updatePassword(E){return N.am(this._delegate,E)}updatePhoneNumber(E){return N.u(this._delegate,E)}updateProfile(E){return N.ak(this._delegate,E)}verifyBeforeUpdateEmail(E,T){return N.ah(this._delegate,E,T)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Sr.USER_MAP=new WeakMap;const nr=N.aC;let Vr=(()=>{class C{constructor(T,R){if(this.app=T,R.isInitialized())return this._delegate=R.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:k}=T.options;nr(k,"invalid-api-key",{appName:T.name}),nr(k,"invalid-api-key",{appName:T.name});const ie=typeof window<"u"?Ni:void 0;this._delegate=R.initialize({options:{persistence:so(k,T.name),popupRedirectResolver:ie}}),this._delegate._updateErrorMap(N.G),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Sr.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(T){this._delegate.languageCode=T}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(T){this._delegate.tenantId=T}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(T,R){N.K(this._delegate,T,R)}applyActionCode(T){return N.a7(this._delegate,T)}checkActionCode(T){return N.a8(this._delegate,T)}confirmPasswordReset(T,R){return N.a6(this._delegate,T,R)}createUserWithEmailAndPassword(T,R){var k=this;return(0,x.A)(function*(){return Yt(k._delegate,N.aa(k._delegate,T,R))})()}fetchProvidersForEmail(T){return this.fetchSignInMethodsForEmail(T)}fetchSignInMethodsForEmail(T){return N.af(this._delegate,T)}isSignInWithEmailLink(T){return N.ad(this._delegate,T)}getRedirectResult(){var T=this;return(0,x.A)(function*(){nr(kt(),T._delegate,"operation-not-supported-in-this-environment");const R=yield N.j(T._delegate,Ni);return R?Yt(T._delegate,Promise.resolve(R)):{credential:null,user:null}})()}addFrameworkForLogging(T){!function W(C,E){(0,N.aJ)(C)._logFramework(E)}(this._delegate,T)}onAuthStateChanged(T,R,k){const{next:ie,error:ye,complete:He}=io(T,R,k);return this._delegate.onAuthStateChanged(ie,ye,He)}onIdTokenChanged(T,R,k){const{next:ie,error:ye,complete:He}=io(T,R,k);return this._delegate.onIdTokenChanged(ie,ye,He)}sendSignInLinkToEmail(T,R){return N.ac(this._delegate,T,R)}sendPasswordResetEmail(T,R){return N.a5(this._delegate,T,R||void 0)}setPersistence(T){var R=this;return(0,x.A)(function*(){let k;switch(function Po(C,E){hi(Object.values(Ut).includes(E),C,"invalid-persistence-type"),(0,Fe.lV)()?hi(E!==Ut.SESSION,C,"unsupported-persistence-type"):(0,Fe.Ll)()?hi(E===Ut.NONE,C,"unsupported-persistence-type"):gr()?hi(E===Ut.NONE||E===Ut.LOCAL&&(0,Fe.zW)(),C,"unsupported-persistence-type"):hi(E===Ut.NONE||gn(),C,"unsupported-persistence-type")}(R._delegate,T),T){case Ut.SESSION:k=N.a;break;case Ut.LOCAL:k=(yield N.aE(N.i)._isAvailable())?N.i:N.b;break;case Ut.NONE:k=N.U;break;default:return N.ax("argument-error",{appName:R._delegate.name})}return R._delegate.setPersistence(k)})()}signInAndRetrieveDataWithCredential(T){return this.signInWithCredential(T)}signInAnonymously(){return Yt(this._delegate,N.a0(this._delegate))}signInWithCredential(T){return Yt(this._delegate,N.a1(this._delegate,T))}signInWithCustomToken(T){return Yt(this._delegate,N.a4(this._delegate,T))}signInWithEmailAndPassword(T,R){return Yt(this._delegate,N.ab(this._delegate,T,R))}signInWithEmailLink(T,R){return Yt(this._delegate,N.ae(this._delegate,T,R))}signInWithPhoneNumber(T,R){return Mi(this._delegate,N.s(this._delegate,T,R))}signInWithPopup(T){var R=this;return(0,x.A)(function*(){return nr(kt(),R._delegate,"operation-not-supported-in-this-environment"),Yt(R._delegate,N.c(R._delegate,T,Ni))})()}signInWithRedirect(T){var R=this;return(0,x.A)(function*(){return nr(kt(),R._delegate,"operation-not-supported-in-this-environment"),yield Os(R._delegate),N.f(R._delegate,T,Ni)})()}updateCurrentUser(T){return this._delegate.updateCurrentUser(T)}verifyPasswordResetCode(T){return N.a9(this._delegate,T)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}return C.Persistence=Ut,C})();function io(C,E,T){let R=C;"function"!=typeof C&&({next:R,error:E,complete:T}=C);const k=R;return{next:ye=>k(ye&&Sr.getOrCreate(ye)),error:E,complete:T}}function so(C,E){const T=function Xi(C,E){const T=Fs();if(!T)return[];const R=N.aF(no,C,E);switch(T.getItem(R)){case Ut.NONE:return[N.U];case Ut.LOCAL:return[N.i,N.a];case Ut.SESSION:return[N.a];default:return[]}}(C,E);if(typeof self<"u"&&!T.includes(N.i)&&T.push(N.i),typeof window<"u")for(const R of[N.b,N.a])T.includes(R)||T.push(R);return T.includes(N.U)||T.push(N.U),T}class oo{constructor(){this.providerId="phone",this._delegate=new N.P(On(Ae.A.auth()))}static credential(E,T){return N.P.credential(E,T)}verifyPhoneNumber(E,T){return this._delegate.verifyPhoneNumber(E,T)}unwrap(){return this._delegate}}oo.PHONE_SIGN_IN_METHOD=N.P.PHONE_SIGN_IN_METHOD,oo.PROVIDER_ID=N.P.PROVIDER_ID;const No=N.aC;class ya{constructor(E,T,R=Ae.A.app()){var k;No(null===(k=R.options)||void 0===k?void 0:k.apiKey,"invalid-api-key",{appName:R.name}),this._delegate=new N.R(R.auth(),E,T),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function oe(C){C.INTERNAL.registerComponent(new Cn.uA("auth-compat",E=>{const T=E.getProvider("app-compat").getImmediate(),R=E.getProvider("auth");return new Vr(T,R)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:N.A.EMAIL_SIGNIN,PASSWORD_RESET:N.A.PASSWORD_RESET,RECOVER_EMAIL:N.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:N.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:N.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:N.A.VERIFY_EMAIL}},EmailAuthProvider:N.V,FacebookAuthProvider:N.W,GithubAuthProvider:N.Y,GoogleAuthProvider:N.X,OAuthProvider:N.Z,SAMLAuthProvider:N._,PhoneAuthProvider:oo,PhoneMultiFactorGenerator:N.m,RecaptchaVerifier:ya,TwitterAuthProvider:N.$,Auth:Vr,AuthCredential:N.L,Error:Fe.g}).setInstantiationMode("LAZY").setMultipleInstances(!1)),C.registerVersion("@firebase/auth-compat","0.5.14")}(Ae.A)},749:(hs,or,Ge)=>{Ge.d(or,{P2:()=>fn});var x=Ge(467);const Ae=(ve,K)=>K.some(je=>ve instanceof je);let N,Fe;const Cn=new WeakMap,Mt=new WeakMap,ht=new WeakMap,se=new WeakMap,he=new WeakMap;let Tt={get(ve,K,je){if(ve instanceof IDBTransaction){if("done"===K)return Mt.get(ve);if("objectStoreNames"===K)return ve.objectStoreNames||ht.get(ve);if("store"===K)return je.objectStoreNames[1]?void 0:je.objectStore(je.objectStoreNames[0])}return qe(ve[K])},set:(ve,K,je)=>(ve[K]=je,!0),has:(ve,K)=>ve instanceof IDBTransaction&&("done"===K||"store"===K)||K in ve};function Xe(ve){return"function"==typeof ve?function gt(ve){return ve!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?function hn(){return Fe||(Fe=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}().includes(ve)?function(...K){return ve.apply(Wn(this),K),qe(Cn.get(this))}:function(...K){return qe(ve.apply(Wn(this),K))}:function(K,...je){const rt=ve.call(Wn(this),K,...je);return ht.set(rt,K.sort?K.sort():[K]),qe(rt)}}(ve):(ve instanceof IDBTransaction&&function ot(ve){if(Mt.has(ve))return;const K=new Promise((je,rt)=>{const At=()=>{ve.removeEventListener("complete",kn),ve.removeEventListener("error",sn),ve.removeEventListener("abort",sn)},kn=()=>{je(),At()},sn=()=>{rt(ve.error||new DOMException("AbortError","AbortError")),At()};ve.addEventListener("complete",kn),ve.addEventListener("error",sn),ve.addEventListener("abort",sn)});Mt.set(ve,K)}(ve),Ae(ve,function Nt(){return N||(N=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}())?new Proxy(ve,Tt):ve)}function qe(ve){if(ve instanceof IDBRequest)return function Le(ve){const K=new Promise((je,rt)=>{const At=()=>{ve.removeEventListener("success",kn),ve.removeEventListener("error",sn)},kn=()=>{je(qe(ve.result)),At()},sn=()=>{rt(ve.error),At()};ve.addEventListener("success",kn),ve.addEventListener("error",sn)});return K.then(je=>{je instanceof IDBCursor&&Cn.set(je,ve)}).catch(()=>{}),he.set(K,ve),K}(ve);if(se.has(ve))return se.get(ve);const K=Xe(ve);return K!==ve&&(se.set(ve,K),he.set(K,ve)),K}const Wn=ve=>he.get(ve);function fn(ve,K,{blocked:je,upgrade:rt,blocking:At,terminated:kn}={}){const sn=indexedDB.open(ve,K),lt=qe(sn);return rt&&sn.addEventListener("upgradeneeded",pn=>{rt(qe(sn.result),pn.oldVersion,pn.newVersion,qe(sn.transaction),pn)}),je&&sn.addEventListener("blocked",pn=>je(pn.oldVersion,pn.newVersion,pn)),lt.then(pn=>{kn&&pn.addEventListener("close",()=>kn()),At&&pn.addEventListener("versionchange",pr=>At(pr.oldVersion,pr.newVersion,pr))}).catch(()=>{}),lt}const zt=["get","getKey","getAll","getAllKeys","count"],Lr=["put","add","delete","clear"],_t=new Map;function nt(ve,K){if(!(ve instanceof IDBDatabase)||K in ve||"string"!=typeof K)return;if(_t.get(K))return _t.get(K);const je=K.replace(/FromIndex$/,""),rt=K!==je,At=Lr.includes(je);if(!(je in(rt?IDBIndex:IDBObjectStore).prototype)||!At&&!zt.includes(je))return;const kn=function(){var sn=(0,x.A)(function*(lt,...pn){const pr=this.transaction(lt,At?"readwrite":"readonly");let Xr=pr.store;return rt&&(Xr=Xr.index(pn.shift())),(yield Promise.all([Xr[je](...pn),At&&pr.done]))[0]});return function(pn){return sn.apply(this,arguments)}}();return _t.set(K,kn),kn}!function tr(ve){Tt=ve(Tt)}(ve=>({...ve,get:(K,je,rt)=>nt(K,je)||ve.get(K,je,rt),has:(K,je)=>!!nt(K,je)||ve.has(K,je)}))},467:(hs,or,Ge)=>{function x(N,Fe,Nt,hn,Cn,Mt,ht){try{var se=N[Mt](ht),he=se.value}catch(Le){return void Nt(Le)}se.done?Fe(he):Promise.resolve(he).then(hn,Cn)}function Ae(N){return function(){var Fe=this,Nt=arguments;return new Promise(function(hn,Cn){var Mt=N.apply(Fe,Nt);function ht(he){x(Mt,hn,Cn,ht,se,"next",he)}function se(he){x(Mt,hn,Cn,ht,se,"throw",he)}ht(void 0)})}}Ge.d(or,{A:()=>Ae})},635:(hs,or,Ge)=>{function Fe(W,ee){var Q={};for(var $ in W)Object.prototype.hasOwnProperty.call(W,$)&&ee.indexOf($)<0&&(Q[$]=W[$]);if(null!=W&&"function"==typeof Object.getOwnPropertySymbols){var re=0;for($=Object.getOwnPropertySymbols(W);re<$.length;re++)ee.indexOf($[re])<0&&Object.prototype.propertyIsEnumerable.call(W,$[re])&&(Q[$[re]]=W[$[re]])}return Q}function Le(W,ee,Q,$){return new(Q||(Q=Promise))(function(ge,de){function Qe(Ft){try{Ke($.next(Ft))}catch(gn){de(gn)}}function Qt(Ft){try{Ke($.throw(Ft))}catch(gn){de(gn)}}function Ke(Ft){Ft.done?ge(Ft.value):function re(ge){return ge instanceof Q?ge:new Q(function(de){de(ge)})}(Ft.value).then(Qe,Qt)}Ke(($=$.apply(W,ee||[])).next())})}function Ht(W){return this instanceof Ht?(this.v=W,this):new Ht(W)}function zt(W,ee,Q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var re,$=Q.apply(W,ee||[]),ge=[];return re=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),Qe("next"),Qe("throw"),Qe("return",function de(kt){return function(Ot){return Promise.resolve(Ot).then(kt,gn)}}),re[Symbol.asyncIterator]=function(){return this},re;function Qe(kt,Ot){$[kt]&&(re[kt]=function(Gn){return new Promise(function(ar,Ir){ge.push([kt,Gn,ar,Ir])>1||Qt(kt,Gn)})},Ot&&(re[kt]=Ot(re[kt])))}function Qt(kt,Ot){try{!function Ke(kt){kt.value instanceof Ht?Promise.resolve(kt.value.v).then(Ft,gn):gr(ge[0][2],kt)}($[kt](Ot))}catch(Gn){gr(ge[0][3],Gn)}}function Ft(kt){Qt("next",kt)}function gn(kt){Qt("throw",kt)}function gr(kt,Ot){kt(Ot),ge.shift(),ge.length&&Qt(ge[0][0],ge[0][1])}}function _t(W){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Q,ee=W[Symbol.asyncIterator];return ee?ee.call(W):(W=function gt(W){var ee="function"==typeof Symbol&&Symbol.iterator,Q=ee&&W[ee],$=0;if(Q)return Q.call(W);if(W&&"number"==typeof W.length)return{next:function(){return W&&$>=W.length&&(W=void 0),{value:W&&W[$++],done:!W}}};throw new TypeError(ee?"Object is not iterable.":"Symbol.iterator is not defined.")}(W),Q={},$("next"),$("throw"),$("return"),Q[Symbol.asyncIterator]=function(){return this},Q);function $(ge){Q[ge]=W[ge]&&function(de){return new Promise(function(Qe,Qt){!function re(ge,de,Qe,Qt){Promise.resolve(Qt).then(function(Ke){ge({value:Ke,done:Qe})},de)}(Qe,Qt,(de=W[ge](de)).done,de.value)})}}}Ge.d(or,{AQ:()=>zt,N3:()=>Ht,Tt:()=>Fe,sH:()=>Le,xN:()=>_t}),"function"==typeof SuppressedError&&SuppressedError}},hs=>{hs(hs.s=693)}]);